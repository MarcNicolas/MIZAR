/**
 * @license almond 0.2.9 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/*! jQuery v1.11.1 | (c) 2005, 2014 jQuery Foundation, Inc. | jquery.org/license */

//     Underscore.js 1.6.0
//     http://underscorejs.org
//     (c) 2009-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.

/***************************************
 * Copyright 2011, 2012 GlobWeb contributors.
 *
 * This file is part of GlobWeb.
 *
 * GlobWeb is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as published by
 * the Free Software Foundation, version 3 of the License, or
 * (at your option) any later version.
 *
 * GlobWeb is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with GlobWeb. If not, see <http://www.gnu.org/licenses/>.
 ***************************************/

/***************************************
 * Copyright 2011, 2012 GlobWeb contributors.
 *
 * This file is part of GlobWeb.
 *  Ported from HEALPix Java code supported by the Gaia project.
 * 	Copyright (C) 2006-2011 Gaia Data Processing and Analysis Consortium
 *
 * GlobWeb is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as published by
 * the Free Software Foundation, version 3 of the License, or
 * (at your option) any later version.
 *
 * GlobWeb is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with GlobWeb. If not, see <http://www.gnu.org/licenses/>.
 ***************************************/

/*
 * Copyright (c) 2012 Brandon Jones, Colin MacKenzie IV
 *
 * This software is provided 'as-is', without any express or implied
 * warranty. In no event will the authors be held liable for any damages
 * arising from the use of this software.
 *
 * Permission is granted to anyone to use this software for any purpose,
 * including commercial applications, and to alter it and redistribute it
 * freely, subject to the following restrictions:
 *
 *    1. The origin of this software must not be misrepresented; you must not
 *    claim that you wrote the original software. If you use this software
 *    in a product, an acknowledgment in the product documentation would be
 *    appreciated but is not required.
 *
 *    2. Altered source versions must be plainly marked as such, and must not
 *    be misrepresented as being the original software.
 *
 *    3. This notice may not be removed or altered from any source
 *    distribution.
 */

/**
 * @license RequireJS text 2.0.3 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

/***************************************
 * Copyright 2009 The Closure Library Authors. All Rights Reserved. (Apache License, Version 2.0)
 * Copyright 2011, 2012 GlobWeb contributors.
 *
 * This file is part of GlobWeb.
 *
 * GlobWeb is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as published by
 * the Free Software Foundation, version 3 of the License, or
 * (at your option) any later version.
 *
 * GlobWeb is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with GlobWeb. If not, see <http://www.gnu.org/licenses/>.
 ***************************************/

/******************************************************************************* 
* Copyright 2012, 2013 CNES - CENTRE NATIONAL d'ETUDES SPATIALES 
* 
* This file is part of SITools2. 
* 
* SITools2 is free software: you can redistribute it and/or modify 
* it under the terms of the GNU General Public License as published by 
* the Free Software Foundation, either version 3 of the License, or 
* (at your option) any later version. 
* 
* SITools2 is distributed in the hope that it will be useful, 
* but WITHOUT ANY WARRANTY; without even the implied warranty of 
* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the 
* GNU General Public License for more details. 
* 
* You should have received a copy of the GNU General Public License 
* along with SITools2. If not, see <http://www.gnu.org/licenses/>. 
******************************************************************************/

/***************************************
 * Copyright 2010, Aladin by the Centre de Donn√©es astronomiques de Strasbourg (CDS).
 * Copyright 2011, 2012 GlobWeb contributors.
 *
 * This file is part of GlobWeb.
 *
 * GlobWeb is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as published by
 * the Free Software Foundation, version 3 of the License, or
 * (at your option) any later version.
 *
 * GlobWeb is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with GlobWeb. If not, see <http://www.gnu.org/licenses/>.
 ***************************************/

/* Copyright (C) 1999 Masanao Izumo <iz@onicos.co.jp>
 * Version: 1.0.0.1
 * LastModified: Dec 25 1999
 */

/* Copyright (C) 1999 Masanao Izumo <iz@onicos.co.jp>
 * Version: 1.0.1
 * LastModified: Dec 25 1999
 */

/*! jQuery UI - v1.11.0 - 2014-06-26
* http://jqueryui.com
* Includes: core.js, widget.js, mouse.js, position.js, draggable.js, droppable.js, resizable.js, selectable.js, sortable.js, accordion.js, autocomplete.js, button.js, datepicker.js, dialog.js, menu.js, progressbar.js, selectmenu.js, slider.js, spinner.js, tabs.js, tooltip.js, effect.js, effect-blind.js, effect-bounce.js, effect-clip.js, effect-drop.js, effect-explode.js, effect-fade.js, effect-fold.js, effect-highlight.js, effect-puff.js, effect-pulsate.js, effect-scale.js, effect-shake.js, effect-size.js, effect-slide.js, effect-transfer.js
* Copyright 2014 jQuery Foundation and other contributors; Licensed MIT */

/*
 * jQuery timepicker addon
 * By: Trent Richardson [http://trentrichardson.com]
 * Version 1.2
 * Last Modified: 02/02/2013
 *
 * Copyright 2013 Trent Richardson
 * You may use this project under MIT or GPL licenses.
 * http://trentrichardson.com/Impromptu/GPL-LICENSE.txt
 * http://trentrichardson.com/Impromptu/MIT-LICENSE.txt
 */

/******************************************************************************* 
* Code taken from "Virtual Sky" project
*        (c) Stuart Lowe, Las Cumbres Observatory Global Telescope
*
* Copyright 2012, 2013 CNES - CENTRE NATIONAL d'ETUDES SPATIALES 
*
* This file is part of SITools2. 
* 
* SITools2 is free software: you can redistribute it and/or modify 
* it under the terms of the GNU General Public License as published by 
* the Free Software Foundation, either version 3 of the License, or 
* (at your option) any later version. 
* 
* SITools2 is distributed in the hope that it will be useful, 
* but WITHOUT ANY WARRANTY; without even the implied warranty of 
* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the 
* GNU General Public License for more details. 
* 
* You should have received a copy of the GNU General Public License 
* along with SITools2. If not, see <http://www.gnu.org/licenses/>. 
******************************************************************************/

(function(e,t){typeof define=="function"&&define.amd?define(["jquery","underscore"],t):e.MizarWidget=t(e.$,e._)})(this,function($,_){var requirejs,require,define;(function(e){function h(e,t){return f.call(e,t)}function p(e,t){var n,r,i,s,o,a,f,l,h,p,d,v=t&&t.split("/"),m=u.map,g=m&&m["*"]||{};if(e&&e.charAt(0)===".")if(t){v=v.slice(0,v.length-1),e=e.split("/"),o=e.length-1,u.nodeIdCompat&&c.test(e[o])&&(e[o]=e[o].replace(c,"")),e=v.concat(e);for(h=0;h<e.length;h+=1){d=e[h];if(d===".")e.splice(h,1),h-=1;else if(d===".."){if(h===1&&(e[2]===".."||e[0]===".."))break;h>0&&(e.splice(h-1,2),h-=2)}}e=e.join("/")}else e.indexOf("./")===0&&(e=e.substring(2));if((v||g)&&m){n=e.split("/");for(h=n.length;h>0;h-=1){r=n.slice(0,h).join("/");if(v)for(p=v.length;p>0;p-=1){i=m[v.slice(0,p).join("/")];if(i){i=i[r];if(i){s=i,a=h;break}}}if(s)break;!f&&g&&g[r]&&(f=g[r],l=h)}!s&&f&&(s=f,a=l),s&&(n.splice(0,a,s),e=n.join("/"))}return e}function d(t,r){return function(){return n.apply(e,l.call(arguments,0).concat([t,r]))}}function v(e){return function(t){return p(t,e)}}function m(e){return function(t){s[e]=t}}function g(n){if(h(o,n)){var r=o[n];delete o[n],a[n]=!0,t.apply(e,r)}if(!h(s,n)&&!h(a,n))throw new Error("No "+n);return s[n]}function y(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function b(e){return function(){return u&&u.config&&u.config[e]||{}}}var t,n,r,i,s={},o={},u={},a={},f=Object.prototype.hasOwnProperty,l=[].slice,c=/\.js$/;r=function(e,t){var n,r=y(e),i=r[0];return e=r[1],i&&(i=p(i,t),n=g(i)),i?n&&n.normalize?e=n.normalize(e,v(t)):e=p(e,t):(e=p(e,t),r=y(e),i=r[0],e=r[1],i&&(n=g(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},i={require:function(e){return d(e)},exports:function(e){var t=s[e];return typeof t!="undefined"?t:s[e]={}},module:function(e){return{id:e,uri:"",exports:s[e],config:b(e)}}},t=function(t,n,u,f){var l,c,p,v,y,b=[],w=typeof u,E;f=f||t;if(w==="undefined"||w==="function"){n=!n.length&&u.length?["require","exports","module"]:n;for(y=0;y<n.length;y+=1){v=r(n[y],f),c=v.f;if(c==="require")b[y]=i.require(t);else if(c==="exports")b[y]=i.exports(t),E=!0;else if(c==="module")l=b[y]=i.module(t);else if(h(s,c)||h(o,c)||h(a,c))b[y]=g(c);else{if(!v.p)throw new Error(t+" missing "+c);v.p.load(v.n,d(f,!0),m(c),{}),b[y]=s[c]}}p=u?u.apply(s[t],b):undefined;if(t)if(l&&l.exports!==e&&l.exports!==s[t])s[t]=l.exports;else if(p!==e||!E)s[t]=p}else t&&(s[t]=u)},requirejs=require=n=function(s,o,a,f,l){if(typeof s=="string")return i[s]?i[s](o):g(r(s,o).f);if(!s.splice){u=s,u.deps&&n(u.deps,u.callback);if(!o)return;o.splice?(s=o,o=a,a=null):s=e}return o=o||function(){},typeof a=="function"&&(a=f,f=l),f?t(e,s,o,a):setTimeout(function(){t(e,s,o,a)},4),n},n.config=function(e){return n(e)},requirejs._defined=s,define=function(e,t,n){t.splice||(n=t,t=[]),!h(s,e)&&!h(o,e)&&(o[e]=[e,t,n])},define.amd={jQuery:!0}})(),define("../build/almond",function(){}),!function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function g(e){var t=e.length,n=h.type(e);return"function"===n||h.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e}function S(e,t,n){if(h.isFunction(t))return h.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return h.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(E.test(t))return h.filter(t,e,n);t=h.filter(t,e)}return h.grep(e,function(e){return h.inArray(e,t)>=0!==n})}function A(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}function _(e){var t=M[e]={};return h.each(e.match(O)||[],function(e,n){t[n]=!0}),t}function P(){T.addEventListener?(T.removeEventListener("DOMContentLoaded",H,!1),e.removeEventListener("load",H,!1)):(T.detachEvent("onreadystatechange",H),e.detachEvent("onload",H))}function H(){(T.addEventListener||"load"===event.type||"complete"===T.readyState)&&(P(),h.ready())}function q(e,t,n){if(void 0===n&&1===e.nodeType){var r="data-"+t.replace(I,"-$1").toLowerCase();if(n=e.getAttribute(r),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:F.test(n)?h.parseJSON(n):n}catch(i){}h.data(e,t,n)}else n=void 0}return n}function R(e){var t;for(t in e)if(("data"!==t||!h.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function U(e,t,r,i){if(h.acceptData(e)){var s,o,u=h.expando,a=e.nodeType,f=a?h.cache:e,l=a?e[u]:e[u]&&u;if(l&&f[l]&&(i||f[l].data)||void 0!==r||"string"!=typeof t)return l||(l=a?e[u]=n.pop()||h.guid++:u),f[l]||(f[l]=a?{}:{toJSON:h.noop}),("object"==typeof t||"function"==typeof t)&&(i?f[l]=h.extend(f[l],t):f[l].data=h.extend(f[l].data,t)),o=f[l],i||(o.data||(o.data={}),o=o.data),void 0!==r&&(o[h.camelCase(t)]=r),"string"==typeof t?(s=o[t],null==s&&(s=o[h.camelCase(t)])):s=o,s}}function z(e,t,n){if(h.acceptData(e)){var r,i,s=e.nodeType,o=s?h.cache:e,u=s?e[h.expando]:h.expando;if(o[u]){if(t&&(r=n?o[u]:o[u].data)){h.isArray(t)?t=t.concat(h.map(t,h.camelCase)):t in r?t=[t]:(t=h.camelCase(t),t=t in r?[t]:t.split(" ")),i=t.length;while(i--)delete r[t[i]];if(n?!R(r):!h.isEmptyObject(r))return}(n||(delete o[u].data,R(o[u])))&&(s?h.cleanData([e],!0):l.deleteExpando||o!=o.window?delete o[u]:o[u]=null)}}}function et(){return!0}function tt(){return!1}function nt(){try{return T.activeElement}catch(e){}}function rt(e){var t=it.split("|"),n=e.createDocumentFragment();if(n.createElement)while(t.length)n.createElement(t.pop());return n}function wt(e,t){var n,r,i=0,s=typeof e.getElementsByTagName!==B?e.getElementsByTagName(t||"*"):typeof e.querySelectorAll!==B?e.querySelectorAll(t||"*"):void 0;if(!s)for(s=[],n=e.childNodes||e;null!=(r=n[i]);i++)!t||h.nodeName(r,t)?s.push(r):h.merge(s,wt(r,t));return void 0===t||t&&h.nodeName(e,t)?h.merge([e],s):s}function Et(e){J.test(e.type)&&(e.defaultChecked=e.checked)}function St(e,t){return h.nodeName(e,"table")&&h.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function xt(e){return e.type=(null!==h.find.attr(e,"type"))+"/"+e.type,e}function Tt(e){var t=vt.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function Nt(e,t){for(var n,r=0;null!=(n=e[r]);r++)h._data(n,"globalEval",!t||h._data(t[r],"globalEval"))}function Ct(e,t){if(1===t.nodeType&&h.hasData(e)){var n,r,i,s=h._data(e),o=h._data(t,s),u=s.events;if(u){delete o.handle,o.events={};for(n in u)for(r=0,i=u[n].length;i>r;r++)h.event.add(t,n,u[n][r])}o.data&&(o.data=h.extend({},o.data))}}function kt(e,t){var n,r,i;if(1===t.nodeType){if(n=t.nodeName.toLowerCase(),!l.noCloneEvent&&t[h.expando]){i=h._data(t);for(r in i.events)h.removeEvent(t,r,i.handle);t.removeAttribute(h.expando)}"script"===n&&t.text!==e.text?(xt(t).text=e.text,Tt(t)):"object"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),l.html5Clone&&e.innerHTML&&!h.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===n&&J.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===n?t.defaultSelected=t.selected=e.defaultSelected:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}}function Ot(t,n){var r,i=h(n.createElement(t)).appendTo(n.body),s=e.getDefaultComputedStyle&&(r=e.getDefaultComputedStyle(i[0]))?r.display:h.css(i[0],"display");return i.detach(),s}function Mt(e){var t=T,n=At[e];return n||(n=Ot(e,t),"none"!==n&&n||(Lt=(Lt||h("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement),t=(Lt[0].contentWindow||Lt[0].contentDocument).document,t.write(),t.close(),n=Ot(e,t),Lt.detach()),At[e]=n),n}function jt(e,t){return{get:function(){var n=e();if(null!=n)return n?void delete this.get:(this.get=t).apply(this,arguments)}}}function Vt(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=Xt.length;while(i--)if(t=Xt[i]+n,t in e)return t;return r}function $t(e,t){for(var n,r,i,s=[],o=0,u=e.length;u>o;o++)r=e[o],r.style&&(s[o]=h._data(r,"olddisplay"),n=r.style.display,t?(s[o]||"none"!==n||(r.style.display=""),""===r.style.display&&V(r)&&(s[o]=h._data(r,"olddisplay",Mt(r.nodeName)))):(i=V(r),(n&&"none"!==n||!i)&&h._data(r,"olddisplay",i?n:h.css(r,"display"))));for(o=0;u>o;o++)r=e[o],r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?s[o]||"":"none"));return e}function Jt(e,t,n){var r=Rt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function Kt(e,t,n,r,i){for(var s=n===(r?"border":"content")?4:"width"===t?1:0,o=0;4>s;s+=2)"margin"===n&&(o+=h.css(e,n+X[s],!0,i)),r?("content"===n&&(o-=h.css(e,"padding"+X[s],!0,i)),"margin"!==n&&(o-=h.css(e,"border"+X[s]+"Width",!0,i))):(o+=h.css(e,"padding"+X[s],!0,i),"padding"!==n&&(o+=h.css(e,"border"+X[s]+"Width",!0,i)));return o}function Qt(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,s=Pt(e),o=l.boxSizing&&"border-box"===h.css(e,"boxSizing",!1,s);if(0>=i||null==i){if(i=Ht(e,t,s),(0>i||null==i)&&(i=e.style[t]),Dt.test(i))return i;r=o&&(l.boxSizingReliable()||i===e.style[t]),i=parseFloat(i)||0}return i+Kt(e,t,n||(o?"border":"content"),r,s)+"px"}function Gt(e,t,n,r,i){return new Gt.prototype.init(e,t,n,r,i)}function on(){return setTimeout(function(){Yt=void 0}),Yt=h.now()}function un(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=X[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function an(e,t,n){for(var r,i=(sn[t]||[]).concat(sn["*"]),s=0,o=i.length;o>s;s++)if(r=i[s].call(n,t,e))return r}function fn(e,t,n){var r,i,s,o,u,a,f,c,p=this,d={},v=e.style,m=e.nodeType&&V(e),g=h._data(e,"fxshow");n.queue||(u=h._queueHooks(e,"fx"),null==u.unqueued&&(u.unqueued=0,a=u.empty.fire,u.empty.fire=function(){u.unqueued||a()}),u.unqueued++,p.always(function(){p.always(function(){u.unqueued--,h.queue(e,"fx").length||u.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[v.overflow,v.overflowX,v.overflowY],f=h.css(e,"display"),c="none"===f?h._data(e,"olddisplay")||Mt(e.nodeName):f,"inline"===c&&"none"===h.css(e,"float")&&(l.inlineBlockNeedsLayout&&"inline"!==Mt(e.nodeName)?v.zoom=1:v.display="inline-block")),n.overflow&&(v.overflow="hidden",l.shrinkWrapBlocks()||p.always(function(){v.overflow=n.overflow[0],v.overflowX=n.overflow[1],v.overflowY=n.overflow[2]}));for(r in t)if(i=t[r],en.exec(i)){if(delete t[r],s=s||"toggle"===i,i===(m?"hide":"show")){if("show"!==i||!g||void 0===g[r])continue;m=!0}d[r]=g&&g[r]||h.style(e,r)}else f=void 0;if(h.isEmptyObject(d))"inline"===("none"===f?Mt(e.nodeName):f)&&(v.display=f);else{g?"hidden"in g&&(m=g.hidden):g=h._data(e,"fxshow",{}),s&&(g.hidden=!m),m?h(e).show():p.done(function(){h(e).hide()}),p.done(function(){var t;h._removeData(e,"fxshow");for(t in d)h.style(e,t,d[t])});for(r in d)o=an(m?g[r]:0,r,p),r in g||(g[r]=o.start,m&&(o.end=o.start,o.start="width"===r||"height"===r?1:0))}}function ln(e,t){var n,r,i,s,o;for(n in e)if(r=h.camelCase(n),i=t[r],s=e[n],h.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=h.cssHooks[r],o&&"expand"in o){s=o.expand(s),delete e[r];for(n in s)n in e||(e[n]=s[n],t[n]=i)}else t[r]=i}function cn(e,t,n){var r,i,s=0,o=rn.length,u=h.Deferred().always(function(){delete a.elem}),a=function(){if(i)return!1;for(var t=Yt||on(),n=Math.max(0,f.startTime+f.duration-t),r=n/f.duration||0,s=1-r,o=0,a=f.tweens.length;a>o;o++)f.tweens[o].run(s);return u.notifyWith(e,[f,s,n]),1>s&&a?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:h.extend({},t),opts:h.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Yt||on(),duration:n.duration,tweens:[],createTween:function(t,n){var r=h.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(r),r},stop:function(t){var n=0,r=t?f.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;for(ln(l,f.opts.specialEasing);o>s;s++)if(r=rn[s].call(f,e,l,f.opts))return r;return h.map(l,an,f),h.isFunction(f.opts.start)&&f.opts.start.call(e,f),h.fx.timer(h.extend(a,{elem:e,anim:f,queue:f.opts.queue})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function Fn(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,s=t.toLowerCase().match(O)||[];if(h.isFunction(n))while(r=s[i++])"+"===r.charAt(0)?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function In(e,t,n,r){function o(u){var a;return i[u]=!0,h.each(e[u]||[],function(e,u){var f=u(t,n,r);return"string"!=typeof f||s||i[f]?s?!(a=f):void 0:(t.dataTypes.unshift(f),o(f),!1)}),a}var i={},s=e===Hn;return o(t.dataTypes[0])||!i["*"]&&o("*")}function qn(e,t){var n,r,i=h.ajaxSettings.flatOptions||{};for(r in t)void 0!==t[r]&&((i[r]?e:n||(n={}))[r]=t[r]);return n&&h.extend(!0,e,n),e}function Rn(e,t,n){var r,i,s,o,u=e.contents,a=e.dataTypes;while("*"===a[0])a.shift(),void 0===i&&(i=e.mimeType||t.getResponseHeader("Content-Type"));if(i)for(o in u)if(u[o]&&u[o].test(i)){a.unshift(o);break}if(a[0]in n)s=a[0];else{for(o in n){if(!a[0]||e.converters[o+" "+a[0]]){s=o;break}r||(r=o)}s=s||r}return s?(s!==a[0]&&a.unshift(s),n[s]):void 0}function Un(e,t,n,r){var i,s,o,u,a,f={},l=e.dataTypes.slice();if(l[1])for(o in e.converters)f[o.toLowerCase()]=e.converters[o];s=l.shift();while(s)if(e.responseFields[s]&&(n[e.responseFields[s]]=t),!a&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),a=s,s=l.shift())if("*"===s)s=a;else if("*"!==a&&a!==s){if(o=f[a+" "+s]||f["* "+s],!o)for(i in f)if(u=i.split(" "),u[1]===s&&(o=f[a+" "+u[0]]||f["* "+u[0]])){o===!0?o=f[i]:f[i]!==!0&&(s=u[0],l.unshift(u[1]));break}if(o!==!0)if(o&&e["throws"])t=o(t);else try{t=o(t)}catch(c){return{state:"parsererror",error:o?c:"No conversion from "+a+" to "+s}}}return{state:"success",data:t}}function Jn(e,t,n,r){var i;if(h.isArray(t))h.each(t,function(t,i){n||Wn.test(e)?r(e,i):Jn(e+"["+("object"==typeof i?t:"")+"]",i,n,r)});else if(n||"object"!==h.type(t))r(e,t);else for(i in t)Jn(e+"["+i+"]",t[i],n,r)}function Yn(){try{return new e.XMLHttpRequest}catch(t){}}function Zn(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function ir(e){return h.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}var n=[],r=n.slice,i=n.concat,s=n.push,o=n.indexOf,u={},a=u.toString,f=u.hasOwnProperty,l={},c="1.11.1",h=function(e,t){return new h.fn.init(e,t)},p=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,d=/^-ms-/,v=/-([\da-z])/gi,m=function(e,t){return t.toUpperCase()};h.fn=h.prototype={jquery:c,constructor:h,selector:"",length:0,toArray:function(){return r.call(this)},get:function(e){return null!=e?0>e?this[e+this.length]:this[e]:r.call(this)},pushStack:function(e){var t=h.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return h.each(this,e,t)},map:function(e){return this.pushStack(h.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(r.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:s,sort:n.sort,splice:n.splice},h.extend=h.fn.extend=function(){var e,t,n,r,i,s,o=arguments[0]||{},u=1,a=arguments.length,f=!1;for("boolean"==typeof o&&(f=o,o=arguments[u]||{},u++),"object"==typeof o||h.isFunction(o)||(o={}),u===a&&(o=this,u--);a>u;u++)if(null!=(i=arguments[u]))for(r in i)e=o[r],n=i[r],o!==n&&(f&&n&&(h.isPlainObject(n)||(t=h.isArray(n)))?(t?(t=!1,s=e&&h.isArray(e)?e:[]):s=e&&h.isPlainObject(e)?e:{},o[r]=h.extend(f,s,n)):void 0!==n&&(o[r]=n));return o},h.extend({expando:"jQuery"+(c+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===h.type(e)},isArray:Array.isArray||function(e){return"array"===h.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!h.isArray(e)&&e-parseFloat(e)>=0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},isPlainObject:function(e){var t;if(!e||"object"!==h.type(e)||e.nodeType||h.isWindow(e))return!1;try{if(e.constructor&&!f.call(e,"constructor")&&!f.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}if(l.ownLast)for(t in e)return f.call(e,t);for(t in e);return void 0===t||f.call(e,t)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?u[a.call(e)]||"object":typeof e},globalEval:function(t){t&&h.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(d,"ms-").replace(v,m)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,s=e.length,o=g(e);if(n){if(o){for(;s>i;i++)if(r=t.apply(e[i],n),r===!1)break}else for(i in e)if(r=t.apply(e[i],n),r===!1)break}else if(o){for(;s>i;i++)if(r=t.call(e[i],i,e[i]),r===!1)break}else for(i in e)if(r=t.call(e[i],i,e[i]),r===!1)break;return e},trim:function(e){return null==e?"":(e+"").replace(p,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(g(Object(e))?h.merge(n,"string"==typeof e?[e]:e):s.call(n,e)),n},inArray:function(e,t,n){var r;if(t){if(o)return o.call(t,e,n);for(r=t.length,n=n?0>n?Math.max(0,r+n):n:0;r>n;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,t){var n=+t.length,r=0,i=e.length;while(n>r)e[i++]=t[r++];if(n!==n)while(void 0!==t[r])e[i++]=t[r++];return e.length=i,e},grep:function(e,t,n){for(var r,i=[],s=0,o=e.length,u=!n;o>s;s++)r=!t(e[s],s),r!==u&&i.push(e[s]);return i},map:function(e,t,n){var r,s=0,o=e.length,u=g(e),a=[];if(u)for(;o>s;s++)r=t(e[s],s,n),null!=r&&a.push(r);else for(s in e)r=t(e[s],s,n),null!=r&&a.push(r);return i.apply([],a)},guid:1,proxy:function(e,t){var n,i,s;return"string"==typeof t&&(s=e[t],t=e,e=s),h.isFunction(e)?(n=r.call(arguments,2),i=function(){return e.apply(t||this,n.concat(r.call(arguments)))},i.guid=e.guid=e.guid||h.guid++,i):void 0},now:function(){return+(new Date)},support:l}),h.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){u["[object "+t+"]"]=t.toLowerCase()});var y=function(e){function st(e,t,r,i){var s,u,f,l,c,d,g,y,S,x;if((t?t.ownerDocument||t:E)!==p&&h(t),t=t||p,r=r||[],!e||"string"!=typeof e)return r;if(1!==(l=t.nodeType)&&9!==l)return[];if(v&&!i){if(s=Z.exec(e))if(f=s[1]){if(9===l){if(u=t.getElementById(f),!u||!u.parentNode)return r;if(u.id===f)return r.push(u),r}else if(t.ownerDocument&&(u=t.ownerDocument.getElementById(f))&&b(t,u)&&u.id===f)return r.push(u),r}else{if(s[2])return P.apply(r,t.getElementsByTagName(e)),r;if((f=s[3])&&n.getElementsByClassName&&t.getElementsByClassName)return P.apply(r,t.getElementsByClassName(f)),r}if(n.qsa&&(!m||!m.test(e))){if(y=g=w,S=t,x=9===l&&e,1===l&&"object"!==t.nodeName.toLowerCase()){d=o(e),(g=t.getAttribute("id"))?y=g.replace(tt,"\\$&"):t.setAttribute("id",y),y="[id='"+y+"'] ",c=d.length;while(c--)d[c]=y+mt(d[c]);S=et.test(e)&&dt(t.parentNode)||t,x=d.join(",")}if(x)try{return P.apply(r,S.querySelectorAll(x)),r}catch(T){}finally{g||t.removeAttribute("id")}}}return a(e.replace(z,"$1"),t,r,i)}function ot(){function t(n,i){return e.push(n+" ")>r.cacheLength&&delete t[e.shift()],t[n+" "]=i}var e=[];return t}function ut(e){return e[w]=!0,e}function at(e){var t=p.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function ft(e,t){var n=e.split("|"),i=e.length;while(i--)r.attrHandle[n[i]]=t}function lt(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||A)-(~e.sourceIndex||A);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function ct(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function ht(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function pt(e){return ut(function(t){return t=+t,ut(function(n,r){var i,s=e([],n.length,t),o=s.length;while(o--)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function dt(e){return e&&typeof e.getElementsByTagName!==L&&e}function vt(){}function mt(e){for(var t=0,n=e.length,r="";n>t;t++)r+=e[t].value;return r}function gt(e,t,n){var r=t.dir,i=n&&"parentNode"===r,s=x++;return t.first?function(t,n,s){while(t=t[r])if(1===t.nodeType||i)return e(t,n,s)}:function(t,n,o){var u,a,f=[S,s];if(o){while(t=t[r])if((1===t.nodeType||i)&&e(t,n,o))return!0}else while(t=t[r])if(1===t.nodeType||i){if(a=t[w]||(t[w]={}),(u=a[r])&&u[0]===S&&u[1]===s)return f[2]=u[2];if(a[r]=f,f[2]=e(t,n,o))return!0}}}function yt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function bt(e,t,n){for(var r=0,i=t.length;i>r;r++)st(e,t[r],n);return n}function wt(e,t,n,r,i){for(var s,o=[],u=0,a=e.length,f=null!=t;a>u;u++)(s=e[u])&&(!n||n(s,r,i))&&(o.push(s),f&&t.push(u));return o}function Et(e,t,n,r,i,s){return r&&!r[w]&&(r=Et(r)),i&&!i[w]&&(i=Et(i,s)),ut(function(s,o,u,a){var f,l,c,h=[],p=[],d=o.length,v=s||bt(t||"*",u.nodeType?[u]:u,[]),m=!e||!s&&t?v:wt(v,h,e,u,a),g=n?i||(s?e:d||r)?[]:o:m;if(n&&n(m,g,u,a),r){f=wt(g,p),r(f,[],u,a),l=f.length;while(l--)(c=f[l])&&(g[p[l]]=!(m[p[l]]=c))}if(s){if(i||e){if(i){f=[],l=g.length;while(l--)(c=g[l])&&f.push(m[l]=c);i(null,g=[],f,a)}l=g.length;while(l--)(c=g[l])&&(f=i?B.call(s,c):h[l])>-1&&(s[f]=!(o[f]=c))}}else g=wt(g===o?g.splice(d,g.length):g),i?i(null,o,g,a):P.apply(o,g)})}function St(e){for(var t,n,i,s=e.length,o=r.relative[e[0].type],u=o||r.relative[" "],a=o?1:0,l=gt(function(e){return e===t},u,!0),c=gt(function(e){return B.call(t,e)>-1},u,!0),h=[function(e,n,r){return!o&&(r||n!==f)||((t=n).nodeType?l(e,n,r):c(e,n,r))}];s>a;a++)if(n=r.relative[e[a].type])h=[gt(yt(h),n)];else{if(n=r.filter[e[a].type].apply(null,e[a].matches),n[w]){for(i=++a;s>i;i++)if(r.relative[e[i].type])break;return Et(a>1&&yt(h),a>1&&mt(e.slice(0,a-1).concat({value:" "===e[a-2].type?"*":""})).replace(z,"$1"),n,i>a&&St(e.slice(a,i)),s>i&&St(e=e.slice(i)),s>i&&mt(e))}h.push(n)}return yt(h)}function xt(e,t){var n=t.length>0,i=e.length>0,s=function(s,o,u,a,l){var c,h,d,v=0,m="0",g=s&&[],y=[],b=f,w=s||i&&r.find.TAG("*",l),E=S+=null==b?1:Math.random()||.1,x=w.length;for(l&&(f=o!==p&&o);m!==x&&null!=(c=w[m]);m++){if(i&&c){h=0;while(d=e[h++])if(d(c,o,u)){a.push(c);break}l&&(S=E)}n&&((c=!d&&c)&&v--,s&&g.push(c))}if(v+=m,n&&m!==v){h=0;while(d=t[h++])d(g,y,o,u);if(s){if(v>0)while(m--)g[m]||y[m]||(y[m]=_.call(a));y=wt(y)}P.apply(a,y),l&&!s&&y.length>0&&v+t.length>1&&st.uniqueSort(a)}return l&&(S=E,f=b),g};return n?ut(s):s}var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w="sizzle"+ -(new Date),E=e.document,S=0,x=0,T=ot(),N=ot(),C=ot(),k=function(e,t){return e===t&&(c=!0),0},L="undefined",A=1<<31,O={}.hasOwnProperty,M=[],_=M.pop,D=M.push,P=M.push,H=M.slice,B=M.indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(this[t]===e)return t;return-1},j="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",F="[\\x20\\t\\r\\n\\f]",I="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",q=I.replace("w","w#"),R="\\["+F+"*("+I+")(?:"+F+"*([*^$|!~]?=)"+F+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+q+"))|)"+F+"*\\]",U=":("+I+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+R+")*)|.*)\\)|)",z=new RegExp("^"+F+"+|((?:^|[^\\\\])(?:\\\\.)*)"+F+"+$","g"),W=new RegExp("^"+F+"*,"+F+"*"),X=new RegExp("^"+F+"*([>+~]|"+F+")"+F+"*"),V=new RegExp("="+F+"*([^\\]'\"]*?)"+F+"*\\]","g"),$=new RegExp(U),J=new RegExp("^"+q+"$"),K={ID:new RegExp("^#("+I+")"),CLASS:new RegExp("^\\.("+I+")"),TAG:new RegExp("^("+I.replace("w","w*")+")"),ATTR:new RegExp("^"+R),PSEUDO:new RegExp("^"+U),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+F+"*(even|odd|(([+-]|)(\\d*)n|)"+F+"*(?:([+-]|)"+F+"*(\\d+)|))"+F+"*\\)|)","i"),bool:new RegExp("^(?:"+j+")$","i"),needsContext:new RegExp("^"+F+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+F+"*((?:-\\d)?\\d*)"+F+"*\\)|)(?=[^-]|$)","i")},Q=/^(?:input|select|textarea|button)$/i,G=/^h\d$/i,Y=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,et=/[+~]/,tt=/'|\\/g,nt=new RegExp("\\\\([\\da-f]{1,6}"+F+"?|("+F+")|.)","ig"),rt=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:0>r?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)};try{P.apply(M=H.call(E.childNodes),E.childNodes),M[E.childNodes.length].nodeType}catch(it){P={apply:M.length?function(e,t){D.apply(e,H.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}n=st.support={},s=st.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},h=st.setDocument=function(e){var t,i=e?e.ownerDocument||e:E,o=i.defaultView;return i!==p&&9===i.nodeType&&i.documentElement?(p=i,d=i.documentElement,v=!s(i),o&&o!==o.top&&(o.addEventListener?o.addEventListener("unload",function(){h()},!1):o.attachEvent&&o.attachEvent("onunload",function(){h()})),n.attributes=at(function(e){return e.className="i",!e.getAttribute("className")}),n.getElementsByTagName=at(function(e){return e.appendChild(i.createComment("")),!e.getElementsByTagName("*").length}),n.getElementsByClassName=Y.test(i.getElementsByClassName)&&at(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),n.getById=at(function(e){return d.appendChild(e).id=w,!i.getElementsByName||!i.getElementsByName(w).length}),n.getById?(r.find.ID=function(e,t){if(typeof t.getElementById!==L&&v){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},r.filter.ID=function(e){var t=e.replace(nt,rt);return function(e){return e.getAttribute("id")===t}}):(delete r.find.ID,r.filter.ID=function(e){var t=e.replace(nt,rt);return function(e){var n=typeof e.getAttributeNode!==L&&e.getAttributeNode("id");return n&&n.value===t}}),r.find.TAG=n.getElementsByTagName?function(e,t){return typeof t.getElementsByTagName!==L?t.getElementsByTagName(e):void 0}:function(e,t){var n,r=[],i=0,s=t.getElementsByTagName(e);if("*"===e){while(n=s[i++])1===n.nodeType&&r.push(n);return r}return s},r.find.CLASS=n.getElementsByClassName&&function(e,t){return typeof t.getElementsByClassName!==L&&v?t.getElementsByClassName(e):void 0},g=[],m=[],(n.qsa=Y.test(i.querySelectorAll))&&(at(function(e){e.innerHTML="<select msallowclip=''><option selected=''></option></select>",e.querySelectorAll("[msallowclip^='']").length&&m.push("[*^$]="+F+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||m.push("\\["+F+"*(?:value|"+j+")"),e.querySelectorAll(":checked").length||m.push(":checked")}),at(function(e){var t=i.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&m.push("name"+F+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||m.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),m.push(",.*:")})),(n.matchesSelector=Y.test(y=d.matches||d.webkitMatchesSelector||d.mozMatchesSelector||d.oMatchesSelector||d.msMatchesSelector))&&at(function(e){n.disconnectedMatch=y.call(e,"div"),y.call(e,"[s!='']:x"),g.push("!=",U)}),m=m.length&&new RegExp(m.join("|")),g=g.length&&new RegExp(g.join("|")),t=Y.test(d.compareDocumentPosition),b=t||Y.test(d.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!!r&&1===r.nodeType&&!!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},k=t?function(e,t){if(e===t)return c=!0,0;var r=!e.compareDocumentPosition-!t.compareDocumentPosition;return r?r:(r=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&r||!n.sortDetached&&t.compareDocumentPosition(e)===r?e===i||e.ownerDocument===E&&b(E,e)?-1:t===i||t.ownerDocument===E&&b(E,t)?1:l?B.call(l,e)-B.call(l,t):0:4&r?-1:1)}:function(e,t){if(e===t)return c=!0,0;var n,r=0,s=e.parentNode,o=t.parentNode,u=[e],a=[t];if(!s||!o)return e===i?-1:t===i?1:s?-1:o?1:l?B.call(l,e)-B.call(l,t):0;if(s===o)return lt(e,t);n=e;while(n=n.parentNode)u.unshift(n);n=t;while(n=n.parentNode)a.unshift(n);while(u[r]===a[r])r++;return r?lt(u[r],a[r]):u[r]===E?-1:a[r]===E?1:0},i):p},st.matches=function(e,t){return st(e,null,null,t)},st.matchesSelector=function(e,t){if((e.ownerDocument||e)!==p&&h(e),t=t.replace(V,"='$1']"),!(!n.matchesSelector||!v||g&&g.test(t)||m&&m.test(t)))try{var r=y.call(e,t);if(r||n.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(i){}return st(t,p,null,[e]).length>0},st.contains=function(e,t){return(e.ownerDocument||e)!==p&&h(e),b(e,t)},st.attr=function(e,t){(e.ownerDocument||e)!==p&&h(e);var i=r.attrHandle[t.toLowerCase()],s=i&&O.call(r.attrHandle,t.toLowerCase())?i(e,t,!v):void 0;return void 0!==s?s:n.attributes||!v?e.getAttribute(t):(s=e.getAttributeNode(t))&&s.specified?s.value:null},st.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},st.uniqueSort=function(e){var t,r=[],i=0,s=0;if(c=!n.detectDuplicates,l=!n.sortStable&&e.slice(0),e.sort(k),c){while(t=e[s++])t===e[s]&&(i=r.push(s));while(i--)e.splice(r[i],1)}return l=null,e},i=st.getText=function(e){var t,n="",r=0,s=e.nodeType;if(s){if(1===s||9===s||11===s){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=i(e)}else if(3===s||4===s)return e.nodeValue}else while(t=e[r++])n+=i(t);return n},r=st.selectors={cacheLength:50,createPseudo:ut,match:K,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(nt,rt),e[3]=(e[3]||e[4]||e[5]||"").replace(nt,rt),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||st.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&st.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return K.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&$.test(n)&&(t=o(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(nt,rt).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=T[e+" "];return t||(t=new RegExp("(^|"+F+")"+e+"("+F+"|$)"))&&T(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==L&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=st.attr(r,e);return null==i?"!="===t:t?(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i+" ").indexOf(n)>-1:"|="===t?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var s="nth"!==e.slice(0,3),o="last"!==e.slice(-4),u="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,a){var f,l,c,h,p,d,v=s!==o?"nextSibling":"previousSibling",m=t.parentNode,g=u&&t.nodeName.toLowerCase(),y=!a&&!u;if(m){if(s){while(v){c=t;while(c=c[v])if(u?c.nodeName.toLowerCase()===g:1===c.nodeType)return!1;d=v="only"===e&&!d&&"nextSibling"}return!0}if(d=[o?m.firstChild:m.lastChild],o&&y){l=m[w]||(m[w]={}),f=l[e]||[],p=f[0]===S&&f[1],h=f[0]===S&&f[2],c=p&&m.childNodes[p];while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if(1===c.nodeType&&++h&&c===t){l[e]=[S,p,h];break}}else if(y&&(f=(t[w]||(t[w]={}))[e])&&f[0]===S)h=f[1];else while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if((u?c.nodeName.toLowerCase()===g:1===c.nodeType)&&++h&&(y&&((c[w]||(c[w]={}))[e]=[S,h]),c===t))break;return h-=i,h===r||h%r===0&&h/r>=0}}},PSEUDO:function(e,t){var n,i=r.pseudos[e]||r.setFilters[e.toLowerCase()]||st.error("unsupported pseudo: "+e);return i[w]?i(t):i.length>1?(n=[e,e,"",t],r.setFilters.hasOwnProperty(e.toLowerCase())?ut(function(e,n){var r,s=i(e,t),o=s.length;while(o--)r=B.call(e,s[o]),e[r]=!(n[r]=s[o])}):function(e){return i(e,0,n)}):i}},pseudos:{not:ut(function(e){var t=[],n=[],r=u(e.replace(z,"$1"));return r[w]?ut(function(e,t,n,i){var s,o=r(e,null,i,[]),u=e.length;while(u--)(s=o[u])&&(e[u]=!(t[u]=s))}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:ut(function(e){return function(t){return st(e,t).length>0}}),contains:ut(function(e){return function(t){return(t.textContent||t.innerText||i(t)).indexOf(e)>-1}}),lang:ut(function(e){return J.test(e||"")||st.error("unsupported lang: "+e),e=e.replace(nt,rt).toLowerCase(),function(t){var n;do if(n=v?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===d},focus:function(e){return e===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!r.pseudos.empty(e)},header:function(e){return G.test(e.nodeName)},input:function(e){return Q.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:pt(function(){return[0]}),last:pt(function(e,t){return[t-1]}),eq:pt(function(e,t,n){return[0>n?n+t:n]}),even:pt(function(e,t){for(var n=0;t>n;n+=2)e.push(n);return e}),odd:pt(function(e,t){for(var n=1;t>n;n+=2)e.push(n);return e}),lt:pt(function(e,t,n){for(var r=0>n?n+t:n;--r>=0;)e.push(r);return e}),gt:pt(function(e,t,n){for(var r=0>n?n+t:n;++r<t;)e.push(r);return e})}},r.pseudos.nth=r.pseudos.eq;for(t in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})r.pseudos[t]=ct(t);for(t in{submit:!0,reset:!0})r.pseudos[t]=ht(t);return vt.prototype=r.filters=r.pseudos,r.setFilters=new vt,o=st.tokenize=function(e,t){var n,i,s,o,u,a,f,l=N[e+" "];if(l)return t?0:l.slice(0);u=e,a=[],f=r.preFilter;while(u){(!n||(i=W.exec(u)))&&(i&&(u=u.slice(i[0].length)||u),a.push(s=[])),n=!1,(i=X.exec(u))&&(n=i.shift(),s.push({value:n,type:i[0].replace(z," ")}),u=u.slice(n.length));for(o in r.filter)!(i=K[o].exec(u))||f[o]&&!(i=f[o](i))||(n=i.shift(),s.push({value:n,type:o,matches:i}),u=u.slice(n.length));if(!n)break}return t?u.length:u?st.error(e):N(e,a).slice(0)},u=st.compile=function(e,t){var n,r=[],i=[],s=C[e+" "];if(!s){t||(t=o(e)),n=t.length;while(n--)s=St(t[n]),s[w]?r.push(s):i.push(s);s=C(e,xt(i,r)),s.selector=e}return s},a=st.select=function(e,t,i,s){var a,f,l,c,h,p="function"==typeof e&&e,d=!s&&o(e=p.selector||e);if(i=i||[],1===d.length){if(f=d[0]=d[0].slice(0),f.length>2&&"ID"===(l=f[0]).type&&n.getById&&9===t.nodeType&&v&&r.relative[f[1].type]){if(t=(r.find.ID(l.matches[0].replace(nt,rt),t)||[])[0],!t)return i;p&&(t=t.parentNode),e=e.slice(f.shift().value.length)}a=K.needsContext.test(e)?0:f.length;while(a--){if(l=f[a],r.relative[c=l.type])break;if((h=r.find[c])&&(s=h(l.matches[0].replace(nt,rt),et.test(f[0].type)&&dt(t.parentNode)||t))){if(f.splice(a,1),e=s.length&&mt(f),!e)return P.apply(i,s),i;break}}}return(p||u(e,d))(s,t,!v,i,et.test(e)&&dt(t.parentNode)||t),i},n.sortStable=w.split("").sort(k).join("")===w,n.detectDuplicates=!!c,h(),n.sortDetached=at(function(e){return 1&e.compareDocumentPosition(p.createElement("div"))}),at(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||ft("type|href|height|width",function(e,t,n){return n?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),n.attributes&&at(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||ft("value",function(e,t,n){return n||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),at(function(e){return null==e.getAttribute("disabled")})||ft(j,function(e,t,n){var r;return n?void 0:e[t]===!0?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),st}(e);h.find=y,h.expr=y.selectors,h.expr[":"]=h.expr.pseudos,h.unique=y.uniqueSort,h.text=y.getText,h.isXMLDoc=y.isXML,h.contains=y.contains;var b=h.expr.match.needsContext,w=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,E=/^.[^:#\[\.,]*$/;h.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?h.find.matchesSelector(r,e)?[r]:[]:h.find.matches(e,h.grep(t,function(e){return 1===e.nodeType}))},h.fn.extend({find:function(e){var t,n=[],r=this,i=r.length;if("string"!=typeof e)return this.pushStack(h(e).filter(function(){for(t=0;i>t;t++)if(h.contains(r[t],this))return!0}));for(t=0;i>t;t++)h.find(e,r[t],n);return n=this.pushStack(i>1?h.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},filter:function(e){return this.pushStack(S(this,e||[],!1))},not:function(e){return this.pushStack(S(this,e||[],!0))},is:function(e){return!!S(this,"string"==typeof e&&b.test(e)?h(e):e||[],!1).length}});var x,T=e.document,N=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,C=h.fn.init=function(e,t){var n,r;if(!e)return this;if("string"==typeof e){if(n="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:N.exec(e),!n||!n[1]&&t)return!t||t.jquery?(t||x).find(e):this.constructor(t).find(e);if(n[1]){if(t=t instanceof h?t[0]:t,h.merge(this,h.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:T,!0)),w.test(n[1])&&h.isPlainObject(t))for(n in t)h.isFunction(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}if(r=T.getElementById(n[2]),r&&r.parentNode){if(r.id!==n[2])return x.find(e);this.length=1,this[0]=r}return this.context=T,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):h.isFunction(e)?"undefined"!=typeof x.ready?x.ready(e):e(h):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),h.makeArray(e,this))};C.prototype=h.fn,x=h(T);var k=/^(?:parents|prev(?:Until|All))/,L={children:!0,contents:!0,next:!0,prev:!0};h.extend({dir:function(e,t,n){var r=[],i=e[t];while(i&&9!==i.nodeType&&(void 0===n||1!==i.nodeType||!h(i).is(n)))1===i.nodeType&&r.push(i),i=i[t];return r},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}}),h.fn.extend({has:function(e){var t,n=h(e,this),r=n.length;return this.filter(function(){for(t=0;r>t;t++)if(h.contains(this,n[t]))return!0})},closest:function(e,t){for(var n,r=0,i=this.length,s=[],o=b.test(e)||"string"!=typeof e?h(e,t||this.context):0;i>r;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(o?o.index(n)>-1:1===n.nodeType&&h.find.matchesSelector(n,e))){s.push(n);break}return this.pushStack(s.length>1?h.unique(s):s)},index:function(e){return e?"string"==typeof e?h.inArray(this[0],h(e)):h.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(h.unique(h.merge(this.get(),h(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),h.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return h.dir(e,"parentNode")},parentsUntil:function(e,t,n){return h.dir(e,"parentNode",n)},next:function(e){return A(e,"nextSibling")},prev:function(e){return A(e,"previousSibling")},nextAll:function(e){return h.dir(e,"nextSibling")},prevAll:function(e){return h.dir(e,"previousSibling")},nextUntil:function(e,t,n){return h.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return h.dir(e,"previousSibling",n)},siblings:function(e){return h.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return h.sibling(e.firstChild)},contents:function(e){return h.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:h.merge([],e.childNodes)}},function(e,t){h.fn[e]=function(n,r){var i=h.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=h.filter(r,i)),this.length>1&&(L[e]||(i=h.unique(i)),k.test(e)&&(i=i.reverse())),this.pushStack(i)}});var O=/\S+/g,M={};h.Callbacks=function(e){e="string"==typeof e?M[e]||_(e):h.extend({},e);var t,n,r,i,s,o,u=[],a=!e.once&&[],f=function(c){for(n=e.memory&&c,r=!0,s=o||0,o=0,i=u.length,t=!0;u&&i>s;s++)if(u[s].apply(c[0],c[1])===!1&&e.stopOnFalse){n=!1;break}t=!1,u&&(a?a.length&&f(a.shift()):n?u=[]:l.disable())},l={add:function(){if(u){var r=u.length;!function s(t){h.each(t,function(t,n){var r=h.type(n);"function"===r?e.unique&&l.has(n)||u.push(n):n&&n.length&&"string"!==r&&s(n)})}(arguments),t?i=u.length:n&&(o=r,f(n))}return this},remove:function(){return u&&h.each(arguments,function(e,n){var r;while((r=h.inArray(n,u,r))>-1)u.splice(r,1),t&&(i>=r&&i--,s>=r&&s--)}),this},has:function(e){return e?h.inArray(e,u)>-1:!!u&&!!u.length},empty:function(){return u=[],i=0,this},disable:function(){return u=a=n=void 0,this},disabled:function(){return!u},lock:function(){return a=void 0,n||l.disable(),this},locked:function(){return!a},fireWith:function(e,n){return!u||r&&!a||(n=n||[],n=[e,n.slice?n.slice():n],t?a.push(n):f(n)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!r}};return l},h.extend({Deferred:function(e){var t=[["resolve","done",h.Callbacks("once memory"),"resolved"],["reject","fail",h.Callbacks("once memory"),"rejected"],["notify","progress",h.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return h.Deferred(function(n){h.each(t,function(t,s){var o=h.isFunction(e[t])&&e[t];i[s[1]](function(){var e=o&&o.apply(this,arguments);e&&h.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[s[0]+"With"](this===r?n.promise():this,o?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?h.extend(e,r):r}},i={};return r.pipe=r.then,h.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[1^e][2].disable,t[2][2].lock),i[s[0]]=function(){return i[s[0]+"With"](this===i?r:this,arguments),this},i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=r.call(arguments),i=n.length,s=1!==i||e&&h.isFunction(e.promise)?i:0,o=1===s?e:h.Deferred(),u=function(e,t,n){return function(i){t[e]=this,n[e]=arguments.length>1?r.call(arguments):i,n===a?o.notifyWith(t,n):--s||o.resolveWith(t,n)}},a,f,l;if(i>1)for(a=new Array(i),f=new Array(i),l=new Array(i);i>t;t++)n[t]&&h.isFunction(n[t].promise)?n[t].promise().done(u(t,l,n)).fail(o.reject).progress(u(t,f,a)):--s;return s||o.resolveWith(l,n),o.promise()}});var D;h.fn.ready=function(e){return h.ready.promise().done(e),this},h.extend({isReady:!1,readyWait:1,holdReady:function(e){e?h.readyWait++:h.ready(!0)},ready:function(e){if(e===!0?!--h.readyWait:!h.isReady){if(!T.body)return setTimeout(h.ready);h.isReady=!0,e!==!0&&--h.readyWait>0||(D.resolveWith(T,[h]),h.fn.triggerHandler&&(h(T).triggerHandler("ready"),h(T).off("ready")))}}}),h.ready.promise=function(t){if(!D)if(D=h.Deferred(),"complete"===T.readyState)setTimeout(h.ready);else if(T.addEventListener)T.addEventListener("DOMContentLoaded",H,!1),e.addEventListener("load",H,!1);else{T.attachEvent("onreadystatechange",H),e.attachEvent("onload",H);var n=!1;try{n=null==e.frameElement&&T.documentElement}catch(r){}n&&n.doScroll&&!function i(){if(!h.isReady){try{n.doScroll("left")}catch(e){return setTimeout(i,50)}P(),h.ready()}}()}return D.promise(t)};var B="undefined",j;for(j in h(l))break;l.ownLast="0"!==j,l.inlineBlockNeedsLayout=!1,h(function(){var e,t,n,r;n=T.getElementsByTagName("body")[0],n&&n.style&&(t=T.createElement("div"),r=T.createElement("div"),r.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",n.appendChild(r).appendChild(t),typeof t.style.zoom!==B&&(t.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",l.inlineBlockNeedsLayout=e=3===t.offsetWidth,e&&(n.style.zoom=1)),n.removeChild(r))}),function(){var e=T.createElement("div");if(null==l.deleteExpando){l.deleteExpando=!0;try{delete e.test}catch(t){l.deleteExpando=!1}}e=null}(),h.acceptData=function(e){var t=h.noData[(e.nodeName+" ").toLowerCase()],n=+e.nodeType||1;return 1!==n&&9!==n?!1:!t||t!==!0&&e.getAttribute("classid")===t};var F=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,I=/([A-Z])/g;h.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return e=e.nodeType?h.cache[e[h.expando]]:e[h.expando],!!e&&!R(e)},data:function(e,t,n){return U(e,t,n)},removeData:function(e,t){return z(e,t)},_data:function(e,t,n){return U(e,t,n,!0)},_removeData:function(e,t){return z(e,t,!0)}}),h.fn.extend({data:function(e,t){var n,r,i,s=this[0],o=s&&s.attributes;if(void 0===e){if(this.length&&(i=h.data(s),1===s.nodeType&&!h._data(s,"parsedAttrs"))){n=o.length;while(n--)o[n]&&(r=o[n].name,0===r.indexOf("data-")&&(r=h.camelCase(r.slice(5)),q(s,r,i[r])));h._data(s,"parsedAttrs",!0)}return i}return"object"==typeof e?this.each(function(){h.data(this,e)}):arguments.length>1?this.each(function(){h.data(this,e,t)}):s?q(s,e,h.data(s,e)):void 0},removeData:function(e){return this.each(function(){h.removeData(this,e)})}}),h.extend({queue:function(e,t,n){var r;return e?(t=(t||"fx")+"queue",r=h._data(e,t),n&&(!r||h.isArray(n)?r=h._data(e,t,h.makeArray(n)):r.push(n)),r||[]):void 0},dequeue:function(e,t){t=t||"fx";var n=h.queue(e,t),r=n.length,i=n.shift(),s=h._queueHooks(e,t),o=function(){h.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return h._data(e,n)||h._data(e,n,{empty:h.Callbacks("once memory").add(function(){h._removeData(e,t+"queue"),h._removeData(e,n)})})}}),h.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?h.queue(this[0],e):void 0===t?this:this.each(function(){var n=h.queue(this,e,t);h._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&h.dequeue(this,e)})},dequeue:function(e){return this.each(function(){h.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=h.Deferred(),s=this,o=this.length,u=function(){--r||i.resolveWith(s,[s])};"string"!=typeof e&&(t=e,e=void 0),e=e||"fx";while(o--)n=h._data(s[o],e+"queueHooks"),n&&n.empty&&(r++,n.empty.add(u));return u(),i.promise(t)}});var W=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,X=["Top","Right","Bottom","Left"],V=function(e,t){return e=t||e,"none"===h.css(e,"display")||!h.contains(e.ownerDocument,e)},$=h.access=function(e,t,n,r,i,s,o){var u=0,a=e.length,f=null==n;if("object"===h.type(n)){i=!0;for(u in n)h.access(e,t,u,n[u],!0,s,o)}else if(void 0!==r&&(i=!0,h.isFunction(r)||(o=!0),f&&(o?(t.call(e,r),t=null):(f=t,t=function(e,t,n){return f.call(h(e),n)})),t))for(;a>u;u++)t(e[u],n,o?r:r.call(e[u],u,t(e[u],n)));return i?e:f?t.call(e):a?t(e[0],n):s},J=/^(?:checkbox|radio)$/i;!function(){var e=T.createElement("input"),t=T.createElement("div"),n=T.createDocumentFragment();if(t.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",l.leadingWhitespace=3===t.firstChild.nodeType,l.tbody=!t.getElementsByTagName("tbody").length,l.htmlSerialize=!!t.getElementsByTagName("link").length,l.html5Clone="<:nav></:nav>"!==T.createElement("nav").cloneNode(!0).outerHTML,e.type="checkbox",e.checked=!0,n.appendChild(e),l.appendChecked=e.checked,t.innerHTML="<textarea>x</textarea>",l.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue,n.appendChild(t),t.innerHTML="<input type='radio' checked='checked' name='t'/>",l.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,l.noCloneEvent=!0,t.attachEvent&&(t.attachEvent("onclick",function(){l.noCloneEvent=!1}),t.cloneNode(!0).click()),null==l.deleteExpando){l.deleteExpando=!0;try{delete t.test}catch(r){l.deleteExpando=!1}}}(),function(){var t,n,r=T.createElement("div");for(t in{submit:!0,change:!0,focusin:!0})n="on"+t,(l[t+"Bubbles"]=n in e)||(r.setAttribute(n,"t"),l[t+"Bubbles"]=r.attributes[n].expando===!1);r=null}();var K=/^(?:input|select|textarea)$/i,Q=/^key/,G=/^(?:mouse|pointer|contextmenu)|click/,Y=/^(?:focusinfocus|focusoutblur)$/,Z=/^([^.]*)(?:\.(.+)|)$/;h.event={global:{},add:function(e,t,n,r,i){var s,o,u,a,f,l,c,p,d,v,m,g=h._data(e);if(g){n.handler&&(a=n,n=a.handler,i=a.selector),n.guid||(n.guid=h.guid++),(o=g.events)||(o=g.events={}),(l=g.handle)||(l=g.handle=function(e){return typeof h===B||e&&h.event.triggered===e.type?void 0:h.event.dispatch.apply(l.elem,arguments)},l.elem=e),t=(t||"").match(O)||[""],u=t.length;while(u--)s=Z.exec(t[u])||[],d=m=s[1],v=(s[2]||"").split(".").sort(),d&&(f=h.event.special[d]||{},d=(i?f.delegateType:f.bindType)||d,f=h.event.special[d]||{},c=h.extend({type:d,origType:m,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&h.expr.match.needsContext.test(i),namespace:v.join(".")},a),(p=o[d])||(p=o[d]=[],p.delegateCount=0,f.setup&&f.setup.call(e,r,v,l)!==!1||(e.addEventListener?e.addEventListener(d,l,!1):e.attachEvent&&e.attachEvent("on"+d,l))),f.add&&(f.add.call(e,c),c.handler.guid||(c.handler.guid=n.guid)),i?p.splice(p.delegateCount++,0,c):p.push(c),h.event.global[d]=!0);e=null}},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,p,d,v,m,g=h.hasData(e)&&h._data(e);if(g&&(l=g.events)){t=(t||"").match(O)||[""],f=t.length;while(f--)if(u=Z.exec(t[f])||[],d=m=u[1],v=(u[2]||"").split(".").sort(),d){c=h.event.special[d]||{},d=(r?c.delegateType:c.bindType)||d,p=l[d]||[],u=u[2]&&new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=s=p.length;while(s--)o=p[s],!i&&m!==o.origType||n&&n.guid!==o.guid||u&&!u.test(o.namespace)||r&&r!==o.selector&&("**"!==r||!o.selector)||(p.splice(s,1),o.selector&&p.delegateCount--,c.remove&&c.remove.call(e,o));a&&!p.length&&(c.teardown&&c.teardown.call(e,v,g.handle)!==!1||h.removeEvent(e,d,g.handle),delete l[d])}else for(d in l)h.event.remove(e,d+t[f],n,r,!0);h.isEmptyObject(l)&&(delete g.handle,h._removeData(e,"events"))}},trigger:function(t,n,r,i){var s,o,u,a,l,c,p,d=[r||T],v=f.call(t,"type")?t.type:t,m=f.call(t,"namespace")?t.namespace.split("."):[];if(u=c=r=r||T,3!==r.nodeType&&8!==r.nodeType&&!Y.test(v+h.event.triggered)&&(v.indexOf(".")>=0&&(m=v.split("."),v=m.shift(),m.sort()),o=v.indexOf(":")<0&&"on"+v,t=t[h.expando]?t:new h.Event(v,"object"==typeof t&&t),t.isTrigger=i?2:3,t.namespace=m.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=r),n=null==n?[t]:h.makeArray(n,[t]),l=h.event.special[v]||{},i||!l.trigger||l.trigger.apply(r,n)!==!1)){if(!i&&!l.noBubble&&!h.isWindow(r)){for(a=l.delegateType||v,Y.test(a+v)||(u=u.parentNode);u;u=u.parentNode)d.push(u),c=u;c===(r.ownerDocument||T)&&d.push(c.defaultView||c.parentWindow||e)}p=0;while((u=d[p++])&&!t.isPropagationStopped())t.type=p>1?a:l.bindType||v,s=(h._data(u,"events")||{})[t.type]&&h._data(u,"handle"),s&&s.apply(u,n),s=o&&u[o],s&&s.apply&&h.acceptData(u)&&(t.result=s.apply(u,n),t.result===!1&&t.preventDefault());if(t.type=v,!i&&!t.isDefaultPrevented()&&(!l._default||l._default.apply(d.pop(),n)===!1)&&h.acceptData(r)&&o&&r[v]&&!h.isWindow(r)){c=r[o],c&&(r[o]=null),h.event.triggered=v;try{r[v]()}catch(g){}h.event.triggered=void 0,c&&(r[o]=c)}return t.result}},dispatch:function(e){e=h.event.fix(e);var t,n,i,s,o,u=[],a=r.call(arguments),f=(h._data(this,"events")||{})[e.type]||[],l=h.event.special[e.type]||{};if(a[0]=e,e.delegateTarget=this,!l.preDispatch||l.preDispatch.call(this,e)!==!1){u=h.event.handlers.call(this,e,f),t=0;while((s=u[t++])&&!e.isPropagationStopped()){e.currentTarget=s.elem,o=0;while((i=s.handlers[o++])&&!e.isImmediatePropagationStopped())(!e.namespace_re||e.namespace_re.test(i.namespace))&&(e.handleObj=i,e.data=i.data,n=((h.event.special[i.origType]||{}).handle||i.handler).apply(s.elem,a),void 0!==n&&(e.result=n)===!1&&(e.preventDefault(),e.stopPropagation()))}return l.postDispatch&&l.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,r,i,s,o=[],u=t.delegateCount,a=e.target;if(u&&a.nodeType&&(!e.button||"click"!==e.type))for(;a!=this;a=a.parentNode||this)if(1===a.nodeType&&(a.disabled!==!0||"click"!==e.type)){for(i=[],s=0;u>s;s++)r=t[s],n=r.selector+" ",void 0===i[n]&&(i[n]=r.needsContext?h(n,this).index(a)>=0:h.find(n,this,null,[a]).length),i[n]&&i.push(r);i.length&&o.push({elem:a,handlers:i})}return u<t.length&&o.push({elem:this,handlers:t.slice(u)}),o},fix:function(e){if(e[h.expando])return e;var t,n,r,i=e.type,s=e,o=this.fixHooks[i];o||(this.fixHooks[i]=o=G.test(i)?this.mouseHooks:Q.test(i)?this.keyHooks:{}),r=o.props?this.props.concat(o.props):this.props,e=new h.Event(s),t=r.length;while(t--)n=r[t],e[n]=s[n];return e.target||(e.target=s.srcElement||T),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,o.filter?o.filter(e,s):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,i,s=t.button,o=t.fromElement;return null==e.pageX&&null!=t.clientX&&(r=e.target.ownerDocument||T,i=r.documentElement,n=r.body,e.pageX=t.clientX+(i&&i.scrollLeft||n&&n.scrollLeft||0)-(i&&i.clientLeft||n&&n.clientLeft||0),e.pageY=t.clientY+(i&&i.scrollTop||n&&n.scrollTop||0)-(i&&i.clientTop||n&&n.clientTop||0)),!e.relatedTarget&&o&&(e.relatedTarget=o===e.target?t.toElement:o),e.which||void 0===s||(e.which=1&s?1:2&s?3:4&s?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==nt()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===nt()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return h.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(e){return h.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=h.extend(new h.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?h.event.trigger(i,null,t):h.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},h.removeEvent=T.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(typeof e[r]===B&&(e[r]=null),e.detachEvent(r,n))},h.Event=function(e,t){return this instanceof h.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&e.returnValue===!1?et:tt):this.type=e,t&&h.extend(this,t),this.timeStamp=e&&e.timeStamp||h.now(),void (this[h.expando]=!0)):new h.Event(e,t)},h.Event.prototype={isDefaultPrevented:tt,isPropagationStopped:tt,isImmediatePropagationStopped:tt,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=et,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=et,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=et,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},h.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){h.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj;return(!i||i!==r&&!h.contains(r,i))&&(e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t),n}}}),l.submitBubbles||(h.event.special.submit={setup:function(){return h.nodeName(this,"form")?!1:void h.event.add(this,"click._submit keypress._submit",function(e){var t=e.target,n=h.nodeName(t,"input")||h.nodeName(t,"button")?t.form:void 0;n&&!h._data(n,"submitBubbles")&&(h.event.add(n,"submit._submit",function(e){e._submit_bubble=!0}),h._data(n,"submitBubbles",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&h.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return h.nodeName(this,"form")?!1:void h.event.remove(this,"._submit")}}),l.changeBubbles||(h.event.special.change={setup:function(){return K.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(h.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),h.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),h.event.simulate("change",this,e,!0)})),!1):void h.event.add(this,"beforeactivate._change",function(e){var t=e.target;K.test(t.nodeName)&&!h._data(t,"changeBubbles")&&(h.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||h.event.simulate("change",this.parentNode,e,!0)}),h._data(t,"changeBubbles",!0))})},handle:function(e){var t=e.target;return this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type?e.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return h.event.remove(this,"._change"),!K.test(this.nodeName)}}),l.focusinBubbles||h.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){h.event.simulate(t,e.target,h.event.fix(e),!0)};h.event.special[t]={setup:function(){var r=this.ownerDocument||this,i=h._data(r,t);i||r.addEventListener(e,n,!0),h._data(r,t,(i||0)+1)},teardown:function(){var r=this.ownerDocument||this,i=h._data(r,t)-1;i?h._data(r,t,i):(r.removeEventListener(e,n,!0),h._removeData(r,t))}}}),h.fn.extend({on:function(e,t,n,r,i){var s,o;if("object"==typeof e){"string"!=typeof t&&(n=n||t,t=void 0);for(s in e)this.on(s,t,n,e[s],i);return this}if(null==n&&null==r?(r=t,n=t=void 0):null==r&&("string"==typeof t?(r=n,n=void 0):(r=n,n=t,t=void 0)),r===!1)r=tt;else if(!r)return this;return 1===i&&(o=r,r=function(e){return h().off(e),o.apply(this,arguments)},r.guid=o.guid||(o.guid=h.guid++)),this.each(function(){h.event.add(this,e,r,n,t)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,h(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return(t===!1||"function"==typeof t)&&(n=t,t=void 0),n===!1&&(n=tt),this.each(function(){h.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){h.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?h.event.trigger(e,t,n,!0):void 0}});var it="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",st=/ jQuery\d+="(?:null|\d+)"/g,ot=new RegExp("<(?:"+it+")[\\s/>]","i"),ut=/^\s+/,at=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,ft=/<([\w:]+)/,lt=/<tbody/i,ct=/<|&#?\w+;/,ht=/<(?:script|style|link)/i,pt=/checked\s*(?:[^=]|=\s*.checked.)/i,dt=/^$|\/(?:java|ecma)script/i,vt=/^true\/(.*)/,mt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,gt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:l.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},yt=rt(T),bt=yt.appendChild(T.createElement("div"));gt.optgroup=gt.option,gt.tbody=gt.tfoot=gt.colgroup=gt.caption=gt.thead,gt.th=gt.td,h.extend({clone:function(e,t,n){var r,i,s,o,u,a=h.contains(e.ownerDocument,e);if(l.html5Clone||h.isXMLDoc(e)||!ot.test("<"+e.nodeName+">")?s=e.cloneNode(!0):(bt.innerHTML=e.outerHTML,bt.removeChild(s=bt.firstChild)),!(l.noCloneEvent&&l.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||h.isXMLDoc(e)))for(r=wt(s),u=wt(e),o=0;null!=(i=u[o]);++o)r[o]&&kt(i,r[o]);if(t)if(n)for(u=u||wt(e),r=r||wt(s),o=0;null!=(i=u[o]);o++)Ct(i,r[o]);else Ct(e,s);return r=wt(s,"script"),r.length>0&&Nt(r,!a&&wt(e,"script")),r=u=i=null,s},buildFragment:function(e,t,n,r){for(var i,s,o,u,a,f,c,p=e.length,d=rt(t),v=[],m=0;p>m;m++)if(s=e[m],s||0===s)if("object"===h.type(s))h.merge(v,s.nodeType?[s]:s);else if(ct.test(s)){u=u||d.appendChild(t.createElement("div")),a=(ft.exec(s)||["",""])[1].toLowerCase(),c=gt[a]||gt._default,u.innerHTML=c[1]+s.replace(at,"<$1></$2>")+c[2],i=c[0];while(i--)u=u.lastChild;if(!l.leadingWhitespace&&ut.test(s)&&v.push(t.createTextNode(ut.exec(s)[0])),!l.tbody){s="table"!==a||lt.test(s)?"<table>"!==c[1]||lt.test(s)?0:u:u.firstChild,i=s&&s.childNodes.length;while(i--)h.nodeName(f=s.childNodes[i],"tbody")&&!f.childNodes.length&&s.removeChild(f)}h.merge(v,u.childNodes),u.textContent="";while(u.firstChild)u.removeChild(u.firstChild);u=d.lastChild}else v.push(t.createTextNode(s));u&&d.removeChild(u),l.appendChecked||h.grep(wt(v,"input"),Et),m=0;while(s=v[m++])if((!r||-1===h.inArray(s,r))&&(o=h.contains(s.ownerDocument,s),u=wt(d.appendChild(s),"script"),o&&Nt(u),n)){i=0;while(s=u[i++])dt.test(s.type||"")&&n.push(s)}return u=null,d},cleanData:function(e,t){for(var r,i,s,o,u=0,a=h.expando,f=h.cache,c=l.deleteExpando,p=h.event.special;null!=(r=e[u]);u++)if((t||h.acceptData(r))&&(s=r[a],o=s&&f[s])){if(o.events)for(i in o.events)p[i]?h.event.remove(r,i):h.removeEvent(r,i,o.handle);f[s]&&(delete f[s],c?delete r[a]:typeof r.removeAttribute!==B?r.removeAttribute(a):r[a]=null,n.push(s))}}}),h.fn.extend({text:function(e){return $(this,function(e){return void 0===e?h.text(this):this.empty().append((this[0]&&this[0].ownerDocument||T).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=St(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=St(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var n,r=e?h.filter(e,this):this,i=0;null!=(n=r[i]);i++)t||1!==n.nodeType||h.cleanData(wt(n)),n.parentNode&&(t&&h.contains(n.ownerDocument,n)&&Nt(wt(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){1===e.nodeType&&h.cleanData(wt(e,!1));while(e.firstChild)e.removeChild(e.firstChild);e.options&&h.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return h.clone(this,e,t)})},html:function(e){return $(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e)return 1===t.nodeType?t.innerHTML.replace(st,""):void 0;if(!("string"!=typeof e||ht.test(e)||!l.htmlSerialize&&ot.test(e)||!l.leadingWhitespace&&ut.test(e)||gt[(ft.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(at,"<$1></$2>");try{for(;r>n;n++)t=this[n]||{},1===t.nodeType&&(h.cleanData(wt(t,!1)),t.innerHTML=e);t=0}catch(i){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=arguments[0];return this.domManip(arguments,function(t){e=this.parentNode,h.cleanData(wt(this)),e&&e.replaceChild(t,this)}),e&&(e.length||e.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t){e=i.apply([],e);var n,r,s,o,u,a,f=0,c=this.length,p=this,d=c-1,v=e[0],m=h.isFunction(v);if(m||c>1&&"string"==typeof v&&!l.checkClone&&pt.test(v))return this.each(function(n){var r=p.eq(n);m&&(e[0]=v.call(this,n,r.html())),r.domManip(e,t)});if(c&&(a=h.buildFragment(e,this[0].ownerDocument,!1,this),n=a.firstChild,1===a.childNodes.length&&(a=n),n)){for(o=h.map(wt(a,"script"),xt),s=o.length;c>f;f++)r=a,f!==d&&(r=h.clone(r,!0,!0),s&&h.merge(o,wt(r,"script"))),t.call(this[f],r,f);if(s)for(u=o[o.length-1].ownerDocument,h.map(o,Tt),f=0;s>f;f++)r=o[f],dt.test(r.type||"")&&!h._data(r,"globalEval")&&h.contains(u,r)&&(r.src?h._evalUrl&&h._evalUrl(r.src):h.globalEval((r.text||r.textContent||r.innerHTML||"").replace(mt,"")));a=n=null}return this}}),h.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){h.fn[e]=function(e){for(var n,r=0,i=[],o=h(e),u=o.length-1;u>=r;r++)n=r===u?this:this.clone(!0),h(o[r])[t](n),s.apply(i,n.get());return this.pushStack(i)}});var Lt,At={};!function(){var e;l.shrinkWrapBlocks=function(){if(null!=e)return e;e=!1;var t,n,r;return n=T.getElementsByTagName("body")[0],n&&n.style?(t=T.createElement("div"),r=T.createElement("div"),r.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",n.appendChild(r).appendChild(t),typeof t.style.zoom!==B&&(t.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",t.appendChild(T.createElement("div")).style.width="5px",e=3!==t.offsetWidth),n.removeChild(r),e):void 0}}();var _t=/^margin/,Dt=new RegExp("^("+W+")(?!px)[a-z%]+$","i"),Pt,Ht,Bt=/^(top|right|bottom|left)$/;e.getComputedStyle?(Pt=function(e){return e.ownerDocument.defaultView.getComputedStyle(e,null)},Ht=function(e,t,n){var r,i,s,o,u=e.style;return n=n||Pt(e),o=n?n.getPropertyValue(t)||n[t]:void 0,n&&(""!==o||h.contains(e.ownerDocument,e)||(o=h.style(e,t)),Dt.test(o)&&_t.test(t)&&(r=u.width,i=u.minWidth,s=u.maxWidth,u.minWidth=u.maxWidth=u.width=o,o=n.width,u.width=r,u.minWidth=i,u.maxWidth=s)),void 0===o?o:o+""}):T.documentElement.currentStyle&&(Pt=function(e){return e.currentStyle},Ht=function(e,t,n){var r,i,s,o,u=e.style;return n=n||Pt(e),o=n?n[t]:void 0,null==o&&u&&u[t]&&(o=u[t]),Dt.test(o)&&!Bt.test(t)&&(r=u.left,i=e.runtimeStyle,s=i&&i.left,s&&(i.left=e.currentStyle.left),u.left="fontSize"===t?"1em":o,o=u.pixelLeft+"px",u.left=r,s&&(i.left=s)),void 0===o?o:o+""||"auto"}),!function(){var t,n,r,i,s,o,u;if(t=T.createElement("div"),t.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",r=t.getElementsByTagName("a")[0],n=r&&r.style){n.cssText="float:left;opacity:.5",l.opacity="0.5"===n.opacity,l.cssFloat=!!n.cssFloat,t.style.backgroundClip="content-box",t.cloneNode(!0).style.backgroundClip="",l.clearCloneStyle="content-box"===t.style.backgroundClip,l.boxSizing=""===n.boxSizing||""===n.MozBoxSizing||""===n.WebkitBoxSizing,h.extend(l,{reliableHiddenOffsets:function(){return null==o&&a(),o},boxSizingReliable:function(){return null==s&&a(),s},pixelPosition:function(){return null==i&&a(),i},reliableMarginRight:function(){return null==u&&a(),u}});function a(){var t,n,r,a;n=T.getElementsByTagName("body")[0],n&&n.style&&(t=T.createElement("div"),r=T.createElement("div"),r.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",n.appendChild(r).appendChild(t),t.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",i=s=!1,u=!0,e.getComputedStyle&&(i="1%"!==(e.getComputedStyle(t,null)||{}).top,s="4px"===(e.getComputedStyle(t,null)||{width:"4px"}).width,a=t.appendChild(T.createElement("div")),a.style.cssText=t.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",a.style.marginRight=a.style.width="0",t.style.width="1px",u=!parseFloat((e.getComputedStyle(a,null)||{}).marginRight)),t.innerHTML="<table><tr><td></td><td>t</td></tr></table>",a=t.getElementsByTagName("td"),a[0].style.cssText="margin:0;border:0;padding:0;display:none",o=0===a[0].offsetHeight,o&&(a[0].style.display="",a[1].style.display="none",o=0===a[0].offsetHeight),n.removeChild(r))}}}(),h.swap=function(e,t,n,r){var i,s,o={};for(s in t)o[s]=e.style[s],e.style[s]=t[s];i=n.apply(e,r||[]);for(s in t)e.style[s]=o[s];return i};var Ft=/alpha\([^)]*\)/i,It=/opacity\s*=\s*([^)]*)/,qt=/^(none|table(?!-c[ea]).+)/,Rt=new RegExp("^("+W+")(.*)$","i"),Ut=new RegExp("^([+-])=("+W+")","i"),zt={position:"absolute",visibility:"hidden",display:"block"},Wt={letterSpacing:"0",fontWeight:"400"},Xt=["Webkit","O","Moz","ms"];h.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Ht(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":l.cssFloat?"cssFloat":"styleFloat"},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,s,o,u=h.camelCase(t),a=e.style;if(t=h.cssProps[u]||(h.cssProps[u]=Vt(a,u)),o=h.cssHooks[t]||h.cssHooks[u],void 0===n)return o&&"get"in o&&void 0!==(i=o.get(e,!1,r))?i:a[t];if(s=typeof n,"string"===s&&(i=Ut.exec(n))&&(n=(i[1]+1)*i[2]+parseFloat(h.css(e,t)),s="number"),null!=n&&n===n&&("number"!==s||h.cssNumber[u]||(n+="px"),l.clearCloneStyle||""!==n||0!==t.indexOf("background")||(a[t]="inherit"),!(o&&"set"in o&&void 0===(n=o.set(e,n,r)))))try{a[t]=n}catch(f){}}},css:function(e,t,n,r){var i,s,o,u=h.camelCase(t);return t=h.cssProps[u]||(h.cssProps[u]=Vt(e.style,u)),o=h.cssHooks[t]||h.cssHooks[u],o&&"get"in o&&(s=o.get(e,!0,n)),void 0===s&&(s=Ht(e,t,r)),"normal"===s&&t in Wt&&(s=Wt[t]),""===n||n?(i=parseFloat(s),n===!0||h.isNumeric(i)?i||0:s):s}}),h.each(["height","width"],function(e,t){h.cssHooks[t]={get:function(e,n,r){return n?qt.test(h.css(e,"display"))&&0===e.offsetWidth?h.swap(e,zt,function(){return Qt(e,t,r)}):Qt(e,t,r):void 0},set:function(e,n,r){var i=r&&Pt(e);return Jt(e,n,r?Kt(e,t,r,l.boxSizing&&"border-box"===h.css(e,"boxSizing",!1,i),i):0)}}}),l.opacity||(h.cssHooks.opacity={get:function(e,t){return It.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=h.isNumeric(t)?"alpha(opacity="+100*t+")":"",s=r&&r.filter||n.filter||"";n.zoom=1,(t>=1||""===t)&&""===h.trim(s.replace(Ft,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===t||r&&!r.filter)||(n.filter=Ft.test(s)?s.replace(Ft,i):s+" "+i)}}),h.cssHooks.marginRight=jt(l.reliableMarginRight,function(e,t){return t?h.swap(e,{display:"inline-block"},Ht,[e,"marginRight"]):void 0}),h.each({margin:"",padding:"",border:"Width"},function(e,t){h.cssHooks[e+t]={expand:function(n){for(var r=0,i={},s="string"==typeof n?n.split(" "):[n];4>r;r++)i[e+X[r]+t]=s[r]||s[r-2]||s[0];return i}},_t.test(e)||(h.cssHooks[e+t].set=Jt)}),h.fn.extend({css:function(e,t){return $(this,function(e,t,n){var r,i,s={},o=0;if(h.isArray(t)){for(r=Pt(e),i=t.length;i>o;o++)s[t[o]]=h.css(e,t[o],!1,r);return s}return void 0!==n?h.style(e,t,n):h.css(e,t)},e,t,arguments.length>1)},show:function(){return $t(this,!0)},hide:function(){return $t(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){V(this)?h(this).show():h(this).hide()})}}),h.Tween=Gt,Gt.prototype={constructor:Gt,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(h.cssNumber[n]?"":"px")},cur:function(){var e=Gt.propHooks[this.prop];return e&&e.get?e.get(this):Gt.propHooks._default.get(this)},run:function(e){var t,n=Gt.propHooks[this.prop];return this.pos=t=this.options.duration?h.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Gt.propHooks._default.set(this),this}},Gt.prototype.init.prototype=Gt.prototype,Gt.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=h.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){h.fx.step[e.prop]?h.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[h.cssProps[e.prop]]||h.cssHooks[e.prop])?h.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Gt.propHooks.scrollTop=Gt.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},h.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},h.fx=Gt.prototype.init,h.fx.step={};var Yt,Zt,en=/^(?:toggle|show|hide)$/,tn=new RegExp("^(?:([+-])=|)("+W+")([a-z%]*)$","i"),nn=/queueHooks$/,rn=[fn],sn={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),i=tn.exec(t),s=i&&i[3]||(h.cssNumber[e]?"":"px"),o=(h.cssNumber[e]||"px"!==s&&+r)&&tn.exec(h.css(n.elem,e)),u=1,a=20;if(o&&o[3]!==s){s=s||o[3],i=i||[],o=+r||1;do u=u||".5",o/=u,h.style(n.elem,e,o+s);while(u!==(u=n.cur()/r)&&1!==u&&--a)}return i&&(o=n.start=+o||+r||0,n.unit=s,n.end=i[1]?o+(i[1]+1)*i[2]:+i[2]),n}]};h.Animation=h.extend(cn,{tweener:function(e,t){h.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var n,r=0,i=e.length;i>r;r++)n=e[r],sn[n]=sn[n]||[],sn[n].unshift(t)},prefilter:function(e,t){t?rn.unshift(e):rn.push(e)}}),h.speed=function(e,t,n){var r=e&&"object"==typeof e?h.extend({},e):{complete:n||!n&&t||h.isFunction(e)&&e,duration:e,easing:n&&t||t&&!h.isFunction(t)&&t};return r.duration=h.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in h.fx.speeds?h.fx.speeds[r.duration]:h.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){h.isFunction(r.old)&&r.old.call(this),r.queue&&h.dequeue(this,r.queue)},r},h.fn.extend({fadeTo:function(e,t,n,r){return this.filter(V).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=h.isEmptyObject(e),s=h.speed(t,n,r),o=function(){var t=cn(this,h.extend({},e),s);(i||h._data(this,"finish"))&&t.stop(!0)};return o.finish=o,i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",s=h.timers,o=h._data(this);if(i)o[i]&&o[i].stop&&r(o[i]);else for(i in o)o[i]&&o[i].stop&&nn.test(i)&&r(o[i]);for(i=s.length;i--;)s[i].elem!==this||null!=e&&s[i].queue!==e||(s[i].anim.stop(n),t=!1,s.splice(i,1));(t||!n)&&h.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=h._data(this),r=n[e+"queue"],i=n[e+"queueHooks"],s=h.timers,o=r?r.length:0;for(n.finish=!0,h.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;o>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),h.each(["toggle","show","hide"],function(e,t){var n=h.fn[t];h.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(un(t,!0),e,r,i)}}),h.each({slideDown:un("show"),slideUp:un("hide"),slideToggle:un("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){h.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),h.timers=[],h.fx.tick=function(){var e,t=h.timers,n=0;for(Yt=h.now();n<t.length;n++)e=t[n],e()||t[n]!==e||t.splice(n--,1);t.length||h.fx.stop(),Yt=void 0},h.fx.timer=function(e){h.timers.push(e),e()?h.fx.start():h.timers.pop()},h.fx.interval=13,h.fx.start=function(){Zt||(Zt=setInterval(h.fx.tick,h.fx.interval))},h.fx.stop=function(){clearInterval(Zt),Zt=null},h.fx.speeds={slow:600,fast:200,_default:400},h.fn.delay=function(e,t){return e=h.fx?h.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},function(){var e,t,n,r,i;t=T.createElement("div"),t.setAttribute("className","t"),t.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",r=t.getElementsByTagName("a")[0],n=T.createElement("select"),i=n.appendChild(T.createElement("option")),e=t.getElementsByTagName("input")[0],r.style.cssText="top:1px",l.getSetAttribute="t"!==t.className,l.style=/top/.test(r.getAttribute("style")),l.hrefNormalized="/a"===r.getAttribute("href"),l.checkOn=!!e.value,l.optSelected=i.selected,l.enctype=!!T.createElement("form").enctype,n.disabled=!0,l.optDisabled=!i.disabled,e=T.createElement("input"),e.setAttribute("value",""),l.input=""===e.getAttribute("value"),e.value="t",e.setAttribute("type","radio"),l.radioValue="t"===e.value}();var hn=/\r/g;h.fn.extend({val:function(e){var t,n,r,i=this[0];if(arguments.length)return r=h.isFunction(e),this.each(function(n){var i;1===this.nodeType&&(i=r?e.call(this,n,h(this).val()):e,null==i?i="":"number"==typeof i?i+="":h.isArray(i)&&(i=h.map(i,function(e){return null==e?"":e+""})),t=h.valHooks[this.type]||h.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,i,"value")||(this.value=i))});if(i)return t=h.valHooks[i.type]||h.valHooks[i.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(n=t.get(i,"value"))?n:(n=i.value,"string"==typeof n?n.replace(hn,""):null==n?"":n)}}),h.extend({valHooks:{option:{get:function(e){var t=h.find.attr(e,"value");return null!=t?t:h.trim(h.text(e))}},select:{get:function(e){for(var t,n,r=e.options,i=e.selectedIndex,s="select-one"===e.type||0>i,o=s?null:[],u=s?i+1:r.length,a=0>i?u:s?i:0;u>a;a++)if(n=r[a],!(!n.selected&&a!==i||(l.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&h.nodeName(n.parentNode,"optgroup"))){if(t=h(n).val(),s)return t;o.push(t)}return o},set:function(e,t){var n,r,i=e.options,s=h.makeArray(t),o=i.length;while(o--)if(r=i[o],h.inArray(h.valHooks.option.get(r),s)>=0)try{r.selected=n=!0}catch(u){r.scrollHeight}else r.selected=!1;return n||(e.selectedIndex=-1),i}}}}),h.each(["radio","checkbox"],function(){h.valHooks[this]={set:function(e,t){return h.isArray(t)?e.checked=h.inArray(h(e).val(),t)>=0:void 0}},l.checkOn||(h.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var pn,dn,vn=h.expr.attrHandle,mn=/^(?:checked|selected)$/i,gn=l.getSetAttribute,yn=l.input;h.fn.extend({attr:function(e,t){return $(this,h.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){h.removeAttr(this,e)})}}),h.extend({attr:function(e,t,n){var r,i,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return typeof e.getAttribute===B?h.prop(e,t,n):(1===s&&h.isXMLDoc(e)||(t=t.toLowerCase(),r=h.attrHooks[t]||(h.expr.match.bool.test(t)?dn:pn)),void 0===n?r&&"get"in r&&null!==(i=r.get(e,t))?i:(i=h.find.attr(e,t),null==i?void 0:i):null!==n?r&&"set"in r&&void 0!==(i=r.set(e,n,t))?i:(e.setAttribute(t,n+""),n):void h.removeAttr(e,t))},removeAttr:function(e,t){var n,r,i=0,s=t&&t.match(O);if(s&&1===e.nodeType)while(n=s[i++])r=h.propFix[n]||n,h.expr.match.bool.test(n)?yn&&gn||!mn.test(n)?e[r]=!1:e[h.camelCase("default-"+n)]=e[r]=!1:h.attr(e,n,""),e.removeAttribute(gn?n:r)},attrHooks:{type:{set:function(e,t){if(!l.radioValue&&"radio"===t&&h.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}}}),dn={set:function(e,t,n){return t===!1?h.removeAttr(e,n):yn&&gn||!mn.test(n)?e.setAttribute(!gn&&h.propFix[n]||n,n):e[h.camelCase("default-"+n)]=e[n]=!0,n}},h.each(h.expr.match.bool.source.match(/\w+/g),function(e,t){var n=vn[t]||h.find.attr;vn[t]=yn&&gn||!mn.test(t)?function(e,t,r){var i,s;return r||(s=vn[t],vn[t]=i,i=null!=n(e,t,r)?t.toLowerCase():null,vn[t]=s),i}:function(e,t,n){return n?void 0:e[h.camelCase("default-"+t)]?t.toLowerCase():null}}),yn&&gn||(h.attrHooks.value={set:function(e,t,n){return h.nodeName(e,"input")?void (e.defaultValue=t):pn&&pn.set(e,t,n)}}),gn||(pn={set:function(e,t,n){var r=e.getAttributeNode(n);return r||e.setAttributeNode(r=e.ownerDocument.createAttribute(n)),r.value=t+="","value"===n||t===e.getAttribute(n)?t:void 0}},vn.id=vn.name=vn.coords=function(e,t,n){var r;return n?void 0:(r=e.getAttributeNode(t))&&""!==r.value?r.value:null},h.valHooks.button={get:function(e,t){var n=e.getAttributeNode(t);return n&&n.specified?n.value:void 0},set:pn.set},h.attrHooks.contenteditable={set:function(e,t,n){pn.set(e,""===t?!1:t,n)}},h.each(["width","height"],function(e,t){h.attrHooks[t]={set:function(e,n){return""===n?(e.setAttribute(t,"auto"),n):void 0}}})),l.style||(h.attrHooks.style={get:function(e){return e.style.cssText||void 0},set:function(e,t){return e.style.cssText=t+""}});var bn=/^(?:input|select|textarea|button|object)$/i,wn=/^(?:a|area)$/i;h.fn.extend({prop:function(e,t){return $(this,h.prop,e,t,arguments.length>1)},removeProp:function(e){return e=h.propFix[e]||e,this.each(function(){try{this[e]=void 0,delete this[e]}catch(t){}})}}),h.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,n){var r,i,s,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return s=1!==o||!h.isXMLDoc(e),s&&(t=h.propFix[t]||t,i=h.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=h.find.attr(e,"tabindex");return t?parseInt(t,10):bn.test(e.nodeName)||wn.test(e.nodeName)&&e.href?0:-1}}}}),l.hrefNormalized||h.each(["href","src"],function(e,t){h.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),l.optSelected||(h.propHooks.selected={get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}}),h.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){h.propFix[this.toLowerCase()]=this}),l.enctype||(h.propFix.enctype="encoding");var En=/[\t\r\n\f]/g;h.fn.extend({addClass:function(e){var t,n,r,i,s,o,u=0,a=this.length,f="string"==typeof e&&e;if(h.isFunction(e))return this.each(function(t){h(this).addClass(e.call(this,t,this.className))});if(f)for(t=(e||"").match(O)||[];a>u;u++)if(n=this[u],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(En," "):" ")){s=0;while(i=t[s++])r.indexOf(" "+i+" ")<0&&(r+=i+" ");o=h.trim(r),n.className!==o&&(n.className=o)}return this},removeClass:function(e){var t,n,r,i,s,o,u=0,a=this.length,f=0===arguments.length||"string"==typeof e&&e;if(h.isFunction(e))return this.each(function(t){h(this).removeClass(e.call(this,t,this.className))});if(f)for(t=(e||"").match(O)||[];a>u;u++)if(n=this[u],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(En," "):"")){s=0;while(i=t[s++])while(r.indexOf(" "+i+" ")>=0)r=r.replace(" "+i+" "," ");o=e?h.trim(r):"",n.className!==o&&(n.className=o)}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):this.each(h.isFunction(e)?function(n){h(this).toggleClass(e.call(this,n,this.className,t),t)}:function(){if("string"===n){var t,r=0,i=h(this),s=e.match(O)||[];while(t=s[r++])i.hasClass(t)?i.removeClass(t):i.addClass(t)}else(n===B||"boolean"===n)&&(this.className&&h._data(this,"__className__",this.className),this.className=this.className||e===!1?"":h._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",n=0,r=this.length;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(En," ").indexOf(t)>=0)return!0;return!1}}),h.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){h.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),h.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var Sn=h.now(),xn=/\?/,Tn=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;h.parseJSON=function(t){if(e.JSON&&e.JSON.parse)return e.JSON.parse(t+"");var n,r=null,i=h.trim(t+"");return i&&!h.trim(i.replace(Tn,function(e,t,i,s){return n&&t&&(r=0),0===r?e:(n=i||t,r+=!s-!i,"")}))?Function("return "+i)():h.error("Invalid JSON: "+t)},h.parseXML=function(t){var n,r;if(!t||"string"!=typeof t)return null;try{e.DOMParser?(r=new DOMParser,n=r.parseFromString(t,"text/xml")):(n=new ActiveXObject("Microsoft.XMLDOM"),n.async="false",n.loadXML(t))}catch(i){n=void 0}return n&&n.documentElement&&!n.getElementsByTagName("parsererror").length||h.error("Invalid XML: "+t),n};var Nn,Cn,kn=/#.*$/,Ln=/([?&])_=[^&]*/,An=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,On=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Mn=/^(?:GET|HEAD)$/,_n=/^\/\//,Dn=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Pn={},Hn={},Bn="*/".concat("*");try{Cn=location.href}catch(jn){Cn=T.createElement("a"),Cn.href="",Cn=Cn.href}Nn=Dn.exec(Cn.toLowerCase())||[],h.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Cn,type:"GET",isLocal:On.test(Nn[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Bn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":h.parseJSON,"text xml":h.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?qn(qn(e,h.ajaxSettings),t):qn(h.ajaxSettings,e)},ajaxPrefilter:Fn(Pn),ajaxTransport:Fn(Hn),ajax:function(e,t){function x(e,t,n,r){var f,g,y,w,S,x=t;2!==b&&(b=2,o&&clearTimeout(o),a=void 0,s=r||"",E.readyState=e>0?4:0,f=e>=200&&300>e||304===e,n&&(w=Rn(l,E,n)),w=Un(l,w,E,f),f?(l.ifModified&&(S=E.getResponseHeader("Last-Modified"),S&&(h.lastModified[i]=S),S=E.getResponseHeader("etag"),S&&(h.etag[i]=S)),204===e||"HEAD"===l.type?x="nocontent":304===e?x="notmodified":(x=w.state,g=w.data,y=w.error,f=!y)):(y=x,(e||!x)&&(x="error",0>e&&(e=0))),E.status=e,E.statusText=(t||x)+"",f?d.resolveWith(c,[g,x,E]):d.rejectWith(c,[E,x,y]),E.statusCode(m),m=void 0,u&&p.trigger(f?"ajaxSuccess":"ajaxError",[E,l,f?g:y]),v.fireWith(c,[E,x]),u&&(p.trigger("ajaxComplete",[E,l]),--h.active||h.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,r,i,s,o,u,a,f,l=h.ajaxSetup({},t),c=l.context||l,p=l.context&&(c.nodeType||c.jquery)?h(c):h.event,d=h.Deferred(),v=h.Callbacks("once memory"),m=l.statusCode||{},g={},y={},b=0,w="canceled",E={readyState:0,getResponseHeader:function(e){var t;if(2===b){if(!f){f={};while(t=An.exec(s))f[t[1].toLowerCase()]=t[2]}t=f[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===b?s:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return b||(e=y[n]=y[n]||e,g[e]=t),this},overrideMimeType:function(e){return b||(l.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>b)for(t in e)m[t]=[m[t],e[t]];else E.always(e[E.status]);return this},abort:function(e){var t=e||w;return a&&a.abort(t),x(0,t),this}};if(d.promise(E).complete=v.add,E.success=E.done,E.error=E.fail,l.url=((e||l.url||Cn)+"").replace(kn,"").replace(_n,Nn[1]+"//"),l.type=t.method||t.type||l.method||l.type,l.dataTypes=h.trim(l.dataType||"*").toLowerCase().match(O)||[""],null==l.crossDomain&&(n=Dn.exec(l.url.toLowerCase()),l.crossDomain=!(!n||n[1]===Nn[1]&&n[2]===Nn[2]&&(n[3]||("http:"===n[1]?"80":"443"))===(Nn[3]||("http:"===Nn[1]?"80":"443")))),l.data&&l.processData&&"string"!=typeof l.data&&(l.data=h.param(l.data,l.traditional)),In(Pn,l,t,E),2===b)return E;u=l.global,u&&0===h.active++&&h.event.trigger("ajaxStart"),l.type=l.type.toUpperCase(),l.hasContent=!Mn.test(l.type),i=l.url,l.hasContent||(l.data&&(i=l.url+=(xn.test(i)?"&":"?")+l.data,delete l.data),l.cache===!1&&(l.url=Ln.test(i)?i.replace(Ln,"$1_="+Sn++):i+(xn.test(i)?"&":"?")+"_="+Sn++)),l.ifModified&&(h.lastModified[i]&&E.setRequestHeader("If-Modified-Since",h.lastModified[i]),h.etag[i]&&E.setRequestHeader("If-None-Match",h.etag[i])),(l.data&&l.hasContent&&l.contentType!==!1||t.contentType)&&E.setRequestHeader("Content-Type",l.contentType),E.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+("*"!==l.dataTypes[0]?", "+Bn+"; q=0.01":""):l.accepts["*"]);for(r in l.headers)E.setRequestHeader(r,l.headers[r]);if(!l.beforeSend||l.beforeSend.call(c,E,l)!==!1&&2!==b){w="abort";for(r in{success:1,error:1,complete:1})E[r](l[r]);if(a=In(Hn,l,t,E)){E.readyState=1,u&&p.trigger("ajaxSend",[E,l]),l.async&&l.timeout>0&&(o=setTimeout(function(){E.abort("timeout")},l.timeout));try{b=1,a.send(g,x)}catch(S){if(!(2>b))throw S;x(-1,S)}}else x(-1,"No Transport");return E}return E.abort()},getJSON:function(e,t,n){return h.get(e,t,n,"json")},getScript:function(e,t){return h.get(e,void 0,t,"script")}}),h.each(["get","post"],function(e,t){h[t]=function(e,n,r,i){return h.isFunction(n)&&(i=i||r,r=n,n=void 0),h.ajax({url:e,type:t,dataType:i,data:n,success:r})}}),h.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){h.fn[t]=function(e){return this.on(t,e)}}),h._evalUrl=function(e){return h.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},h.fn.extend({wrapAll:function(e){if(h.isFunction(e))return this.each(function(t){h(this).wrapAll(e.call(this,t))});if(this[0]){var t=h(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&1===e.firstChild.nodeType)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return this.each(h.isFunction(e)?function(t){h(this).wrapInner(e.call(this,t))}:function(){var t=h(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=h.isFunction(e);return this.each(function(n){h(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){h.nodeName(this,"body")||h(this).replaceWith(this.childNodes)}).end()}}),h.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0||!l.reliableHiddenOffsets()&&"none"===(e.style&&e.style.display||h.css(e,"display"))},h.expr.filters.visible=function(e){return!h.expr.filters.hidden(e)};var zn=/%20/g,Wn=/\[\]$/,Xn=/\r?\n/g,Vn=/^(?:submit|button|image|reset|file)$/i,$n=/^(?:input|select|textarea|keygen)/i;h.param=function(e,t){var n,r=[],i=function(e,t){t=h.isFunction(t)?t():null==t?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=h.ajaxSettings&&h.ajaxSettings.traditional),h.isArray(e)||e.jquery&&!h.isPlainObject(e))h.each(e,function(){i(this.name,this.value)});else for(n in e)Jn(n,e[n],t,i);return r.join("&").replace(zn,"+")},h.fn.extend({serialize:function(){return h.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=h.prop(this,"elements");return e?h.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!h(this).is(":disabled")&&$n.test(this.nodeName)&&!Vn.test(e)&&(this.checked||!J.test(e))}).map(function(e,t){var n=h(this).val();return null==n?null:h.isArray(n)?h.map(n,function(e){return{name:t.name,value:e.replace(Xn,"\r\n")}}):{name:t.name,value:n.replace(Xn,"\r\n")}}).get()}}),h.ajaxSettings.xhr=void 0!==e.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&Yn()||Zn()}:Yn;var Kn=0,Qn={},Gn=h.ajaxSettings.xhr();e.ActiveXObject&&h(e).on("unload",function(){for(var e in Qn)Qn[e](void 0,!0)}),l.cors=!!Gn&&"withCredentials"in Gn,Gn=l.ajax=!!Gn,Gn&&h.ajaxTransport(function(e){if(!e.crossDomain||l.cors){var t;return{send:function(n,r){var i,s=e.xhr(),o=++Kn;if(s.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(i in e.xhrFields)s[i]=e.xhrFields[i];e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");for(i in n)void 0!==n[i]&&s.setRequestHeader(i,n[i]+"");s.send(e.hasContent&&e.data||null),t=function(n,i){var u,a,f;if(t&&(i||4===s.readyState))if(delete Qn[o],t=void 0,s.onreadystatechange=h.noop,i)4!==s.readyState&&s.abort();else{f={},u=s.status,"string"==typeof s.responseText&&(f.text=s.responseText);try{a=s.statusText}catch(l){a=""}u||!e.isLocal||e.crossDomain?1223===u&&(u=204):u=f.text?200:404}f&&r(u,a,f,s.getAllResponseHeaders())},e.async?4===s.readyState?setTimeout(t):s.onreadystatechange=Qn[o]=t:t()},abort:function(){t&&t(void 0,!0)}}}}),h.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return h.globalEval(e),e}}}),h.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),h.ajaxTransport("script",function(e){if(e.crossDomain){var t,n=T.head||h("head")[0]||T.documentElement;return{send:function(r,i){t=T.createElement("script"),t.async=!0,e.scriptCharset&&(t.charset=e.scriptCharset),t.src=e.url,t.onload=t.onreadystatechange=function(e,n){(n||!t.readyState||/loaded|complete/.test(t.readyState))&&(t.onload=t.onreadystatechange=null,t.parentNode&&t.parentNode.removeChild(t),t=null,n||i(200,"success"))},n.insertBefore(t,n.firstChild)},abort:function(){t&&t.onload(void 0,!0)}}}});var er=[],tr=/(=)\?(?=&|$)|\?\?/;h.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=er.pop()||h.expando+"_"+Sn++;return this[e]=!0,e}}),h.ajaxPrefilter("json jsonp",function(t,n,r){var i,s,o,u=t.jsonp!==!1&&(tr.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&tr.test(t.data)&&"data");return u||"jsonp"===t.dataTypes[0]?(i=t.jsonpCallback=h.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,u?t[u]=t[u].replace(tr,"$1"+i):t.jsonp!==!1&&(t.url+=(xn.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return o||h.error(i+" was not called"),o[0]},t.dataTypes[0]="json",s=e[i],e[i]=function(){o=arguments},r.always(function(){e[i]=s,t[i]&&(t.jsonpCallback=n.jsonpCallback,er.push(i)),o&&h.isFunction(s)&&s(o[0]),o=s=void 0}),"script"):void 0}),h.parseHTML=function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||T;var r=w.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=h.buildFragment([e],t,i),i&&i.length&&h(i).remove(),h.merge([],r.childNodes))};var nr=h.fn.load;h.fn.load=function(e,t,n){if("string"!=typeof e&&nr)return nr.apply(this,arguments);var r,i,s,o=this,u=e.indexOf(" ");return u>=0&&(r=h.trim(e.slice(u,e.length)),e=e.slice(0,u)),h.isFunction(t)?(n=t,t=void 0):t&&"object"==typeof t&&(s="POST"),o.length>0&&h.ajax({url:e,type:s,dataType:"html",data:t}).done(function(e){i=arguments,o.html(r?h("<div>").append(h.parseHTML(e)).find(r):e)}).complete(n&&function(e,t){o.each(n,i||[e.responseText,t,e])}),this},h.expr.filters.animated=function(e){return h.grep(h.timers,function(t){return e===t.elem}).length};var rr=e.document.documentElement;h.offset={setOffset:function(e,t,n){var r,i,s,o,u,a,f,l=h.css(e,"position"),c=h(e),p={};"static"===l&&(e.style.position="relative"),u=c.offset(),s=h.css(e,"top"),a=h.css(e,"left"),f=("absolute"===l||"fixed"===l)&&h.inArray("auto",[s,a])>-1,f?(r=c.position(),o=r.top,i=r.left):(o=parseFloat(s)||0,i=parseFloat(a)||0),h.isFunction(t)&&(t=t.call(e,n,u)),null!=t.top&&(p.top=t.top-u.top+o),null!=t.left&&(p.left=t.left-u.left+i),"using"in t?t.using.call(e,p):c.css(p)}},h.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){h.offset.setOffset(this,e,t)});var t,n,r={top:0,left:0},i=this[0],s=i&&i.ownerDocument;if(s)return t=s.documentElement,h.contains(t,i)?(typeof i.getBoundingClientRect!==B&&(r=i.getBoundingClientRect()),n=ir(s),{top:r.top+(n.pageYOffset||t.scrollTop)-(t.clientTop||0),left:r.left+(n.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}):r},position:function(){if(this[0]){var e,t,n={top:0,left:0},r=this[0];return"fixed"===h.css(r,"position")?t=r.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),h.nodeName(e[0],"html")||(n=e.offset()),n.top+=h.css(e[0],"borderTopWidth",!0),n.left+=h.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-h.css(r,"marginTop",!0),left:t.left-n.left-h.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||rr;while(e&&!h.nodeName(e,"html")&&"static"===h.css(e,"position"))e=e.offsetParent;return e||rr})}}),h.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n=/Y/.test(t);h.fn[e]=function(r){return $(this,function(e,r,i){var s=ir(e);return void 0===i?s?t in s?s[t]:s.document.documentElement[r]:e[r]:void (s?s.scrollTo(n?h(s).scrollLeft():i,n?i:h(s).scrollTop()):e[r]=i)},e,r,arguments.length,null)}}),h.each(["top","left"],function(e,t){h.cssHooks[t]=jt(l.pixelPosition,function(e,n){return n?(n=Ht(e,t),Dt.test(n)?h(e).position()[t]+"px":n):void 0})}),h.each({Height:"height",Width:"width"},function(e,t){h.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){h.fn[r]=function(r,i){var s=arguments.length&&(n||"boolean"!=typeof r),o=n||(r===!0||i===!0?"margin":"border");return $(this,function(t,n,r){var i;return h.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(i=t.documentElement,Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])):void 0===r?h.css(t,n,o):h.style(t,n,r,o)},t,s?r:void 0,s,null)}})}),h.fn.size=function(){return this.length},h.fn.andSelf=h.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return h});var sr=e.jQuery,or=e.$;return h.noConflict=function(t){return e.$===h&&(e.$=or),t&&e.jQuery===h&&(e.jQuery=sr),h},typeof t===B&&(e.jQuery=e.$=h),h}),function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.push,u=r.slice,a=r.concat,f=i.toString,l=i.hasOwnProperty,c=r.forEach,h=r.map,p=r.reduce,d=r.reduceRight,v=r.filter,m=r.every,g=r.some,y=r.indexOf,b=r.lastIndexOf,w=Array.isArray,E=Object.keys,S=s.bind,x=function(e){return e instanceof x?e:this instanceof x?void (this._wrapped=e):new x(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):e._=x,x.VERSION="1.6.0";var T=x.each=x.forEach=function(e,t,r){if(null==e)return e;if(c&&e.forEach===c)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;s>i;i++)if(t.call(r,e[i],i,e)===n)return}else for(var o=x.keys(e),i=0,s=o.length;s>i;i++)if(t.call(r,e[o[i]],o[i],e)===n)return;return e};x.map=x.collect=function(e,t,n){var r=[];return null==e?r:h&&e.map===h?e.map(t,n):(T(e,function(e,i,s){r.push(t.call(n,e,i,s))}),r)};var N="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(e,t,n,r){var i=arguments.length>2;if(null==e&&(e=[]),p&&e.reduce===p)return r&&(t=x.bind(t,r)),i?e.reduce(t,n):e.reduce(t);if(T(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)}),!i)throw new TypeError(N);return n},x.reduceRight=x.foldr=function(e,t,n,r){var i=arguments.length>2;if(null==e&&(e=[]),d&&e.reduceRight===d)return r&&(t=x.bind(t,r)),i?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=x.keys(e);s=o.length}if(T(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)}),!i)throw new TypeError(N);return n},x.find=x.detect=function(e,t,n){var r;return C(e,function(e,i,s){return t.call(n,e,i,s)?(r=e,!0):void 0}),r},x.filter=x.select=function(e,t,n){var r=[];return null==e?r:v&&e.filter===v?e.filter(t,n):(T(e,function(e,i,s){t.call(n,e,i,s)&&r.push(e)}),r)},x.reject=function(e,t,n){return x.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)},x.every=x.all=function(e,t,r){t||(t=x.identity);var i=!0;return null==e?i:m&&e.every===m?e.every(t,r):(T(e,function(e,s,o){return(i=i&&t.call(r,e,s,o))?void 0:n}),!!i)};var C=x.some=x.any=function(e,t,r){t||(t=x.identity);var i=!1;return null==e?i:g&&e.some===g?e.some(t,r):(T(e,function(e,s,o){return i||(i=t.call(r,e,s,o))?n:void 0}),!!i)};x.contains=x.include=function(e,t){return null==e?!1:y&&e.indexOf===y?e.indexOf(t)!=-1:C(e,function(e){return e===t})},x.invoke=function(e,t){var n=u.call(arguments,2),r=x.isFunction(t);return x.map(e,function(e){return(r?t:e[t]).apply(e,n)})},x.pluck=function(e,t){return x.map(e,x.property(t))},x.where=function(e,t){return x.filter(e,x.matches(t))},x.findWhere=function(e,t){return x.find(e,x.matches(t))},x.max=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);var r=-1/0,i=-1/0;return T(e,function(e,s,o){var u=t?t.call(n,e,s,o):e;u>i&&(r=e,i=u)}),r},x.min=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);var r=1/0,i=1/0;return T(e,function(e,s,o){var u=t?t.call(n,e,s,o):e;i>u&&(r=e,i=u)}),r},x.shuffle=function(e){var t,n=0,r=[];return T(e,function(e){t=x.random(n++),r[n-1]=r[t],r[t]=e}),r},x.sample=function(e,t,n){return null==t||n?(e.length!==+e.length&&(e=x.values(e)),e[x.random(e.length-1)]):x.shuffle(e).slice(0,Math.max(0,t))};var k=function(e){return null==e?x.identity:x.isFunction(e)?e:x.property(e)};x.sortBy=function(e,t,n){return t=k(t),x.pluck(x.map(e,function(e,r,i){return{value:e,index:r,criteria:t.call(n,e,r,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(r>n||r===void 0)return-1}return e.index-t.index}),"value")};var L=function(e){return function(t,n,r){var i={};return n=k(n),T(t,function(s,o){var u=n.call(r,s,o,t);e(i,u,s)}),i}};x.groupBy=L(function(e,t,n){x.has(e,t)?e[t].push(n):e[t]=[n]}),x.indexBy=L(function(e,t,n){e[t]=n}),x.countBy=L(function(e,t){x.has(e,t)?e[t]++:e[t]=1}),x.sortedIndex=function(e,t,n,r){n=k(n);for(var i=n.call(r,t),s=0,o=e.length;o>s;){var u=s+o>>>1;n.call(r,e[u])<i?s=u+1:o=u}return s},x.toArray=function(e){return e?x.isArray(e)?u.call(e):e.length===+e.length?x.map(e,x.identity):x.values(e):[]},x.size=function(e){return null==e?0:e.length===+e.length?e.length:x.keys(e).length},x.first=x.head=x.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:0>t?[]:u.call(e,0,t)},x.initial=function(e,t,n){return u.call(e,0,e.length-(null==t||n?1:t))},x.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:u.call(e,Math.max(e.length-t,0))},x.rest=x.tail=x.drop=function(e,t,n){return u.call(e,null==t||n?1:t)},x.compact=function(e){return x.filter(e,x.identity)};var A=function(e,t,n){return t&&x.every(e,x.isArray)?a.apply(n,e):(T(e,function(e){x.isArray(e)||x.isArguments(e)?t?o.apply(n,e):A(e,t,n):n.push(e)}),n)};x.flatten=function(e,t){return A(e,t,[])},x.without=function(e){return x.difference(e,u.call(arguments,1))},x.partition=function(e,t){var n=[],r=[];return T(e,function(e){(t(e)?n:r).push(e)}),[n,r]},x.uniq=x.unique=function(e,t,n,r){x.isFunction(t)&&(r=n,n=t,t=!1);var i=n?x.map(e,n,r):e,s=[],o=[];return T(i,function(n,r){(t?r&&o[o.length-1]===n:x.contains(o,n))||(o.push(n),s.push(e[r]))}),s},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(e){var t=u.call(arguments,1);return x.filter(x.uniq(e),function(e){return x.every(t,function(t){return x.contains(t,e)})})},x.difference=function(e){var t=a.apply(r,u.call(arguments,1));return x.filter(e,function(e){return!x.contains(t,e)})},x.zip=function(){for(var e=x.max(x.pluck(arguments,"length").concat(0)),t=new Array(e),n=0;e>n;n++)t[n]=x.pluck(arguments,""+n);return t},x.object=function(e,t){if(null==e)return{};for(var n={},r=0,i=e.length;i>r;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},x.indexOf=function(e,t,n){if(null==e)return-1;var r=0,i=e.length;if(n){if("number"!=typeof n)return r=x.sortedIndex(e,t),e[r]===t?r:-1;r=0>n?Math.max(0,i+n):n}if(y&&e.indexOf===y)return e.indexOf(t,n);for(;i>r;r++)if(e[r]===t)return r;return-1},x.lastIndexOf=function(e,t,n){if(null==e)return-1;var r=null!=n;if(b&&e.lastIndexOf===b)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);for(var i=r?n:e.length;i--;)if(e[i]===t)return i;return-1},x.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;for(var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);r>i;)s[i++]=e,e+=n;return s};var O=function(){};x.bind=function(e,t){var n,r;if(S&&e.bind===S)return S.apply(e,u.call(arguments,1));if(!x.isFunction(e))throw new TypeError;return n=u.call(arguments,2),r=function(){if(this instanceof r){O.prototype=e.prototype;var i=new O;O.prototype=null;var s=e.apply(i,n.concat(u.call(arguments)));return Object(s)===s?s:i}return e.apply(t,n.concat(u.call(arguments)))}},x.partial=function(e){var t=u.call(arguments,1);return function(){for(var n=0,r=t.slice(),i=0,s=r.length;s>i;i++)r[i]===x&&(r[i]=arguments[n++]);for(;n<arguments.length;)r.push(arguments[n++]);return e.apply(this,r)}},x.bindAll=function(e){var t=u.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return T(t,function(t){e[t]=x.bind(e[t],e)}),e},x.memoize=function(e,t){var n={};return t||(t=x.identity),function(){var r=t.apply(this,arguments);return x.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},x.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},x.defer=function(e){return x.delay.apply(x,[e,1].concat(u.call(arguments,1)))},x.throttle=function(e,t,n){var r,i,s,o=null,u=0;n||(n={});var a=function(){u=n.leading===!1?0:x.now(),o=null,s=e.apply(r,i),r=i=null};return function(){var f=x.now();u||n.leading!==!1||(u=f);var l=t-(f-u);return r=this,i=arguments,0>=l?(clearTimeout(o),o=null,u=f,s=e.apply(r,i),r=i=null):o||n.trailing===!1||(o=setTimeout(a,l)),s}},x.debounce=function(e,t,n){var r,i,s,o,u,a=function(){var f=x.now()-o;t>f?r=setTimeout(a,t-f):(r=null,n||(u=e.apply(s,i),s=i=null))};return function(){s=this,i=arguments,o=x.now();var f=n&&!r;return r||(r=setTimeout(a,t)),f&&(u=e.apply(s,i),s=i=null),u}},x.once=function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}},x.wrap=function(e,t){return x.partial(t,e)},x.compose=function(){var e=arguments;return function(){for(var t=arguments,n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},x.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},x.keys=function(e){if(!x.isObject(e))return[];if(E)return E(e);var t=[];for(var n in e)x.has(e,n)&&t.push(n);return t},x.values=function(e){for(var t=x.keys(e),n=t.length,r=new Array(n),i=0;n>i;i++)r[i]=e[t[i]];return r},x.pairs=function(e){for(var t=x.keys(e),n=t.length,r=new Array(n),i=0;n>i;i++)r[i]=[t[i],e[t[i]]];return r},x.invert=function(e){for(var t={},n=x.keys(e),r=0,i=n.length;i>r;r++)t[e[n[r]]]=n[r];return t},x.functions=x.methods=function(e){var t=[];for(var n in e)x.isFunction(e[n])&&t.push(n);return t.sort()},x.extend=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},x.pick=function(e){var t={},n=a.apply(r,u.call(arguments,1));return T(n,function(n){n in e&&(t[n]=e[n])}),t},x.omit=function(e){var t={},n=a.apply(r,u.call(arguments,1));for(var i in e)x.contains(n,i)||(t[i]=e[i]);return t},x.defaults=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]===void 0&&(e[n]=t[n])}),e},x.clone=function(e){return x.isObject(e)?x.isArray(e)?e.slice():x.extend({},e):e},x.tap=function(e,t){return t(e),e};var M=function(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof x&&(e=e._wrapped),t instanceof x&&(t=t._wrapped);var i=f.call(e);if(i!=f.call(t))return!1;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var s=n.length;s--;)if(n[s]==e)return r[s]==t;var o=e.constructor,u=t.constructor;if(o!==u&&!(x.isFunction(o)&&o instanceof o&&x.isFunction(u)&&u instanceof u)&&"constructor"in e&&"constructor"in t)return!1;n.push(e),r.push(t);var a=0,l=!0;if("[object Array]"==i){if(a=e.length,l=a==t.length)for(;a--&&(l=M(e[a],t[a],n,r)););}else{for(var c in e)if(x.has(e,c)&&(a++,!(l=x.has(t,c)&&M(e[c],t[c],n,r))))break;if(l){for(c in t)if(x.has(t,c)&&!(a--))break;l=!a}}return n.pop(),r.pop(),l};x.isEqual=function(e,t){return M(e,t,[],[])},x.isEmpty=function(e){if(null==e)return!0;if(x.isArray(e)||x.isString(e))return 0===e.length;for(var t in e)if(x.has(e,t))return!1;return!0},x.isElement=function(e){return!!e&&1===e.nodeType},x.isArray=w||function(e){return"[object Array]"==f.call(e)},x.isObject=function(e){return e===Object(e)},T(["Arguments","Function","String","Number","Date","RegExp"],function(e){x["is"+e]=function(t){return f.call(t)=="[object "+e+"]"}}),x.isArguments(arguments)||(x.isArguments=function(e){return!!e&&!!x.has(e,"callee")}),"function"!=typeof /./&&(x.isFunction=function(e){return"function"==typeof e}),x.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},x.isNaN=function(e){return x.isNumber(e)&&e!=+e},x.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==f.call(e)},x.isNull=function(e){return null===e},x.isUndefined=function(e){return e===void 0},x.has=function(e,t){return l.call(e,t)},x.noConflict=function(){return e._=t,this},x.identity=function(e){return e},x.constant=function(e){return function(){return e}},x.property=function(e){return function(t){return t[e]}},x.matches=function(e){return function(t){if(t===e)return!0;for(var n in e)if(e[n]!==t[n])return!1;return!0}},x.times=function(e,t,n){for(var r=Array(Math.max(0,e)),i=0;e>i;i++)r[i]=t.call(n,i);return r},x.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},x.now=Date.now||function(){return(new Date).getTime()};var _={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};_.unescape=x.invert(_.escape);var D={escape:new RegExp("["+x.keys(_.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(_.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(e){x[e]=function(t){return null==t?"":(""+t).replace(D[e],function(t){return _[e][t]})}}),x.result=function(e,t){if(null==e)return void 0;var n=e[t];return x.isFunction(n)?n.call(e):n},x.mixin=function(e){T(x.functions(e),function(t){var n=x[t]=e[t];x.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),F.call(this,n.apply(x,e))}})};var P=0;x.uniqueId=function(e){var t=++P+"";return e?e+t:t},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(e,t,n){var r;n=x.defaults({},n,x.templateSettings);var i=new RegExp([(n.escape||H).source,(n.interpolate||H).source,(n.evaluate||H).source].join("|")+"|$","g"),s=0,o="__p+='";e.replace(i,function(t,n,r,i,u){return o+=e.slice(s,u).replace(j,function(e){return"\\"+B[e]}),n&&(o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(o+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(o+="';\n"+i+"\n__p+='"),s=u+t.length,t}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{r=new Function(n.variable||"obj","_",o)}catch(u){throw u.source=o,u}if(t)return r(t,x);var a=function(e){return r.call(this,e,x)};return a.source="function("+(n.variable||"obj")+"){\n"+o+"}",a},x.chain=function(e){return x(e).chain()};var F=function(e){return this._chain?x(e).chain():e};x.mixin(x),T(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];x.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!=e&&"splice"!=e||0!==n.length||delete n[0],F.call(this,n)}}),T(["concat","join","slice"],function(e){var t=r[e];x.prototype[e]=function(){return F.call(this,t.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return x})}.call(this),define("underscore-min",["jquery"],function(e){return function(){var t,n;return t||e._}}(this)),define("gw/Numeric",[],function(){var e={};return e.lerp=function(e,t,n){return t+(n-t)*e},e.cubicInterpolation=function(e,t,n,r,i){var s=e*e,o=s*e,u=2*t[0]-2*r[0]+n[0]+i[0],a=2*t[1]-2*r[1]+n[1]+i[1],f=2*t[2]-2*r[2]+n[2]+i[2],l=-3*t[0]+3*r[0]-2*n[0]-i[0],c=-3*t[1]+3*r[1]-2*n[1]-i[1],h=-3*t[2]+3*r[2]-2*n[2]-i[2],p=vec3.create();return p[0]=u*o+l*s+n[0]*e+t[0],p[1]=a*o+c*s+n[1]*e+t[1],p[2]=f*o+h*s+n[2]*e+t[2],p},e.cubicInterpolationDerivative=function(e,t,n,r,i){var s=e*e,o=6*t[0]-6*r[0]+3*n[0]+3*i[0],u=6*t[1]-6*r[1]+3*n[1]+3*i[1],a=6*t[2]-6*r[2]+3*n[2]+3*i[2],f=-6*t[0]+6*r[0]-4*n[0]-2*i[0],l=-6*t[1]+6*r[1]-4*n[1]-2*i[1],c=-6*t[2]+6*r[2]-4*n[2]-2*i[2],h=vec3.create();return h[0]=o*s+f*e+n[0],h[1]=u*s+l*e+n[1],h[2]=a*s+c*e+n[2],h},e.map01=function(e,t,n){return t!=n?(e-t)/(n-t):0},e.mapLinear=function(t,n,r,i,s){return e.lerp(e.map01(t,n,r),i,s)},e.easeInQuad=function(e){return e*e},e.easeOutQuad=function(e){var t=e-1;return 1-t*t},e.easeInOutQuad=function(e){var t=e;return t<.5?(t+=t,t=.5*t*t):(t=t+t-2,t=.5*(1-t*t),t=.5+t),t},e.easeOutInQuad=function(e){var t=e;return t<.5?(t=t+t-1,t=.5*(1-t*t)):(t=t+t-1,t=.5*t*t,t=.5+t),t},e.toRadian=function(e){return e*Math.PI/180},e.toDegree=function(e){return e*180/Math.PI},e.pointOnRay=function(e,t,n,r){return r||(r=vec3.create()),vec3.scale(t,n,r),vec3.add(r,e,r),r},e.lineIntersection=function(e,t,n,r,i,s,o,u){var a=(u-s)*(n-e)-(o-i)*(r-t);if(a==0)return[-1,-1];var f=(o-i)*(t-s)-(u-s)*(e-i),l=(n-e)*(t-s)-(r-t)*(e-i);return f/=a,l/=a,[f,l]},e.raySphereIntersection=function(e,t,n,r){var i=vec3.subtract(e,n,vec3.create()),s=2*vec3.dot(t,i),o=vec3.dot(i,i)-r*r,u=s*s-4*o;if(u<0)return-1;u=Math.sqrt(u);var a=(-s-u)/2,f=(-s+u)/2;if(a>f){var l=a;a=f,f=l}return f<0?-1:a<0?f:a},e.roundNumber=function(e,t){var n=Math.round(e*Math.pow(10,t))/Math.pow(10,t);return n},e}),define("gw/CoordinateSystem",["./Numeric"],function(e){var t={radius:1,heightScale:1/6356752.3142,realEarthRadius:6356752.3142};return t.fromGeoTo3D=function(n,r){r||(r=new Array(3));var i=e.toRadian(n[0]),s=e.toRadian(n[1]),o=Math.cos(s),u=n.length>2?t.heightScale*n[2]:0,a=t.radius+u;return r[0]=a*Math.cos(i)*o,r[1]=a*Math.sin(i)*o,r[2]=a*Math.sin(s),r},t.from3DToGeo=function(n,r){r||(r=new Array(3));var i=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]),s=Math.atan2(n[1]/i,n[0]/i),o=Math.asin(n[2]/i);return r[0]=e.toDegree(s),r[1]=e.toDegree(o),r[2]=t.realEarthRadius*(i-t.radius),r},t.getLocalTransform=function(e,t){t||(t=mat4.create());var n=e[0]*Math.PI/180,r=e[1]*Math.PI/180,i=[Math.cos(n)*Math.cos(r),Math.sin(n)*Math.cos(r),Math.sin(r)],s=[-Math.sin(n),Math.cos(n),0],o=vec3.create();return vec3.cross(i,s,o),t[0]=s[0],t[1]=s[1],t[2]=s[2],t[3]=0,t[4]=o[0],t[5]=o[1],t[6]=o[2],t[7]=0,t[8]=i[0],t[9]=i[1],t[10]=i[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.getLHVTransform=function(e,n){n||(n=mat4.create());var r=e[0]*Math.PI/180,i=e[1]*Math.PI/180,s=[Math.cos(r)*Math.cos(i),Math.sin(r)*Math.cos(i),Math.sin(i)],o=[-Math.sin(r),Math.cos(r),0],u=vec3.create();vec3.cross(s,o,u);var a=t.fromGeoTo3D(e);return n[0]=o[0],n[1]=o[1],n[2]=o[2],n[3]=0,n[4]=u[0],n[5]=u[1],n[6]=u[2],n[7]=0,n[8]=s[0],n[9]=s[1],n[10]=s[2],n[11]=0,n[12]=a[0],n[13]=a[1],n[14]=a[2],n[15]=1,n},t.getSideVector=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},t.getFrontVector=function(e,t){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t},t.getUpVector=function(e,t){return t[0]=e[8],t[1]=e[9],t[2]=e[10],t},t}),define("gw/AstroCoordTransform",[],function(){var e=2*Math.PI,t=4*Math.PI,n=180/Math.PI,r=[[.57595865315,4.9261918136,0,0,.11129056012,4.7005372834],[.574770433,4.9368292465,0,0,.11142137093,4.71279419371]],i=[[.88781538514,-0.88781538514,.39788119938,-0.39788119938,.86766174755,-0.86766174755],[.88998808748,-0.88998808748,.39777715593,-0.39777715593,.86766622025,-0.86766622025]],s=[[.46019978478,.46019978478,.9174369467,.9174369467,.49715499774,.49715499774],[.45598377618,.45598377618,.91748206207,.91748206207,.49714719172,.49714719172]],o=[[4.9261918136,.57595865315,0,0,4.7005372834,.11129056012],[4.9368292465,.574770433,0,0,4.71279419371,.11142137093]],u={transform:function(n,u){var a,f,l,c,h,p,d,v=1;return l=n[0]-o[v][u],c=n[1],h=Math.sin(c),p=Math.cos(c),d=p*Math.sin(l),c=-i[v][u]*d+s[v][u]*h,c=Math.max(-1,Math.min(c,1)),f=Math.asin(c),l=Math.atan2(s[v][u]*d+i[v][u]*h,p*Math.cos(l)),a=(l+r[v][u]+t)%e,[a,f]},transformInDeg:function(u,a){var f,l,c,h,p,d,v,m=1;return c=u[0]/n-o[m][a],h=u[1]/n,p=Math.sin(h),d=Math.cos(h),v=d*Math.sin(c),h=-i[m][a]*v+s[m][a]*p,h=Math.max(-1,Math.min(h,1)),l=Math.asin(h)*n,c=Math.atan2(s[m][a]*v+i[m][a]*p,d*Math.cos(c)),f=(c+r[m][a]+t)%e*n,[f,l]}};return u.Type={EQ2GAL:0,GAL2EQ:1,EQ2ECL:2,ECL2EQ:3,ECL2GAL:4,GAL2ECL:5},u}),define("gw/glMatrix",[],function(){var e=1e-6,t=Array,n={};n.create=function(e){var n=new t(3);return e?(n[0]=e[0],n[1]=e[1],n[2]=e[2]):n[0]=n[1]=n[2]=0,n},n.createFrom=function(e,n,r){var i=new t(3);return i[0]=e,i[1]=n,i[2]=r,i},n.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},n.equal=function(t,n){return t===n||Math.abs(t[0]-n[0])<e&&Math.abs(t[1]-n[1])<e&&Math.abs(t[2]-n[2])<e},n.add=function(e,t,n){return!n||e===n?(e[0]+=t[0],e[1]+=t[1],e[2]+=t[2],e):(n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n)},n.subtract=function(e,t,n){return!n||e===n?(e[0]-=t[0],e[1]-=t[1],e[2]-=t[2],e):(n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n)},n.multiply=function(e,t,n){return!n||e===n?(e[0]*=t[0],e[1]*=t[1],e[2]*=t[2],e):(n[0]=e[0]*t[0],n[1]=e[1]*t[1],n[2]=e[2]*t[2],n)},n.negate=function(e,t){return t||(t=e),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},n.scale=function(e,t,n){return!n||e===n?(e[0]*=t,e[1]*=t,e[2]*=t,e):(n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n)},n.normalize=function(e,t){t||(t=e);var n=e[0],r=e[1],i=e[2],s=Math.sqrt(n*n+r*r+i*i);return s?s===1?(t[0]=n,t[1]=r,t[2]=i,t):(s=1/s,t[0]=n*s,t[1]=r*s,t[2]=i*s,t):(t[0]=0,t[1]=0,t[2]=0,t)},n.cross=function(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2],o=t[0],u=t[1],a=t[2];return n[0]=i*a-s*u,n[1]=s*o-r*a,n[2]=r*u-i*o,n},n.length=function(e){var t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)},n.squaredLength=function(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r},n.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},n.lerp=function(e,t,n,r){return r||(r=e),r[0]=e[0]+n*(t[0]-e[0]),r[1]=e[1]+n*(t[1]-e[1]),r[2]=e[2]+n*(t[2]-e[2]),r},n.dist=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(n*n+r*r+i*i)},n.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+"]"};var r={};r.create=function(e){var n=new t(16);return e&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n},r.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},r.identity=function(e){return e||(e=r.create()),e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},r.transpose=function(e,t){if(!t||e===t){var n=e[1],r=e[2],i=e[3],s=e[6],o=e[7],u=e[11];return e[1]=e[4],e[2]=e[8],e[3]=e[12],e[4]=n,e[6]=e[9],e[7]=e[13],e[8]=r,e[9]=s,e[11]=e[14],e[12]=i,e[13]=o,e[14]=u,e}return t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15],t},r.determinant=function(e){var t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],o=e[5],u=e[6],a=e[7],f=e[8],l=e[9],c=e[10],h=e[11],p=e[12],d=e[13],v=e[14],m=e[15];return p*l*u*i-f*d*u*i-p*o*c*i+s*d*c*i+f*o*v*i-s*l*v*i-p*l*r*a+f*d*r*a+p*n*c*a-t*d*c*a-f*n*v*a+t*l*v*a+p*o*r*h-s*d*r*h-p*n*u*h+t*d*u*h+s*n*v*h-t*o*v*h-f*o*r*m+s*l*r*m+f*n*u*m-t*l*u*m-s*n*c*m+t*o*c*m},r.inverse=function(e,t){t||(t=e);var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],u=e[5],a=e[6],f=e[7],l=e[8],c=e[9],h=e[10],p=e[11],d=e[12],v=e[13],m=e[14],g=e[15],y=n*u-r*o,b=n*a-i*o,w=n*f-s*o,E=r*a-i*u,S=r*f-s*u,x=i*f-s*a,T=l*v-c*d,N=l*m-h*d,C=l*g-p*d,k=c*m-h*v,L=c*g-p*v,A=h*g-p*m,O=y*A-b*L+w*k+E*C-S*N+x*T,M;return O?(M=1/O,t[0]=(u*A-a*L+f*k)*M,t[1]=(-r*A+i*L-s*k)*M,t[2]=(v*x-m*S+g*E)*M,t[3]=(-c*x+h*S-p*E)*M,t[4]=(-o*A+a*C-f*N)*M,t[5]=(n*A-i*C+s*N)*M,t[6]=(-d*x+m*w-g*b)*M,t[7]=(l*x-h*w+p*b)*M,t[8]=(o*L-u*C+f*T)*M,t[9]=(-n*L+r*C-s*T)*M,t[10]=(d*S-v*w+g*y)*M,t[11]=(-l*S+c*w-p*y)*M,t[12]=(-o*k+u*N-a*T)*M,t[13]=(n*k-r*N+i*T)*M,t[14]=(-d*E+v*b-m*y)*M,t[15]=(l*E-c*b+h*y)*M,t):null},r.toRotationMat=function(e,t){return t||(t=r.create()),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.toMat3=function(e,t){return t||(t=mat3.create()),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},r.multiply=function(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2],o=e[3],u=e[4],a=e[5],f=e[6],l=e[7],c=e[8],h=e[9],p=e[10],d=e[11],v=e[12],m=e[13],g=e[14],y=e[15],b=t[0],w=t[1],E=t[2],S=t[3];return n[0]=b*r+w*u+E*c+S*v,n[1]=b*i+w*a+E*h+S*m,n[2]=b*s+w*f+E*p+S*g,n[3]=b*o+w*l+E*d+S*y,b=t[4],w=t[5],E=t[6],S=t[7],n[4]=b*r+w*u+E*c+S*v,n[5]=b*i+w*a+E*h+S*m,n[6]=b*s+w*f+E*p+S*g,n[7]=b*o+w*l+E*d+S*y,b=t[8],w=t[9],E=t[10],S=t[11],n[8]=b*r+w*u+E*c+S*v,n[9]=b*i+w*a+E*h+S*m,n[10]=b*s+w*f+E*p+S*g,n[11]=b*o+w*l+E*d+S*y,b=t[12],w=t[13],E=t[14],S=t[15],n[12]=b*r+w*u+E*c+S*v,n[13]=b*i+w*a+E*h+S*m,n[14]=b*s+w*f+E*p+S*g,n[15]=b*o+w*l+E*d+S*y,n},r.multiplyVec3=function(e,t,n){n||(n=t);var r=t[0],i=t[1],s=t[2];return n[0]=e[0]*r+e[4]*i+e[8]*s+e[12],n[1]=e[1]*r+e[5]*i+e[9]*s+e[13],n[2]=e[2]*r+e[6]*i+e[10]*s+e[14],n},r.multiplyVec4=function(e,t,n){n||(n=t);var r=t[0],i=t[1],s=t[2],o=t[3];return n[0]=e[0]*r+e[4]*i+e[8]*s+e[12]*o,n[1]=e[1]*r+e[5]*i+e[9]*s+e[13]*o,n[2]=e[2]*r+e[6]*i+e[10]*s+e[14]*o,n[3]=e[3]*r+e[7]*i+e[11]*s+e[15]*o,n},r.project=function(e,t,n){n||(n=t),r.multiplyVec4(e,t,n);var i=1/n[3];return n[0]*=i,n[1]*=i,n[2]*=i,n},r.rotateVec3=function(e,t,n){n||(n=t);var r=t[0],i=t[1],s=t[2];return n[0]=e[0]*r+e[4]*i+e[8]*s,n[1]=e[1]*r+e[5]*i+e[9]*s,n[2]=e[2]*r+e[6]*i+e[10]*s,n},r.translate=function(e,t,n){var r=t[0],i=t[1],s=t[2],o,u,a,f,l,c,h,p,d,v,m,g;return!n||e===n?(e[12]=e[0]*r+e[4]*i+e[8]*s+e[12],e[13]=e[1]*r+e[5]*i+e[9]*s+e[13],e[14]=e[2]*r+e[6]*i+e[10]*s+e[14],e[15]=e[3]*r+e[7]*i+e[11]*s+e[15],e):(o=e[0],u=e[1],a=e[2],f=e[3],l=e[4],c=e[5],h=e[6],p=e[7],d=e[8],v=e[9],m=e[10],g=e[11],n[0]=o,n[1]=u,n[2]=a,n[3]=f,n[4]=l,n[5]=c,n[6]=h,n[7]=p,n[8]=d,n[9]=v,n[10]=m,n[11]=g,n[12]=o*r+l*i+d*s+e[12],n[13]=u*r+c*i+v*s+e[13],n[14]=a*r+h*i+m*s+e[14],n[15]=f*r+p*i+g*s+e[15],n)},r.scale=function(e,t,n){var r=t[0],i=t[1],s=t[2];return!n||e===n?(e[0]*=r,e[1]*=r,e[2]*=r,e[3]*=r,e[4]*=i,e[5]*=i,e[6]*=i,e[7]*=i,e[8]*=s,e[9]*=s,e[10]*=s,e[11]*=s,e):(n[0]=e[0]*r,n[1]=e[1]*r,n[2]=e[2]*r,n[3]=e[3]*r,n[4]=e[4]*i,n[5]=e[5]*i,n[6]=e[6]*i,n[7]=e[7]*i,n[8]=e[8]*s,n[9]=e[9]*s,n[10]=e[10]*s,n[11]=e[11]*s,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n)},r.rotate=function(e,t,n,r){var i=n[0],s=n[1],o=n[2],u=Math.sqrt(i*i+s*s+o*o),a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M;return u?(u!==1&&(u=1/u,i*=u,s*=u,o*=u),a=Math.sin(t),f=Math.cos(t),l=1-f,c=e[0],h=e[1],p=e[2],d=e[3],v=e[4],m=e[5],g=e[6],y=e[7],b=e[8],w=e[9],E=e[10],S=e[11],x=i*i*l+f,T=s*i*l+o*a,N=o*i*l-s*a,C=i*s*l-o*a,k=s*s*l+f,L=o*s*l+i*a,A=i*o*l+s*a,O=s*o*l-i*a,M=o*o*l+f,r?e!==r&&(r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]):r=e,r[0]=c*x+v*T+b*N,r[1]=h*x+m*T+w*N,r[2]=p*x+g*T+E*N,r[3]=d*x+y*T+S*N,r[4]=c*C+v*k+b*L,r[5]=h*C+m*k+w*L,r[6]=p*C+g*k+E*L,r[7]=d*C+y*k+S*L,r[8]=c*A+v*O+b*M,r[9]=h*A+m*O+w*M,r[10]=p*A+g*O+E*M,r[11]=d*A+y*O+S*M,r):null},r.rotateX=function(e,t,n){var r=Math.sin(t),i=Math.cos(t),s=e[4],o=e[5],u=e[6],a=e[7],f=e[8],l=e[9],c=e[10],h=e[11];return n?e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]):n=e,n[4]=s*i+f*r,n[5]=o*i+l*r,n[6]=u*i+c*r,n[7]=a*i+h*r,n[8]=s*-r+f*i,n[9]=o*-r+l*i,n[10]=u*-r+c*i,n[11]=a*-r+h*i,n},r.rotateY=function(e,t,n){var r=Math.sin(t),i=Math.cos(t),s=e[0],o=e[1],u=e[2],a=e[3],f=e[8],l=e[9],c=e[10],h=e[11];return n?e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]):n=e,n[0]=s*i+f*-r,n[1]=o*i+l*-r,n[2]=u*i+c*-r,n[3]=a*i+h*-r,n[8]=s*r+f*i,n[9]=o*r+l*i,n[10]=u*r+c*i,n[11]=a*r+h*i,n},r.rotateZ=function(e,t,n){var r=Math.sin(t),i=Math.cos(t),s=e[0],o=e[1],u=e[2],a=e[3],f=e[4],l=e[5],c=e[6],h=e[7];return n?e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]):n=e,n[0]=s*i+f*r,n[1]=o*i+l*r,n[2]=u*i+c*r,n[3]=a*i+h*r,n[4]=s*-r+f*i,n[5]=o*-r+l*i,n[6]=u*-r+c*i,n[7]=a*-r+h*i,n},r.frustum=function(e,t,n,i,s,o,u){u||(u=r.create());var a=t-e,f=i-n,l=o-s;return u[0]=s*2/a,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=s*2/f,u[6]=0,u[7]=0,u[8]=(t+e)/a,u[9]=(i+n)/f,u[10]=-(o+s)/l,u[11]=-1,u[12]=0,u[13]=0,u[14]=-(o*s*2)/l,u[15]=0,u},r.perspective=function(e,t,n,i,s){var o=n*Math.tan(e*Math.PI/360),u=o*t;return r.frustum(-u,u,-o,o,n,i,s)},r.ortho=function(e,t,n,i,s,o,u){u||(u=r.create());var a=t-e,f=i-n,l=o-s;return u[0]=2/a,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=2/f,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=-2/l,u[11]=0,u[12]=-(e+t)/a,u[13]=-(i+n)/f,u[14]=-(o+s)/l,u[15]=1,u},r.lookAt=function(e,t,n,i){i||(i=r.create());var s,o,u,a,f,l,c,h,p,d,v=e[0],m=e[1],g=e[2],y=n[0],b=n[1],w=n[2],E=t[0],S=t[1],x=t[2];return v===E&&m===S&&g===x?r.identity(i):(c=v-E,h=m-S,p=g-x,d=1/Math.sqrt(c*c+h*h+p*p),c*=d,h*=d,p*=d,s=b*p-w*h,o=w*c-y*p,u=y*h-b*c,d=Math.sqrt(s*s+o*o+u*u),d?(d=1/d,s*=d,o*=d,u*=d):(s=0,o=0,u=0),a=h*u-p*o,f=p*s-c*u,l=c*o-h*s,d=Math.sqrt(a*a+f*f+l*l),d?(d=1/d,a*=d,f*=d,l*=d):(a=0,f=0,l=0),i[0]=s,i[1]=a,i[2]=c,i[3]=0,i[4]=o,i[5]=f,i[6]=h,i[7]=0,i[8]=u,i[9]=l,i[10]=p,i[11]=0,i[12]=-(s*v+o*m+u*g),i[13]=-(a*v+f*m+l*g),i[14]=-(c*v+h*m+p*g),i[15]=1,i)},r.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+"]"};var i={};return i.create=function(e){var n=new t(4);return e?(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3]):n[0]=n[1]=n[2]=n[3]=0,n},i.createFrom=function(e,n,r,i){var s=new t(4);return s[0]=e,s[1]=n,s[2]=r,s[3]=i,s},i.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},i.equal=function(t,n){return t===n||Math.abs(t[0]-n[0])<e&&Math.abs(t[1]-n[1])<e&&Math.abs(t[2]-n[2])<e&&Math.abs(t[3]-n[3])<e},i.identity=function(e){return e||(e=i.create()),e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},i.calculateW=function(e,t){var n=e[0],r=e[1],i=e[2];return!t||e===t?(e[3]=-Math.sqrt(Math.abs(1-n*n-r*r-i*i)),e):(t[0]=n,t[1]=r,t[2]=i,t[3]=-Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t)},i.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},i.inverse=function(e,t){var n=e[0],r=e[1],i=e[2],s=e[3],o=n*n+r*r+i*i+s*s,u=o?1/o:0;return!t||e===t?(e[0]*=-u,e[1]*=-u,e[2]*=-u,e[3]*=u,e):(t[0]=-e[0]*u,t[1]=-e[1]*u,t[2]=-e[2]*u,t[3]=e[3]*u,t)},i.conjugate=function(e,t){return!t||e===t?(e[0]*=-1,e[1]*=-1,e[2]*=-1,e):(t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t)},i.length=function(e){var t=e[0],n=e[1],r=e[2],i=e[3];return Math.sqrt(t*t+n*n+r*r+i*i)},i.normalize=function(e,t){t||(t=e);var n=e[0],r=e[1],i=e[2],s=e[3],o=Math.sqrt(n*n+r*r+i*i+s*s);return o===0?(t[0]=0,t[1]=0,t[2]=0,t[3]=0,t):(o=1/o,t[0]=n*o,t[1]=r*o,t[2]=i*o,t[3]=s*o,t)},i.add=function(e,t,n){return!n||e===n?(e[0]+=t[0],e[1]+=t[1],e[2]+=t[2],e[3]+=t[3],e):(n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n)},i.multiply=function(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2],o=e[3],u=t[0],a=t[1],f=t[2],l=t[3];return n[0]=r*l+o*u+i*f-s*a,n[1]=i*l+o*a+s*u-r*f,n[2]=s*l+o*f+r*a-i*u,n[3]=o*l-r*u-i*a-s*f,n},i.multiplyVec3=function(e,t,n){n||(n=t);var r=t[0],i=t[1],s=t[2],o=e[0],u=e[1],a=e[2],f=e[3],l=f*r+u*s-a*i,c=f*i+a*r-o*s,h=f*s+o*i-u*r,p=-o*r-u*i-a*s;return n[0]=l*f+p*-o+c*-a-h*-u,n[1]=c*f+p*-u+h*-o-l*-a,n[2]=h*f+p*-a+l*-u-c*-o,n},i.scale=function(e,t,n){return!n||e===n?(e[0]*=t,e[1]*=t,e[2]*=t,e[3]*=t,e):(n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n)},i.toMat4=function(e,t){t||(t=r.create());var n=e[0],i=e[1],s=e[2],o=e[3],u=n+n,a=i+i,f=s+s,l=n*u,c=n*a,h=n*f,p=i*a,d=i*f,v=s*f,m=o*u,g=o*a,y=o*f;return t[0]=1-(p+v),t[1]=c+y,t[2]=h-g,t[3]=0,t[4]=c-y,t[5]=1-(l+v),t[6]=d+m,t[7]=0,t[8]=h+g,t[9]=d-m,t[10]=1-(l+p),t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.slerp=function(e,t,n,r){r||(r=e);var i=e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3],s,o,u,a;return Math.abs(i)>=1?(r!==e&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3]),r):(s=Math.acos(i),o=Math.sqrt(1-i*i),Math.abs(o)<.001?(r[0]=e[0]*.5+t[0]*.5,r[1]=e[1]*.5+t[1]*.5,r[2]=e[2]*.5+t[2]*.5,r[3]=e[3]*.5+t[3]*.5,r):(u=Math.sin((1-n)*s)/o,a=Math.sin(n*s)/o,r[0]=e[0]*u+t[0]*a,r[1]=e[1]*u+t[1]*a,r[2]=e[2]*u+t[2]*a,r[3]=e[3]*u+t[3]*a,r))},i.fromRotationMatrix=function(e,t){t||(t=i.create());var n=e[0]+e[4]+e[8],r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[7]-e[5])*r,t[1]=(e[2]-e[6])*r,t[2]=(e[3]-e[1])*r;else{var s=i.fromRotationMatrix.s_iNext=i.fromRotationMatrix.s_iNext||[1,2,0],o=0;e[4]>e[0]&&(o=1),e[8]>e[o*3+o]&&(o=2);var u=s[o],a=s[u];r=Math.sqrt(e[o*3+o]-e[u*3+u]-e[a*3+a]+1),t[o]=.5*r,r=.5/r,t[3]=(e[a*3+u]-e[u*3+a])*r,t[u]=(e[u*3+o]+e[o*3+u])*r,t[a]=(e[a*3+o]+e[o*3+a])*r}return t},i.identity=function(e){return e||(e=i.create()),e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},i.fromAngleAxis=function(e,t,n){n||(n=i.create());var r=e*.5,s=Math.sin(r);return n[3]=Math.cos(r),n[0]=s*t[0],n[1]=s*t[1],n[2]=s*t[2],n},i.toAngleAxis=function(e,t){t||(t=e);var n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];if(n>0){t[3]=2*Math.acos(e[3]);var r=1/Math.sqrt(n);t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r}else t[3]=0,t[0]=1,t[1]=0,t[2]=0;return t},i.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+"]"},window.vec3=n,window.mat4=r,window.quat4=i,r}),define("gw/EquatorialCoordinateSystem",["./CoordinateSystem","./Numeric","./AstroCoordTransform","./glMatrix"],function(e,t,n){e.type="EQ",e.from3DToEquatorial=function(t,n){n||(n=new Array(3));var r=[];return e.from3DToGeo(t,r),e.fromGeoToEquatorial(r,n),n},e.fromEquatorialTo3D=function(t,n){n||(n=new Array(3));var r=[];return e.fromEquatorialToGeo(t,r),e.fromGeoTo3D(r,n),n},e.fromEquatorialToGeo=function(e,t){function n(e){return e[0]=="-"?-1:1}t||(t=[]);var r=e[0].split(" "),i=parseFloat(r[0]),s=parseFloat(r[1]),o=parseFloat(r[2]);t[0]=(i+s/60+o/3600)*15,t[0]>180&&(t[0]-=360);var u=e[1].split(" ");return i=parseFloat(u[0]),s=parseFloat(u[1]),o=parseFloat(u[2]),t[1]=n(u[0])*(Math.abs(i)+s/60+o/3600),t},e.fromGeoToEquatorial=function(t,n){n||(n=[]);var r=t[0];return r<0&&(r+=360),n[0]=e.fromDegreesToHMS(r),n[1]=e.fromDegreesToDMS(t[1]),n},e.fromDegreesToDMS=function(e){function n(e){return e>=0?"+":"-"}var r=Math.abs(e),i=Math.floor(r),s=(r-i)*60,o=Math.floor(s),u=(s-o)*60;return n(e)+i+String.fromCharCode(176)+" "+o+"' "+t.roundNumber(u,2)+'"'},e.fromDegreesToHMS=function(e){var e=e/15,n=Math.abs(e),r=Math.floor(n),i=(n-r)*60,s=Math.floor(i),o=(i-s)*60;return r+"h "+s+"m "+t.roundNumber(o,2)+"s"},e.convert=function(e,t,r){switch(t+"2"+r){case"GAL2EQ":convertType=n.Type.GAL2EQ;break;case"EQ2GAL":convertType=n.Type.EQ2GAL;break;default:return console.error("Not implemented"),null}return n.transformInDeg(e,convertType)},e.transformVec=function(e){var t=[];return mat4.multiplyVec3(r,e,t),t};var r=[],i=e.convert([0,90],"GAL","EQ"),s=e.fromGeoTo3D(i),o=e.convert([0,0],"GAL","EQ"),u=e.fromGeoTo3D(o),a=e.convert([90,0],"GAL","EQ"),f=e.fromGeoTo3D(a);return r[0]=u[0],r[1]=u[1],r[2]=u[2],r[3]=0,r[4]=f[0],r[5]=f[1],r[6]=f[2],r[7]=0,r[8]=s[0],r[9]=s[1],r[10]=s[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,mat4.create(r),mat4.inverse(r),e}),define("gw/Frustum",["./glMatrix"],function(){var e=function(){this.normal=vec3.create([0,0,0]),this.d=0};e.prototype.init=function(e,t,n){var r=[],i=[];vec3.subtract(t,e,r),vec3.subtract(n,e,i),vec3.cross(r,i,this.normal),vec3.normalize(this.normal),this.d=-vec3.dot(e,this.normal)},e.prototype.transform=function(e){var t=[this.normal[0],this.normal[1],this.normal[2],this.d];mat4.multiplyVec4(e,t),this.normal[0]=t[0],this.normal[1]=t[1],this.normal[2]=t[2],this.d=t[3]},e.prototype.intersectSphere=function(e,t){var n=vec3.dot(e,this.normal)+this.d;return n>t?1:n<-t?-1:0},e.prototype.distance=function(e){return e[0]*this.normal[0]+e[1]*this.normal[1]+e[2]*this.normal[2]+this.d},e.prototype.intersectBoundingBox=function(e){var t=(this.normal[0]>=0?1:0)|(this.normal[1]>=0?2:0)|(this.normal[2]>=0?4:0),n=~t&7;return this.distance(e.getCorner(n))>0?1:this.distance(e.getCorner(t))<0?-1:0};var t=function(){this.planes=[new e,new e,new e,new e,new e]};return t.prototype.compute=function(e){var t=mat4.create();mat4.inverse(e,t);var n=mat4.project(t,[-1,-1,-1,1]),r=mat4.project(t,[-1,1,-1,1]),i=mat4.project(t,[1,1,-1,1]),s=mat4.project(t,[1,-1,-1,1]);this.planes[0].init([0,0,0],n,r),this.planes[1].init([0,0,0],r,i),this.planes[2].init([0,0,0],i,s),this.planes[3].init([0,0,0],s,n),this.planes[4].init(n,r,i)},t.prototype.transform=function(e,t){var n=mat4.create();mat4.inverse(t,n),this.inverseTransform(e,n)},t.prototype.inverseTransform=function(e,t){for(var n=0;n<e.planes.length;n++){var r=e.planes[n],i=r.normal[0],s=r.normal[1],o=r.normal[2],u=r.d;r=this.planes[n],r.normal[0]=t[0]*i+t[1]*s+t[2]*o+t[3]*u,r.normal[1]=t[4]*i+t[5]*s+t[6]*o+t[7]*u,r.normal[2]=t[8]*i+t[9]*s+t[10]*o+t[11]*u,r.d=t[12]*i+t[13]*s+t[14]*o+t[15]*u}},t.prototype.containsSphere=function(e,t){var n=1;for(var r=0;r<this.planes.length;r++){var i=this.planes[r].normal,s=e[0]*i[0]+e[1]*i[1]+e[2]*i[2]+this.planes[r].d;if(s<=t){if(s<-t)return-1;n=0}}return n},t.prototype.containsBoundingBox=function(e){for(var t=0;t<this.planes.length;t++){var n=this.planes[t],r=n.normal[0]>=0?e.max[0]:e.min[0],i=n.normal[1]>=0?e.max[1]:e.min[1],s=n.normal[2]>=0?e.max[2]:e.min[2],o=r*n.normal[0]+i*n.normal[1]+s*n.normal[2]+n.d;if(o<0)return!1}return!0},t.Plane=e,t}),define("gw/RenderContext",["./Frustum","./Numeric","./CoordinateSystem","./glMatrix"],function(e,t,n){var r=function(t){this.activeAnimations=[],this.shadersPath=t.shadersPath||"../shaders/",this.tileErrorTreshold=t.tileErrorTreshold||4,this.lighting=t.lighting||!1,this.continuousRendering=t.continuousRendering||!1,this.stats=null;var n=null;if(!t.canvas)throw"GlobWeb : no canvas in options";typeof t["canvas"]=="string"?n=document.getElementById(t.canvas):n=t.canvas;if(!n instanceof HTMLCanvasElement)throw"GlobWeb : invalid canvas";var i=["webgl","experimental-webgl","webkit-3d","moz-webgl"],s=null;for(var o=0;o<i.length&&s==null;++o)try{s=n.getContext(i[o],r.contextAttributes)}catch(u){}if(s==null)throw"GlobWeb : WebGL context cannot be initialized";if(t.backgroundColor){var a=t.backgroundColor;s.clearColor(a[0],a[1],a[2],a[3])}else s.clearColor(0,0,0,1);s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,s.NONE),s.enable(s.DEPTH_TEST),s.enable(s.CULL_FACE),this.viewMatrix=mat4.create(),this.modelViewMatrix=mat4.create(),this.projectionMatrix=mat4.create(),this.gl=s,this.canvas=n,this.frustum=new e,this.worldFrustum=new e,this.localFrustum=new e,this.eyePosition=vec3.create(),this.eyeDirection=vec3.create(),this.minNear=1e-4,this.minFar=0,this.near=r.minNear,this.far=6,this.numActiveAttribArray=0,this.frameRequested=!1,this.fov=45,window.requestAnimationFrame||(window.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){window.setTimeout(e,1e3/60)}}());var f=this;this.frameCallback=function(){f.frame()}};return r.contextAttributes={},r.prototype.requestFrame=function(){if(!this.frameRequested){var e=this;window.requestAnimationFrame(this.frameCallback),this.frameRequested=!0}},r.prototype.frame=function(){this.frameRequested=!1;var e=this.stats,t=this.gl;e&&e.start("globalRenderTime");if(this.activeAnimations.length>0){var n=Date.now();for(var i=0;i<this.activeAnimations.length;i++)this.activeAnimations[i].update(n)}r.contextAttributes.stencil?t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT|t.STENCIL_BUFFER_BIT):t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT);if(this.canvas.width==0||this.canvas.height==0)return;t.viewport(0,0,this.canvas.width,this.canvas.height),this.updateViewDependentProperties(),this.renderer.render(),e&&e.end("globalRenderTime"),this.continuousRendering?this.requestFrame():this.activeAnimations.length>0&&this.requestFrame()},r.prototype.updateViewDependentProperties=function(){var e=mat4.create();mat4.inverse(this.viewMatrix,e),vec3.set([0,0,0],this.eyePosition),mat4.multiplyVec3(e,this.eyePosition),vec3.set([0,0,-1],this.eyeDirection),mat4.rotateVec3(e,this.eyeDirection),mat4.perspective(this.fov,this.canvas.width/this.canvas.height,this.minNear,this.far,this.projectionMatrix),this.frustum.compute(this.projectionMatrix),this.worldFrustum.inverseTransform(this.frustum,this.viewMatrix),this.pixelSizeVector=this.computePixelSizeVector()},r.prototype.getXYRelativeToCanvas=function(e){var t=[];e.pageX||e.pageY?(t[0]=e.pageX,t[1]=e.pageY):(t[0]=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,t[1]=e.clientY+document.body.scrollTop+document.documentElement.scrollTop);var n=this.canvas;while(n)t[0]-=n.offsetLeft,t[1]-=n.offsetTop,n=n.offsetParent;return t},r.prototype.computePixelSizeVector=function(e){var t=this.canvas.width,n=this.canvas.height,r=this.projectionMatrix,i=e||this.viewMatrix,s=r[0]*t*.5,o=r[8]*t*.5+r[11]*t*.5,u=[i[0]*s+i[2]*o,i[4]*s+i[6]*o,i[8]*s+i[10]*o],a=r[5]*n*.5,f=r[9]*n*.5+r[11]*n*.5,l=[i[1]*a+i[2]*f,i[5]*a+i[6]*f,i[9]*a+i[10]*f],c=r[11],h=r[15],p=[i[2]*c,i[6]*c,i[10]*c,i[14]*c+i[15]*h],d=.7071067811/Math.sqrt(vec3.dot(u,u)+vec3.dot(l,l));return p[0]*=d,p[1]*=d,p[2]*=d,p[3]*=d,p},r.prototype.get3DFromPixel=function(e,r){var i=e/this.canvas.width*2-1,s=-(r/this.canvas.height*2-1),o=mat4.create();mat4.multiply(this.projectionMatrix,this.viewMatrix,o),mat4.inverse(o);var u=mat4.multiplyVec4(o,[i,s,-1,1]);u[0]/=u[3],u[1]/=u[3],u[2]/=u[3],mat4.inverse(this.viewMatrix,o);var a=[o[12],o[13],o[14]],f=vec3.create();vec3.subtract(u,a,f),vec3.normalize(f);var l=t.raySphereIntersection(a,f,[0,0,0],n.radius);if(l>=0){var c=t.pointOnRay(a,f,l);return c}return null},r.prototype.getPixelFrom3D=function(e,t,n){var r=mat4.create();mat4.multiply(this.projectionMatrix,this.viewMatrix,r);var i=[e,t,n,1];mat4.project(r,i);var s=Math.round((1+i[0])*.5*this.canvas.width),o=Math.round((1-i[1])*.5*this.canvas.height);return[s,o]},r.prototype.createNonPowerOfTwoTextureFromImage=function(e,t){var n=this.gl,r=n.createTexture();return n.bindTexture(n.TEXTURE_2D,r),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,t),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1),r},r}),define("gw/BoundingBox",[],function(){var e=function(e,t){e&&(this.min=vec3.create(e)),t&&(this.max=vec3.create(t))};return e.prototype.extend=function(e,t,n){this.min?(e<this.min[0]&&(this.min[0]=e),t<this.min[1]&&(this.min[1]=t),n<this.min[2]&&(this.min[2]=n),e>this.max[0]&&(this.max[0]=e),t>this.max[1]&&(this.max[1]=t),n>this.max[2]&&(this.max[2]=n)):(this.min=vec3.create(),this.max=vec3.create(),this.min[0]=e,this.min[1]=t,this.min[2]=n,this.max[0]=e,this.max[1]=t,this.max[2]=n)},e.prototype.compute=function(e,t,n){this.min||(this.min=vec3.create(),this.max=vec3.create()),this.min[0]=e[0],this.min[1]=e[1],this.min[2]=e[2],this.max[0]=e[0],this.max[1]=e[1],this.max[2]=e[2];var r=n||3,i=t||e.length;for(var s=r;s<i;s+=r)for(var o=0;o<3;o++)e[s+o]<this.min[o]&&(this.min[o]=e[s+o]),e[s+o]>this.max[o]&&(this.max[o]=e[s+o])},e.prototype.getCorner=function(e){return[e&1?this.max[0]:this.min[0],e&2?this.max[1]:this.min[1],e&4?this.max[2]:this.min[2]]},e.prototype.getCenter=function(){return[(this.max[0]+this.min[0])*.5,(this.max[1]+this.min[1])*.5,(this.max[2]+this.min[2])*.5]},e.prototype.getRadius=function(){var e=vec3.create();return vec3.subtract(this.max,this.min,e),.5*vec3.length(e)},e}),define("gw/Tile",["./BoundingBox","./CoordinateSystem","./glMatrix"],function(e,t){var n=function(){this.parent=null,this.parentIndex=-1,this.children=null,this.vertices=null,this.texture=null,this.vertexBuffer=null,this.texTransform=[1,1,0,0],this.matrix=null,this.inverseMatrix=null,this.bbox=new e,this.radius=0,this.distance=0,this.closestPointToEye=[0,0,0],this.extension={},this.state=n.State.NONE,this.config=null,this.imageSize=256};return n.State={ERROR:-10,NONE:0,REQUESTED:1,LOADING:2,LOADED:3},n.prototype.computePosition=function(e,t){var n=Math.floor(t),r=t-n,i=Math.floor(e),s=e-i,o=this.config.tesselation,u=this.config.vertexSize,a=u*(n*o+i),f=[0,0,0];for(var l=0;l<3;l++)f[l]=(1-r)*(1-s)*this.vertices[a+l]+r*(1-s)*this.vertices[a+u*o+l]+r*s*this.vertices[a+u*o+u+l]+(1-r)*s*this.vertices[a+u+l];return f},n.prototype.initFromParent=function(e,t,n){this.parent=e,this.parentIndex=n*2+t,this.matrix=e.matrix,this.inverseMatrix=e.inverseMatrix,this.texture=e.texture,this.config=e.config,this.vertexBuffer=e.vertexBuffer;var r=this.config.tesselation,i=(r-1)/2;for(var s=0;s<=i;s++){var o=this.config.vertexSize*((s+n*i)*r+t*i);for(var u=0;u<=i;u++)this.bbox.extend(e.vertices[o],e.vertices[o+1],e.vertices[o+2]),o+=this.config.vertexSize}this.radius=this.bbox.getRadius();for(var a in e.extension){var f=e.extension[a];f.initChild&&f.initChild(this,t,n)}},n.prototype.needsToBeRefined=function(e){if(this.distance<this.radius)return!0;var t=.25*(this.bbox.max[0]-this.bbox.min[0]+(this.bbox.max[1]-this.bbox.min[1]))/this.imageSize,n=this.matrix,r=this.closestPointToEye,i=n[0]*r[0]+n[4]*r[1]+n[8]*r[2]+n[12],s=n[1]*r[0]+n[5]*r[1]+n[9]*r[2]+n[13],o=n[2]*r[0]+n[6]*r[1]+n[10]*r[2]+n[14],u=e.pixelSizeVector,a=t/(i*u[0]+s*u[1]+o*u[2]+u[3]);return Math.abs(a)>e.tileErrorTreshold},n.prototype.isCulled=function(e){var n=this.inverseMatrix,r=e.eyePosition,i=n[0]*r[0]+n[4]*r[1]+n[8]*r[2]+n[12],s=n[1]*r[0]+n[5]*r[1]+n[9]*r[2]+n[13],o=n[2]*r[0]+n[6]*r[1]+n[10]*r[2]+n[14];this.distance=Math.sqrt(i*i+s*s+o*o);if(this.distance<this.radius)return this.distance=0,!1;var u=this.closestPointToEye;u[0]=Math.min(Math.max(i,this.bbox.min[0]),this.bbox.max[0]),u[1]=Math.min(Math.max(s,this.bbox.min[1]),this.bbox.max[1]),u[2]=Math.min(Math.max(o,this.bbox.min[2]),this.bbox.max[2]);if(o<0){var a=u[0],f=u[1],l=u[2]+t.radius,c=Math.sqrt(a*a+f*f+l*l);a/=c,f/=c,l/=c;var h=i-a*t.radius,p=s-f*t.radius,d=o-(l-1)*t.radius,v=Math.sqrt(h*h+p*p+d*d),m=(h*a+p*f+d*l)/v;m*=this.config.cullSign;if(m<-0.05)return!0}var g=e.localFrustum;return g.inverseTransform(e.worldFrustum,this.matrix),!g.containsBoundingBox(this.bbox)},n.prototype.dispose=function(e,t){for(var r in this.extension)this.extension[r].dispose&&this.extension[r].dispose(e,t);this.state==n.State.LOADED&&(t.disposeGLBuffer(this.vertexBuffer),this.texture&&t.disposeGLTexture(this.texture),this.vertexBuffer=null,this.texture=null,this.parent=null,this.state=n.State.NONE)},n.prototype.deleteChildren=function(e,t){if(this.children){for(var n=0;n<4;n++)this.children[n].deleteChildren(e,t),this.children[n].dispose(e,t);this.children=null}},n.prototype.buildSkirtVertices=function(e,t,n,r){var i=this.vertices,s=this.radius*.05,o=this.config.tesselation;for(var u=0;u<o;u++){var a=i[t]-e[0],f=i[t+1]-e[1],l=i[t+2]-e[2],c=s/Math.sqrt(a*a+f*f+l*l);a*=c,f*=c,l*=c,i[r]=i[t]-a,i[r+1]=i[t+1]-f,i[r+2]=i[t+2]-l;for(var h=3;h<this.config.vertexSize;h++)i[r+h]=i[t+h];r+=this.config.vertexSize,t+=n}},n.prototype.generateNormals=function(){var e=this.config.tesselation,t=this.config.vertexSize,n=t*e,r=0;for(var i=0;i<e;i++){var s=i==e-1?0:n,o=i==0?0:-n;for(var u=0;u<e;u++){var a=u==e-1?0:t,f=u==0?0:-t,l=[this.vertices[r+a]-this.vertices[r+f],this.vertices[r+a+1]-this.vertices[r+f+1],this.vertices[r+a+2]-this.vertices[r+f+2]],c=[this.vertices[r+s]-this.vertices[r+o],this.vertices[r+s+1]-this.vertices[r+o+1],this.vertices[r+s+2]-this.vertices[r+o+2]],h=vec3.cross(l,c,[]);vec3.normalize(h),this.vertices[r+3]=h[0],this.vertices[r+4]=h[1],this.vertices[r+5]=h[2],r+=t}}},n.prototype.generate=function(e,t,r){this.vertices=this.generateVertices(r);var i=this.config.tesselation,s=this.config.vertexSize;this.bbox.compute(this.vertices,s*i*i,s),this.radius=this.bbox.getRadius(),this.config.normals&&this.generateNormals();if(this.config.skirt){var o=[0,0,0];mat4.multiplyVec3(this.inverseMatrix,o);var u=s*i*i;this.buildSkirtVertices(o,0,s,u),u+=s*i,this.buildSkirtVertices(o,s*i*(i-1),s,u),u+=s*i,this.buildSkirtVertices(o,0,s*i,u),u+=s*i,this.buildSkirtVertices(o,s*(i-1),s*i,u),u+=s*i,this.buildSkirtVertices(o,s*(i*(i-1)/2),s,u),u+=s*i,this.buildSkirtVertices(o,s*((i-1)/2),s*i,u)}this.vertexBuffer!=null&&this.parent==null&&e.disposeGLBuffer(this.vertexBuffer),this.vertexBuffer=e.createGLBuffer(this.vertices),t&&(this.texture=e.createGLTexture(t),this.imageSize=this.config.imageSize),this.state=n.State.LOADED},n}),define("gw/TilePool",[],function(){var e=function(e){var t=e.gl,n={},r=[],i=this,s=t.getExtension("OES_texture_float_linear"),o=s?t.LINEAR:t.NEAREST;this.numCreatedTextures=0,this.numReusedTextures=0;var u=function(e,n){var r=t.createTexture();return t.bindTexture(t.TEXTURE_2D,r),e.dataType=="byte"?(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.generateMipmap(t.TEXTURE_2D)):(t.texImage2D(t.TEXTURE_2D,0,t.LUMINANCE,e.width,e.height,0,t.LUMINANCE,t.FLOAT,e.typedArray),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,o),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,o)),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),r.pool=n,i.numCreatedTextures++,r},a=function(e,n){var r=n.pop();return t.bindTexture(t.TEXTURE_2D,r),e.dataType=="byte"?(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e),t.generateMipmap(t.TEXTURE_2D)):t.texImage2D(t.TEXTURE_2D,0,t.LUMINANCE,e.width,e.height,0,t.LUMINANCE,t.FLOAT,e.typedArray),i.numReusedTextures++,r},f=function(e){var t=e.dataType+e.width;return n[t]||(n[t]=[]),n[t]};this.createGLTexture=function(e){var t=f(e);return t.length>0?a(e,t):u(e,t)},this.createGLBuffer=function(e){var n;return r.length>0?n=r.pop():n=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW),n},this.disposeGLTexture=function(e){e.pool.push(e)},this.disposeGLBuffer=function(e){r.push(e)},this.disposeAll=function(){for(var e in n)if(n.hasOwnProperty(e)){var i=n[e];for(var s=0;s<i.length;s++)t.deleteTexture(i[s])}n={};for(var s=0;s<r.length;s++)t.deleteBuffer(r[s]);r.length=0}};return e}),define("gw/ImageRequest",[],function(){var e=function(e){this.successCallback=e.successCallback,this.failCallback=e.failCallback,this.abortCallback=e.abortCallback,this.image=null};return e.prototype.send=function(e){this.image=new Image,this.image.crossOrigin="",this.image.dataType="byte";var t=this;this.image.onload=function(){var e=t.image.naturalWidth!=0&&t.image.complete;e&&t.successCallback.call(t)},this.image.onerror=this.failCallback.bind(this),this.image.src=e},e.prototype.abort=function(){this.abortCallback&&this.abortCallback(this),this.image.src=""},e}),define("gw/TileRequest",["./Tile","./ImageRequest"],function(e,t){var n=function(n){var r=!1,i=!0,s=new XMLHttpRequest,o;this.tile=null,this.elevations=null,this.image=null;var u=this;s.onreadystatechange=function(e){s.readyState==4&&(s.status==200?c():h())};var a=function(){r||(r=!0,i&&(n.imageryProvider&&n.imageryProvider.handleImage&&n.imageryProvider.handleImage(o),n.completedRequests.push(u),n.renderContext.requestFrame()),u.image=o.image)},f=function(){u.tile.state=e.State.ERROR,n.availableRequests.push(u)},l=function(){u.tile.state=e.State.NONE,n.availableRequests.push(u)},c=function(){u.elevations=n.elevationProvider.parseElevations(s.responseText),i=!0,r&&(n.completedRequests.push(u),n.renderContext.requestFrame())},h=function(){u.elevations=null,i=!0,r&&(n.completedRequests.push(u),n.renderContext.requestFrame())};this.launch=function(u){u.state=e.State.LOADING,this.tile=u,this.image=null,this.elevations=null,n.elevationProvider?(i=!1,s.open("GET",n.elevationProvider.getUrl(u)),s.send()):i=!0,n.imageryProvider&&(o||(o=new t({successCallback:a,failCallback:f,abortCallback:l})),r=!1,o.send(n.imageryProvider.getUrl(u))),!n.imageryProvider&&!n.elevationProvider&&n.completedRequests.push(this)}};return n}),define("gw/TileIndexBuffer",[],function(){var e=function(e,t){this.renderContext=e,this.config=t,this.solidIndexBuffer=null,this.subSolidIndexBuffer=[null,null,null,null],this.subIndices=[null,null,null,null]};return e.prototype.reset=function(){var e=this.renderContext.gl;for(var t=0;t<4;t++)this.subSolidIndexBuffer[t]&&(e.deleteBuffer(this.subSolidIndexBuffer[t]),this.subSolidIndexBuffer[t]=null);this.solidIndexBuffer&&(e.deleteBuffer(this.solidIndexBuffer),this.solidIndexBuffer=null)},e.prototype.getSubSolid=function(e){if(this.subSolidIndexBuffer[e]==null){var t=e%2,n=Math.floor(e/2),r=this.config.tesselation,i=(r-1)/2,s=[];for(var o=i*n;o<i*(n+1);o++)for(var u=i*t;u<i*(t+1);u++)s.push(o*r+u),s.push((o+1)*r+u),s.push(o*r+u+1),s.push(o*r+u+1),s.push((o+1)*r+u),s.push((o+1)*r+u+1);this.subIndices[e]=s;if(this.config.skirt){var a=n==0?r*r:r*r+4*r,f=n==0?0:i*r;for(var o=i*t;o<i*(t+1);o++)s.push(a+o),s.push(f+o),s.push(a+o+1),s.push(a+o+1),s.push(f+o),s.push(f+o+1);a=n==0?r*r+4*r:r*r+r,f=n==0?i*r:(r-1)*r;for(var o=i*t;o<i*(t+1);o++)s.push(f+o),s.push(a+o),s.push(f+o+1),s.push(f+o+1),s.push(a+o),s.push(a+o+1);a=t==0?r*r+2*r:r*r+5*r,f=t==0?0:i;for(var u=i*n;u<i*(n+1);u++)s.push(a+u),s.push(a+u+1),s.push(f+u*r),s.push(f+u*r),s.push(a+u+1),s.push(f+(u+1)*r);a=t==0?r*r+5*r:r*r+3*r,f=t==0?i:r-1;for(var u=i*n;u<i*(n+1);u++)s.push(u*r+f),s.push((u+1)*r+f),s.push(a+u),s.push(a+u),s.push((u+1)*r+f),s.push(a+u+1)}var l=this.renderContext.gl,c=l.createBuffer();l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,c),l.bufferData(l.ELEMENT_ARRAY_BUFFER,new Uint16Array(s),l.STATIC_DRAW),c.numIndices=s.length,this.subSolidIndexBuffer[e]=c}return this.subSolidIndexBuffer[e]},e.prototype.getSolid=function(){if(this.solidIndexBuffer==null){var e=this.config.tesselation,t=[];for(var n=0;n<e-1;n++)for(var r=0;r<e-1;r++)t.push(n*e+r),t.push((n+1)*e+r),t.push(n*e+r+1),t.push(n*e+r+1),t.push((n+1)*e+r),t.push((n+1)*e+r+1);if(this.config.skirt){var i=e*e;for(var r=0;r<e-1;r++)t.push(i+r),t.push(r),t.push(i+r+1),t.push(i+r+1),t.push(r),t.push(r+1);i+=e;for(var r=0;r<e-1;r++)t.push((e-1)*e+r),t.push(i+r),t.push((e-1)*e+r+1),t.push((e-1)*e+r+1),t.push(i+r),t.push(i+r+1);i+=e;for(var n=0;n<e-1;n++)t.push(i+n),t.push(i+n+1),t.push(n*e),t.push(n*e),t.push(i+n+1),t.push((n+1)*e);i+=e;for(var n=0;n<e-1;n++)t.push(n*e+e-1),t.push((n+1)*e+e-1),t.push(i+n),t.push(i+n),t.push((n+1)*e+e-1),t.push(i+n+1)}var s=this.renderContext.gl,o=s.createBuffer();s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,o),s.bufferData(s.ELEMENT_ARRAY_BUFFER,new Uint16Array(t),s.STATIC_DRAW),this.numIndices=t.length,this.solidIndexBuffer=o,this.solidIndexBuffer.numIndices=t.length}return this.solidIndexBuffer},e}),define("gw/Program",[],function(){var e=function(e){this.renderContext=e,this.glProgram=null,this.attributes={},this.uniforms={},this.numActiveAttribArray=0};return e.prototype.createShader=function(e,t){var n=this.renderContext.gl,r=n.createShader(e);return n.shaderSource(r,t),n.compileShader(r),n.getShaderParameter(r,n.COMPILE_STATUS)?r:(console.log("Shader compilation error: "+n.getShaderInfoLog(r)),console.log(t),n.deleteShader(r),null)},e.prototype.createFromSource=function(e,t){var n=this.renderContext.gl,r=this.createShader(n.VERTEX_SHADER,e),i=this.createShader(n.FRAGMENT_SHADER,t);if(r==null||i==null)return!1;this.glProgram=n.createProgram(),n.attachShader(this.glProgram,r),n.attachShader(this.glProgram,i),n.linkProgram(this.glProgram);if(!n.getProgramParameter(this.glProgram,n.LINK_STATUS))return console.log("Program link error: "+n.getProgramInfoLog(this.glProgram)),n.deleteShader(r),n.deleteShader(i),n.deleteProgram(this.glProgram),this.glProgram=null,!1;var s=n.getProgramParameter(this.glProgram,n.ACTIVE_ATTRIBUTES);this.numActiveAttribArray=0;for(var o=0;o<s;++o){var u=n.getActiveAttrib(this.glProgram,o),a=n.getAttribLocation(this.glProgram,u.name);this.attributes[u.name]=a,a+1>this.numActiveAttribArray&&(this.numActiveAttribArray=a+1)}var f=n.getProgramParameter(this.glProgram,n.ACTIVE_UNIFORMS);for(var o=0;o<f;++o){var l=n.getActiveUniform(this.glProgram,o);this.uniforms[l.name]=n.getUniformLocation(this.glProgram,l.name)}return!0},e.prototype.loadFromFile=function(e,t){var n=new XMLHttpRequest;n.open("get",this.renderContext.shadersPath+e,!1),n.send(null);var r=n.responseText;n.open("get",this.renderContext.shadersPath+t,!1),n.send(null);var i=n.responseText;return this.createFromSource(r,i)},e.prototype.apply=function(){var e=this.renderContext,t=e.gl;t.useProgram(this.glProgram);for(var n=e.numActiveAttribArray;n<this.numActiveAttribArray;n++)t.enableVertexAttribArray(n);for(var n=this.numActiveAttribArray;n<e.numActiveAttribArray;n++)t.disableVertexAttribArray(n);e.numActiveAttribArray=this.numActiveAttribArray},e.prototype.dispose=function(){this.renderContext.gl.deleteProgram(this.glProgram)},e}),define("gw/TileManager",["./Tile","./TilePool","./TileRequest","./TileIndexBuffer","./Program","./CoordinateSystem"],function(e,t,n,r,i,s){var o=function(e){this.parent=e,this.renderContext=this.parent.renderContext,this.tilePool=e.tilePool||new t(this.renderContext),this.tiling=null,this.imageryProvider=null,this.elevationProvider=null,this.tilesToRender=[],this.visibleTiles=[],this.tilesToRequest=[],this.postRenderers=[],this.level0Tiles=[],this.maxRequests=4,this.availableRequests=[];for(var s=0;s<this.maxRequests;s++)this.availableRequests[s]=new n(this);this.completedRequests=[],this.level0TilesLoaded=!1,this.tileConfig={tesselation:9,skirt:!0,cullSign:1,imageSize:256,vertexSize:this.renderContext.lighting?6:3,normals:this.renderContext.lighting},this.tcoordBuffer=null,this.tileIndexBuffer=new r(this.renderContext,this.tileConfig),this.freeze=!1,this.numTilesGenerated=0,this.frameNumber=0,this.vertexShader="	attribute vec3 vertex;\n	attribute vec2 tcoord;\n	uniform mat4 modelViewMatrix;\n	uniform mat4 projectionMatrix;\n	varying vec2 texCoord;\n",this.renderContext.lighting&&(this.vertexShader+="attribute vec3 normal;\nvarying vec3 color;\n"),this.vertexShader+="	void main(void) \n	{\n		gl_Position = projectionMatrix * modelViewMatrix * vec4(vertex, 1.0);\n",this.renderContext.lighting&&(this.vertexShader+="vec4 vn = modelViewMatrix * vec4(normal,0);\ncolor = max( vec3(-vn[2],-vn[2],-vn[2]), 0.0 );\n"),this.vertexShader+="		texCoord = tcoord;\n	}\n	",this.fragmentShader="	precision lowp float; \n	varying vec2 texCoord;\n",this.renderContext.lighting&&(this.fragmentShader+="varying vec3 color;\n"),this.fragmentShader+="	uniform sampler2D colorTexture;\n	void main(void)\n	{\n		gl_FragColor.rgb = texture2D(colorTexture, texCoord).rgb;\n",this.renderContext.lighting&&(this.fragmentShader+="gl_FragColor.rgb *= color;\n"),this.fragmentShader+="		gl_FragColor.a = 1.0;\n	}\n	",this.program=new i(this.renderContext),this.program.createFromSource(this.vertexShader,this.fragmentShader)};o.prototype.addPostRenderer=function(e){this.postRenderers.push(e),this.postRenderers.sort(function(e,t){var n=e.zIndex|0,r=t.zIndex|0;return n-r}),e.generate&&this.visitTiles(function(t){e.generate(t)})},o.prototype.removePostRenderer=function(e){var t=this.postRenderers.indexOf(e);t!=-1&&(e.cleanupTile&&this.visitTiles(function(t){e.cleanupTile(t)}),this.postRenderers.splice(t,1))},o.prototype.setImageryProvider=function(e){this.reset(),this.imageryProvider=e,e&&(this.tilePool.disposeAll(),this.tiling=e.tiling,this.tileConfig.imageSize=e.tilePixelSize,this.level0Tiles=this.tiling.generateLevelZeroTiles(this.tileConfig,this.tilePool),e.customShader?(this.program.dispose(),this.program=new i(this.renderContext),this.currentFragmentShader=e.customShader.fragmentCode?e.customShader.fragmentCode:this.fragmentShader,this.program.createFromSource(e.customShader.vertexCode?e.customShader.vertexCode:this.vertexShader,this.currentFragmentShader)):this.currentFragmentShader!=null&&(this.program.dispose(),this.program=new i(this.renderContext),this.program.createFromSource(this.vertexShader,this.fragmentShader),this.currentFragmentShader=null))},o.prototype.getOverlappedLevelZeroTiles=function(e){var t;switch(e.type){case"Point":t=[],t.push(e.coordinates);break;case"LineString":t=e.coordinates;break;case"Polygon":t=e.coordinates[0];break;case"MultiPolygon":t=[];for(var n=0;n<e.coordinates.length;n++)t=t.concat(e.coordinates[n][0])}t||console.log("COOORDDS!!");var r={},i=[];for(var s=0;s<t.length;s++){var o=this.tiling.lonlat2LevelZeroIndex(t[s][0],t[s][1]);r[o]||(r[o]=!0,i.push(o))}return i},o.prototype.setElevationProvider=function(e){this.reset(),this.elevationProvider=e;var t=e?e.tilePixelSize:9;if(t!=this.tileConfig.tesselation){this.tileConfig.tesselation=t;var n=this.renderContext.gl;this.tileIndexBuffer.reset(),n.deleteBuffer(this.tcoordBuffer),this.tcoordBuffer=null}},o.prototype.reset=function(){for(var e=0;e<this.level0Tiles.length;e++)this.level0Tiles[e].deleteChildren(this.renderContext,this.tilePool),this.level0Tiles[e].dispose(this.renderContext,this.tilePool);this.level0TilesLoaded=!1},o.prototype.visitTiles=function(e){var t=this.level0Tiles.concat([]);while(t.length>0){var n=t.shift();e(n),n.children&&(t.push(n.children[0]),t.push(n.children[1]),t.push(n.children[2]),t.push(n.children[3]))}},o.prototype.traverseTiles=function(){this.tilesToRender.length=0,this.visibleTiles.length=0,this.tilesToRequest.length=0,this.numTraversedTiles=0;if(!this.level0TilesLoaded){this.level0TilesLoaded=!0;for(var t=0;t<this.level0Tiles.length;t++){var n=this.level0Tiles[t],r=n.state==e.State.LOADED;n.frameNumber=this.frameNumber,this.level0TilesLoaded=this.level0TilesLoaded&&r,r||(n.state==e.State.NONE?(n.state=e.State.REQUESTED,this.tilesToRequest.push(n)):n.state==e.State.ERROR&&this.imageryProvider&&this.parent.publish("baseLayersError",this.imageryProvider))}this.level0TilesLoaded&&this.imageryProvider&&this.parent.publish("baseLayersReady")}if(this.level0TilesLoaded)for(var t=0;t<this.level0Tiles.length;t++){var n=this.level0Tiles[t];n.isCulled(this.renderContext)?n.deleteChildren(this.renderContext,this.tilePool):this.processTile(n,0)}},o.prototype.processTile=function(t,n){this.numTraversedTiles++,t.frameNumber=this.frameNumber;var r=!0;t.state==e.State.NONE&&(t.state=e.State.REQUESTED,this.tilesToRequest.push(t)),t.state==e.State.LOADED&&(this.imageryProvider?r=n>=this.imageryProvider.numberOfLevels:r=!1,r|=!t.needsToBeRefined(this.renderContext));if(r)t.texture&&this.tilesToRender.push(t),this.visibleTiles.push(t);else{t.children==null&&t.createChildren();for(var i=0;i<4;i++)t.children[i].isCulled(this.renderContext)?t.children[i].deleteChildren(this.renderContext,this.tilePool):this.processTile(t.children[i],n+1)}for(var s in t.extension){var o=t.extension[s];o.traverse&&o.traverse(t,r)}},o.prototype.generateReceivedTiles=function(){while(this.completedRequests.length>0){var t=this.completedRequests.pop(),n=t.tile;if(n.frameNumber==this.frameNumber){n.generate(this.tilePool,t.image,t.elevations);for(var r=0;r<this.postRenderers.length;r++)this.postRenderers[r].generate&&this.postRenderers[r].generate(n);this.numTilesGenerated++,this.renderContext.requestFrame()}else n.state=e.State.NONE;this.availableRequests.push(t)}this.availableRequests.length==this.maxRequests&&this.imageryProvider&&this.parent.publish("endBackgroundLoad")},o.prototype.renderTiles=function(){var t=this.renderContext,n=t.gl,r,o;if(this.tileConfig.cullSign<0)r=.2*s.radius,o=1.1*s.radius;else{r=1e9,o=0;for(var u=0;u<this.visibleTiles.length;u++){var a=this.visibleTiles[u];r=Math.min(r,a.distance-1.5*a.radius),o=Math.max(o,a.distance+1.5*a.radius)}}t.near=Math.max(t.minNear,r),t.far=Math.max(t.minFar,o);if(this.tilesToRender.length!=0){this.tileConfig.cullSign<0?(n.depthMask(!1),n.disable(n.DEPTH_TEST),n.disable(n.CULL_FACE)):(n.enable(n.POLYGON_OFFSET_FILL),n.polygonOffset(0,4)),this.currentFragmentShader&&this.currentFragmentShader!=this.imageryProvider.customShader.fragmentCode&&(this.program.dispose(),this.program=new i(this.renderContext),this.imageryProvider.customShader&&(this.currentFragmentShader=this.imageryProvider.customShader.fragmentCode?this.imageryProvider.customShader.fragmentCode:this.fragmentShader,this.program.createFromSource(this.imageryProvider.customShader.vertexShader?this.imageryProvider.customShader.vertexShader:this.vertexShader,this.currentFragmentShader))),this.program.apply();var f=this.program.attributes;mat4.perspective(t.fov,t.canvas.width/t.canvas.height,t.near,t.far,t.projectionMatrix),this.imageryProvider.customShader&&this.imageryProvider.customShader.updateUniforms(n,this.program),n.activeTexture(n.TEXTURE0),n.uniformMatrix4fv(this.program.uniforms.projectionMatrix,!1,t.projectionMatrix),n.uniform1i(this.program.uniforms.colorTexture,0),this.tcoordBuffer||this.buildSharedTexCoordBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.tcoordBuffer),n.vertexAttribPointer(f.tcoord,2,n.FLOAT,!1,0,0);var l=null;for(var u=0;u<this.tilesToRender.length;u++){var a=this.tilesToRender[u],c=a.state==e.State.LOADED,h=a.parentIndex==-1;n.bindTexture(n.TEXTURE_2D,a.texture),mat4.multiply(t.viewMatrix,a.matrix,t.modelViewMatrix),n.uniformMatrix4fv(this.program.uniforms.modelViewMatrix,!1,t.modelViewMatrix),n.bindBuffer(n.ARRAY_BUFFER,a.vertexBuffer),n.vertexAttribPointer(f.vertex,3,n.FLOAT,!1,4*this.tileConfig.vertexSize,0),this.tileConfig.normals&&n.vertexAttribPointer(f.normal,3,n.FLOAT,!1,4*this.tileConfig.vertexSize,12);var p=c||h?this.tileIndexBuffer.getSolid():this.tileIndexBuffer.getSubSolid(a.parentIndex);l!=p&&(n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,p),l=p),n.drawElements(n.TRIANGLES,l.numIndices,n.UNSIGNED_SHORT,0)}this.tileConfig.cullSign<0?(n.depthMask(!0),n.enable(n.DEPTH_TEST)):n.disable(n.POLYGON_OFFSET_FILL)}for(var u=0;u<this.postRenderers.length;u++)this.postRenderers[u].render(this.visibleTiles)};var u=function(e,t){return e.distance-t.distance};return o.prototype.launchRequests=function(){this.tilesToRequest.sort(u);var t=this.tilesToRequest.length;for(var n=0;n<t;n++){var r=this.tilesToRequest[n];if(this.availableRequests.length>0){this.availableRequests.length==this.maxRequests&&this.imageryProvider&&this.parent.publish("startBackgroundLoad");var i=this.availableRequests.pop();i.launch(r)}else r.state=e.State.NONE}},o.prototype.render=function(){if(this.imageryProvider&&!this.imageryProvider._ready)return;if(!this.level0TilesLoaded&&this.imageryProvider&&this.imageryProvider.levelZeroImage){this.imageryProvider.generateLevel0Textures(this.level0Tiles,this.tilePool);for(var e=0;e<this.level0Tiles.length;e++){var t=this.level0Tiles[e];t.generate(this.tilePool);for(var n=0;n<this.postRenderers.length;n++)this.postRenderers[n].generate&&this.postRenderers[n].generate(t)}this.level0TilesLoaded=!0,this.parent.publish("baseLayersReady")}var r=this.renderContext.stats;this.freeze||(r&&r.start("traverseTime"),this.traverseTiles(),r&&r.end("traverseTime")),this.level0TilesLoaded&&(r&&r.start("renderTime"),this.renderTiles(),r&&r.end("renderTime")),r&&r.start("generateTime"),this.generateReceivedTiles(),r&&r.end("generateTime"),r&&r.start("requestTime"),this.launchRequests(),r&&r.end("requestTime"),this.frameNumber++},o.prototype.getVisibleTile=function(e,t){return this.tiling.findInsideTile(e,t,this.visibleTiles)},o.prototype.buildSharedTexCoordBuffer=function(){var e=this.tileConfig.tesselation,t=this.tileConfig.skirt,n=2*e*e;t&&(n+=2*e*6);var r=new Float32Array(n),i=1/(e-1),s=0,o=0;for(var u=0;u<e;u++){var a=0;for(var f=0;f<e;f++)r[s]=a,r[s+1]=o,s+=2,a+=i;o+=i}if(t){a=0,o=0;for(var f=0;f<e;f++)r[s]=a,r[s+1]=o,a+=i,s+=2;a=0,o=1;for(var f=0;f<e;f++)r[s]=a,r[s+1]=o,a+=i,s+=2;a=0,o=0;for(var f=0;f<e;f++)r[s]=a,r[s+1]=o,o+=i,s+=2;a=1,o=0;for(var f=0;f<e;f++)r[s]=a,r[s+1]=o,o+=i,s+=2;a=0,o=.5;for(var f=0;f<e;f++)r[s]=a,r[s+1]=o,a+=i,s+=2;a=.5,o=0;for(var f=0;f<e;f++)r[s]=a,r[s+1]=o,o+=i,s+=2}var l=this.renderContext.gl,c=l.createBuffer();l.bindBuffer(l.ARRAY_BUFFER,c),l.bufferData(l.ARRAY_BUFFER,r,l.STATIC_DRAW),this.tcoordBuffer=c},o}),define("gw/VectorRendererManager",[],function(){var e=function(t){this.renderers=[];for(var n=0;n<e.factory.length;n++)this.renderers.push(e.factory[n](t));this.renderables=[],this.bucketId=0};e.factory=[],e.prototype.getRenderer=function(e,t){for(var n=0;n<this.renderers.length;n++)if(this.renderers[n].canApply(e.type,t))return this.renderers[n];return null},e.prototype.generate=function(e){if(!e.parent)for(var t=0;t<this.renderers.length;t++)this.renderers[t].generateLevelZero(e);else{var n=e.parent.extension.renderer;if(n){delete e.extension.renderer;for(var t=0;t<n.renderables.length;t++){var r=n.renderables[t];r.generateChild&&r.generateChild(e)}}}},e.prototype.addGeometry=function(e,t,n){var r=this.getRenderer(t,n);r.addGeometry(e,t,n)},e.prototype.removeGeometry=function(e){var t=e._bucket;t&&t.renderer.removeGeometry(e)},e.prototype.addGeometryToTile=function(e,t,n,r){var i=this.getRenderer(t,n);i.addGeometryToTile(e,t,n,r)},e.prototype.removeGeometryFromTile=function(e,t){var n=e._bucket;n.renderer.removeGeometryFromTile(e,t)};var t=function(e,t){var n=e.bucket.style.zIndex-t.bucket.style.zIndex;return n==0?e.bucket.id-t.bucket.id:n};return e.prototype.render=function(){for(var e=0;e<this.renderers.length;e++){var n=this.renderers[e].buckets;for(var r=0;r<n.length;r++)n[r].layer._visible&&n[r].mainRenderable&&this.renderables.push(n[r].mainRenderable)}this.renderables.sort(t);var r=0;while(r<this.renderables.length){var e=r+1,i=this.renderables[r].bucket.renderer;while(e<this.renderables.length&&this.renderables[e].bucket.renderer==i)e++;i.render(this.renderables,r,e),r=e}this.renderables.length=0},e}),define("gw/GeoBound",[],function(){var e=function(e,t,n,r){this.south=t,this.west=e,this.north=r,this.east=n};return e.prototype.getCenter=function(){return[(this.east+this.west)*.5,(this.south+this.north)*.5,0]},e.prototype.getNorth=function(){return this.north},e.prototype.getSouth=function(){return this.south},e.prototype.getWest=function(){return this.west},e.prototype.getEast=function(){return this.east},e.prototype.computeFromCoordinates=function(e){this.west=e[0][0],this.east=e[0][0],this.south=e[0][1],this.north=e[0][1];for(var t=1;t<e.length;t++)this.west=Math.min(this.west,e[t][0]),this.east=Math.max(this.east,e[t][0]),this.south=Math.min(this.south,e[t][1]),this.north=Math.max(this.north,e[t][1])},e.prototype.intersects=function(e){return this.west>=e.east||this.east<=e.west?!1:this.south>=e.north||this.north<=e.south?!1:!0},e}),define("gw/Event",[],function(){var e=function(){this.callbacks={}};return e.prototype.subscribe=function(e,t){this.callbacks[e]?this.callbacks[e].push(t):this.callbacks[e]=[t]},e.prototype.unsubscribe=function(e,t){if(this.callbacks[e]){var n=this.callbacks[e].indexOf(t);n!=-1&&this.callbacks[e].splice(n,1)}},e.prototype.publish=function(e,t){if(this.callbacks[e]){var n=this.callbacks[e];for(var r=0;r<n.length;r++)n[r](t)}},e}),define("gw/Utils",[],function(){var e={};return e.inherits=function(e,t){function n(){}n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t},e}),define("gw/Sky",["./CoordinateSystem","./RenderContext","./TileManager","./TilePool","./Tile","./VectorRendererManager","./Numeric","./GeoBound","./Event","./Utils"],function(e,t,n,r,i,s,o,u,a,f){var l=function(e){a.prototype.constructor.call(this),this.renderContext=new t(e),this.tilePool=new r(this.renderContext),this.tileManagers={EQ:new n(this),GAL:new n(this)},this.tileManager=this.tileManagers.EQ,this.vectorRendererManager=new s(this),this.attributionHandler=null,this.baseImagery=null,this.nbCreatedLayers=0,this.tileManager.addPostRenderer(this.vectorRendererManager),this.renderContext.renderer=this,this.renderContext.requestFrame()};return f.inherits(a,l),l.prototype.refresh=function(){this.renderContext.requestFrame()},l.prototype.setBaseImagery=function(e){if(this.baseImagery==e)return;this.baseImagery&&(this.removeLayer(this.baseImagery),this.tileManagers[this.baseImagery.coordSystem].setImageryProvider(null),this.baseImagery=null),e&&(e._overlay=!1,this.addLayer(e),this.tileManagers[e.coordSystem].setImageryProvider(e),this.baseImagery=e)},l.prototype.addLayer=function(e){e.id=this.nbCreatedLayers,e._attach(this),this.renderContext.requestFrame(),this.nbCreatedLayers++},l.prototype.removeLayer=function(e){e._detach(),this.renderContext.requestFrame()},l.prototype.addAnimation=function(e){e.renderContext=this.renderContext},l.prototype.removeAnimation=function(e){e.renderContext=null},l.prototype.getViewportGeoBound=function(t){var n=this.renderContext,r=mat4.create();mat4.inverse(n.viewMatrix,r);var i=[r[12],r[13],r[14]];mat4.multiply(n.projectionMatrix,n.viewMatrix,r),mat4.inverse(r);var s=[[-1,-1,1,1],[1,-1,1,1],[-1,1,1,1],[1,1,1,1]],a=vec3.create(),f=[0,0,0];for(var l=0;l<4;l++){mat4.multiplyVec4(r,s[l]),vec3.scale(s[l],1/s[l][3]),vec3.subtract(s[l],i,s[l]),vec3.normalize(s[l]);var c=o.raySphereIntersection(i,s[l],f,e.radius);if(c<0)return null;s[l]=e.from3DToGeo(o.pointOnRay(i,s[l],c,a)),t&&(s[l]=t(s[l]))}var h=new u;return h.computeFromCoordinates(s),h},l.prototype.getLonLatFromPixel=function(t,n){var r=this.renderContext.get3DFromPixel(t,n);return r?e.from3DToGeo(r):null},l.prototype.getPixelFromLonLat=function(t,n){var r=vec3.create();e.fromGeoTo3D([t,n],r);var i=this.renderContext.getPixelFrom3D(r[0],r[1],r[2]);return i},l.prototype.render=function(){this.tileManagers.GAL.render(),this.tileManagers.EQ.render()},l.prototype.getRenderStats=function(){return"# rendered tiles : "+this.tileManager.tilesToRender.length},l}),define("gw/Stats",[],function(){var e=function(e,t){e.stats=this,this.renderContext=e;var n=t?t.element:undefined;n&&(typeof n=="string"?this.element=document.getElementById(n):this.element=n),this.showFPS=this.renderContext.continuousRendering,this.verbose=t&&t.verbose?t.verbose:!1,this.numFrames=0;var r=this;window.setInterval(function(){r.print()},1e3)};return e.prototype.start=function(e){this[e]=Date.now()},e.prototype.end=function(e){var t=Date.now()-this[e],n=this["max_"+e]||-1;n<t&&(n=t);var r=this["sum_"+e]||0;r+=t,this[e]=t,this["max_"+e]=n,this["sum_"+e]=r,e=="globalRenderTime"&&this.numFrames++},e.prototype.print=function(){if(this.numFrames>0){var e="";this.showFPS&&(e+="FPS : "+this.numFrames+"<br>"),e+="Average render time : "+(this.sum_globalRenderTime/this.numFrames).toFixed(2)+" ms",this.renderContext.renderer.getRenderStats&&(e+="<br>"+this.renderContext.renderer.getRenderStats()),this.verbose&&(e+="<br>Average traverse tiles time : "+(this.sum_traverseTime/this.numFrames).toFixed(2)+" ms",e+="<br>Average render tiles time : "+(this.sum_renderTime/this.numFrames).toFixed(2)+" ms",e+="<br>Average generate tiles time : "+(this.sum_generateTime/this.numFrames).toFixed(2)+" ms",e+="<br>Average request tiles time : "+(this.sum_requestTime/this.numFrames).toFixed(2)+" ms",e+="<br>Max render time : "+this.max_globalRenderTime+" ms",e+="<br>Max traverse tiles time : "+this.max_traverseTime+" ms",e+="<br>Max render tiles time : "+this.max_renderTime+" ms",e+="<br>Max generate tiles time : "+this.max_generateTime+" ms",e+="<br>Max request tiles time : "+this.max_requestTime+" ms"),this.element.innerHTML=e,this.sum_globalRenderTime=0,this.sum_traverseTime=0,this.sum_renderTime=0,this.sum_generateTime=0,this.sum_requestTime=0,this.max_globalRenderTime=0,this.max_traverseTime=0,this.max_renderTime=0,this.max_generateTime=0,this.max_requestTime=0,this.numFrames=0}},e}),define("gw/MouseNavigationHandler",[],function(){var e=function(e){var t=null,n=-1,r=-1,i=-1,s=0,o=0,u=e&&e.panButton||0,a=e&&e.rotateButton||1,f=function(e){var n;return e.wheelDelta===undefined?n=e.detail:n=-e.wheelDelta/120,t.zoom(n),t.stopAnimations(),t.inertia&&t.inertia.launch("zoom",n<0?-1:1),e.preventDefault&&e.preventDefault(),e.returnValue=!1,!1},l=function(e){return document.addEventListener("mouseup",c),n=e.button,t.stopAnimations(),e.button==u||e.button==a?(r=e.clientX,i=e.clientY,s=0,o=0,!1):!0},c=function(e){return n=-1,document.removeEventListener("mouseup",c),t.inertia&&(s!=0||o!=0)&&(e.button==u&&t.inertia.launch("pan",s,o),e.button==a&&t.inertia.launch("rotate",s,o)),e.button==u||e.button==a?(e.preventDefault(),!1):!0},h=function(e){if(n<0)return;s=e.clientX-r,o=e.clientY-i;if(s==0&&o==0)return;var f=!1;return n==u?(t.pan(s,o),f=!0):n==a&&(t.rotate(s,o),f=!0),r=e.clientX,i=e.clientY,f},p=function(e){if(e.button==0){var n=t.globe.renderContext.getXYRelativeToCanvas(e),r=t.globe.getLonLatFromPixel(n[0],n[1]);r&&t.zoomTo(r)}};this.install=function(n){t=n;var r=t.renderContext.canvas;r.addEventListener("mousedown",l),r.addEventListener("mousemove",h),e&&e.zoomOnDblClick&&r.addEventListener("dblclick",p),r.addEventListener("DOMMouseScroll",f),r.addEventListener("mousewheel",f),r.addEventListener("dragstart",function(e){return e.preventDefault(),!1}),a==2&&r.addEventListener("contextmenu",function(e){return e.preventDefault(),!1},!1)},this.uninstall=function(){var n=t.renderContext.canvas;n.removeEventListener("mousedown",l),n.removeEventListener("mousemove",h),e&&e.zoomOnDblClick&&n.removeEventListener("dblclick",p),n.removeEventListener("DOMMouseScroll",f),n.removeEventListener("mousewheel",f)}};return e}),define("gw/KeyboardNavigationHandler",[],function(){var e=function(e){var t=null,n=this;this.panFactor=10,this.zoomFactor=1,e&&(e.panFactor&&typeof e["panFactor"]=="number"&&(this.panFactor=e.panFactor),e.zoomFactor&&typeof e["zoomFactor"]=="number"&&(this.zoomFactor=e.zoomFactor));var r=function(e){return this.focus(),!1},i=function(e){switch(e.keyCode){case 32:t.stopAnimations();break;case 187:case 61:case 107:t.zoom(-n.zoomFactor);break;case 189:case 54:case 109:t.zoom(n.zoomFactor);break;case 81:case 37:e.shiftKey?t.rotate(n.panFactor,0):t.pan(n.panFactor,0);break;case 90:case 38:e.shiftKey?t.rotate(0,n.panFactor):t.pan(0,n.panFactor);break;case 68:case 39:e.shiftKey?t.rotate(-n.panFactor,0):t.pan(-n.panFactor,0);break;case 83:case 40:e.shiftKey?t.rotate(0,-n.panFactor):t.pan(0,-n.panFactor)}};this.install=function(n){t=n;if(e&&e.installOnDocument)document.addEventListener("keydown",i);else{var s=t.renderContext.canvas;s.addEventListener("keydown",i),s.tabIndex="0",s.addEventListener("mousedown",r)}},this.uninstall=function(){if(e&&e.installOnDocument)document.removeEventListener("keydown",i);else{var n=t.renderContext.canvas;n.removeEventListener("keydown",i),n.removeEventListener("mousedown",r)}}};return e}),define("gw/Animation",[],function(){var e=function(){this.startTime=-1,this.pauseTime=-1,this.renderContext=null};return e.prototype._unregisterActive=function(){var e=this.renderContext.activeAnimations.indexOf(this);this.renderContext.activeAnimations.splice(e,1)},e.prototype.getStatus=function(){return this.startTime==-1?"STOPPED":this.pauseTime==-1?"RUNNING":"PAUSED"},e.prototype.start=function(){if(!this.renderContext)return;if(this.startTime==-1||this.pauseTime!=-1){var e=Date.now();this.startTime==-1?this.startTime=e:(this.startTime+=e-this.pauseTime,this.pauseTime=-1),this.renderContext.activeAnimations.push(this),this.renderContext.requestFrame()}},e.prototype.pause=function(){if(!this.renderContext)return;this.startTime!=-1&&this.pauseTime==-1&&(this.pauseTime=Date.now(),this._unregisterActive(this))},e.prototype.stop=function(){this.startTime=-1,this.pauseTime=-1,this.onstop&&this.onstop(),this._unregisterActive(this)},e}),define("gw/InertiaAnimation",["./Utils","./Animation"],function(e,t){var n=.1,r=function(e,n){t.prototype.constructor.call(this),n&&(this.panFactor=n.hasOwnProperty("panFactor")?n.panFactor:.95,this.rotateFactor=n.hasOwnProperty("rotateFactor")?n.rotateFactor:.95,this.zoomFactor=n.hasOwnProperty("zoomFactor")?n.zoomFactor:.95),this.type=null,this.dx=0,this.dy=0,this.navigation=e,this.renderContext=e.renderContext};return e.inherits(t,r),r.prototype.update=function(e){var t=!1;switch(this.type){case"pan":this.navigation.pan(this.dx,this.dy),this.dx*=this.panFactor,this.dy*=this.panFactor,t=Math.abs(this.dx)<n&&Math.abs(this.dy)<n;break;case"rotate":this.navigation.rotate(this.dx,this.dy),this.dx*=this.rotateFactor,this.dy*=this.rotateFactor,t=Math.abs(this.dx)<n&&Math.abs(this.dy)<n;break;case"zoom":this.navigation.zoom(this.dx),this.dx*=this.zoomFactor,t=Math.abs(this.dx)<n;break;default:}this.navigation.renderContext.requestFrame(),t&&this.stop()},r.prototype.launch=function(e,t,n){this.type=e,this.dx=t,this.dy=n,this.start()},r}),define("gw/BaseNavigation",["./Utils","./Event","./MouseNavigationHandler","./KeyboardNavigationHandler","./InertiaAnimation"],function(e,t,n,r,i){var s=function(e,s){t.prototype.constructor.call(this),this.renderContext=e,s&&s.handlers?this.handlers=s.handlers:this.handlers=[new n(s?s.mouse:null),new r(s?s.keyboard:null)],s&&s.inertia&&(this.inertia=new i(this,s)),this.zoomToAnimation=null,this.start()};return e.inherits(t,s),s.prototype.start=function(){for(var e=0;e<this.handlers.length;e++)this.handlers[e].install(this)},s.prototype.stop=function(){for(var e=0;e<this.handlers.length;e++)this.handlers[e].uninstall()},s.prototype.stopAnimations=function(){this.inertia&&this.inertia.stop(),this.zoomToAnimation&&(this.zoomToAnimation.stop(),this.zoomToAnimation=null)},s.prototype.getFov=function(){var e=this.renderContext.canvas.width/this.renderContext.canvas.height;return[e*this.renderContext.fov,this.renderContext.fov]},s}),define("gw/SegmentedAnimation",["./Utils","./Animation","./Numeric"],function(e,t,n){var r=function(e,n){t.prototype.constructor.call(this),this.segments=[],this.duration=e,this.valueSetter=n};e.inherits(t,r);var i=function(e,t,n,r,i){this.start=e,this.startValue=t,this.end=n,this.endValue=r,this.interpolator=i};return r.prototype.addSegment=function(e,t,n,r,s){var o=this.segments.length,u=0;while(u<o&&this.segments[u].end<=e)u++;this.segments.splice(u,0,new i(e,t,n,r,s))},r.prototype.update=function(e){var t=n.map01(e,this.startTime,this.startTime+this.duration);if(t>=1){var r=this.segments.length-1;this.valueSetter(this.segments[r].endValue),this.stop()}else{var i=this.segments.length,s=0;while(s<i&&this.segments[s].end<t)s++;s=Math.min(s,i-1),t=n.map01(t,this.segments[s].start,this.segments[s].end);var o=this.segments[s].interpolator(t,this.segments[s].startValue,this.segments[s].endValue);this.valueSetter(o)}},r}),define("gw/AstroNavigation",["./Utils","./CoordinateSystem","./BaseNavigation","./SegmentedAnimation","./Numeric","./glMatrix"],function(e,t,n,r,i){var s=function(e,r){n.prototype.constructor.call(this,e.renderContext,r),this.globe=e,this.minFov=r&&r.minFov||.001,this.maxFov=r&&r.maxFov||100,this.center3d=[1,0,0],this.up=[0,0,1],r&&(r.initTarget&&t.fromGeoTo3D(r.initTarget,this.center3d),r.initFov&&(this.renderContext.fov=r.initFov,this._clampFov()),r.up&&(this.up=r.up)),this.computeViewMatrix()};return e.inherits(n,s),s.prototype.zoomTo=function(e,n,s,o){var u=this,a=n||2;s=s||2e3;var f=[],l=25;t.from3DToGeo(this.center3d,f);var c=[f[0],f[1],this.renderContext.fov],h=[e[0],e[1],a];Math.abs(e[0]-f[0])>180&&(f[0]<e[0]?c[0]+=360:h[0]+=360);var p=new r(s,function(e){var n=t.fromGeoTo3D([e[0],e[1]]);u.center3d[0]=n[0],u.center3d[1]=n[1],u.center3d[2]=n[2],u.globe.renderContext.fov=e[2],u.computeViewMatrix()}),d=t.fromGeoTo3D(e);if(l>this.renderContext.fov&&this.renderContext.worldFrustum.containsSphere(d,.005)<0){var v=[c[0]*.5+h[0]*.5,c[1]*.5+h[1]*.5,l];p.addSegment(0,c,.5,v,function(e,t,n){var r=i.easeInQuad(e),s=i.easeOutQuad(e);return[i.lerp(r,t[0],n[0]),i.lerp(r,t[1],n[1]),i.lerp(s,t[2],n[2])]}),p.addSegment(.5,v,1,h,function(e,t,n){var r=i.easeOutQuad(e),s=i.easeInQuad(e);return[i.lerp(r,t[0],n[0]),i.lerp(r,t[1],n[1]),i.lerp(s,t[2],n[2])]})}else p.addSegment(0,c,1,h,function(e,t,n){var r=i.easeOutQuad(e),s=i.easeInQuad(e);return[i.lerp(r,t[0],n[0]),i.lerp(r,t[1],n[1]),i.lerp(s,t[2],n[2])]});p.onstop=function(){o&&o(),u.zoomToAnimation=null},this.globe.addAnimation(p),p.start(),this.zoomToAnimation=p},s.prototype.moveTo=function(e,n,s){var o=this;n=n||5e3;var u=[];t.from3DToGeo(this.center3d,u);var a=[u[0],u[1]],f=[e[0],e[1]];Math.abs(e[0]-u[0])>180&&(u[0]<e[0]?a[0]+=360:f[0]+=360);var l=new r(n,function(e){var n=t.fromGeoTo3D([e[0],e[1]]);o.center3d[0]=n[0],o.center3d[1]=n[1],o.center3d[2]=n[2],o.computeViewMatrix()});l.addSegment(0,a,1,f,function(e,t,n){var r=i.easeOutQuad(e);return[i.lerp(r,t[0],n[0]),i.lerp(r,t[1],n[1])]}),l.onstop=function(){s&&s()},this.globe.addAnimation(l),l.start()},s.prototype.moveUpTo=function(e,n){var s=[],o=[];t.from3DToGeo(this.up,s),t.from3DToGeo(e,o);var n=n||1e3,u=this,a=new r(n,function(e){var n=t.fromGeoTo3D([e[0],e[1]]);u.up[0]=n[0],u.up[1]=n[1],u.up[2]=n[2],u.computeViewMatrix()});a.addSegment(0,s,1,o,function(e,t,n){var r=i.easeOutQuad(e);return[i.lerp(r,t[0],n[0]),i.lerp(r,t[1],n[1])]}),this.globe.addAnimation(a),a.start()},s.prototype.computeViewMatrix=function(){var e=[];vec3.normalize(this.center3d);var t=this.renderContext.viewMatrix;mat4.lookAt([0,0,0],this.center3d,this.up,t),this.up=[t[1],t[5],t[9]],this.publish("modified"),this.renderContext.requestFrame()},s.prototype.zoom=function(e,t){t?this.renderContext.fov*=1/t:this.renderContext.fov*=1+e*.1,this._clampFov(),this.computeViewMatrix()},s.prototype.pan=function(e,t){var n=this.renderContext.canvas.width/2,r=this.renderContext.canvas.height/2;this.center3d=this.renderContext.get3DFromPixel(n-e,r-t),this.computeViewMatrix()},s.prototype.rotate=function(e,t){var n=e*.1*Math.PI/180,r=quat4.fromAngleAxis(n,this.center3d);quat4.multiplyVec3(r,this.up),this.computeViewMatrix()},s.prototype._clampFov=function(){this.renderContext.fov>this.maxFov&&(this.renderContext.fov=this.maxFov),this.renderContext.fov<this.minFov&&(this.renderContext.fov=this.minFov)},s}),define("gw/AttributionHandler",[],function(){var e=function(e,t){e.attributionHandler=this;var n=t?t.element:undefined;n&&(typeof n=="string"?this.element=document.getElementById(n):this.element=n)};return e.prototype.removeAttribution=function(e){var t=document.getElementById("attribution_"+e.id);t&&this.element.removeChild(t)},e.prototype.addAttribution=function(e){var t=document.createElement("div");t.innerHTML=e.attribution,t.id="attribution_"+e.id,e.id==0?this.element.insertBefore(t,this.element.firstChild):this.element.appendChild(t)},e.prototype.toggleAttribution=function(e){var t=document.getElementById("attribution_"+e.id);t?this.removeAttribution(e):this.addAttribution(e)},e}),define("gw/BaseLayer",[],function(){var e=function(e){this.globe=null,this.name=e&&e.hasOwnProperty("name")?e.name:"",this.attribution=e&&e.hasOwnProperty("attribution")?e.attribution:"",this.icon=e&&e.hasOwnProperty("icon")?e.icon:"",this.description=e&&e.hasOwnProperty("description")?e.description:"",this._visible=e&&e.hasOwnProperty("visible")?e.visible:!0,this._opacity=e&&e.hasOwnProperty("opacity")?e.opacity:1};return e.prototype._attach=function(e){this.globe=e,this.attribution&&this.globe.attributionHandler&&this._visible&&this.globe.attributionHandler.addAttribution(this)},e.prototype._detach=function(){this.attribution&&this.globe.attributionHandler&&this.globe.attributionHandler.removeAttribution(this),this.globe=null},e.prototype.visible=function(e){return typeof e=="boolean"&&(this._visible!=e&&this.attribution&&this.globe.attributionHandler&&this.globe.attributionHandler.toggleAttribution(this),this._visible=e,this.globe&&this.globe.renderContext.requestFrame()),this._visible},e.prototype.opacity=function(e){return typeof e=="number"&&(this._opacity=e,this.globe&&this.globe.renderContext.requestFrame()),this._opacity},e}),define("gw/FeatureStyle",[],function(){var e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"},t=/^(\w{2})(\w{2})(\w{2})$/,n=/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,r=/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3},\s*(\d{1,3}))\)$/,i=function(e){this.strokeColor=[1,0,0,1],this.fillColor=[1,0,0,1],this.fillTextureUrl=null,this.fillTexture=null,this.fillShader=null,this.strokeWidth=1,this.iconUrl=null,this.icon=null,this.label=null,this.textColor=[1,1,1,1],this.fill=!1,this.pointMaxSize=40,this.opacity=1,this.zIndex=0;if(e)for(var t in e)this[t]=e[t]};return i.fromStringToColor=function(i){var s=0,o=0,u=0,a=255,f;return i=i.trim(),i=i.toLowerCase(),i.charAt(0)=="#"&&(i=i.substr(1,6)),e.hasOwnProperty(i)&&(i=e[i]),f=t.exec(i),f&&(s=parseInt(f[1],16),o=parseInt(f[2],16),u=parseInt(f[3],16)),f=n.exec(i),f&&(s=parseInt(f[1]),o=parseInt(f[2]),u=parseInt(f[3])),f=r.exec(i),f&&(s=parseInt(f[1]),o=parseInt(f[2]),u=parseInt(f[3]),a=parseInt(f[4])),s=s<0?0:s>255?255:s,o=o<0?0:o>255?255:o,u=u<0?0:u>255?255:u,a=a<0?0:a>255?255:a,[s/255,o/255,u/255,a/255]},i.fromColorToString=function(e){var t="#";for(var n=0;n<3;n++){var r=parseInt(e[n]*255).toString(16);t+=r<10?"0"+r:r}return t},i}),define("gw/VectorLayer",["./Utils","./BaseLayer","./FeatureStyle"],function(e,t,n){var r=function(e){t.prototype.constructor.call(this,e),e&&e.style?this.style=e.style:this.style=new n,this.features=[]};return e.inherits(t,r),r.prototype._attach=function(e){t.prototype._attach.call(this,e);for(var n=0;n<this.features.length;n++)this._addFeatureToRenderers(this.features[n])},r.prototype._detach=function(){for(var e=0;e<this.features.length;e++)this._removeFeatureFromRenderers(this.features[e]);t.prototype._detach.call(this)},r.prototype.addFeatureCollection=function(e){var t=e.features;if(t)for(var n=0;n<t.length;n++)this.addFeature(t[n])},r.prototype.removeFeatureCollection=function(e){var t=e.features;if(t)for(var n=0;n<t.length;n++)this.removeFeature(t[n])},r.prototype._addFeatureToRenderers=function(e){var t=e.geometry,n=this.style,r=e.properties;r&&r.style&&(n=r.style);if(t.type=="GeometryCollection"){var i=t.geometries;for(var s=0;s<i.length;s++)this.globe.vectorRendererManager.addGeometry(this,i[s],n)}else this.globe.vectorRendererManager.addGeometry(this,t,n)},r.prototype._removeFeatureFromRenderers=function(e){var t=e.geometry;if(t.type=="GeometryCollection"){var n=t.geometries;for(var r=0;r<n.length;r++)this.globe.vectorRendererManager.removeGeometry(n[r],this)}else this.globe.vectorRendererManager.removeGeometry(t,this)},r.prototype.addFeature=function(e){var t=e.geometry;if(!t||!t.type)return;this.features.push(e),this.globe&&(this._addFeatureToRenderers(e),this._visible&&this.globe.renderContext.requestFrame())},r.prototype.removeFeature=function(e){var t=this.features.indexOf(e);this.features.splice(t,1),this.globe&&(this._removeFeatureFromRenderers(e),this._visible&&this.globe.renderContext.requestFrame())},r.prototype.removeAllFeatures=function(){if(this.globe)for(var e=0;e<this.features.length;e++)this._removeFeatureFromRenderers(this.features[e]);this.features.length=0,this.globe&&this._visible&&this.globe.renderContext.requestFrame()},r.prototype.modifyFeatureStyle=function(e,t){this._removeFeatureFromRenderers(e),e.properties.style=t,this._addFeatureToRenderers(e)},r.prototype.modifyStyle=function(e){for(var t=0;t<this.features.length;t++)this._removeFeatureFromRenderers(this.features[t]);this.style=e;for(var t=0;t<this.features.length;t++)this._addFeatureToRenderers(this.features[t])},r}),define("gw/TouchNavigationHandler",[],function(){var e={PAN:0,ROTATE:1,TILT:2,ZOOM:3},t=function(t){var n=null,r,i=[],s,o,u,a,f,l=[0,0,0,0],c,h,p=300,d=t&&t.hasOwnProperty("inversed")?t.inversed:!1,v=function(e,t){var n=t.clientY-e.clientY,r=t.clientX-e.clientX;return Math.atan2(n,r)*180/Math.PI},m=function(e,t){return e.length>=2&&t.length>=2?v(t[1],t[0])-v(e[1],e[0]):0},g=function(e){s=e.touches,i=e.touches,l=[0,0,0,0],n.stopAnimations(),u=0,a=0;if(e.touches.length==2){var t=e.touches[0].clientX-e.touches[1].clientX,f=e.touches[0].clientY-e.touches[1].clientY;r=Math.sqrt(t*t+f*f),console.log("Finger distance : "+r),o=m(i,e.touches)}return e.preventDefault&&e.preventDefault(),e.returnValue=!1,!1},y=function(t){u=t.touches[0].clientX-s[0].clientX,a=t.touches[0].clientY-s[0].clientY;if(t.touches.length==1)n.pan(u,a),l[e.PAN]++;else{var f=(t.touches[0].clientY-s[0].clientY)*(t.touches[1].clientY-s[1].clientY)>0;if(f)n.rotate(0,-a),l[e.TILT]++;else{var c=m(i,t.touches),p=c-o;o=c,d&&(p*=-1),h=p*10,n.rotate(h,0),l[e.ROTATE]++}var p=t.touches[0].clientX-t.touches[1].clientX,v=t.touches[0].clientY-t.touches[1].clientY,g=Math.sqrt(p*p+v*v),y=g-r,b;d?b=g/r:b=r/g,r!=0&&(n.zoom(y*.025,b),l[e.ZOOM]++),n.renderContext.requestFrame(),r=g}return s=t.touches,t.preventDefault&&t.preventDefault(),t.returnValue=!1,!1},b=function(r){if(t&&t.zoomOnDblClick&&r.touches.length==0&&u==0&&a==0){var i=Date.now();if(i-c<p){var o=n.globe.getLonLatFromPixel(s[0].clientX,s[0].clientY);o&&n.zoomTo(o)}c=i}s=r.touches;if(n.inertia&&(u!=0||a!=0)){var f=l.indexOf(Math.max.apply(this,l));f==e.PAN?n.inertia.launch("pan",u,a):f!=e.ROTATE&&f==e.TILT}return r.preventDefault&&r.preventDefault(),r.returnValue=!1,!1};this.install=function(e){n=e;var t=n.renderContext.canvas;t.addEventListener("touchstart",g,!1),t.addEventListener("touchend",b,!1),t.addEventListener("touchmove",y,!1)},this.uninstall=function(){var e=n.renderContext.canvas;e.removeEventListener("touchstart",g,!1),e.removeEventListener("touchend",b,!1),e.removeEventListener("touchmove",y,!1)}};return t}),define("text",["module"],function(e){var t,n,r=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],i=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,s=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,o=typeof location!="undefined"&&location.href,u=o&&location.protocol&&location.protocol.replace(/\:/,""),a=o&&location.hostname,f=o&&(location.port||undefined),l=[],c=e.config&&e.config()||{};t={version:"2.0.3",strip:function(e){if(e){e=e.replace(i,"");var t=e.match(s);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:c.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=r[t];try{e=new ActiveXObject(n)}catch(i){}if(e){r=[n];break}}return e},parseName:function(e){var t=!1,n=e.indexOf("."),r=e.substring(0,n),i=e.substring(n+1,e.length);return n=i.indexOf("!"),n!==-1&&(t=i.substring(n+1,i.length),t=t==="strip",i=i.substring(0,n)),{moduleName:r,ext:i,strip:t}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,c.isBuild&&(l[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}c.isBuild=i.isBuild;var s=t.parseName(e),l=s.moduleName+"."+s.ext,h=n.toUrl(l),p=c.useXhr||t.useXhr;!o||p(h,u,a,f)?t.get(h,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([l],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(l.hasOwnProperty(n)){var s=t.jsEscape(l[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.moduleName+"."+o.ext,a=r.toUrl(o.moduleName+"."+o.ext)+".js";t.load(u,r,function(n){var r=function(e){return i(a,e)};r.asModule=function(e,t){return i.asModule(e,a,t)},t.write(e,u,r,s)},s)}};if(c.env==="node"||!c.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node)n=require.nodeRequire("fs"),t.get=function(e,t){var r=n.readFileSync(e,"utf8");r.indexOf("Ôªø")===0&&(r=r.substring(1)),t(r)};else if(c.env==="xhr"||!c.env&&t.createXhr())t.get=function(e,n,r){var i=t.createXhr();i.open("GET",e,!0),c.onXhr&&c.onXhr(i,e),i.onreadystatechange=function(t){var s,o;i.readyState===4&&(s=i.status,s>399&&s<600?(o=new Error(e+" HTTP status: "+s),o.xhr=i,r(o)):n(i.responseText))},i.send(null)};else if(c.env==="rhino"||!c.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};return t}),define("text!../templates/mizarCore.html",[],function(){return'<div id="webGLNotAvailable">\n	If you see this message, WebGL is not supported in your browser.<br/>\n	Please install a recent version of <a href="http://www.mozilla.com">Firefox</a> or <a href="http://www.google.com/chrome">Google Chrome</a>.<br/>\n	If you already have a recent version of Firefox or Google Chrome, your graphics driver are too old, please update it.<br/>\n	On Google Chrome, you can check why it is not working by entering "about:gpu" in the url bar.\n</div>\n\n<div id="webGLContextLost">\n	If you see this message, WebGL context was lost.<br/>\n	Please re-launch your browser. We are working on restoring without relaunching.\n</div>\n\n<div id="loading"></div>\n\n<div class="canvas">\n\n	<!-- Side bar will contain available layers -->\n	<div class="sidebar">\n	</div>\n	\n	<div class="noSelect" id="navigationDiv">\n		<div id="searchDiv">\n		</div>\n\n		<div id="compassDiv">\n		</div>\n\n		<div id="imageViewerDiv">\n		</div>\n	</div>\n	\n	<!-- Left-Bottom-section -->\n	<div class="noSelect" id="leftBottomDiv">\n		<!-- Div for relative position 164 = define height of mollweideContent-->\n		<div id="2dMapContainer" style="display: none; position: relative; height: 164px; margin-bottom: 5px;">\n			<div id="mollweideDiv">\n				<span id="mollweideContent">\n					<canvas id="mollweideCanvas" class="noSelect" width="232px" height="116px"></canvas>\n					<div id="fov" class="ui-widget">Fov : 45 x 45</div>\n				</span>\n				\n				<span id="slideArrow"></span>\n			</div>\n		</div>\n		<div id="shareContainer" style="display: none;" class="leftBottomButton">\n			<input type="button" id="share" />\n			<div id="shareResult" style="pointer-events : auto;">\n				<input type="text" id="shareInput" />\n				<input type="button" id="shareClear" />\n			</div>\n		</div>\n		<div id="sampContainer" style="display: none;" class="leftBottomButton">\n			<input type="button" id="sampInvoker" />\n		</div>\n		<div id="measureContainer" style="display: none;" class="leftBottomButton">\n			<input type="button" id="measureInvoker" />\n		</div>\n		<div style="display: none;" id="fps" class="statBox ui-widget">FPS : 0</div>	\n	</div>\n	\n	<div class="noSelect" id="attributions"></div>	\n	<div id="posTracker" class="noSelect"></div>\n\n	<canvas class="noSelect" id="GlobWebCanvas" style="border: none; margin: 0; padding: 0;" width="0" height="0">\n	</canvas>\n\n</div>'}),define("text!../data/backgroundSurveys.json",[],function(){return'[\n	/**\n	 *	Built-in star/constellation catalogs\n	 */\n	{\n		"category": "Other",\n		"type": "GeoJSON",\n		"name": "Constellations",\n		"icon": "css/images/constellation_icon.png",\n		"attribution": "Constellation coming from <a href=\\"http://cdsweb.u-strasbg.fr/index-fr.gml\\" target=\\"_blank\\"><object width=\'24\' height=\'16\' data=\\"http://demonstrator.telespazio.com/mizar/css/images/cds.svg\\" type=\\"image/svg+xml\\"></object></a>",\n		"description": "Constellation shapes from VizieR Catalogue",\n		"data": {\n			"type": "constellation",\n			"nameUrl": "http://demonstrator.telespazio.com/mizar/data/ConstellationNames.tsv",\n			"catalogueUrl": "http://demonstrator.telespazio.com/mizar/data/bound_20.dat"\n		},\n		"visible": false,\n		"pickable" : false,\n		"color": "rgb(8, 59, 167)"\n	},\n	{\n		"category": "Other",\n		"type": "GeoJSON",\n		"name": "Brighten stars",\n		"icon": "http://demonstrator.telespazio.com/mizar/css/images/star_icon.png",\n		"attribution": "The most brighten stars coming from <a href=\\"http://cdsweb.u-strasbg.fr/index-fr.gml\\" target=\\"_blank\\"><object width=\'24\' height=\'16\' data=\\"http://demonstrator.telespazio.com/mizar/css/images/cds.svg\\" type=\\"image/svg+xml\\"></object></a>",\n		"description": "The most brighten stars from VizieR Catalogue",\n		"data": {\n			"type": "star",\n			"nameUrl": "http://demonstrator.telespazio.com/mizar/data/Names.tsv",\n			"catalogueUrl": "http://demonstrator.telespazio.com/mizar/data/Catalogue.tsv"\n		},\n		"visible": true,\n		"opacity": 100,\n		"pickable" : false,\n		"color": "white"\n	},\n	/**\n     * Coordinate grids\n	 */\n	{\n		"category": "Coordinate systems",\n		"type": "coordinateGrid",\n		"name": "Equatorial grid",\n		"visible": false,\n		"coordSystem": "EQ",\n		"color": "white",\n		"latFormat": "DMS",\n		"longFormat": "HMS"\n	},\n	{\n		"category": "Coordinate systems",\n		"type": "coordinateGrid",\n		"name": "Galactic grid",\n		"visible": false,\n		"coordSystem": "GAL",\n		"color": "red",\n		"latFormat": "Deg",\n		"longFormat": "Deg"\n	},\n	/**\n	 *	Alasky healpix sources\n	 *\n	 *	Plugin: Proxy Healpix Image cache\n	 *	urlClient: http://alasky.u-strasbg.fr or http://healpix.ias.u-psud.fr/\n	 */\n	{\n		"type": "healpix",\n		"name": "WISE RGB",\n		"baseUrl": "http://demonstrator.telespazio.com/sitools/Alasky/WISE/RGB/",\n		"description": "WISE color",			\n		"visible": false,\n		"background": true,	\n        "coordSystem": "GAL",\n        "attribution":"<a href=\\"http://irsa.ipac.caltech.edu/Missions/wise.html\\" target=\\"_blank\\"><img src=\\"http://demonstrator.telespazio.com/sitools/upload/wise.svg\\" width=\'24\' height=\'16\'/></a> color background provided by <a href=\\"http://cdsweb.u-strasbg.fr/index-fr.gml\\" target=\\"_blank\\"><object width=\'24\' height=\'16\' data=\\"http://demonstrator.telespazio.com/mizar/css/images/cds.svg\\" type=\\"image/svg+xml\\"></object></a>",\n		"numberOfLevels": 5\n	},\n	{\n		"type": "healpix",\n		"name": "SpitzerI1I2I4color",\n		"baseUrl": "http://demonstrator.telespazio.com/Alasky/SpitzerI1I2I4color",\n		"description": "Spitzer color",			\n		"visible": false,\n		"background": true,	\n        "coordSystem": "GAL",\n        "attribution":"<object width=\'24\' height=\'16\' data=\\"http://demonstrator.telespazio.com/upload/spitzer.svg\\" type=\\"image/svg+xml\\"></object> color background provided by <a href=\\"http://cdsweb.u-strasbg.fr/index-fr.gml\\" target=\\"_blank\\"><object width=\'24\' height=\'16\' data=\\"http://demonstrator.telespazio.com/mizar/css/images/cds.svg\\" type=\\"image/svg+xml\\"></object></a>",\n		"numberOfLevels": 9\n	},\n	{\n		"type": "healpix",\n		"name": "IRIS",\n		"baseUrl": "http://demonstrator.telespazio.com/Alasky/IRISColor",\n		"description": "IRIS color",\n		"icon": "http://demonstrator.telespazio.com/mizar/css/images/star_icon.png",\n		"visible": false,\n		"background": true,\n		"coordSystem": "GAL",\n        "attribution": "IRIS background from <img width=\'24\' height=\'16\' src=\\"http://demonstrator.telespazio.com/mizar/css/images/cds.svg\\" />",\n		"numberOfLevels": 1\n	},\n	{ \n		"type": "healpix",\n		"name": "Deep CFHTLS",\n		"baseUrl": "http://demonstrator.telespazio.com/sitools/Alasky/CFHTLS-T0007b/Deep/RGB-UGIm",\n		"description": "Deep CFHTLS from CDS",\n		"attribution": "Deep CFHTLS background from <a href=\\"http://cdsweb.u-strasbg.fr/index-fr.gml\\" target=\\"_blank\\"><img width=\'24\' height=\'16\' src=\\"http://demonstrator.telespazio.com/mizar/css/images/cds.svg\\" /></a>",\n		"visible": false,\n		"background": true,\n		"numberOfLevels": 11\n	},\n	{ \n		"type": "healpix",\n		"name": "CFHTLS Wide",\n		"baseUrl": "http://demonstrator.telespazio.com/sitools/Alasky/CFHTLS-T0007b/Wide/RGB-UGIm",\n		"description": "CFHTLS-W-Colored (UGI)",\n        "attribution": "TERAPIX - Healpixed by <a href=\\"http://cdsweb.u-strasbg.fr/index-fr.gml\\" target=\\"_blank\\"><img width=\'24\' height=\'16\' src=\\"http://demonstrator.telespazio.com/mizar/css/images/cds.svg\\" /></a>",\n		"visible": false,\n		"background": true,\n		"numberOfLevels": 10\n	},\n	{ \n		"type": "healpix",\n		"name": "2MASS",\n		"baseUrl": "http://demonstrator.telespazio.com/sitools/Alasky/2MASS/Color",\n		"description": "Infrared 2MASS colored survey from NASA, healpixed by CDS",\n		"attribution": "2MASS background from <a href=\\"http://cdsweb.u-strasbg.fr/index-fr.gml\\" target=\\"_blank\\"><img width=\'24\' height=\'16\' src=\\"http://demonstrator.telespazio.com/mizar/css/images/cds.svg\\" /></a>",\n		"visible": false,\n		"background": true,\n		"numberOfLevels": 8\n	},\n	{ \n		"type": "healpix",\n		"name": "RASS",\n		"baseUrl": "http://demonstrator.telespazio.com/sitools/Alasky/RASS",\n		"description": "RASS-ROSAT X-Ray All-Sky Survey",\n		"attribution": "Distributed by MPE - Healpixed by <a href=\\"http://cdsweb.u-strasbg.fr/index-fr.gml\\" target=\\"_blank\\"><img width=\'24\' height=\'16\' src=\\"http://demonstrator.telespazio.com/mizar/css/images/cds.svg\\" /></a>",\n		"visible": false,\n		"background": true,\n		"numberOfLevels": 3\n	},\n	{ \n		"type": "healpix",\n		"name": "NVSS",\n		"baseUrl": "http://demonstrator.telespazio.com/sitools/Alasky/NVSS/intensity",\n		"description": "NVSS intensity maps (1.4GHz)",\n		"visible": false,\n		"background": true,\n		"numberOfLevels": 4\n	},\n	{ \n		"type": "healpix",\n		"name": "DSS",\n		"baseUrl": "http://demonstrator.telespazio.com/Alasky/DssColor",\n		"description": "Digital Sky Survey from CDS",\n		"attribution": "DSS background from <a href=\\"http://cdsweb.u-strasbg.fr/index-fr.gml\\" target=\\"_blank\\"><img width=\'24\' height=\'16\' src=\\"http://demonstrator.telespazio.com/mizar/css/images/cds.svg\\" /></a>",\n		"visible": true,\n		"background": true,\n		"numberOfLevels": 8\n	},\n	{			\n		"type": "healpix",\n		"name": "SDSS",\n		"baseUrl": "http://demonstrator.telespazio.com/sitools/Alasky/SDSS/DR7/Color",\n		"description": "Sloan Digital Sky Survey from CDS",\n		"attribution": "SDSS background from <a href=\\"http://cdsweb.u-strasbg.fr/index-fr.gml\\" target=\\"_blank\\"><img width=\'24\' height=\'16\' src=\\"http://demonstrator.telespazio.com/mizar/css/images/cds.svg\\" /></a>",\n		"icon": "http://demonstrator.telespazio.com/mizar/css/images/star_icon.png",\n		"visible": false,\n		"background": true\n	},\n	/**\n	 *	Plack FITS supported surveys\n	 */\n	// Background\n	{\n		"type": "healpix",\n		"name": "PlanckCMB",\n		"baseUrl" : "http://demonstrator.telespazio.com/Alasky/PLANCK/CMB",\n		"description": "Planck survey from CDS",\n		"visible": false,\n		"background": true,\n		"dataType": "jpg",\n		"fitsSupported": true,\n		"coordSystem": "GAL",\n		//"availableServices": [ { "name": "HEALPixCut", "fileName": "HFI_SkyMap_857_2048_R1.10_nominal.fits"	} ],\n		"numberOfLevels": 2,\n        "attribution":"<a href=\\"http://irsa.ipac.caltech.edu/data/Planck/release_1/all-sky-maps/\\" target=\\"_blank\\"><img src=\\"http://demonstrator.telespazio.com/sitools/upload/planck.svg\\" width=\'20\' height=\'20\'/></a> data provided by <a href=\\"http://cdsweb.u-strasbg.fr/index-fr.gml\\" target=\\"_blank\\"><img width=\'24\' height=\'16\' src=\\"http://demonstrator.telespazio.com/mizar/css/images/cds.svg\\" /></a>"\n	},\n    {\n		"type": "healpix",\n		"name": "Planck-HFI-857",\n		"baseUrl": "http://demonstrator.telespazio.com/sitools/Alasky/PLANCK/HFI857",\n		"description": "PLANCK HFI 857 from CDS",\n		"visible": false,\n		"background": true,\n		"coordSystem": "GAL",\n		"fitsSupported": true,\n		"dataType": "jpg",\n		//"availableServices": [ { "name": "HEALPixCut", "fileName": "HFI_SkyMap_857_2048_R1.10_nominal.fits"	} ],\n		"numberOfLevels": 2,\n        "attribution":"<a href=\\"http://irsa.ipac.caltech.edu/data/Planck/release_1/all-sky-maps/\\" target=\\"_blank\\"><img src=\\"http://demonstrator.telespazio.com/sitools/upload/planck.svg\\" width=\'20\' height=\'20\'/></a> data provided by <a href=\\"http://cdsweb.u-strasbg.fr/index-fr.gml\\" target=\\"_blank\\"><img width=\'24\' height=\'16\' src=\\"http://demonstrator.telespazio.com/mizar/css/images/cds.svg\\" /></a>"\n    },\n    {\n		"type": "healpix",\n		"name": "Planck-HFI-545",\n		"baseUrl": "http://demonstrator.telespazio.com/sitools/Alasky/PLANCK/HFI545",\n		"description": "PLANCK HFI 545 from CDS",\n		"visible": false,\n		"background": true,\n		"coordSystem": "GAL",\n		"fitsSupported": true,\n		"dataType": "jpg",\n		//"availableServices": [ { "name": "HEALPixCut", "fileName": "HFI_SkyMap_545_2048_R1.10_nominal.fits"	} ],\n		"numberOfLevels": 2,\n        "attribution":"<a href=\\"http://irsa.ipac.caltech.edu/data/Planck/release_1/all-sky-maps/\\" target=\\"_blank\\"><img src=\\"http://demonstrator.telespazio.com/sitools/upload/planck.svg\\" width=\'20\' height=\'20\'/></a> data provided by <a href=\\"http://cdsweb.u-strasbg.fr/index-fr.gml\\" target=\\"_blank\\"><img width=\'24\' height=\'16\' src=\\"http://demonstrator.telespazio.com/mizar/css/images/cds.svg\\" /></a>"\n    },\n    {\n		"type": "healpix",\n		"name": "Planck-HFI-353",\n		"baseUrl": "http://demonstrator.telespazio.com/sitools/Alasky/PLANCK/HFI353",\n		"description": "PLANCK HFI 353 from CDS",\n		"visible": false,\n		"background": true,\n		"coordSystem": "GAL",\n		"fitsSupported": true,\n		"dataType": "jpg",\n		//"availableServices": [ { "name": "HEALPixCut", "fileName": "HFI_SkyMap_353_2048_R1.10_nominal.fits"	} ],\n		"numberOfLevels": 2,\n        "attribution":"<a href=\\"http://irsa.ipac.caltech.edu/data/Planck/release_1/all-sky-maps/\\" target=\\"_blank\\"><img src=\\"http://demonstrator.telespazio.com/sitools/upload/planck.svg\\" width=\'20\' height=\'20\'/></a> data provided by <a href=\\"http://cdsweb.u-strasbg.fr/index-fr.gml\\" target=\\"_blank\\"><img width=\'24\' height=\'16\' src=\\"http://demonstrator.telespazio.com/mizar/css/images/cds.svg\\" /></a>"\n    },\n    {\n		"type": "healpix",\n		"name": "Planck-HFI-217",\n		"baseUrl": "http://demonstrator.telespazio.com/sitools/Alasky/PLANCK/HFI217",\n		"description": "PLANCK HFI 217 from CDS",\n		"visible": false,\n		"background": true,\n		"coordSystem": "GAL",\n		"fitsSupported": true,\n		"dataType": "jpg",\n		//"availableServices": [ { "name": "HEALPixCut", "fileName": "HFI_SkyMap_217_2048_R1.10_nominal.fits"	} ],\n		"numberOfLevels": 2,\n        "attribution":"<a href=\\"http://irsa.ipac.caltech.edu/data/Planck/release_1/all-sky-maps/\\" target=\\"_blank\\"><img src=\\"http://demonstrator.telespazio.com/sitools/upload/planck.svg\\" width=\'20\' height=\'20\'/></a> data provided by <a href=\\"http://cdsweb.u-strasbg.fr/index-fr.gml\\" target=\\"_blank\\"><img width=\'24\' height=\'16\' src=\\"http://demonstrator.telespazio.com/mizar/css/images/cds.svg\\" /></a>"\n    },\n    {\n		"type": "healpix",\n		"name": "Planck-HFI-143",\n		"baseUrl": "http://demonstrator.telespazio.com/sitools/Alasky/PLANCK/HFI143",\n		"description": "PLANCK HFI 143 from CDS",\n		"visible": false,\n		"background": true,\n		"coordSystem": "GAL",\n		"fitsSupported": true,\n		"dataType": "jpg",\n		//"availableServices": [ { "name": "HEALPixCut", "fileName": "HFI_SkyMap_143_2048_R1.10_nominal.fits"	} ],\n		"numberOfLevels": 2,\n        "attribution":"<a href=\\"http://irsa.ipac.caltech.edu/data/Planck/release_1/all-sky-maps/\\" target=\\"_blank\\"><img src=\\"http://demonstrator.telespazio.com/sitools/upload/planck.svg\\" width=\'20\' height=\'20\'/></a> data provided by <a href=\\"http://cdsweb.u-strasbg.fr/index-fr.gml\\" target=\\"_blank\\"><img width=\'24\' height=\'16\' src=\\"http://demonstrator.telespazio.com/mizar/css/images/cds.svg\\" /></a>"\n    },\n    {\n		"type": "healpix",\n		"name": "Planck-HFI-100",\n		"baseUrl": "http://demonstrator.telespazio.com/sitools/Alasky/PLANCK/HFI100",\n		"description": "PLANCK HFI 100 from CDS",\n		"visible": false,\n		"background": true,\n		"coordSystem": "GAL",\n		"fitsSupported": true,\n		"dataType": "jpg",\n		//"availableServices": [ { "name": "HEALPixCut", "fileName": "HFI_SkyMap_100_2048_R1.10_nominal.fits"	} ],\n		"numberOfLevels": 2,\n        "attribution":"<a href=\\"http://irsa.ipac.caltech.edu/data/Planck/release_1/all-sky-maps/\\" target=\\"_blank\\"><img src=\\"http://demonstrator.telespazio.com/sitools/upload/planck.svg\\" width=\'20\' height=\'20\'/></a> data provided by <a href=\\"http://cdsweb.u-strasbg.fr/index-fr.gml\\" target=\\"_blank\\"><img width=\'24\' height=\'16\' src=\\"http://demonstrator.telespazio.com/mizar/css/images/cds.svg\\" /></a>"\n    },\n\n	// Overlay\n	{\n		"category": "Image",\n		"type": "healpix",\n		"name": "PlanckCMB",\n		"baseUrl" : "http://demonstrator.telespazio.com/sitools/Alasky/PLANCK/CMB",\n		"description": "Planck survey from CDS",\n		"visible": false,\n		"background": false,\n		"dataType": "jpg",\n		"fitsSupported": true,\n		"coordSystem": "GAL",\n        "attribution":"<a href=\\"http://irsa.ipac.caltech.edu/data/Planck/release_1/all-sky-maps/\\" target=\\"_blank\\"><img src=\\"http://demonstrator.telespazio.com/sitools/upload/planck.svg\\" width=\'20\' height=\'20\'/></a> data provided by <a href=\\"http://cdsweb.u-strasbg.fr/index-fr.gml\\" target=\\"_blank\\"><img width=\'24\' height=\'16\' src=\\"http://demonstrator.telespazio.com/mizar/css/images/cds.svg\\" /></a>"\n	},\n	/**\n	 *	Healpix grid\n	 */\n	{\n		"category": "Other",\n		"type": "healpixGrid",\n		"name": "Healpix grid",\n		"outline": true\n	},\n	/**\n	 *	IAS PLWSAG Healpix imagery\n	 *\n	 *	Plugin: Proxy Healpix Image cache\n	 *	urlClient: http://healpix.ias.u-psud.fr/PLWSAG-4ALLSKY\n	 */\n	{\n		"category": "Herschel-SAG4",\n		"type": "healpix",\n		"name": "PLWSAG-4ALL",\n		"baseUrl": "http://demonstrator.telespazio.com/sitools/ias-Alasky/PLWSAG-4ALLSKY/",\n		"description": "PLWSAG-4ALL",\n		"attribution": "PLWSAG-4ALLSKY provided by <a href=\\"http://idoc-herschel.ias.u-psud.fr/\\" target=\\"_blank\\"><img width=\'28\' height=\'16\' src=\\"http://demonstrator.telespazio.com/sitools/upload/idoc.svg\\" /></a>",\n		"visible": false,\n		"background": false,\n		"dataType": "jpg",\n        "numberOfLevels": 5,\n        "fitsSupported": true\n	},\n	/**\n	 *	IAS PMWSAG Healpix imagery\n	 *\n	 *	Plugin: Proxy Healpix Image cache\n	 *	urlClient: http://healpix.ias.u-psud.fr/PMWSAG-4ALLSKY/\n	 */\n	{\n		"category": "Herschel-SAG4",\n		"type": "healpix",\n		"name": "PMWSAG-4ALLSKY",\n		"baseUrl": "http://demonstrator.telespazio.com/sitools/ias-Alasky/PMWSAG-4ALLSKY/",\n		"description": "PLWSAG-4ALL",\n		"attribution": "PLWSAG-4ALL provided by <a href=\\"http://idoc-herschel.ias.u-psud.fr/\\" target=\\"_blank\\"><img width=\'28\' height=\'16\' src=\\"http://demonstrator.telespazio.com/sitools/upload/idoc.svg\\" /></a>",\n		"visible": false,\n		"background": false,\n		"dataType": "jpg",\n        "numberOfLevels": 5,\n        "fitsSupported": true\n	},\n	/**\n	 *	IAS PSWSAG Healpix imagery\n	 *\n	 *	Plugin: Proxy Healpix Image cache\n	 *	urlClient: http://healpix.ias.u-psud.fr/PSWSAG-4ALLSKY/\n	 */\n	{\n		"category": "Herschel-SAG4",\n		"type": "healpix",\n		"name": "PSWSAG-4ALLSKY",\n		"baseUrl": "http://demonstrator.telespazio.com/sitools/ias-Alasky/PSWSAG-4ALLSKY/",\n		"description": "PSWSAG-4ALLSKY",\n		"attribution": "PSWSAG-4ALLSKY provided by <a href=\\"http://idoc-herschel.ias.u-psud.fr/\\" target=\\"_blank\\"><img width=\'28\' height=\'16\' src=\\"http://demonstrator.telespazio.com/sitools/upload/idoc.svg\\" /></a>",\n		"visible": false,\n		"background": false,\n		"dataType": "jpg",\n        "numberOfLevels": 5,\n        "fitsSupported": true\n	},\n	/**\n	 *	IAS RGBSAG-4ALLSKYfromPNG Healpix imagery\n	 *\n	 *	Plugin: Proxy Healpix Image cache\n	 *	urlClient: http://healpix.ias.u-psud.fr/SAG-4_RGB/\n	 */\n	{\n		"category": "Herschel-SAG4",\n		"type": "healpix",\n		"name": "SAG4-Herschel-RGB",\n		"baseUrl": "http://demonstrator.telespazio.com/sitools/ias-Alasky/SAG-4_RGB",\n		"description": "combined bands (PSW, PMW, PLW)",\n		"attribution": "SAG4-Herschel-RGB provided by <a href=\\"http://idoc-herschel.ias.u-psud.fr/\\" target=\\"_blank\\"><img width=\'28\' height=\'16\' src=\\"http://demonstrator.telespazio.com/sitools/upload/idoc.svg\\" /></a>",\n		"visible": false,\n		"background": false,\n		"dataType": "png",\n        "numberOfLevels": 5,\n        "fitsSupported": true\n	},\n	/**\n	 *	OpenSearch SOLR Herschel layer\n	 *\n	 *	Plugin: OpenSearch Application\n	 *	queryShape: healpix\n	 *	healpixScheme: NESTED\n	 *	solrCore: herschel\n	 */\n	{\n        "category": "Herschel-SAG4",\n		"type": "DynamicOpenSearch",\n		"dataType": "line",\n		"name": "Pacs-SAG4-Herschel",\n		"serviceUrl": "http://demonstrator.telespazio.com/sitools/oherschel",\n		"visible": false,\n        "description": "SAG-4 : Evolution of interstellar dust (Herschel Guaranteed Time Key Project prepared by the ISM Specialist Astronomy Group of the SPIRE consortium) ",\n		"attribution": "SAG4 provided by <a href=\\"http://idoc-herschel.ias.u-psud.fr/\\" target=\\"_blank\\"><img width=\'28\' height=\'16\' src=\\"http://demonstrator.telespazio.com/sitools/upload/idoc.svg\\" /></a>",\n		"minOrder": 4,\n		"availableServices": [ "OpenSearch", "Moc", "XMatch" ]\n	},\n	/**\n	 *	OpenSearch SOLR Herschel layer\n	 *\n	 *	Plugin: OpenSearch Application\n	 *	queryShape: healpix\n	 *	healpixScheme: NESTED\n	 *	solrCore: spire-herschel\n	 */\n	{\n        "category": "Herschel-SAG4",\n		"type": "DynamicOpenSearch",\n		"dataType": "line",\n		"name": "Spire-SAG4-Herschel",\n		"serviceUrl": "http://demonstrator.telespazio.com/sitools/spireherschel",\n		"visible": false,\n		"minOrder": 4,\n        "description": "SAG-4 : Evolution of interstellar dust (Herschel Guaranteed Time Key Project prepared by the ISM Specialist Astronomy Group of the SPIRE consortium) ",\n		"attribution": "SAG4 provided by <a href=\\"http://idoc-herschel.ias.u-psud.fr/\\" target=\\"_blank\\"><img width=\'28\' height=\'16\' src=\\"http://demonstrator.telespazio.com/sitools/upload/idoc.svg\\" /></a>",\n		"availableServices": [ "OpenSearch", "Moc", "XMatch" ]\n	},\n	/**\n	 *	OpenSearch SIA ESO layer\n	 *\n	 *	Plugin: VO OpenSearchApplication for Sia\n	 *	siaSearchUrl: http://archive.eso.org/apps/siaserver/EsoProxySiap?\n	 */\n	{\n		"category": "Image",\n		"type": "DynamicOpenSearch",\n		"dataType": "line",\n		"name": "ESO",\n		"serviceUrl": "http://demonstrator.telespazio.com/sitools/eso/siap",\n        "displayProperties": [ "identifier","Instrument","Telescope name","quicklook"],\n		"visible": false,\n        "attribution":"<a href=\\"http://archive.eso.org/cms.html\\" target=\\"_blank\\"><img width=\'28\' height=\'28\' src=\\"http://demonstrator.telespazio.com/sitools/upload/eso.svg\\"></a>Science Archive Facility",\n		"minOrder": 4,\n		"invertY": true\n	},\n	/**\n	 *	OpenSearch Sia HST layer\n	 *\n	 *	Plugin: VO OpenSearch Application for Sia\n	 *	siaSearchUrl: http://archives.esac.esa.int/hst/hst-vo/hla_sia?REQUEST=queryData&\n	 */\n	{\n		"category": "Image",\n		"type": "DynamicOpenSearch",\n		"dataType": "line",\n		"name": "HST",\n		"serviceUrl": "http://demonstrator.telespazio.com/sitools/hst",\n        "description":"Hubble Space Telescope (HST) is an orbiting astronomical observatory operating from the near-infrared into the ultraviolet. Launched in 1990 and scheduled to operate through 2010, HST carries and has carried a wide variety of instruments producing imaging, spectrographic, astrometric, and photometric data through both pointed and parallel observing programs. MAST is the primary archive and distribution center for HST data, distributing science, calibration, and engineering data to HST users and the astronomical community at large. Over 100 000 observations of more than 20 000 targets are available for retrieval from the Archive.",\n		"visible": false,\n		"minOrder": 4,\n        "attribution":"HST data provided by <a href=\\"http://hst.esac.esa.int\\" target=\\"_blank\\"><img src=\\"http://demonstrator.telespazio.com/sitools/upload/esa.svg\\" width=\'28\' height=\'16\'/></a>"\n	},\n	/**\n	 *	OpenSearch Sia ISO layer\n	 *\n	 *	Plugin: VO OpenSearch Application for Sia\n	 *	siaSearchUrl: http://archives.esac.esa.int/ida/aio/jsp/siap.jsp?imageType=image&\n	 */\n	{\n		"category": "Image",\n		"type": "DynamicOpenSearch",\n		"dataType": "line",\n		"name": "Iso",\n		"serviceUrl": "http://demonstrator.telespazio.com/sitools/iso",\n		"visible": false,\n		"minOrder": 4,\n		"availableServices": [ "Moc", "XMatch" ]\n	},\n	/**\n	 *	OpenSearch ConeSearch I320 layer\n	 *\n	 *	Plugin: VO OpenSearch Application for Cone Search\n	 *	mocUrl: http://alasky.u-strasbg.fr/footprints/tables/vizier/I_320_spm4/MOC\n	 *	coneSearchUrl: http://vizier.u-strasbg.fr/viz-bin/votable/-A?-source=I/320/spm4&\n	 */\n	{\n		"category": "Catalog",\n		"type": "DynamicOpenSearch",\n		"dataType": "point",\n		"name": "SPM4",\n		"description":"The SPM4 Catalog contains absolute proper motions, celestial coordinates, and B,V photometry for 103,319,647 stars and galaxies between the south celestial pole and -20 degrees declination. The  catalog is roughly complete to V=17.5. It is based on photographic  and CCD observations taken with the Yale Southern Observatory\'s  double-astrograph at Cesco Observatory in El Leoncito, Argentina. The first-epoch survey, taken from 1965 to 1979, was entirely photographic. The second-epoch survey is approximately 1/3 photographic (taken from 1988 to 1998) and 2/3 CCD-based (taken  from 2004 through 2008). Full details about the creation of the SPM4.0 catalog can be found in the paper, and also in  the document \\"spm4_doc.txt\\" file which describes the original files, accessible from tttp://www.astro.yale.edu/astrom/spm4cat/",\n		"serviceUrl": "http://demonstrator.telespazio.com/sitools/i320",\n		"visible": false,\n		"minOrder": 9,\n		"availableServices": [ "Moc", "XMatch" ]\n	},\n	/**\n	 *	OpenSearch ConeSearch USNOB1 layer\n	 *\n	 *	Plugin: VO OpenSearch Application for Cone Search\n	 *	mocUrl: http://alasky.u-strasbg.fr/footprints/tables/vizier/I_284_out/MOC\n	 *	coneSearchUrl: http://vizier.u-strasbg.fr/viz-bin/votable/-A?-source=I/284&\n	 */\n	{\n		"category": "Catalog",\n		"type": "DynamicOpenSearch",\n		"dataType": "point",\n		"name": "USNO-B1.0",\n		"description":" The USNO-B1.0 is a catalog that presents positions, proper motions, magnitudes in various optical passbands, and star/galaxy estimators for 1,045,913,669 objects derived from 3,648,832,040 separate observations. The data were taken from scans of 7,435 Schmidt plates taken from various sky surveys during the last 50 years. The catalog is expected to be complete down to V=21; the estimated accuracies are 0.2arcsec for the positions at J2000, 0.3mag in up to 5 colors, and 85% accuracy for distinguishing stars from non-stellar objects.",\n		"attribution": "USNOB1 coming from <a href=\\"http://cdsweb.u-strasbg.fr/index-fr.gml\\" target=\\"_blank\\"><img width=\'24\' height=\'16\' src=\\"http://demonstrator.telespazio.com/mizar/css/images/cds.svg\\" /></a>",\n		"serviceUrl": "http://demonstrator.telespazio.com/sitools/usnob1",\n		"visible": false,\n		"minOrder": 9,\n		"availableServices": [ "Moc", "XMatch" ]\n	},\n	/**\n	 *	OpenSearch ConeSearch Hipparcos layer\n	 *\n	 *	Plugin: VO OpenSearch Application for Cone Search\n	 *	mocUrl: http://alasky.u-strasbg.fr/footprints/tables/vizier/I_239_tyc_main/MOC\n	 *	coneSearchUrl: http://vizier.u-strasbg.fr/viz-bin/votable/-A?-source=I/239&\n	 */\n	//{\n	//	"category": "Catalog",\n	//	"type": "DynamicOpenSearch",\n	//	"dataType": "point",\n	//	"name": "Hipparcos",\n	//	"description":" The Hipparcos and Tycho Catalogues are the primary products of the  European Space Agency\'s astrometric mission, Hipparcos. The satellite, which operated for four years, returned high quality scientific data from November 1989 to March 1993.",\n	//	"attribution": "Hipparcos coming from <a href=\\"http://cdsweb.u-strasbg.fr/index-fr.gml\\" target=\\"_blank\\"><img width=\'24\' height=\'16\' src=\\"http://demonstrator.telespazio.com/mizar/css/images/cds.svg\\" /></a>",\n	//	"serviceUrl": "/sitools/hipparcos",\n	//	"visible": false,\n	//	"minOrder": 5,\n	//	"availableServices": [ "Moc", "XMatch" ]\n	//},\n    /**\n     *      Built-in planets provider\n     */\n    {\n        "category": "Solar system",\n        "type": "GeoJSON",\n        "name": "Planets",\n        "icon": "http://demonstrator.telespazio.com/mizar/css/images/star_icon.png",\n        "description": "Planets",\n        "data": {\n                "type": "planets"\n        },\n        "visible": true,\n        "opacity": 100,\n        "pickable" : false\n    },\n\n	/**\n	 *	OpenSearch ConeSearch IMCCE layer\n	 *\n	 *	Plugin: VO OpenSearch Application for Cone Search\n	 *	mocUrl: http://alasky.u-strasbg.fr/footprints/tables/vizier/II_306_sdss8/MOC\n	 *	coneSearchUrl: http://vo.imcce.fr/webservices/skybot/skybotconesearch_query.php?from=SITools2&EPOCH=now&\n	 */\n	{\n		"category": "Solar system",\n		"type": "DynamicOpenSearch",\n		"dataType": "point",\n		"name": "IMCCE",\n		"serviceUrl": "http://demonstrator.telespazio.com/sitools/solar",\n		"minOrder": 7\n	},\n	/**\n	 *	OpenSearch ConeSearch exoplanet layer\n	 *\n	 *	Plugin: VO OpenSearch Application\n	 *	coneSearchUrl: http://exoplanet.eu/catalog/conesearch?\n	 */\n	{\n		"category": "Solar system",\n		"type": "DynamicOpenSearch",\n		"dataType": "point",\n		"name": "Exoplanets",\n		"description":"The Extrasolar Planets Encyclopaedia (http://exoplanet.eu)",\n		"serviceUrl": "http://demonstrator.telespazio.com/sitools/exoplanet",\n		"visible": false,\n		"minOrder": 3\n	},\n	/**\n	 *	OpenSearch ConeSearch COROT exo\n	 *\n	 *	Plugin: VO OpenSearch Application\n	 *	coneSearchUrl: http://vizier.u-strasbg.fr/viz-bin/votable/-A?-source=B/corot/exo&\n	 */\n	{\n		"category": "Corot",\n		"type": "DynamicOpenSearch",\n		"dataType": "point",\n		"name": "Corot exo",\n		"description":"CoRoT observation log Release 13 (CoRoT, 2009-2013). Stars observed in the exoplanet detection program",\n		"serviceUrl": "http://demonstrator.telespazio.com/sitools/corot/exo",\n		"visible": false,\n		"minOrder": 5,\n		"availableServices" : [ "Moc", "XMatch" ],\n        "attribution":"<img width=\'28\' height=\'16\' src=\\"http://demonstrator.telespazio.com/sitools/upload/corot.svg\\"> data provided by <a href=\\"http://cdsweb.u-strasbg.fr/index-fr.gml\\" target=\\"_blank\\"><img width=\'24\' height=\'16\' src=\\"http://demonstrator.telespazio.com/mizar/css/images/cds.svg\\" /></a>"\n	},\n	/**\n	 *	OpenSearch ConeSearch COROT exo\n	 *\n	 *	Plugin: VO OpenSearch Application\n	 *	coneSearchUrl: http://vizier.u-strasbg.fr/viz-bin/votable/-A?-source=B/corot/astero&\n	 */\n	{\n		"category": "Corot",\n		"type": "DynamicOpenSearch",\n		"dataType": "point",\n		"name": "Corot astero",\n		"description":"CoRoT observation log Release 13 (CoRoT, 2009-2013). Stars observed in the asterosismology program",\n		"serviceUrl": "http://demonstrator.telespazio.com/sitools/corot/astero",\n		"visible": false,\n		"minOrder": 5,\n		"availableServices" : [ "Moc", "XMatch" ],\n        "attribution":"<img width=\'28\' height=\'16\' src=\\"http://demonstrator.telespazio.com/sitools/upload/corot.svg\\"> data provided by <a href=\\"http://cdsweb.u-strasbg.fr/index-fr.gml\\" target=\\"_blank\\"><img width=\'24\' height=\'16\' src=\\"http://demonstrator.telespazio.com/mizar/css/images/cds.svg\\" /></a>"\n	}\n]'}),define("gw/HEALPixTables",[],function(){var e={ctab:[0,1,256,257,2,3,258,259,512,513,768,769,514,515,770,771,4,5,260,261,6,7,262,263,516,517,772,773,518,519,774,775,1024,1025,1280,1281,1026,1027,1282,1283,1536,1537,1792,1793,1538,1539,1794,1795,1028,1029,1284,1285,1030,1031,1286,1287,1540,1541,1796,1797,1542,1543,1798,1799,8,9,264,265,10,11,266,267,520,521,776,777,522,523,778,779,12,13,268,269,14,15,270,271,524,525,780,781,526,527,782,783,1032,1033,1288,1289,1034,1035,1290,1291,1544,1545,1800,1801,1546,1547,1802,1803,1036,1037,1292,1293,1038,1039,1294,1295,1548,1549,1804,1805,1550,1551,1806,1807,2048,2049,2304,2305,2050,2051,2306,2307,2560,2561,2816,2817,2562,2563,2818,2819,2052,2053,2308,2309,2054,2055,2310,2311,2564,2565,2820,2821,2566,2567,2822,2823,3072,3073,3328,3329,3074,3075,3330,3331,3584,3585,3840,3841,3586,3587,3842,3843,3076,3077,3332,3333,3078,3079,3334,3335,3588,3589,3844,3845,3590,3591,3846,3847,2056,2057,2312,2313,2058,2059,2314,2315,2568,2569,2824,2825,2570,2571,2826,2827,2060,2061,2316,2317,2062,2063,2318,2319,2572,2573,2828,2829,2574,2575,2830,2831,3080,3081,3336,3337,3082,3083,3338,3339,3592,3593,3848,3849,3594,3595,3850,3851,3084,3085,3340,3341,3086,3087,3342,3343,3596,3597,3852,3853,3598,3599,3854,3855],utab:[0,1,4,5,16,17,20,21,64,65,68,69,80,81,84,85,256,257,260,261,272,273,276,277,320,321,324,325,336,337,340,341,1024,1025,1028,1029,1040,1041,1044,1045,1088,1089,1092,1093,1104,1105,1108,1109,1280,1281,1284,1285,1296,1297,1300,1301,1344,1345,1348,1349,1360,1361,1364,1365,4096,4097,4100,4101,4112,4113,4116,4117,4160,4161,4164,4165,4176,4177,4180,4181,4352,4353,4356,4357,4368,4369,4372,4373,4416,4417,4420,4421,4432,4433,4436,4437,5120,5121,5124,5125,5136,5137,5140,5141,5184,5185,5188,5189,5200,5201,5204,5205,5376,5377,5380,5381,5392,5393,5396,5397,5440,5441,5444,5445,5456,5457,5460,5461,16384,16385,16388,16389,16400,16401,16404,16405,16448,16449,16452,16453,16464,16465,16468,16469,16640,16641,16644,16645,16656,16657,16660,16661,16704,16705,16708,16709,16720,16721,16724,16725,17408,17409,17412,17413,17424,17425,17428,17429,17472,17473,17476,17477,17488,17489,17492,17493,17664,17665,17668,17669,17680,17681,17684,17685,17728,17729,17732,17733,17744,17745,17748,17749,20480,20481,20484,20485,20496,20497,20500,20501,20544,20545,20548,20549,20560,20561,20564,20565,20736,20737,20740,20741,20752,20753,20756,20757,20800,20801,20804,20805,20816,20817,20820,20821,21504,21505,21508,21509,21520,21521,21524,21525,21568,21569,21572,21573,21584,21585,21588,21589,21760,21761,21764,21765,21776,21777,21780,21781,21824,21825,21828,21829,21840,21841,21844,21845],jrll:[2,2,2,2,3,3,3,3,4,4,4,4],jpll:[1,3,5,7,0,2,4,6,1,3,5,7],xoffset:[-1,-1,0,1,1,1,0,-1],yoffset:[0,1,1,1,0,-1,-1,-1],facearray:[[8,9,10,11,-1,-1,-1,-1,10,11,8,9],[5,6,7,4,8,9,10,11,9,10,11,8],[-1,-1,-1,-1,5,6,7,4,-1,-1,-1,-1],[4,5,6,7,11,8,9,10,11,8,9,10],[0,1,2,3,4,5,6,7,8,9,10,11],[1,2,3,0,0,1,2,3,5,6,7,4],[-1,-1,-1,-1,7,4,5,6,-1,-1,-1,-1],[3,0,1,2,3,0,1,2,4,5,6,7],[2,3,0,1,-1,-1,-1,-1,0,1,2,3]],swaparray:[[0,0,3],[0,0,6],[0,0,0],[0,0,5],[0,0,0],[5,0,0],[0,0,0],[6,0,0],[3,0,0]],swap_cycle:[[],[0,1,8,12,16,21,40],[0,1,2,40,114],[0,4,160,263],[0,4,30,49,51,87,526,1027,1105,1387,1807,2637],[0,8,10,18,39,74,146,307,452,4737],[0,1,2,7,9,17,80,410,1526,1921,32859,33566,38931],[0,5,6,10,12,24,27,95,372,494,924,1409,3492,4248,9137,66043,103369,156899],[0,1,2,3,4,45,125,351,697,24337,102940,266194,341855,419857],[0,1,2,3,9,16,1705,2082,2126,8177,12753,15410,52642,80493,83235,88387,99444,1675361,2495125],[0,2,6,8,9,11,20,50,93,152,183,2137,13671,44794,486954,741908,4803258,5692573],[0,1,5,6,44,53,470,2847,3433,4906,13654,14710,400447,1797382,2744492,18775974,23541521],[0,4,9,10,16,33,83,117,318,451,5759,10015,128975,171834,211256,347608,1278690,2154097,2590798,3427694,5581717,21012301,27023976,72522811,95032729,139166747,171822389],[0,5,10,267,344,363,2968,3159,9083,18437,76602,147614,1246902,1593138,2035574,6529391,9511830,11340287,29565945,281666026,677946848]]};return e}),define("gw/Long",[],function(){var e=function(e,t){this.low_=e|0,this.high_=t|0};return e.IntCache_={},e.fromInt=function(t){if(-128<=t&&t<128){var n=e.IntCache_[t];if(n)return n}var r=new e(t|0,t<0?-1:0);return-128<=t&&t<128&&(e.IntCache_[t]=r),r},e.fromNumber=function(t){return isNaN(t)||!isFinite(t)?e.ZERO:t<=-e.TWO_PWR_63_DBL_?e.MIN_VALUE:t+1>=e.TWO_PWR_63_DBL_?e.MAX_VALUE:t<0?e.fromNumber(-t).negate():new e(t%e.TWO_PWR_32_DBL_|0,t/e.TWO_PWR_32_DBL_|0)},e.fromBits=function(t,n){return new e(t,n)},e.TWO_PWR_16_DBL_=65536,e.TWO_PWR_24_DBL_=1<<24,e.TWO_PWR_32_DBL_=e.TWO_PWR_16_DBL_*e.TWO_PWR_16_DBL_,e.TWO_PWR_64_DBL_=e.TWO_PWR_32_DBL_*e.TWO_PWR_32_DBL_,e.TWO_PWR_63_DBL_=e.TWO_PWR_64_DBL_/2,e.ZERO=e.fromInt(0),e.ONE=e.fromInt(1),e.MAX_VALUE=e.fromBits(-1,2147483647),e.MIN_VALUE=e.fromBits(0,-2147483648),e.TWO_PWR_24_=e.fromInt(1<<24),e.prototype.toInt=function(){return this.low_},e.prototype.toNumber=function(){return this.high_*e.TWO_PWR_32_DBL_+this.getLowBitsUnsigned()},e.prototype.getLowBitsUnsigned=function(){return this.low_>=0?this.low_:e.TWO_PWR_32_DBL_+this.low_},e.prototype.isZero=function(){return this.high_==0&&this.low_==0},e.prototype.isNegative=function(){return this.high_<0},e.prototype.isOdd=function(){return(this.low_&1)==1},e.prototype.equals=function(e){return this.high_==e.high_&&this.low_==e.low_},e.prototype.lessThan=function(e){return this.compare(e)<0},e.prototype.greaterThanOrEqual=function(e){return this.compare(e)>=0},e.prototype.compare=function(e){if(this.equals(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.subtract(e).isNegative()?-1:1},e.prototype.negate=function(){return this.equals(e.MIN_VALUE)?e.MIN_VALUE:this.not().add(e.ONE)},e.prototype.add=function(t){var n=this.high_>>>16,r=this.high_&65535,i=this.low_>>>16,s=this.low_&65535,o=t.high_>>>16,u=t.high_&65535,a=t.low_>>>16,f=t.low_&65535,l=0,c=0,h=0,p=0;return p+=s+f,h+=p>>>16,p&=65535,h+=i+a,c+=h>>>16,h&=65535,c+=r+u,l+=c>>>16,c&=65535,l+=n+o,l&=65535,e.fromBits(h<<16|p,l<<16|c)},e.prototype.subtract=function(e){return this.add(e.negate())},e.prototype.multiply=function(t){if(this.isZero())return e.ZERO;if(t.isZero())return e.ZERO;if(this.equals(e.MIN_VALUE))return t.isOdd()?e.MIN_VALUE:e.ZERO;if(t.equals(e.MIN_VALUE))return this.isOdd()?e.MIN_VALUE:e.ZERO;if(this.isNegative())return t.isNegative()?this.negate().multiply(t.negate()):this.negate().multiply(t).negate();if(t.isNegative())return this.multiply(t.negate()).negate();if(this.lessThan(e.TWO_PWR_24_)&&t.lessThan(e.TWO_PWR_24_))return e.fromNumber(this.toNumber()*t.toNumber());var n=this.high_>>>16,r=this.high_&65535,i=this.low_>>>16,s=this.low_&65535,o=t.high_>>>16,u=t.high_&65535,a=t.low_>>>16,f=t.low_&65535,l=0,c=0,h=0,p=0;return p+=s*f,h+=p>>>16,p&=65535,h+=i*f,c+=h>>>16,h&=65535,h+=s*a,c+=h>>>16,h&=65535,c+=r*f,l+=c>>>16,c&=65535,c+=i*a,l+=c>>>16,c&=65535,c+=s*u,l+=c>>>16,c&=65535,l+=n*f+r*a+i*u+s*o,l&=65535,e.fromBits(h<<16|p,l<<16|c)},e.prototype.not=function(){return e.fromBits(~this.low_,~this.high_)},e.prototype.and=function(t){return e.fromBits(this.low_&t.low_,this.high_&t.high_)},e.prototype.or=function(t){return e.fromBits(this.low_|t.low_,this.high_|t.high_)},e.prototype.shiftRightUnsigned=function(t){t&=63;if(t==0)return this;var n=this.high_;if(t<32){var r=this.low_;return e.fromBits(r>>>t|n<<32-t,n>>>t)}return t==32?e.fromBits(n,0):e.fromBits(n>>>t-32,0)},e}),define("gw/HEALPixBase",["./HEALPixTables","./Long"],function(e,t){var n=1.570796325,r=function(e,t){e<0&&(e+=360);var n=e*Math.PI/180,r=(-t+90)*Math.PI/180;return[n,r]},i=function(e,t){if(e>=0)return e<t?e:e%t;var n=e%t+t;return n==t?0:n},s=function(t){return e.utab[t&255]|e.utab[t>>>8&255]<<16|e.utab[t>>>16&255]<<32|e.utab[t>>>24&255]<<48},o=function(e,t,n,r){return(n<<2*r)+s(e)+(s(t)<<1)},u=function(e,n,r){var s=Math.pow(2,e),u=Math.cos(r),n=n,a={phi:n,theta:r,z:u};Math.abs(u)>.9&&(a.sth=Math.sin(r),a.have_sth=!0);var f=2/Math.PI,l=i(n*f,4),c=Math.abs(u);if(c<=2/3){var h=s*(.5+l),p=s*u*.75,d=t.fromNumber(h-p),v=t.fromNumber(h+p),m=d.shiftRightUnsigned(e),g=v.shiftRightUnsigned(e),y;m.equals(g)?y=m.or(t.fromInt(4)):m.lessThan(g)?y=m:y=g.add(t.fromInt(8));var b=t.fromNumber(s-1),w=v.and(b),E=b.subtract(d.and(b));return o(w.toInt(),E.toInt(),y.toInt(),e)}var S=parseInt(Math.min(3,parseInt(l))),x=l-S,T=c<.9||!a.have_sth?s*Math.sqrt(3*(1-c)):s*a.sth/Math.sqrt((1+c)/3),d=t.fromNumber(x*T),v=t.fromNumber((1-x)*T),N=t.fromNumber(s),b=t.fromNumber(s-1),C=t.fromInt(1);return d.greaterThanOrEqual(N)&&(d=b),v.greaterThanOrEqual(N)&&(v=b),u>=0?o(N.subtract(v).subtract(C).toInt(),N.subtract(d).subtract(C).toInt(),S,e):o(d.toInt(),v.toInt(),S+8,e)},a={compress_bits:function(n){var r=t.fromNumber(n),i=t.fromNumber(0x5555555555555),s=r.and(i),o=s.shiftRightUnsigned(15);s=s.or(o);var u=s.and(t.fromNumber(65535)).toInt(),a=s.shiftRightUnsigned(32),f=a.and(t.fromNumber(65535)).toInt();return e.ctab[u&255]|e.ctab[u>>>8]<<4|e.ctab[f&255]<<16|e.ctab[f>>>8]<<20},fxyf:function(t,r,i){var s=e.jrll[i]-t-r,o=0,u=0,a=0,f=!1,l;if(s<1){l=s;var c=l*l/3;o=1-c,o>.99&&(a=Math.sqrt(c*(2-c)),f=!0)}else if(s>3){l=4-s;var c=l*l/3;o=c-1,o<-0.99&&(a=Math.sqrt(c*(2-c)),f=!0)}else l=1,o=(2-s)*2/3;var c=e.jpll[i]*l+t-r;c<0&&(c+=8),c>=8&&(c-=8),u=l<1e-15?0:.5*n*c/l;var h=f?a:Math.sqrt((1-o)*(1+o));return[h*Math.cos(u),h*Math.sin(u),o]},nside2order:function(e){var t=0;while(e>65535)t+=16,e>>>=16;return e>255&&(t|=8,e>>>=8),e>15&&(t|=4,e>>>=4),e>3&&(t|=2,e>>>=2),e>1&&(t|=1),t},lonLat2pix:function(e,t,n){var i=r(t,n);return u(e,i[0],i[1])}};return a}),define("gw/HEALPixTiling",["./Tile","./HEALPixBase","./GeoBound","./EquatorialCoordinateSystem","./Numeric","./AstroCoordTransform"],function(e,t,n,r,i,s){var o=function(e,t){this.order=e,this.nside=Math.pow(2,this.order),this.coordSystem=t.coordSystem||"EQ"};o.prototype.generateLevelZeroTiles=function(e,t){e.skirt=!1,e.cullSign=-1,e.tesselation=5,e.coordSystem=this.coordSystem;var n=[],r=Math.pow(this.nside,2),i=12,s=i*r;for(var o=0;o<s;o++){var a=Math.floor(o/r),f=new u(this.order,o,a);f.config=e,n.push(f)}return n},o.prototype.lonlat2LevelZeroIndex=function(e,n){if(this.coordSystem!="EQ"){var i=r.convert([e,n],"EQ",this.coordSystem);e=i[0],n=i[1]}return t.lonLat2pix(this.order,e,n)},o.prototype.findInsideTile=function(e,n,i){if(this.coordSystem!="EQ"){var s=r.convert([e,n],"EQ",this.coordSystem);e=s[0],n=s[1]}for(var o=0;o<i.length;o++){var u=i[o],a=t.lonLat2pix(u.order,e,n);if(a==u.pixelIndex)return u}return null};var u=function(t,n,r){e.prototype.constructor.call(this),this.order=t,this.nside=Math.pow(2,this.order),this.pixelIndex=n,this.face=r,this.geoBound=null};return u.prototype=new e,u.prototype.createChildren=function(){var e=new u(this.order+1,this.pixelIndex*4,this.face),t=new u(this.order+1,this.pixelIndex*4+2,this.face),n=new u(this.order+1,this.pixelIndex*4+1,this.face),r=new u(this.order+1,this.pixelIndex*4+3,this.face);e.initFromParent(this,0,0),t.initFromParent(this,1,0),n.initFromParent(this,0,1),r.initFromParent(this,1,1),this.children=[e,t,n,r]},u.prototype.computeLocalMatrix=function(e){var t=mat4.create(),n=vec3.create(),r=vec3.create(),i=vec3.create(),s=0,o=0,u=0;for(var a=0;a<e.length;a++)s+=e[a][0],o+=e[a][1],u+=e[a][2];var f=vec3.create([s/e.length,o/e.length,u/e.length]);return vec3.set(f,i),vec3.normalize(i),vec3.subtract(e[0],e[3],r),vec3.cross(i,r,n),vec3.normalize(n),vec3.cross(i,n,r),vec3.normalize(r),t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=0,t[4]=r[0],t[5]=r[1],t[6]=r[2],t[7]=0,t[8]=i[0],t[9]=i[1],t[10]=i[2],t[11]=0,t[12]=f[0],t[13]=f[1],t[14]=f[2],t[15]=1,t},u.prototype.generateVertices=function(){var e=this.config.tesselation,i=new Array,s=1/(e-1),o=this.pixelIndex&this.nside*this.nside-1,u=t.compress_bits(o),a=t.compress_bits(o>>>1);for(var f=0;f<e;f++)for(var l=0;l<e;l++)if(this.config.coordSystem!="EQ"){var c=t.fxyf((u+f*s)/this.nside,(a+l*s)/this.nside,this.face),h=r.from3DToGeo(c),p=r.convert(h,this.config.coordSystem,"EQ");i[f*e+l]=r.fromGeoTo3D(p)}else i[f*e+l]=t.fxyf((u+f*s)/this.nside,(a+l*s)/this.nside,this.face);this.geoBound=new n;var d=[];d.push(r.from3DToGeo(i[0])),d.push(r.from3DToGeo(i[e-1])),d.push(r.from3DToGeo(i[e*(e-1)])),d.push(r.from3DToGeo(i[e*e-1])),this.geoBound.computeFromCoordinates(d),this.matrix=this.computeLocalMatrix(i);var v=mat4.create();mat4.inverse(this.matrix,v),this.inverseMatrix=v;var m=new Float32Array(3*e*e),g=0;for(var y=0;y<i.length;y++)m[g]=v[0]*i[y][0]+v[4]*i[y][1]+v[8]*i[y][2]+v[12],m[g+1]=v[1]*i[y][0]+v[5]*i[y][1]+v[9]*i[y][2]+v[13],m[g+2]=v[2]*i[y][0]+v[6]*i[y][1]+v[10]*i[y][2]+v[14],g+=3;return m},o}),define("gw/RendererTileData",[],function(){var e=function(e){this.manager=e,this.renderables=[]};return e.prototype.initChild=function(t,n,r){var i;for(var s=0;s<this.renderables.length;s++)if(this.renderables[s].initChild){var o=this.renderables[s].initChild(n,r,t);o&&(i||(i=t.extension.renderer=new e(this.manager)),i.renderables.push(o))}},e.prototype.traverse=function(e,t){for(var n=0;n<this.renderables.length;n++){var r=this.renderables[n],i=r.bucket;if(i.layer._visible&&i.layer._opacity>0)if(r.traverse)r.traverse(this.manager,e,t);else{if(r.hasChildren&&!t)continue;this.manager.renderables.push(r)}}},e.prototype.getRenderable=function(e){for(var t=0;t<this.renderables.length;t++)if(e==this.renderables[t].bucket)return this.renderables[t];return null},e.prototype.dispose=function(e,t){for(var n=0;n<this.renderables.length;n++)this.renderables[n].dispose(e,t);this.renderables.length=0},e}),define("gw/RasterOverlayRenderer",["./Program","./Tile","./ImageRequest","./RendererTileData"],function(e,t,n,r){var i=function(e){this.vertexShader="	attribute vec3 vertex;\n	attribute vec2 tcoord;\n	uniform mat4 modelViewMatrix;\n	uniform mat4 projectionMatrix;\n	uniform vec4 textureTransform; \n	varying vec2 texCoord;\n	void main(void) \n	{\n		gl_Position = projectionMatrix * modelViewMatrix * vec4(vertex, 1.0);\n		texCoord = tcoord * textureTransform.xy + textureTransform.zw;\n	}\n	",this.fragmentShader="	precision lowp float;\n	varying vec2 texCoord;\n	uniform sampler2D overlayTexture;\n	uniform float opacity; \n	void main(void)\n	{\n		gl_FragColor.rgba = texture2D(overlayTexture, texCoord.xy); \n		gl_FragColor.a *= opacity; \n	}\n	",this.rendererManager=e.vectorRendererManager,this.tileManager=e.tileManager,this.programs=[],this.program=this.createProgram({vertexCode:this.vertexShader,fragmentCode:this.fragmentShader,updateUniforms:null}),this.buckets=[],this.imageRequests=[],this.frameNumber=0;var t=this;for(var r=0;r<4;r++){var i=new n({successCallback:function(){this.renderable&&(this.renderable.bucket.layer.handleImage&&this.renderable.bucket.layer.handleImage(this),this.renderable.ownTexture=t.tileManager.tilePool.createGLTexture(this.image),this.renderable.texture=this.renderable.ownTexture,this.renderable.uvScale=1,this.renderable.uTrans=0,this.renderable.vTrans=0,this.renderable.updateChildrenTexture(),this.renderable.onRequestFinished(!0),this.renderable=null,t.tileManager.renderContext.requestFrame())},failCallback:function(){this.renderable&&(this.renderable.onRequestFinished(!0),this.renderable=null)},abortCallback:function(){this.renderable&&(this.renderable.onRequestFinished(!1),this.renderable=null)}});this.imageRequests.push(i)}},s=function(e){this.bucket=e,this.ownTexture=null,this.texture=null,this.request=null,this.requestFinished=!1,this.tile=null,this.uvScale=1,this.uTrans=0,this.vTrans=0};s.prototype.onRequestStarted=function(e){this.request=e,this.requestFinished=!1;var t=this.bucket.layer;t._numRequests==0&&t.globe.publish("startLoad",t),t._numRequests++},s.prototype.onRequestFinished=function(e){this.request=null,this.requestFinished=e;var t=this.bucket.layer;t._numRequests--,t.globe&&t._numRequests==0&&t.globe.publish("endLoad",t)},s.prototype.initChild=function(e,t,n){var r=this.bucket.createRenderable();return r.tile=n,this.texture&&(r.texture=this.texture,r.uvScale=this.uvScale,r.uTrans=this.uTrans,r.vTrans=this.vTrans),r},s.prototype.generateChild=function(e){var t=this.bucket.renderer;t.addOverlayToTile(e,this.bucket,this)},s.prototype.updateChildrenTexture=function(){if(this.tile.children)for(var e=0;e<4;e++){var t=this.tile.children[e].extension.renderer;if(t){var n=t.getRenderable(this.bucket);n&&!n.ownTexture&&(n.updateTextureFromParent(this),n.updateChildrenTexture())}}},s.prototype.updateTextureFromParent=function(e){this.tile.state==t.State.LOADED?(this.texture=e.texture,this.uvScale=e.uvScale*.5,this.uTrans=e.uTrans,this.vTrans=e.vTrans,this.uTrans+=this.tile.parentIndex&1?this.uvScale:0,this.vTrans+=this.tile.parentIndex&2?this.uvScale:0):(this.texture=e.texture,this.uvScale=e.uvScale,this.uTrans=e.uTrans,this.vTrans=e.vTrans)},s.prototype.traverse=function(e,n,r){r&&this.texture&&e.renderables.push(this),!this.requestFinished&&this.tile.state==t.State.LOADED&&this.bucket.renderer.requestOverlayTextureForTile(this)},s.prototype.dispose=function(e,t){this.ownTexture&&(t.disposeGLTexture(this.ownTexture),this.ownTexture=null)};var o=function(e){this.layer=e,this.renderer=null,this.style=e};o.prototype.createRenderable=function(){return new s(this)},i.prototype.addOverlay=function(e){e._numRequests=0;var n=new o(e);n.renderer=this,n.id=this.rendererManager.bucketId++,this.buckets.push(n),e._bucket=n;for(var r=0;r<this.tileManager.level0Tiles.length;r++){var i=this.tileManager.level0Tiles[r];i.state==t.State.LOADED&&this.addOverlayToTile(i,n)}},i.prototype.removeOverlay=function(e){var t=this.buckets.indexOf(e._bucket);this.buckets.splice(t,1);var n=this.tileManager.renderContext,r=this.tileManager.tilePool;this.tileManager.visitTiles(function(t){var i=t.extension.renderer,s=i?i.getRenderable(e._bucket):null;if(s){var o=i.renderables.indexOf(s);i.renderables.splice(o,1),s.dispose(n,r),i.renderables.length==0&&delete t.extension.renderer}})},i.prototype.addOverlayToTile=function(e,n,i){if(!this.overlayIntersects(e.geoBound,n.layer))return;e.extension.renderer||(e.extension.renderer=new r(this.rendererManager));var s=n.createRenderable();s.tile=e,e.extension.renderer.renderables.push(s),i&&i.texture&&s.updateTextureFromParent(i);if(e.children)for(var o=0;o<4;o++)e.children[o].state==t.State.LOADED&&this.addOverlayToTile(e.children[o],n,s)};var u=function(e,t,n){return[t[0]+e*(n[0]-t[0]),t[1]+e*(n[1]-t[1])]};return i.prototype.clipPolygonToSide=function(e,t,n,r){var i=[];for(var s=0;s<r.length;s++){var o=r[s],a=r[(s+1)%r.length],f=o[e],l=a[e],c=(f-n)*t>=0,h=(l-n)*t>=0;if(!c&&h){var p=(n-f)/(l-f),d=u(p,o,a);i.push(d),i.push(a)}else if(c&&h)i.push(a);else if(c&&!h){var p=(n-f)/(l-f),d=u(p,o,a);i.push(d)}}return i},i.prototype.overlayIntersects=function(e,t){if(t.coordinates){var n;return n=this.clipPolygonToSide(0,1,e.west,t.coordinates),n=this.clipPolygonToSide(0,-1,e.east,n),n=this.clipPolygonToSide(1,1,e.south,n),n=this.clipPolygonToSide(1,-1,e.north,n),n.length>0}return t.geoBound?t.geoBound.intersects(e):!0},i.prototype.generateLevelZero=function(e){for(var t=0;t<this.buckets.length;t++)this.addOverlayToTile(e,this.buckets[t])},i.prototype.requestOverlayTextureForTile=function(e){if(!e.request){var t;for(var n=0;n<this.imageRequests.length;n++)if(!this.imageRequests[n].renderable){t=this.imageRequests[n];break}t&&(e.onRequestStarted(t),t.renderable=e,t.frameNumber=this.frameNumber,t.send(e.bucket.layer.getUrl(e.tile)))}else e.request.frameNumber=this.frameNumber},i.prototype.createProgram=function(t){var n=new e(this.tileManager.renderContext);return n.createFromSource(this.vertexShader,t.fragmentCode),n.id=this.programs.length,this.programs.push({fragmentCode:t.fragmentCode,program:n}),n},i.prototype.getProgram=function(e){var t;for(var n=0;n<this.programs.length;n++)this.programs[n].fragmentCode==e.fragmentCode&&(t=this.programs[n].program);return t||(t=this.createProgram(e)),t},i.prototype.render=function(e,n,r){var i=this.tileManager.renderContext,s=i.gl;s.enable(s.BLEND),s.blendFunc(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA),s.depthFunc(s.LEQUAL);var o=mat4.create(),u=null,a=null,f=null;for(var l=n;l<r;l++){var c=e[l],h=c.bucket,p=h.layer,d,v;p.customShader?(v=this.getProgram(p.customShader),d=p.customShader.updateUniforms):v=this.getProgram({vertexCode:this.vertexShader,fragmentCode:this.fragmentShader,updateUniforms:null}),v!=f&&(f=v,v.apply(),s.uniformMatrix4fv(v.uniforms.projectionMatrix,!1,i.projectionMatrix),s.uniform1i(v.uniforms.overlayTexture,0),s.bindBuffer(s.ARRAY_BUFFER,this.tileManager.tcoordBuffer),s.vertexAttribPointer(v.attributes.tcoord,2,s.FLOAT,!1,0,0)),d&&d(s,v),s.bindBuffer(s.ARRAY_BUFFER,c.tile.vertexBuffer),s.vertexAttribPointer(v.attributes.vertex,3,s.FLOAT,!1,0,0);var m=c.tile.state==t.State.LOADED?this.tileManager.tileIndexBuffer.getSolid():this.tileManager.tileIndexBuffer.getSubSolid(c.tile.parentIndex);a!=m&&(s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,m),a=m),mat4.multiply(i.viewMatrix,c.tile.matrix,o),s.uniformMatrix4fv(v.uniforms.modelViewMatrix,!1,o),s.uniform1f(v.uniforms.opacity,p._opacity),s.uniform4f(v.uniforms.textureTransform,c.uvScale,c.uvScale,c.uTrans,c.vTrans),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,c.texture),s.drawElements(s.TRIANGLES,a.numIndices,s.UNSIGNED_SHORT,0)}s.disable(s.BLEND),s.depthFunc(s.LESS)},i.prototype.canApply=function(e,t){return!1},i}),define("gw/RasterLayer",["./Utils","./BaseLayer","./RasterOverlayRenderer"],function(e,t,n){var r=function(e){t.prototype.constructor.call(this,e),this.tilePixelSize=-1,this.tiling=null,this.numberOfLevels=-1,this.geoBound=e.geoBound||null,this.coordinates=e.coordinates||null,this.zIndex=e.zIndex||0,this._overlay=!0,this._ready=!0};return e.inherits(t,r),r.prototype._attach=function(e){this._overlay||(this.id=0),t.prototype._attach.call(this,e);if(this._overlay){if(!e.rasterOverlayRenderer){var r=new n(e);e.vectorRendererManager.renderers.push(r),e.rasterOverlayRenderer=r}e.rasterOverlayRenderer.addOverlay(this)}},r.prototype._detach=function(){this._overlay&&this.globe.rasterOverlayRenderer&&this.globe.rasterOverlayRenderer.removeOverlay(this),t.prototype._detach.call(this)},r}),define("gw/HEALPixLayer",["./Utils","./HEALPixTiling","./RasterLayer"],function(e,t,n){var r=function(e){n.prototype.constructor.call(this,e),this.tilePixelSize=e.tilePixelSize||512,this.tiling=new t(e.baseLevel||2,e),this.numberOfLevels=e.numberOfLevels||10,this.type="ImageryRaster",this.baseUrl=e.baseUrl,this.dataType=e.dataType||"jpg",this.coordSystem=e.coordSystem||"EQ",this.levelZeroImage=new Image;var r=this;this.levelZeroImage.crossOrigin="",this.levelZeroImage.onload=function(){r._ready=!0,e.onready&&e.onready instanceof Function&&e.onready(r),r.globe&&r.globe.renderContext.requestFrame()},this.levelZeroImage.onerror=function(e){r.globe.publish("baseLayersError",r),r._ready=!1,console.log("Cannot load "+r.levelZeroImage.src)},this._ready=!1};return e.inherits(n,r),r.prototype._attach=function(e){n.prototype._attach.call(this,e),this._overlay||(this.levelZeroImage.src=this.baseUrl+"/Norder3/Allsky."+this.dataType)},r.prototype.getUrl=function(e){var t=this.baseUrl;t+="/Norder",t+=e.order,t+="/Dir";var n=Math.floor(e.pixelIndex/1e4)*1e4;return t+=n,t+="/Npix",t+=e.pixelIndex,t+="."+this.dataType,t},r.prototype.generateLevel0Textures=function(e,t){var n=document.createElement("canvas");n.width=128,n.height=128;var r=n.getContext("2d");for(var i=0;i<e.length;i++){var s=e[i],o=s.pixelIndex*4,u=o%27*64,a=Math.floor(o/27)*64;r.drawImage(this.levelZeroImage,u,a,64,64,0,0,64,64),o=s.pixelIndex*4+2;var u=o%27*64,a=Math.floor(o/27)*64;r.drawImage(this.levelZeroImage,u,a,64,64,64,0,64,64),o=s.pixelIndex*4+1;var u=o%27*64,a=Math.floor(o/27)*64;r.drawImage(this.levelZeroImage,u,a,64,64,0,64,64,64),o=s.pixelIndex*4+3;var u=o%27*64,a=Math.floor(o/27)*64;r.drawImage(this.levelZeroImage,u,a,64,64,64,64,64,64);var f=r.getImageData(0,0,128,128);f.dataType="byte",s.texture=t.createGLTexture(f),s.imageSize=128}},r}),define("gw/Mesh",[],function(){var e=function(e){this.renderContext=e,this.vertexBuffer=null,this.tcoordBuffer=null,this.indexBuffer=null,this.colorBuffer=null,this.numVertices=0,this.mode=e.gl.TRIANGLES};return e.prototype.setVertices=function(e){var t=this.renderContext.gl;this.vertexBuffer==null&&(this.vertexBuffer=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e),t.STATIC_DRAW),this.numVertices=e.length},e.prototype.setTexCoords=function(e){var t=this.renderContext.gl;this.tcoordBuffer==null&&(this.tcoordBuffer=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,this.tcoordBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e),t.STATIC_DRAW)},e.prototype.setColors=function(e){var t=this.renderContext.gl;this.colorBuffer==null&&(this.colorBuffer=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e),t.STATIC_DRAW)},e.prototype.setIndices=function(e){var t=this.renderContext.gl;this.indexBuffer==null&&(this.indexBuffer=t.createBuffer()),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(e),t.STATIC_DRAW),this.numIndices=e.length},e.prototype.setIndicesToWireframe=function(e){this.mode=this.renderContext.gl.LINES;var t=[];t.length=2*e.length;for(var n=0;n<e.length;n+=3)t[2*n]=e[n],t[2*n+1]=e[n+1],t[2*n+2]=e[n+1],t[2*n+3]=e[n+2],t[2*n+4]=e[n+2],t[2*n+5]=e[n];this.setIndices(t)},e.prototype.render=function(e){var t=this.renderContext.gl;t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.vertexAttribPointer(e.vertex,3,t.FLOAT,!1,0,0),e.hasOwnProperty("tcoord")&&(t.bindBuffer(t.ARRAY_BUFFER,this.tcoordBuffer),t.vertexAttribPointer(e.tcoord,2,t.FLOAT,!1,0,0)),e.hasOwnProperty("color")&&(t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.vertexAttribPointer(e.color,4,t.FLOAT,!1,0,0)),this.indexBuffer?(t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.drawElements(this.mode,this.numIndices,t.UNSIGNED_SHORT,0)):t.drawArrays(this.mode,0,this.numVertices/3)},e.prototype.dispose=function(){var e=this.renderContext.gl;this.indexBuffer&&e.deleteBuffer(this.indexBuffer),this.vertexBuffer&&e.deleteBuffer(this.vertexBuffer),this.tcoordBuffer&&e.deleteBuffer(this.tcoordBuffer),this.colorBuffer&&e.deleteBuffer(this.colorBuffer),this.indexBuffer=null,this.vertexBuffer=null,this.tcoordBuffer=null,this.colorBuffer=null},e}),define("gw/CoordinateGridLayer",["./BaseLayer","./Utils","./Program","./Mesh","./CoordinateSystem","./AstroCoordTransform","./FeatureStyle"],function(e,t,n,r,i,s,o){function a(e,t){var n;switch(e){case"Deg":n=t+"¬∞";break;case"HMS":n=i.fromDegreesToHMS(t);break;case"DMS":n=i.fromDegreesToDMS(t);break;default:return console.error(e+" : format not supported"),null}return n}var u=function(t){e.prototype.constructor.call(this,t),this.globe=null,this.labels={},this.texturePool=null,this.longitudeSample=t.longitudeSample||15,this.latitudeSample=t.latitudeSample||10,this.canvas2d=document.createElement("canvas"),this.canvas2d.width=100,this.canvas2d.height=20,this.vertexBuffer=null,this.indexBuffer=null,this.color=t.color||[1,1,1],this.coordSystem=t.coordSystem?t.coordSystem:"EQ",this.longFormat=t.longFormat?t.longFormat:"Deg",this.latFormat=t.latFormat?t.latFormat:"Deg",this.geoBound={},this.tesselation=t.tesselation||2};t.inherits(e,u),u.prototype.generateImageData=function(e){var t=this.canvas2d.getContext("2d");t.clearRect(0,0,this.canvas2d.width,this.canvas2d.height),t.fillStyle=o.fromColorToString(this.color),t.font="18px sans-serif",t.textBaseline="top",t.textAlign="center";var n=this.canvas2d.width/2;return t.fillText(e,n,0),t.getImageData(0,0,this.canvas2d.width,this.canvas2d.height)},u.prototype._attach=function(t){e.prototype._attach.call(this,t),this._visible&&this.globe.tileManager.addPostRenderer(this);if(!this.gridProgram){var i="		attribute vec3 vertex;\n		uniform mat4 viewProjectionMatrix;\n		void main(void) \n		{\n			gl_Position = viewProjectionMatrix * vec4(vertex, 1.0);\n		}\n		",s="		precision highp float; \n		uniform float alpha; \n		uniform vec3 color; \n		void main(void)\n		{\n			gl_FragColor = vec4(color,alpha);\n		}\n		",o="		attribute vec3 vertex; // vertex have z = 0, spans in x,y from -0.5 to 0.5 \n		uniform mat4 viewProjectionMatrix; \n		uniform vec3 poiPosition; // world position \n		uniform vec2 poiScale; // x,y scale \n		\n		varying vec2 texCoord; \n		\n		void main(void)  \n		{ \n			// Generate texture coordinates, input vertex goes from -0.5 to 0.5 (on x,y) \n			texCoord = vertex.xy + vec2(0.5); \n			// Invert y \n			texCoord.y = 1.0 - texCoord.y; \n			\n			// Compute poi position in clip coordinate \n			gl_Position = viewProjectionMatrix * vec4(poiPosition, 1.0); \n			gl_Position.xy += vertex.xy * gl_Position.w * poiScale; \n		} \n		",u="		#ifdef GL_ES \n		precision highp float; \n		#endif \n		\n		varying vec2 texCoord; \n		uniform sampler2D texture; \n		uniform float alpha; \n		\n		void main(void) \n		{ \n			vec4 textureColor = texture2D(texture, texCoord); \n			gl_FragColor = vec4(textureColor.rgb, textureColor.a * alpha); \n		} \n		";this.gridProgram=new n(this.globe.renderContext),this.labelProgram=new n(this.globe.renderContext),this.gridProgram.createFromSource(i,s),this.labelProgram.createFromSource(o,u)}this.labelMesh=new r(this.globe.renderContext);var a=[-0.5,-0.5,0,-0.5,.5,0,.5,.5,0,.5,-0.5,0],l=[0,3,1,1,3,2];this.labelMesh.setVertices(a),this.labelMesh.setIndices(l);var c=this.globe.renderContext.gl;this.vertexBuffer=c.createBuffer(),this.indexBuffer=c.createBuffer(),this.texturePool||(this.texturePool=new f(c))},u.prototype._detach=function(){var t=this.globe.renderContext.gl;t.deleteBuffer(this.vertexBuffer),t.deleteBuffer(this.indexBuffer),this.texturePool.disposeAll();for(var n in this.labels)delete this.labels[n];this.globe.tileManager.removePostRenderer(this),e.prototype._detach.call(this)},u.prototype.clampGeoBound=function(e){return e.west=Math.floor(e.west/this.longitudeSample)*this.longitudeSample,e.east=Math.ceil(e.east/this.longitudeSample)*this.longitudeSample,e.north=Math.ceil(e.north/this.latitudeSample)*this.latitudeSample,e.south=Math.floor(e.south/this.latitudeSample)*this.latitudeSample,e},u.prototype.render=function(e){var t=this.globe.renderContext,n=t.gl;n.disable(n.DEPTH_TEST),n.enable(n.BLEND),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA);var r;if(this.coordSystem!="EQ"){var s=this;r=this.globe.getViewportGeoBound(function(e){return i.convert(e,"EQ",s.coordSystem)})}else r=this.globe.getViewportGeoBound();r=this.clampGeoBound(r),this.geoBound.west!=r.west||this.geoBound.east!=r.east||this.geoBound.north!=r.north||this.geoBound.south!=r.south?(this.geoBound=r,this.computeSamples(),this.generateGridBuffers(),this.generateLabels()):this.updateLabels(),this.gridProgram.apply(),mat4.multiply(t.projectionMatrix,t.viewMatrix,t.modelViewMatrix),n.uniformMatrix4fv(this.gridProgram.uniforms.viewProjectionMatrix,!1,t.modelViewMatrix),n.uniform1f(this.gridProgram.uniforms.alpha,this._opacity),n.uniform3f(this.gridProgram.uniforms.color,this.color[0],this.color[1],this.color[2]),n.bindBuffer(n.ARRAY_BUFFER,this.vertexBuffer),n.vertexAttribPointer(this.gridProgram.attributes.vertex,this.vertexBuffer.itemSize,n.FLOAT,!1,0,0),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer),n.drawElements(n.LINES,this.indexBuffer.numItems,n.UNSIGNED_SHORT,0),this.labelProgram.apply(),mat4.multiply(t.projectionMatrix,t.viewMatrix,t.modelViewMatrix),n.uniformMatrix4fv(this.labelProgram.uniforms.viewProjectionMatrix,!1,t.modelViewMatrix),n.uniform1i(this.labelProgram.uniforms.texture,0);var o=t.computePixelSizeVector();for(var u in this.labels){var a=this.labels[u];n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,a.texture);var f=[2*a.textureWidth/t.canvas.width,2*a.textureHeight/t.canvas.height];n.uniform2fv(this.labelProgram.uniforms.poiScale,f);var l=a.pos3d,c=a.vertical;f=a.textureHeight*(o[0]*l[0]+o[1]*l[1]+o[2]*l[2]+o[3]);var h=c[0]*f+l[0],p=c[1]*f+l[1],d=c[2]*f+l[2];n.uniform3f(this.labelProgram.uniforms.poiPosition,h,p,d),n.uniform1f(this.labelProgram.uniforms.alpha,1),this.labelMesh.render(this.labelProgram.attributes),a.needed=!1}n.enable(n.DEPTH_TEST),n.disable(n.BLEND)},u.prototype.visible=function(e){return typeof e=="boolean"&&this._visible!=e&&(this._visible=e,e?this.globe.tileManager.addPostRenderer(this):this.globe.tileManager.removePostRenderer(this)),this._visible},u.prototype.opacity=function(t){return e.prototype.opacity.call(this,t)},u.prototype.computeSamples=function(){var e=this.geoBound.east-this.geoBound.west,t=this.geoBound.north-this.geoBound.south;while(e/this.longitudeSample<3&&this.longitudeSample>1)this.longitudeSample/=2,this.latitudeSample/=2;while(e/this.longitudeSample>7&&this.longitudeSample<15)this.longitudeSample*=2,this.latitudeSample*=2},u.prototype.generateGridBuffers=function(){var e,t;this.geoBound.east-this.geoBound.west>180?(e=0,t=360):(e=this.geoBound.west,t=this.geoBound.east);var n=[],r=180/this.latitudeSample;for(var s=0;s<=r;s++){var o=s*Math.PI/r,u=Math.sin(o),a=Math.cos(o);for(var f=e;f<=t;f+=this.longitudeSample){var l=this.longitudeSample/this.tesselation;for(var c=0;c<this.tesselation;c++){var h=(f+c*l)*Math.PI/180,p=Math.sin(h),d=Math.cos(h),v=d*u,m=p*u,g=a;if(this.coordSystem!="EQ"){var y=i.from3DToGeo([v,m,g]);y=i.convert(y,this.coordSystem,"EQ");var b=i.fromGeoTo3D(y);n.push(b[0],b[1],b[2])}else n.push(v,m,g)}}}var w=this.globe.renderContext.gl;w.bindBuffer(w.ARRAY_BUFFER,this.vertexBuffer),w.bufferData(w.ARRAY_BUFFER,new Float32Array(n),w.STATIC_DRAW),this.vertexBuffer.itemSize=3,this.vertexBuffer.numItems=n.length/3;var E=[],S=(t-e)/this.longitudeSample+1;S*=this.tesselation;for(var s=0;s<r;s++)for(var f=e,x=0;f<t;f+=this.longitudeSample,x+=this.tesselation){var T=s*S+x%(S-1),N=T+S;for(var c=0;c<this.tesselation;c++)E.push(T+c),E.push(T+c+1);E.push(T+this.tesselation),E.push(N+this.tesselation),E.push(N),E.push(T)}w.bindBuffer(w.ELEMENT_ARRAY_BUFFER,this.indexBuffer),w.bufferData(w.ELEMENT_ARRAY_BUFFER,new Uint16Array(E),w.STATIC_DRAW),this.indexBuffer.itemSize=1,this.indexBuffer.numItems=E.length},u.prototype.computeGeoCenter=function(){var e=this.globe.renderContext.get3DFromPixel(this.globe.renderContext.canvas.width/2,this.globe.renderContext.canvas.height/2),t=[];return i.from3DToGeo(e,t),this.coordSystem!="EQ"&&(t=i.convert(t,"EQ",this.coordSystem)),t},u.prototype.updateLabel=function(e,t){this.coordSystem!="EQ"&&(t=i.convert(t,this.coordSystem,"EQ"));var n=i.fromGeoTo3D(t),r=vec3.create();vec3.normalize(n,r),this.labels[e].pos3d=n,this.labels[e].vertical=r,this.labels[e].needed=!0},u.prototype.updateLabels=function(){var e=this.computeGeoCenter();for(var t in this.labels){var n;this.labels[t].type=="lat"?n=[this.labels[t].angle,e[1]]:this.labels[t].type=="long"&&(n=[e[0],this.labels[t].angle]),this.updateLabel(t,n)}},u.prototype.generateLabels=function(){var e,t;this.geoBound.east-this.geoBound.west>180?(t=0,e=360):(t=this.geoBound.west,e=this.geoBound.east);var n=this.computeGeoCenter(),r;for(var i=t;i<e;i+=this.longitudeSample){var s=i<0?i+360:i;r=a(this.longFormat,s);if(!this.labels["lat_"+r]){this.labels["lat_"+r]={angle:i,type:"lat"};var o=this.generateImageData(r);this._buildTextureFromImage(this.labels["lat_"+r],o)}var u=[i,n[1]];this.updateLabel("lat_"+r,u)}thetaStart=Math.min(this.geoBound.north,this.geoBound.south),thetaStop=Math.max(this.geoBound.north,this.geoBound.south);for(var f=thetaStart;f<=thetaStop;f+=this.latitudeSample){r=a(this.latFormat,f);if(!this.labels["long_"+r]){this.labels["long_"+r]={angle:f,type:"long"};var o=this.generateImageData(r);this._buildTextureFromImage(this.labels["long_"+r],o)}var u=[n[0],f];this.updateLabel("long_"+r,u)}for(var l in this.labels)this.labels[l].needed||(this.texturePool.disposeGLTexture(this.labels[l].texture),delete this.labels[l])},u.prototype._buildTextureFromImage=function(e,t){e.texture=this.texturePool.createGLTexture(t),e.textureWidth=t.width,e.textureHeight=t.height};var f=function(e){var e=e,t=[];this.createGLTexture=function(e){return t.length>0?r(e):n(e)},this.disposeGLTexture=function(e){t.push(e)},this.disposeAll=function(){for(var n=0;n<t.length;n++)e.deleteTexture(t[n]);t.length=0};var n=function(t){var n=e.createTexture();return e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),n},r=function(n){var r=t.pop();return e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),r}};return u}),define("gw/TileWireframeLayer",["./Utils","./BaseLayer","./Program","./Tile"],function(e,t,n,r){var i=function(e){t.prototype.constructor.call(this,e),this.outline=e&&e.outline?e.outline:!1,this.globe=null,this.program=null,this.indexBuffer=null,this.subIndexBuffer=[null,null,null,null]};return e.inherits(t,i),i.prototype.buildIndexBuffer=function(){var e=this.globe.renderContext.gl,t=this.globe.tileManager.tileConfig.tesselation,n=[],r=this.outline?t-1:1;for(var i=0;i<t;i+=r)for(var s=0;s<t-1;s++)n.push(i*t+s),n.push(i*t+s+1);for(var i=0;i<t;i+=r)for(var s=0;s<t-1;s++)n.push(s*t+i),n.push((s+1)*t+i);var o=e.createBuffer();e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,o),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(n),e.STATIC_DRAW),o.numIndices=n.length,this.indexBuffer=o;var u=(t-1)/2;r=this.outline?u:1;for(var a=0;a<4;a++){var s=a%2,i=Math.floor(a/2),n=[];for(var f=u*i;f<u*(i+1)+1;f+=r)for(var l=u*s;l<u*(s+1);l++)n.push(f*t+l),n.push(f*t+l+1);for(var f=u*s;f<u*(s+1)+1;f+=r)for(var l=u*i;l<u*(i+1);l++)n.push(l*t+f),n.push((l+1)*t+f);var o=e.createBuffer();e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,o),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(n),e.STATIC_DRAW),o.numIndices=n.length,this.subIndexBuffer[a]=o}},i.prototype._attach=function(e){t.prototype._attach.call(this,e),this._visible&&this.globe.tileManager.addPostRenderer(this);if(!this.program){var r="		attribute vec3 vertex;\n		uniform mat4 modelViewMatrix;\n		uniform mat4 projectionMatrix;\n		void main(void) \n		{\n			gl_Position = projectionMatrix * modelViewMatrix * vec4(vertex, 1.0);\n		}\n		",i="		precision highp float; \n		uniform float alpha; \n		void main(void)\n		{\n				gl_FragColor = vec4(1.0,1.0,1.0,alpha);\n		}\n		";this.program=new n(this.globe.renderContext),this.program.createFromSource(r,i),this.buildIndexBuffer()}},i.prototype._detach=function(){this.globe.tileManager.removePostRenderer(this),t.prototype._detach.call(this)},i.prototype.render=function(e){var t=this.globe.renderContext,n=t.gl;n.enable(n.BLEND),this.program.apply(),n.uniformMatrix4fv(this.program.uniforms.projectionMatrix,!1,t.projectionMatrix);var i=this.program.attributes.vertex,s=null;for(var o=0;o<e.length;o++){var u=e[o],a=u.state==r.State.LOADED,f=u.parentIndex==-1;mat4.multiply(t.viewMatrix,u.matrix,t.modelViewMatrix),n.uniformMatrix4fv(this.program.uniforms.modelViewMatrix,!1,t.modelViewMatrix),n.uniform1f(this.program.uniforms.alpha,this.opacity()),n.bindBuffer(n.ARRAY_BUFFER,u.vertexBuffer),n.vertexAttribPointer(i,3,n.FLOAT,!1,4*u.config.vertexSize,0);var l=a||f?this.indexBuffer:this.subIndexBuffer[u.parentIndex];s!=l&&(n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,l),s=l);var c=s.numIndices;n.drawElements(n.LINES,s.numIndices,n.UNSIGNED_SHORT,0)}n.disable(n.BLEND)},i.prototype.visible=function(e){return typeof e=="boolean"&&this._visible!=e&&(this._visible=e,e?this.globe.tileManager.addPostRenderer(this):this.globe.tileManager.removePostRenderer(this)),this._visible},i}),define("gw/OpenSearchLayer",["./FeatureStyle","./VectorRendererManager","./Utils","./BaseLayer","./RendererTileData","./CoordinateSystem","./Tile"],function(e,t,n,r,i,s,o){function f(e,t){return e.tile.distance-t.tile.distance}var u=function(t){r.prototype.constructor.call(this,t),this.serviceUrl=t.serviceUrl,this.minOrder=t.minOrder||5,this.maxRequests=t.maxRequests||2,this.requestProperties="",this.invertY=t.invertY||!1,this.coordSystemRequired=t.hasOwnProperty("coordSystemRequired")?t.coordSystemRequired:!0,t&&t.style?this.style=t.style:this.style=new e,this.extId="os",this.features=[],this.featuresSet={},this.freeRequests=[],this.tilesToLoad=[];for(var n=0;n<this.maxRequests;n++){var i=new XMLHttpRequest;this.freeRequests.push(i)}};n.inherits(r,u),u.prototype._attach=function(e){r.prototype._attach.call(this,e),this.extId+=this.id,e.tileManager.addPostRenderer(this)},u.prototype._detach=function(){this.globe.tileManager.removePostRenderer(this),r.prototype._detach.call(this)},u.prototype.launchRequest=function(e,t){var n=e.extension[this.extId],r=null;if(this.freeRequests.length==0)return;n.state=u.TileState.LOADING,this.requestProperties!=""&&(t+="&"+this.requestProperties),this.maxRequests==this.freeRequests.length&&this.globe.publish("startLoad",this);var i=this.freeRequests.pop(),s=this;i.onreadystatechange=function(t){if(i.readyState==4){if(i.status==200){var r=JSON.parse(i.response);n.complete=r.totalResults==r.features.length,s.updateFeatures(r.features);for(var o=0;o<r.features.length;o++)s.addFeature(r.features[o],e)}else i.status>=400&&(n.complete=!0,console.error(i.responseText));n.state=u.TileState.LOADED,s.freeRequests.push(i),s.maxRequests==s.freeRequests.length&&s.globe.publish("endLoad",s)}},i.open("GET",t),i.send()},u.prototype.setRequestProperties=function(e){for(var t in this.featuresSet){var n=this.featuresSet[t];for(var r=0;r<n.tiles.length;r++){var i=n.tiles[r],s=this.features[n.index];this.globe.vectorRendererManager.removeGeometryFromTile(this,s.geometry,i)}}var o=this;this.globe.tileManager.visitTiles(function(e){e.extension[o.extId]&&(e.extension[o.extId].dispose(),e.extension[o.extId].featureIds=[],e.extension[o.extId].state=u.TileState.NOT_LOADED,e.extension[o.extId].complete=!1)}),this.featuresSet={},this.features=[],this.requestProperties="";for(var a in e)this.requestProperties!=""&&(this.requestProperties+="&"),this.requestProperties+=a+"="+e[a]},u.prototype.addFeature=function(e,t){var n=t.extension[this.extId],r;this.featuresSet.hasOwnProperty(e.properties.identifier)?(r=this.featuresSet[e.properties.identifier],r.tiles.push(t),e=this.features[r.index]):(this.features.push(e),r={index:this.features.length-1,tiles:[t]},this.featuresSet[e.properties.identifier]=r),n.featureIds.push(e.properties.identifier),e.geometry.gid=e.properties.identifier;var i=e.properties.style?e.properties.style:this.style;this.globe.vectorRendererManager.addGeometryToTile(this,e.geometry,i,t)},u.prototype.removeFeature=function(e,t){var n=this.featuresSet[e];if(!n)return;var r=n.tiles.indexOf(t);r>=0?n.tiles.splice(r,1):console.log("OpenSearchLayer internal error : tile not found when removing feature");if(n.tiles.length==0){delete this.featuresSet[e];var i=this.features.pop();n.index<this.features.length&&(this.features[n.index]=i,this.featuresSet[i.properties.identifier].index=n.index)}},u.prototype.modifyFeatureStyle=function(e,t){e.properties.style=t;var n=this.featuresSet[e.properties.identifier];if(n)for(var r=0;r<n.tiles.length;r++){var i=n.tiles[r];this.globe.vectorRendererManager.removeGeometryFromTile(e.geometry,i),this.globe.vectorRendererManager.addGeometryToTile(this,e.geometry,t,i)}},u.TileState={LOADING:0,LOADED:1,NOT_LOADED:2,INHERIT_PARENT:3},u.prototype.generate=function(e){e.order==this.minOrder&&(e.extension[this.extId]=new a(this,e,null))};var a=function(e,t,n){this.layer=e,this.parent=n,this.tile=t,this.featureIds=[],this.state=u.TileState.NOT_LOADED,this.complete=!1,this.childrenCreated=!1};return a.prototype.traverse=function(e){if(!this.layer._visible)return;if(e.state!=o.State.LOADED)return;this.state==u.TileState.NOT_LOADED&&this.layer.tilesToLoad.push(this);if(this.state==u.TileState.LOADED&&!this.complete&&e.state==o.State.LOADED&&e.children&&!this.childrenCreated){for(var t=0;t<4;t++)e.children[t].extension[this.layer.extId]||(e.children[t].extension[this.layer.extId]=new a(this.layer,e.children[t],this));this.childrenCreated=!0;var n=e.extension.renderer?e.extension.renderer.renderables:[];for(var t=0;t<n.length;t++)n[t].bucket.layer==this.layer&&(n[t].hasChildren=!0)}},a.prototype.dispose=function(e,t){if(this.parent&&this.parent.childrenCreated){this.parent.childrenCreated=!1;var n=this.parent.tile.extension.renderer?this.parent.tile.extension.renderer.renderables:[];for(var r=0;r<n.length;r++)n[r].bucket.layer==this.layer&&(n[r].hasChildren=!1)}for(var r=0;r<this.featureIds.length;r++)this.layer.removeFeature(this.featureIds[r],this.tile);this.tile=null,this.parent=null},u.prototype.buildUrl=function(e){var t=this.serviceUrl+"/search?order="+e.order+"&healpix="+e.pixelIndex;return this.coordSystemRequired&&(t+="&coordSystem=EQUATORIAL"),t+="&media=json",t},u.prototype.render=function(e){if(!this._visible)return;this.tilesToLoad.sort(f);for(var t=0;t<this.tilesToLoad.length&&this.freeRequests.length>0;t++){var n=this.tilesToLoad[t].tile,r=this.buildUrl(n);r&&this.launchRequest(n,r)}this.tilesToLoad.length=0},u.prototype.updateFeatures=function(e){for(var t=0;t<e.length;t++){var n=e[t];switch(n.geometry.type){case"Point":n.geometry.coordinates[0]>180&&(n.geometry.coordinates[0]-=360);break;case"Polygon":var r=n.geometry.coordinates[0];for(var i=0;i<r.length;i++)r[i][0]>180&&(r[i][0]-=360);break;default:}}},u}),define("ClusterOpenSearchLayer",["gw/FeatureStyle","gw/Utils","gw/OpenSearchLayer","gw/HEALPixBase","gw/CoordinateSystem","gw/RendererTileData"],function(e,t,n,r,i,s){var o=function(t){n.prototype.constructor.call(this,t),this.treshold=t.treshold||5,this.maxClusterOrder=t.maxClusterOrder||8,this.accuracyOrder=t.accuracyOrder||10,this.coordSystemRequired=t.hasOwnProperty("coordSystemRequired")?t.coordSystemRequired:!0,this.distributions=null,this.clusterServiceUrl=null,this.handleClusterService(),this.clusterStyle=new e(this.style),this.clusterStyle.iconUrl=t.clusterIconUrl||"css/images/cluster.png",this.clusterBucket=null};return t.inherits(n,o),o.prototype._detach=function(){n.prototype._detach.call(this),this.clusterBucket=null},o.prototype.handleClusterService=function(){var e=new XMLHttpRequest,t=this;e.onreadystatechange=function(r){if(e.readyState==4)if(e.status==200){var i=e.responseXML.getElementsByTagName("Url");for(var s=0;s<i.length;s++)if(i[s].attributes.getNamedItem("rel")&&i[s].attributes.getNamedItem("rel").nodeValue=="clusterdesc"){var o=i[s].attributes.getNamedItem("template").nodeValue;if(o){var u=o.indexOf("q=");u!=-1?t.clusterServiceUrl=o.substring(0,u):t.clusterServiceUrl=o,t.updateDistributions(t)}break}s==i.length&&(t.prototype=n.prototype)}else t.prototype=n.prototype},e.open("GET",this.serviceUrl),e.send()},o.prototype.updateDistributions=function(e){var t=new XMLHttpRequest,n=e.clusterServiceUrl+e.requestProperties;t.onreadystatechange=function(n){if(t.readyState==4&&t.status==200){var r=JSON.parse(t.response);e.handleDistribution(r)}},t.open("GET",n),t.send()},o.prototype.handleDistribution=function(e){var t={},n=e.facet_counts.facet_fields,r=3;for(var i in n){t[r]={};for(var s=0;s<n[i].length;s+=2)t[r][n[i][s]]=n[i][s+1];r++}this.distributions=t},o.prototype.addCluster=function(t,n,s,o,u){var a=Math.pow(2,n),f=t&a*a-1,l=r.compress_bits(f),c=r.compress_bits(f>>>1),h=r.fxyf((l+.5)/a,(c+.5)/a,s),p=i.from3DToGeo(h),d=h,v=vec3.create();vec3.normalize(d,v);var m={coordinates:p,type:"Point"},g=n+"_"+t,y={geometry:m,properties:{featureNum:o,identifier:g,title:"Cluster("+o+")",order:n,pixelIndex:t,style:new e(this.clusterStyle)},cluster:!0};u.extension[this.extId].containsCluster=!0,this.addFeature(y,u)},o.prototype.launchRequest=function(e,t){var r=e.extension[this.extId],i=null;if(this.freeRequests.length==0)return;r.state=n.TileState.LOADING,this.requestProperties!=""&&(t+="&"+this.requestProperties),this.maxRequests==this.freeRequests.length&&this.globe.publish("startLoad",this);var s=this.freeRequests.pop(),o=this;s.onreadystatechange=function(t){if(s.readyState==4){if(s.status==200){var i=JSON.parse(s.response);r.containsCluster||(r.complete=i.totalResults==i.features.length),o.updateFeatures(i.features);if(i.features.length>0)for(var u=0;u<i.features.length;u++)o.addFeature(i.features[u],e)}else s.status>=400&&console.error(s.responseText);r.state=n.TileState.LOADED,o.freeRequests.push(s),o.maxRequests==o.freeRequests.length&&o.globe.publish("endLoad",o)}},s.open("GET",t),s.send()},o.prototype.buildUrl=function(e){if(this.distributions&&e.order<this.maxClusterOrder){var t=[],r=this.accuracyOrder-e.order,i=this.accuracyOrder;if(this.distributions[i]){var s=Math.pow(4,r),o=e.pixelIndex*s;for(var u=o;u<o+s;u++){var a=this.distributions[i][u];a>this.treshold?this.addCluster(u,this.accuracyOrder,e.face,a,e):a>0&&t.push(u)}}if(t.length>0){var f="";for(var l=0;l<t.length-1;l++)f+=t[l]+",";f+=t[l];var c=this.serviceUrl+"/search?order="+i+"&healpix="+f;return c}return e.extension[this.extId].containsCluster||(e.extension[this.extId].complete=!0),e.extension[this.extId].state=n.TileState.LOADED,null}return n.prototype.buildUrl.call(this,e)},o.prototype.setRequestProperties=function(e){n.prototype.setRequestProperties.call(this,e),this.distributions=null,this.updateDistributions(this)},o}),define("MocLayer",["jquery","gw/BaseLayer","gw/FeatureStyle","gw/Utils","gw/HEALPixBase","gw/CoordinateSystem"],function(e,t,n,r,i,s){var o=function(e){t.prototype.constructor.call(this,e),this.serviceUrl=e.serviceUrl,this.startOrder=e.startOrder||2,e&&e.style?this.style=new n(e.style):this.style=new n,this.featuresSet=null};return r.inherits(t,o),o.prototype._attach=function(n){t.prototype._attach.call(this,n);var r=this;e.ajax({type:"GET",url:r.serviceUrl,dataType:"json",success:function(e){r.handleDistribution(e)},error:function(t,n,i){e("#addLayer_"+r.id).find("label").css("color","red"),console.error(t.responseText)}}),n.tileManager.addPostRenderer(this)},o.prototype.generate=function(e){if(this.featuresSet&&e.order==this.startOrder){var t=this.featuresSet[e.pixelIndex];if(t)for(var n=0;n<t.length;n++)this.globe.vectorRendererManager.addGeometryToTile(this,t[n],this.style,e)}},o.prototype.render=function(){},o.prototype._detach=function(){for(var e in this.featuresSet){var n=this.globe.tileManager.level0Tiles[e];for(var r=0;r<this.featuresSet[e].length;r++)this.globe.vectorRendererManager.removeGeometryFromTile(this.featuresSet[e][r],n)}this.featuresSet=null,this.globe.tileManager.removePostRenderer(this),t.prototype._detach.call(this)},o.prototype.findChildIndices=function(e,t){var n=this.startOrder,r=n-t,i=Math.pow(4,r),s=e*i,o=[];for(var u=s;u<s+i;u++)o.push(u);return o},o.prototype.findParentIndex=function(e,t){var n=this.startOrder,r=t-n,i=Math.floor(e/Math.pow(4,r));return i},o.prototype.handleDistribution=function(e){var t=this.globe.tileManager.renderContext.gl;this.featuresSet={};for(var n in e){var r=parseInt(n);for(var o=0;o<e[n].length;o++){var u=e[n][o];if(r>this.startOrder)var a=this.findParentIndex(u,r);else{if(r!=this.startOrder){var f=this.findChildIndices(u,r);e[this.startOrder.toString()]=e[this.startOrder.toString()].concat(f);continue}var a=u}var l={type:"Polygon",gid:"moc"+this.id+"_"+r+"_"+u,coordinates:[[]]},c=2,h=1;r<5&&(c=5,h=1/(c-1));var p=Math.pow(2,r),d=u&p*p-1,v=i.compress_bits(d),m=i.compress_bits(d>>>1),g=u>>>2*r,y,b;for(var w=0;w<2;w++)for(var E=0;E<c;E++)y=i.fxyf((v+w*(c-1)*h)/p,(m+E*h)/p,g),b=s.from3DToGeo(y),w==0?l.coordinates[0][2*w*c+(c-1)-E]=[b[0],b[1]]:l.coordinates[0][2*w*c+E]=[b[0],b[1]];for(var E=0;E<2;E++)for(var w=0;w<c;w++)y=i.fxyf((v+w*h)/p,(m+E*(c-1)*h)/p,g),b=s.from3DToGeo(y),E==1?l.coordinates[0][c+2*E*c+(c-1)-w]=[b[0],b[1]]:l.coordinates[0][c+2*E*c+w]=[b[0],b[1]];var S=this.globe.tileManager.level0Tiles[a];this.featuresSet[a]||(this.featuresSet[a]=[]),this.featuresSet[a].push(l),this.globe.vectorRendererManager.addGeometryToTile(this,l,this.style,S)}}},o}),define("gw/ColorMap",[],function(){function r(e,t,n,r,i,s){var o;if(r==e.UNSIGNED_BYTE)o=new Uint8Array(t);else{if(r!=e.FLOAT)return null;o=new Float32Array(t)}var u=e.createTexture();return e.bindTexture(e.TEXTURE_2D,u),e.texImage2D(e.TEXTURE_2D,0,n,i,s,0,n,r,o),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),u}var e={linear:[],asin:[],sqrt:[],sqr:[],log:[]},t=function(){for(var t in e){var n=Number.MAX_VALUE,r=Number.MIN_VALUE,i,s=[];for(var o=0;o<256;o++){i=o;switch(t){case"linear":s[o]=i;break;case"asin":s[o]=Math.log(i+Math.sqrt(Math.pow(i,2)+1));break;case"log":s[o]=Math.log(i/10+1);break;case"sqrt":s[o]=Math.sqrt(i/10);break;case"sqr":s[o]=i*i;break;default:}s[o]<n&&(n=s[o]),s[o]>r&&(r=s[o])}for(o=0;o<256;o++)i=256*((s[o]-n)/(r-n)),i>256?i=256:i<0&&(i=0),e[t][o]=Math.floor(i)}};t();var n={fire:{red:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,4,7,10,13,16,19,22,25,28,31,34,37,40,43,46,49,52,55,58,61,64,67,70,73,76,79,82,85,88,91,94,98,101,104,107,110,113,116,119,122,125,128,131,134,137,140,143,146,148,150,152,154,156,158,160,162,163,164,166,167,168,170,171,173,174,175,177,178,179,181,182,184,185,186,188,189,190,192,193,195,196,198,199,201,202,204,205,207,208,209,210,212,213,214,215,217,218,220,221,223,224,226,227,229,230,231,233,234,235,237,238,240,241,243,244,246,247,249,250,252,252,252,253,253,253,254,254,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255],green:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,3,5,7,8,10,12,14,16,19,21,24,27,29,32,35,37,40,43,46,48,51,54,57,59,62,65,68,70,73,76,79,81,84,87,90,92,95,98,101,103,105,107,109,111,113,115,117,119,121,123,125,127,129,131,133,134,136,138,140,141,143,145,147,148,150,152,154,155,157,159,161,162,164,166,168,169,171,173,175,176,178,180,182,184,186,188,190,191,193,195,197,199,201,203,205,206,208,210,212,213,215,217,219,220,222,224,226,228,230,232,234,235,237,239,241,242,244,246,248,248,249,250,251,252,253,254,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255],blue:[0,7,15,22,30,38,45,53,61,65,69,74,78,82,87,91,96,100,104,108,113,117,121,125,130,134,138,143,147,151,156,160,165,168,171,175,178,181,185,188,192,195,199,202,206,209,213,216,220,220,221,222,223,224,225,226,227,224,222,220,218,216,214,212,210,206,202,199,195,191,188,184,181,177,173,169,166,162,158,154,151,147,143,140,136,132,129,125,122,118,114,111,107,103,100,96,93,89,85,82,78,74,71,67,64,60,56,53,49,45,42,38,35,31,27,23,20,16,12,8,5,4,3,3,2,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,8,13,17,21,26,30,35,42,50,58,66,74,82,90,98,105,113,121,129,136,144,152,160,167,175,183,191,199,207,215,223,227,231,235,239,243,247,251,255,255,255,255,255,255,255,255]},eosb:{red:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,18,27,36,45,49,57,72,81,91,100,109,118,127,136,131,139,163,173,182,191,200,209,218,227,213,221,255,255,255,255,255,255,255,255,229,229,255,255,255,255,255,255,255,255,229,229,255,255,255,255,255,255,255,255,229,229,255,255,255,255,255,255,255,255,229,229,255,255,255,255,255,255,255,255,229,229,255,255,255,255,255,255,255,255,229,229,255,255,255,255,255,255,255,255,229,229,255,255,255,255,255,255,255,255,229,229,255,255,255,255,255,255,255,255,229,229,255,253,251,249,247,245,243,241,215,214,235,234,232,230,228,226,224,222,198,196,216,215,213,211,209,207,205,203,181,179,197,196,194,192,190,188,186,184,164,162,178,176,175,173,171,169,167,165,147,145,159,157,156,154,152,150,148,146,130,128,140,138,137,135,133,131,129,127,113,111,121,119,117,117],green:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,15,23,31,39,47,55,57,64,79,87,95,103,111,119,127,135,129,136,159,167,175,183,191,199,207,215,200,207,239,247,255,255,255,255,255,255,229,229,255,255,255,255,255,255,255,255,229,229,255,255,255,255,255,255,255,255,229,229,255,250,246,242,238,233,229,225,198,195,212,208,204,199,195,191,187,182,160,156,169,165,161,157,153,148,144,140,122,118,127,125,123,121,119,116,114,112,99,97,106,104,102,99,97,95,93,91,80,78,84,82,80,78,76,74,72,70,61,59,63,61,59,57,55,53,50,48,42,40,42,40,38,36,33,31,29,27,22,21,21,19,16,14,12,13,8,6,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],blue:[116,121,127,131,136,140,144,148,153,157,145,149,170,174,178,182,187,191,195,199,183,187,212,216,221,225,229,233,238,242,221,225,255,247,239,231,223,215,207,199,172,164,175,167,159,151,143,135,127,119,100,93,95,87,79,71,63,55,47,39,28,21,15,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},stern:{red:[0,18,36,54,72,90,108,127,145,163,199,217,235,254,249,244,239,234,229,223,218,213,208,203,197,192,187,182,177,172,161,156,151,146,140,135,130,125,120,115,109,104,99,94,89,83,78,73,68,63,52,47,42,37,32,26,21,16,11,6,64,65,66,67,68,69,70,71,72,73,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,117,118,119,120,121,122,123,124,125,126,128,129,130,131,132,133,134,135,136,137,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,181,182,183,184,185,186,187,188,189,190,192,193,194,195,196,197,198,199,200,201,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,245,246,247,248,249,250,251,252,253,254],green:[0,1,2,3,4,5,6,7,8,9,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,53,54,55,56,57,58,59,60,61,62,64,65,66,67,68,69,70,71,72,73,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,117,118,119,120,121,122,123,124,125,126,128,129,130,131,132,133,134,135,136,137,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,181,182,183,184,185,186,187,188,189,190,192,193,194,195,196,197,198,199,200,201,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,245,246,247,248,249,250,251,252,253,254],blue:[0,1,3,5,7,9,11,13,15,17,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,63,65,67,69,71,73,75,77,79,81,83,85,87,89,91,93,95,97,99,101,105,107,109,111,113,115,117,119,121,123,127,129,131,133,135,137,139,141,143,145,149,151,153,155,157,159,161,163,165,167,169,171,173,175,177,179,181,183,185,187,191,193,195,197,199,201,203,205,207,209,211,213,215,217,219,221,223,225,227,229,233,235,237,239,241,243,245,247,249,251,255,251,247,243,238,234,230,226,221,217,209,204,200,196,192,187,183,179,175,170,166,162,158,153,149,145,141,136,132,128,119,115,111,107,102,98,94,90,85,81,77,73,68,64,60,56,51,47,43,39,30,26,22,17,13,9,5,0,3,7,15,19,22,26,30,34,38,41,45,49,57,60,64,68,72,76,79,83,87,91,95,98,102,106,110,114,117,121,125,129,137,140,144,148,152,156,159,163,167,171,175,178,182,186,190,194,197,201,205,209,216,220,224,228,232,235,239,243,247,251]},rainbow:{red:[0,4,9,13,18,22,27,31,36,40,45,50,54,58,61,64,68,69,72,74,77,79,80,82,83,85,84,86,87,88,86,87,87,87,85,84,84,84,83,79,78,77,76,71,70,68,66,60,58,55,53,46,43,40,36,33,25,21,16,12,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,8,12,21,25,29,33,42,46,51,55,63,67,72,76,80,89,93,97,101,110,114,119,123,131,135,140,144,153,157,161,165,169,178,182,187,191,199,203,208,212,221,225,229,233,242,246,250,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255],green:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,8,16,21,25,29,38,42,46,51,55,63,67,72,76,84,89,93,97,106,110,114,119,127,131,135,140,144,152,157,161,165,174,178,182,187,195,199,203,208,216,220,225,229,233,242,246,250,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,250,242,238,233,229,221,216,212,208,199,195,191,187,178,174,170,165,161,153,148,144,140,131,127,123,119,110,106,102,97,89,85,80,76,72,63,59,55,51,42,38,34,29,21,17,12,8,0],blue:[0,3,7,10,14,19,23,28,32,38,43,48,53,59,63,68,72,77,81,86,91,95,100,104,109,113,118,122,127,132,136,141,145,150,154,159,163,168,173,177,182,186,191,195,200,204,209,214,218,223,227,232,236,241,245,250,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,246,242,238,233,225,220,216,212,203,199,195,191,187,178,174,170,165,157,152,148,144,135,131,127,123,114,110,106,102,97,89,84,80,76,67,63,59,55,46,42,38,34,25,21,16,12,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},grey:{red:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255],green:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255],blue:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]}};return{generateColormap:function(t,i,s,o){var u=e[i],a=[],f,l,c;f=n[s].red,l=n[s].green,c=n[s].blue;var h=f.length-1;for(var p=0;p<256;p++){var d=u[p];d>h?d=h:d<0&&(d=0),o&&(d=h-d),a[p*3]=f[d]/256,a[p*3+1]=l[d]/256,a[p*3+2]=c[d]/256}return r(t,a,t.RGB,t.FLOAT,a.length/3,1)}}}),define("gw/DynamicImage",["./ColorMap"],function(e){var t="		precision highp float; \n		varying vec2 vTextureCoord;\n		uniform sampler2D texture; \n		uniform sampler2D colormap; \n		uniform float min; \n		uniform float max; \n		uniform vec4 color; \n		void main(void)\n		{\n			float i = texture2D(texture,vTextureCoord).r;\n			float d = clamp( ( i - min ) / (max - min), 0.0, 1.0 );\n			vec4 cmValue = texture2D(colormap, vec2(d,0.));\n			gl_FragColor = vec4(cmValue.r,cmValue.g,cmValue.b,color.a);\n		}\n		",n=function(e,t,n){n||(n=t.polygonProgram),e.uniform1f(n.uniforms.max,t.style.uniformValues.tmax),e.uniform1f(n.uniforms.min,t.style.uniformValues.tmin),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,t.style.uniformValues.colormapTex),e.uniform1i(n.uniforms.colormap,1)},r=function(e,r,i,s,o,u,a){t=a&&a.fragmentCode?a.fragmentCode:t,n=a&&a.updateUniforms?a.updateUniforms:n,this.fragmentCode=t,this.updateUniforms=n,this.tmin=0,this.tmax=1,this.colormapTex=null,this.renderContext=e,this.pixels=r,this.transferFn="raw",this.inverse=!1;var f=e.gl,l=f.createTexture();f.bindTexture(f.TEXTURE_2D,l),f.texImage2D(f.TEXTURE_2D,0,i,o,u,0,i,s,r);if(s==f.FLOAT){var c=f.getExtension("OES_texture_float_linear"),h=c?f.LINEAR:f.NEAREST;f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,h),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,h)}else f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR_MIPMAP_LINEAR),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.LINEAR);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),this.texture=l,this.width=o,this.height=u,this.computeMinMax(r),e.requestFrame()};return r.prototype.computeMinMax=function(e){var t=Number.MIN_VALUE,n=Number.MAX_VALUE;for(var r=1;r<e.length;r++){var i=e[r];if(isNaN(i))continue;t<i&&(t=i),n>i&&(n=i)}this.min=n,this.max=t,this.tmax=t,this.tmin=n},r.prototype.updateColormap=function(r,i,s){var o=this.renderContext.gl;r!="raw"?(this.fragmentCode=t,this.updateUniforms=n,this.colormapTex&&o.deleteTexture(this.colormapTex),this.colormapTex=e.generateColormap(o,r,i,s)):(this.fragmentCode=null,this.updateUniforms=null),this.transferFn=r,this.inverse=s},r.prototype.dispose=function(){var e=this.renderContext.gl;this.colormapTex&&e.deleteTexture(this.colormapTex),this.texture&&e.deleteTexture(this.texture),this.colormapTex=null,this.texture=null},r}),function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1},m={}.hasOwnProperty,g=function(e,t){function r(){this.constructor=e}for(var n in t)m.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},y=[].slice,b=function(e,t){return function(){return e.apply(t,arguments)}};this.astro==null&&(this.astro={}),i={},i.version="0.2.3",this.astro.FITS=i,d=["included","extended"],c=function(){function e(){}return e.include=function(e){var t,n,r;if(!e)throw"include(obj) requires obj";for(t in e)n=e[t],v.call(d,t)<0&&(this.prototype[t]=n);return(r=e.included)!=null&&r.apply(this),this},e.extend=function(e){var t,n,r;if(!e)throw"extend(obj) requires obj";for(t in e)n=e[t],v.call(d,t)<0&&(this[t]=n);return(r=e.extended)!=null&&r.apply(this),this},e.proxy=function(e){var t=this;return function(){return e.apply(t,arguments)}},e.prototype.proxy=function(e){var t=this;return function(){return e.apply(t,arguments)}},e}(),this.astro.FITS.Module=c,n=function(e){function t(e,t){this.view=e,this.begin=this.current=e.tell(),this.length=void 0}return g(t,e),t}(c),this.astro.FITS.DataUnit=n,a={verifyOrder:function(e,t){if(t!==this.cardIndex)return console.warn(""+e+" should appear at index "+this.cardIndex+" in the FITS header")},verifyBetween:function(e,t,n,r){if(!(t>=n&&t<=r))throw"The "+e+" value of "+t+" is not between "+n+" and "+r},verifyBoolean:function(e){return e==="T"?!0:!1},Functions:{SIMPLE:function(){var e,t;return e=1<=arguments.length?y.call(arguments,0):[],t=arguments[0],this.primary=!0,this.verifyOrder("SIMPLE",0),this.verifyBoolean(t)},XTENSION:function(){var e,t;return e=1<=arguments.length?y.call(arguments,0):[],t=arguments[0],this.extension=!0,this.extensionType=t,this.verifyOrder("XTENSION",0),t},BITPIX:function(){var e,t,n;e=1<=arguments.length?y.call(arguments,0):[],t="BITPIX",n=parseInt(arguments[0]),this.verifyOrder(t,1);if(n!==8&&n!==16&&n!==32&&n!==64&&n!==-32&&n!==-64)throw""+t+" value "+n+" is not permitted";return n},NAXIS:function(){var e,t,n,r,i,s;e=1<=arguments.length?y.call(arguments,0):[],n="NAXIS",i=parseInt(arguments[0]),t=arguments[1];if(!t){this.verifyOrder(n,2),this.verifyBetween(n,i,0,999);if(this.isExtension())if((s=this.extensionType)==="TABLE"||s==="BINTABLE"){r=2;if(i!==r)throw""+n+" must be "+r+" for TABLE and BINTABLE extensions"}}return i},PCOUNT:function(){var e,t,n,r,i,s;e=1<=arguments.length?y.call(arguments,0):[],t="PCOUNT",i=parseInt(arguments[0]),n=3+this.NAXIS,this.verifyOrder(t,n);if(this.isExtension())if((s=this.extensionType)==="IMAGE"||s==="TABLE"){r=0;if(i!==r)throw""+t+" must be "+r+" for the "+this.extensionType+" extensions"}return i},GCOUNT:function(){var e,t,n,r,i,s;e=1<=arguments.length?y.call(arguments,0):[],t="GCOUNT",i=parseInt(arguments[0]),n=3+this.NAXIS+1,this.verifyOrder(t,n);if(this.isExtension())if((s=this.extensionType)==="IMAGE"||s==="TABLE"||s==="BINTABLE"){r=1;if(i!==r)throw""+t+" must be "+r+" for the "+this.extensionType+" extensions"}return i},EXTEND:function(){var e,t,n;e=1<=arguments.length?y.call(arguments,0):[],t="EXTEND",n=arguments[0];if(!this.isPrimary())throw""+t+" must only appear in the primary header";return this.verifyBoolean(n)},BSCALE:function(){var e;return e=1<=arguments.length?y.call(arguments,0):[],parseFloat(arguments[0])},BZERO:function(){var e;return e=1<=arguments.length?y.call(arguments,0):[],parseFloat(arguments[0])},BLANK:function(){var e,t,n;return e=1<=arguments.length?y.call(arguments,0):[],t="BLANK",n=arguments[0],parseInt(n)},DATAMIN:function(){var e;return e=1<=arguments.length?y.call(arguments,0):[],parseFloat(arguments[0])},DATAMAX:function(){var e;return e=1<=arguments.length?y.call(arguments,0):[],parseFloat(arguments[0])},EXTVER:function(){var e,t,n;return e=1<=arguments.length?y.call(arguments,0):[],t="EXTVER",n=arguments[0],n=parseInt(n),n},EXTLEVEL:function(){var e,t,n;return e=1<=arguments.length?y.call(arguments,0):[],t="EXTLEVEL",n=arguments[0],n=parseInt(n),n},TFIELDS:function(){var e,t,n;return e=1<=arguments.length?y.call(arguments,0):[],t="TFIELDS",n=arguments[0],n=parseInt(n),this.verifyBetween(t,n,0,999),n},TBCOL:function(){var e,t,n,r;return e=1<=arguments.length?y.call(arguments,0):[],n="TBCOL",r=arguments[0],t=arguments[2],this.verifyBetween(n,t,0,this.TFIELDS),r},ZIMAGE:function(){var e,t,n;return e=1<=arguments.length?y.call(arguments,0):[],t="ZIMAGE",n=arguments[0],this.verifyBoolean(n)},ZCMPTYPE:function(){var e,t,n;e=1<=arguments.length?y.call(arguments,0):[],t="ZCMPTYPE",n=arguments[0];if(n!=="GZIP_1"&&n!=="RICE_1"&&n!=="PLIO_1"&&n!=="HCOMPRESS_1")throw""+t+" value "+n+" is not permitted";if(n!=="RICE_1"&&n!=="GZIP_1")throw"Compress type "+n+" is not yet implement";return n},ZBITPIX:function(){var e,t,n;e=1<=arguments.length?y.call(arguments,0):[],t="ZBITPIX",n=parseInt(arguments[0]);if(n!==8&&n!==16&&n!==32&&n!==64&&n!==-32&&n!==-64)throw""+t+" value "+n+" is not permitted";return n},ZNAXIS:function(){var e,t,n,r;return e=1<=arguments.length?y.call(arguments,0):[],n="ZNAXIS",r=parseInt(arguments[0]),t=arguments[1],r=r,t||this.verifyBetween(n,r,0,999),r},ZTILE:function(){var e,t;return e=1<=arguments.length?y.call(arguments,0):[],t="ZTILE",parseInt(arguments[0])},ZSIMPLE:function(){var e;return e=1<=arguments.length?y.call(arguments,0):[],arguments[0]==="T"?!0:!1},ZPCOUNT:function(){var e,t;return e=1<=arguments.length?y.call(arguments,0):[],t="ZPCOUNT",parseInt(arguments[0])},ZGCOUNT:function(){var e,t;return e=1<=arguments.length?y.call(arguments,0):[],t="ZGCOUNT",parseInt(arguments[0])}}},this.astro.FITS.HeaderVerify=a,u=function(e){function t(){this.init=b(this.init,this);var e,t,n;this.primary=!1,this.extension=!1,this.verifyCard={},n=this.Functions;for(t in n)e=n[t],this.verifyCard[t]=this.proxy(e);this.cards={},this.cardIndex=0}return g(t,e),t.keywordPattern=/^([A-Z0-9_-]+)\s*=\s*(.*)/,t.nonStringPattern=/([^\/]*)\s*\/*(.*)/,t.stringPattern=/'(.*)'\s*\/*(.*)/,t.arrayPattern=/([A-Za-z]+)(\d+)/,t.include(a),t.prototype.get=function(e){return this.contains(e)?this.cards[e]:console.warn("Header does not contain the key "+e)},t.prototype.getIndex=function(e){return this.contains(e)?this.cards[e][0]:console.warn("Header does not contain the key "+e)},t.prototype.getComment=function(e){return this.contains(e)?this.cards[e][2]!=null?this.cards[e][2]:console.warn(""+e+" does not contain a comment"):console.warn("Header does not contain the key "+e)},t.prototype.getComments=function(){return this.contains("COMMENT")?this.cards.COMMENT:console.warn("Header does not contain any COMMENT fields")},t.prototype.getHistory=function(){return this.contains("HISTORY")?this.cards.HISTORY:console.warn("Header does not contain any HISTORY fields")},t.prototype.set=function(e,t,n){return this.cards[e]=n?[this.cardIndex,t,n]:[this.cardIndex,t],this.cardIndex+=1},t.prototype.setComment=function(e){return this.contains("COMMENT")||(this.cards.COMMENT=[],this.cardIndex+=1),this.cards.COMMENT.push(e)},t.prototype.setHistory=function(e){return this.contains("HISTORY")||(this.cards.HISTORY=[],this.cardIndex+=1),this.cards.HISTORY.push(e)},t.prototype.contains=function(e){return this.cards.hasOwnProperty(e)},t.prototype.readCard=function(e){var n,r,i,s,o,u,a,f,l,c,h,p;u=e.match(t.keywordPattern);if(u==null)return;f=u.slice(1),s=f[0],a=f[1],s==="COMMENT"||s==="HISTORY"?u[1]=a.trim():a[0]==="'"?(u=a.match(t.stringPattern),u[1]=u[1].trim()):(u=a.match(t.nonStringPattern),u[1]=(l=u[1][0])==="T"||l==="F"?u[1].trim():parseFloat(u[1])),u[2]=u[2].trim(),c=u.slice(1),a=c[0],r=c[1],o=s,h=[!1,void 0],n=h[0],i=h[1],u=s.match(t.arrayPattern),u!=null&&(o=u[1],p=[!0,u[2]],n=p[0],i=p[1]),this.verifyCard.hasOwnProperty(o)&&(a=this.verifyCard[o](a,n,i));switch(s){case"COMMENT":return this.setComment(a);case"HISTORY":return this.setHistory(a);default:return this.set(s,a,r),this.__defineGetter__(s,function(){return this.cards[s][1]})}},t.prototype.init=function(e){var t,n,r,i,s,o,u,a;r=80,s=e.length/r,i=600,s=s<i?s:i,a=[];for(t=o=0,u=s-1;0<=u?o<=u:o>=u;t=0<=u?++o:--o)n=e.slice(t*r,(t+1)*r),a.push(this.readCard(n));return a},t.prototype.hasDataUnit=function(){return this.NAXIS===0?!1:!0},t.prototype.isPrimary=function(){return this.primary},t.prototype.isExtension=function(){return this.extension},t}(c),this.astro.FITS.Header=u,l={initArray:function(e){return this.data=new e(this.width*this.height)},getExtremes:function(){var e,t,n,r,i,s;if(this.min!=null&&this.max!=null)return[this.min,this.max];e=this.data.length;while(e--){r=this.data[e];if(isNaN(r))continue;i=[r,r],n=i[0],t=i[1];break}while(e--){r=this.data[e];if(isNaN(r))continue;r<n&&(n=r),r>t&&(t=r)}return s=[n,t],this.min=s[0],this.max=s[1],[this.min,this.max]},getPixel:function(e,t){return this.data[t*this.width+e]}},this.astro.FITS.ImageUtils=l,f=function(e){function t(e,n){var r,i,s,o,u=this;t.__super__.constructor.apply(this,arguments),s=n.NAXIS,r=n.BITPIX,this.naxis=[];for(i=o=1;1<=s?o<=s:o>=s;i=1<=s?++o:--o)this.naxis.push(n["NAXIS"+i]);this.width=n.NAXIS1,this.height=n.NAXIS2||1,this.bzero=n.BZERO||0,this.bscale=n.BSCALE||1,this.rowByteSize=this.width*Math.abs(r)/8,this.totalRowsRead=0,this.length=this.naxis.reduce(function(e,t){return e*t})*Math.abs(r)/8,this.data=void 0,this.frame=0;switch(r){case 8:this.bscale%1===0?(this.arrayType=Uint8Array,this.accessor=function(){return u.bzero+u.bscale*u.view.getUint8()}):(this.arrayType=Float32Array,this.accessor=function(){return u.bzero+u.bscale*u.view.getUint8()});break;case 16:this.bscale%1===0?(this.arrayType=Int16Array,this.accessor=function(){return u.bzero+u.bscale*u.view.getInt16()}):(this.arrayType=Float32Array,this.accessor=function(){return u.bzero+u.bscale*u.view.getInt16()});break;case 32:this.bscale%1===0?(this.arrayType=Int32Array,this.accessor=function(){return u.bzero+u.bscale*u.view.getUint32()}):(this.arrayType=Float32Array,this.accessor=function(){return u.bzero+u.bscale*u.view.getUint32()});break;case 64:this.arrayType=this.bscale%1===0?Int32Array:Float32Array,console.warn("Unusual behaviour with 64 bit integers."),this.accessor=function(){var e,t,n,r,i;return t=Math.abs(u.view.getInt32()),n=Math.abs(u.view.getInt32()),r=t%10,e=r?-1:1,t-=r,i=e*(t<<32|n),u.bzero+u.bscale*i};break;case-32:this.arrayType=Float32Array,this.accessor=function(){return u.bzero+u.bscale*u.view.getFloat32()};break;case-64:this.arrayType=Float64Array,this.accessor=function(){return u.bzero+u.bscale*u.view.getFloat64()};break;default:throw"Invalid BITPIX."}}return g(t,e),t.include(l),t.prototype.getRow=function(){var e,t,n;this.current=this.begin+this.totalRowsRead*this.rowByteSize,this.view.seek(this.current);for(e=t=0,n=this.width-1;0<=n?t<=n:t>=n;e=0<=n?++t:--t)this.data[this.width*this.rowsRead+e]=this.accessor();return this.rowsRead+=1,this.totalRowsRead+=1},t.prototype.getFrame=function(e){var t;this.frame=e!=null?e:this.frame,this.data==null&&this.initArray(this.arrayType),this.totalRowsRead=this.width*this.frame,this.rowsRead=0,t=this.height;while(t--)this.getRow();return this.frame+=1,this.data},t.prototype.seek=function(e){return e==null&&(e=0),this.naxis.length===2?(this.totalRowsRead=0,this.frame=0):(this.totalRowsRead=this.height*e,this.frame=this.height/this.totalRowsRead-1)},t.prototype.isDataCube=function(){return this.naxis.length>2?!0:!1},t}(n),this.astro.FITS.Image=f,p=function(e){function t(e,n){this.getRow=b(this.getRow,this),t.__super__.constructor.apply(this,arguments),this.rowByteSize=n.NAXIS1,this.rows=n.NAXIS2,this.cols=n.TFIELDS,this.length=this.tableLength=this.rowByteSize*this.rows,this.rowsRead=0,this.columns=this.getColumnNames(n),this.accessors=[]}return g(t,e),t.dataAccessors={L:function(e){return e.getInt8()===84?!0:!1},X:function(e){throw"Data type not yet implemented"},B:function(e){return e.getUint8()},I:function(e){return e.getInt16()},J:function(e){return e.getInt32()},K:function(e){var t,n,r,i,s;return n=Math.abs(e.getInt32()),r=Math.abs(e.getInt32()),i=n%10,t=i?-1:1,n-=i,s=t*(n<<32|r),console.warn("Something funky happens here when dealing with 64 bit integers.  Be wary!!!"),s},A:function(e){return e.getChar()},E:function(e){return e.getFloat32()},D:function(e){return e.getFloat64()},C:function(e){return[e.getFloat32(),e.getFloat32()]},M:function(e){return[e.getFloat64(),e.getFloat64()]}},t.prototype.getRow=function(e){var t,n,r,i,s;e==null&&(e=null),e!=null&&(this.rowsRead=e),this.current=this.begin+this.rowsRead*this.rowByteSize,this.view.seek(this.current),e={},s=this.accessors;for(n=r=0,i=s.length;r<i;n=++r)t=s[n],e[this.columns[n]]=t();return this.rowsRead+=1,e},t.prototype.getColumnNames=function(e){var t,n,r,i,s;t=[];for(n=i=1,s=this.cols;1<=s?i<=s:i>=s;n=1<=s?++i:--i){r="TTYPE"+n;if(!e.contains(r))return null;t.push(e[r])}return t},t}(n),this.astro.FITS.Tabular=p,h=function(e){function t(e,n){this.getRow=b(this.getRow,this);var r,i,s,o,u,a,f=this;t.__super__.constructor.apply(this,arguments),o=function(){var e,n,r,i,o;return o=s.slice(1),n=o[0],i=o[1],r=o[2],e=function(e){return t.dataAccessors[n](e)},f.accessors.push(e)};for(i=u=1,a=this.cols;1<=a?u<=a:u>=a;i=1<=a?++u:--u)r=n["TFORM"+i],s=r.match(t.formPattern),o()}return g(t,e),t.formPattern=/([AIFED])(\d+)\.*(\d+)*/,t.dataAccessors={A:function(e){return e.trim()},I:function(e){return parseInt(e)},F:function(e){return parseFloat(e)},E:function(e){return parseFloat(e)},D:function(e){return parseFloat(e)}},t.prototype.getRow=function(e){var t,n,r,i,s,o,u,a;e==null&&(e=null),e!=null&&(this.rowsRead=e),this.current=this.begin+this.rowsRead*this.rowByteSize,this.view.seek(this.current),r="";for(t=s=1,a=this.rowByteSize;1<=a?s<=a:s>=a;t=1<=a?++s:--s)r+=this.view.getChar();r=r.trim().split(/\s+/),e={};for(n=o=0,u=r.length;o<u;n=++o)i=r[n],e[this.columns[n]]=this.accessors[n](i);return this.rowsRead+=1,e},t}(p),this.astro.FITS.Table=h,e=function(e){function t(e,n){var r,i,s,o,u,a,f,l,c,h=this;t.__super__.constructor.apply(this,arguments);for(i=f=1,l=this.cols;1<=l?f<=l:f>=l;i=1<=l?++f:--f)s="TFORM"+i,a=n[s],u=a.match(t.arrayDescriptorPattern),u!=null?function(){var e,n;return n=u[1],e=function(){var e,r,s,o;r=h.view.getInt32(),s=h.view.getInt32(),h.current=h.view.tell(),h.view.seek(h.begin+h.tableLength+s),e=[];for(i=o=1;1<=r?o<=r:o>=r;i=1<=r?++o:--o)e.push(t.dataAccessors[n](h.view));return h.view.seek(h.current),e},h.accessors.push(e)}():(u=a.match(t.dataTypePattern),c=u.slice(1),o=c[0],r=c[1],o=o?parseInt(o):0,o===0||o===1?function(e){var n;return n=function(){var n;return n=t.dataAccessors[e](h.view),n},h.accessors.push(n)}(r):function(e,n){var r,s;return e==="X"?(s=Math.log(n)/Math.log(2),r=function(){var e,t,r,o,u,a,f,l;o=function(e){var t;t=[],i=128;while(i>=1)t.push(e&i?1:0),i/=2;return t},u=[];for(i=a=1;1<=s?a<=s:a>=s;i=1<=s?++a:--a){r=h.view.getUint8(),t=o(r);for(f=0,l=t.length;f<l;f++)e=t[f],u.push(e)}return u.slice(0,+(n-1)+1||9e9)}):e==="A"?r=function(){var r,s;r="";for(i=s=1;1<=n?s<=n:s>=n;i=1<=n?++s:--s)r+=t.dataAccessors[e](h.view);return r.trim()}:r=function(){var r,s;r=[];for(i=s=1;1<=n?s<=n:s>=n;i=1<=n?++s:--s)r.push(t.dataAccessors[e](h.view));return r},h.accessors.push(r)}(r,o))}return g(t,e),t.dataTypePattern=/(\d*)([L|X|B|I|J|K|A|E|D|C|M])/,t.arrayDescriptorPattern=/[0,1]*P([L|X|B|I|J|K|A|E|D|C|M])\((\d*)\)/,t}(p),this.astro.FITS.BinaryTable=e,r={Rice:function(e,t,n,r,i,s){var o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E;u=1<<l,w=this.RiceSetup[r](e),l=w[0],c=w[1],v=w[2],b=w[3],g=new Uint8Array(256),y=8,E=[128,255],d=E[0],h=E[1];while(h>=0){while(h>=d)g[h]=y,h-=1;d/=2,y-=1}g[0]=0,o=e[b],b+=1,m=8,h=0;while(h<s){m-=l;while(m<0)o=o<<8|e[b],b+=1,m+=8;f=(o>>m)-1,o&=(1<<m)-1,p=h+n,p>s&&(p=s);if(f<0)while(h<p)e[h]=v,h++;else if(f===c)while(h<p){d=u-m,a=o<<d,d-=8;while(d>=0)o=e[b],b+=1,a|=o<<d,d-=8;m>0?(o=e[b],b+=1,a|=o>>-d,o&=(1<<m)-1):o=0,(a&1)===0?a>>=1:a=~(a>>1),e[h]=a+v,v=e[h],h++}else while(h<p){while(o===0)m+=8,o=e[b],b+=1;y=m-g[o],m-=y+1,o^=1<<m,m-=f;while(m<0)o=o<<8|e[b],b+=1,m+=8;a=y<<f|o>>m,o&=(1<<m)-1,(a&1)===0?a>>=1:a=~(a>>1),i[h]=a+v,v=i[h],h++}}return i},RiceSetup:{1:function(e){var t,n,r,i;return i=0,t=3,n=6,r=e[i],i+=1,[t,n,r,i]},2:function(e){var t,n,r,i,s;return s=0,n=4,r=14,i=0,t=e[s],s+=1,i|=t<<8,t=e[s],s+=1,i|=t,[n,r,i,s]},4:function(e){var t,n,r,i,s;return s=0,n=5,r=25,i=0,t=e[s],s+=1,i|=t<<24,t=e[s],s+=1,i|=t<<16,t=e[s],s+=1,i|=t<<8,t=e[s],s+=1,i|=t,[n,r,i,s]}},gzip:function(e){throw"Not yet implemented"},plio:function(e,t){throw"Not yet implemented"},hcompress:function(e,t){throw"Not yet implemented"}},this.astro.FITS.Decompress=r,t=function(e){function t(e,n){var r,i,s,o,u,a;t.__super__.constructor.apply(this,arguments),this.length+=n.PCOUNT,this.zcmptype=n.ZCMPTYPE,this.zbitpix=n.ZBITPIX,this.znaxis=n.ZNAXIS,this.zblank=t.setValue(n,"ZBLANK",void 0),this.blank=t.setValue(n,"BLANK",void 0),this.ztile=[];for(r=u=1,a=this.znaxis;1<=a?u<=a:u>=a;r=1<=a?++u:--u)o=n.contains("ZTILE"+r)?n["ZTILE"+r]:r===1?n.ZNAXIS1:1,this.ztile.push(o);this.width=n.ZNAXIS1,this.height=n.ZNAXIS2||1,this.algorithmParameters={},r=1;for(;;){i="ZNAME"+r;if(!n.contains(i))break;s="ZVAL"+r,this.algorithmParameters[n[i]]=n[s],r+=1}this.zcmptype==="RICE_1"&&this.setRiceDefaults(),this.zmaskcmp=t.setValue(n,"ZMASKCMP",void 0),this.zquantiz=t.setValue(n,"ZQUANTIZ","LINEAR_SCALING"),this.bzero=t.setValue(n,"BZERO",0),this.bscale=t.setValue(n,"BSCALE",1),this.defineColumnAccessors(n),this.defineGetRow()}return g(t,e),t.dataTypePattern=/(\d*)([L|X|B|I|J|K|A|E|D|C|M])/,t.arrayDescriptorPattern=/[0,1]*P([L|X|B|I|J|K|A|E|D|C|M])\((\d*)\)/,t.include(l),t.extend(r),t.typedArray={B:Uint8Array,I:Int16Array,J:Int32Array,E:Float32Array,D:Float64Array,1:Uint8Array,2:Uint8Array,4:Int16Array,8:Int32Array},t.prototype.defineColumnAccessors=function(e){var n,r,i,s,o,u,a,f,l,c,h,p=this;this.columnNames={},h=[];for(i=f=1,l=this.cols;1<=l?f<=l:f>=l;i=1<=l?++f:--f){a=e["TFORM"+i],o=a.match(t.arrayDescriptorPattern),u=e["TTYPE"+i].toUpperCase(),this.columnNames[u]=i-1,n=null;if(o!=null){r=o[1];switch(u){case"COMPRESSED_DATA":(function(e){return n=function(){var n,r;return n=p._accessor(e),n==null?new Float32Array(p.ztile[0]):(r=new t.typedArray[p.algorithmParameters.BYTEPIX](p.ztile[0]),t.Rice(n,s,p.algorithmParameters.BLOCKSIZE,p.algorithmParameters.BYTEPIX,r,p.ztile[0]),r)}})(r);break;case"UNCOMPRESSED_DATA":(function(e){return n=p._accessor(e)})(r);break;case"GZIP_COMPRESSED_DATA":(function(e){return n=function(){var t,n,r,i,s;t=p._accessor(e);if(t!=null){t=new Float32Array(p.width);for(n=i=0,s=t.length;i<s;n=++i)r=t[n],t[n]=NaN;return t}return null}})(r);break;default:(function(e){return n=p._accessor(e)})(r)}}else o=a.match(t.dataTypePattern),c=o.slice(1),s=c[0],r=c[1],s=s!=null?parseInt(s):0,s===0||s===1?function(e){return n=function(){return t.dataAccessors[e](p.view)}}(r):function(e,r){return n=function(){var n,s,o;n=new t.typedArray[r](e);for(i=s=0,o=e-1;0<=o?s<=o:s>=o;i=0<=o?++s:--s)n[i]=t.dataAccessors[r](p.view);return n}}(s,r);h.push(this.accessors.push(n))}return h},t.prototype.defineGetRow=function(){var e;return this.totalRowsRead=0,e=this.zblank!=null||this.blank!=null||this.columnNames.hasOwnProperty("ZBLANK"),this.getRow=e?this.getRowHasBlanks:this.getRowNoBlanks},t.prototype.setRiceDefaults=function(){this.algorithmParameters.hasOwnProperty("BLOCKSIZE")||(this.algorithmParameters.BLOCKSIZE=32);if(!this.algorithmParameters.hasOwnProperty("BYTEPIX"))return this.algorithmParameters.BYTEPIX=4},t.setValue=function(e,t,n){return e.contains(t)?e[t]:n},t.prototype.getRowHasBlanks=function(){var e,t,n,r,i,s,o,u,a,f;f=this._getRow(),t=f[0],e=f[1],i=f[2],o=f[3];for(n=u=0,a=t.length;u<a;n=++u)s=t[n],r=this.totalRowsRead*this.width+n,this.data[r]=s===e?NaN:o+i*s;return this.rowsRead+=1,this.totalRowsRead+=1},t.prototype.getRowNoBlanks=function(){var e,t,n,r,i,s,o,u,a,f;f=this._getRow(),t=f[0],e=f[1],i=f[2],o=f[3];for(n=u=0,a=t.length;u<a;n=++u)s=t[n],r=this.totalRowsRead*this.width+n,this.data[r]=o+i*s;return this.rowsRead+=1,this.totalRowsRead+=1},t.prototype.getFrame=function(){var e;this.data==null&&this.initArray(Float32Array),this.totalRowsRead=0,this.rowsRead=0,e=this.height;while(e--)this.getRow();return this.data},t.prototype._accessor=function(e){var n,r,i,s,o,u,a;u=[this.view.getInt32(),this.view.getInt32()],i=u[0],s=u[1];if(i===0)return null;n=new t.typedArray[e](i),this.current=this.view.tell(),this.view.seek(this.begin+this.tableLength+s);for(r=o=0,a=i-1;0<=a?o<=a:o>=a;r=0<=a?++o:--o)n[r]=t.dataAccessors[e](this.view);return this.view.seek(this.current),n},t.prototype._getRow=function(){var e,t,n,r,i,s,o,u,a;this.current=this.begin+this.totalRowsRead*this.rowByteSize,this.view.seek(this.current),r=[],a=this.accessors;for(o=0,u=a.length;o<u;o++)e=a[o],r.push(e());return n=r[this.columnNames.COMPRESSED_DATA]||r[this.columnNames.UNCOMPRESSED_DATA]||r[this.columnNames.GZIP_COMPRESSED_DATA],t=r[this.columnNames.ZBLANK]||this.zblank,i=r[this.columnNames.ZSCALE]||this.bscale,s=r[this.columnNames.ZZERO]||this.bzero,[n,t,i,s]},t.subtractiveDither1=function(){throw"Not yet implemented"},t.linearScaling=function(){throw"Not yet implemented"},t}(p),this.astro.FITS.CompressedImage=t,o=function(){function e(e,t){this.header=e,this.data=t}return e.prototype.hasData=function(){return this.data!=null?!0:!1},e.prototype.getCard=function(e){return this.header[e]},e}(),this.astro.FITS.HDU=o,s=function(){function n(e){var t;t=n.getType(e);switch(t){case"arraybuffer":this.initFromBuffer(e);break;case"object":this.initFromObject(e);break;default:throw"fitsjs cannot initialize object"}}return n.LINEWIDTH=80,n.BLOCKLENGTH=2880,n.getType=function(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()},n.excessBytes=function(e){return(n.BLOCKLENGTH-e%n.BLOCKLENGTH)%n.BLOCKLENGTH},n.extendDataView=function(e){var t,n,r,i,s,o,u,a;return DataView.prototype.getString=function(e){var t,n,r,i,s;r="";for(n=i=0,s=e-1;0<=s?i<=s:i>=s;n=0<=s?++i:--i)t=this.getUint8(),r+=String.fromCharCode(t>127?65533:t);return r},DataView.prototype.getChar=function(){return this.getString(1)},e.offset=0,s=e.getInt8,a=e.getUint8,r=e.getInt16,o=e.getUint16,i=e.getInt32,u=e.getUint32,t=e.getFloat32,n=e.getFloat64,e.getInt8=function(){var e;return e=s.apply(this,[this.offset]),this.offset+=1,e},e.getUint8=function(){var e;return e=a.apply(this,[this.offset]),this.offset+=1,e},e.getInt16=function(){var e;return e=r.apply(this,[this.offset,!1]),this.offset+=2,e},e.getUint16=function(){var e;return e=o.apply(this,[this.offset,!1]),this.offset+=2,e},e.getInt32=function(){var e;return e=i.apply(this,[this.offset,!1]),this.offset+=4,e},e.getUint32=function(){var e;return e=u.apply(this,[this.offset,!1]),this.offset+=4,e},e.getFloat32=function(){var e;return e=t.apply(this,[this.offset,!1]),this.offset+=4,e},e.getFloat64=function(){var e;return e=n.apply(this,[this.offset,!1]),this.offset+=8,e},e.seek=function(e){return this.offset=e},e.tell=function(){return this.offset}},n.prototype.initFromBuffer=function(e){var t,r,i,s;this.length=e.byteLength,this.view=new DataView(e),this.hdus=[],this.eof=!1,n.extendDataView(this.view),s=[];for(;;){i=this.readHeader(),t=this.readData(i),r=new o(i,t),this.hdus.push(r);if(this.eof)break;s.push(void 0)}return s},n.prototype.initFromObject=function(e){return this.length=e.length,this.view=null,this.hdus=e.hdus,this.eof=!0},n.prototype.readHeader=function(){var e,t,r,i,s,o,a,f,l,c,h,p;p=/\s{80}/,o=/^END\s/,e=this.view.tell(),r=!1;for(;;){if(r)break;t=this.view.getString(n.BLOCKLENGTH),f=0;for(;;){h=n.BLOCKLENGTH-n.LINEWIDTH*(f+1),i=n.BLOCKLENGTH-n.LINEWIDTH*f,l=t.slice(h,i),c=l.match(p);if(c){f+=1;continue}c=l.match(o);if(c)return s=this.view.tell(),this.view.seek(e),t=this.view.getString(s-e),a=new u,a.init(t),r=!0,this.checkEOF(),a;break}}},n.prototype.readData=function(r){var i,s;if(!r.hasDataUnit())return;return r.isPrimary()?i=new f(this.view,r):r.isExtension()&&(r.extensionType==="BINTABLE"?r.contains("ZIMAGE")?i=new t(this.view,r):i=new e(this.view,r):r.extensionType==="TABLE"?i=new h(this.view,r):r.extensionType==="IMAGE"&&(i=new f(this.view,r))),s=n.excessBytes(i.length),this.view.seek(this.view.tell()+i.length+s),this.checkEOF(),i},n.prototype.checkEOF=function(){if(this.view.offset>=this.length)return this.eof=!0},n.prototype.count=function(){return this.hdus.length},n.prototype.getHDU=function(e){var t,n,r,i;e==null&&(e=void 0);if(e!=null&&this.hdus[e]!=null)return this.hdus[e];i=this.hdus;for(n=0,r=i.length;n<r;n++){t=i[n];if(t.hasData())return t}},n.prototype.getHeader=function(e){return e==null&&(e=void 0),this.getHDU(e).header},n.prototype.getDataUnit=function(e){return e==null&&(e=void 0),this.getHDU(e).data},n.prototype.getData=function(e){return e==null&&(e=void 0),this.getHDU(e).data.getFrame()},n}(),this.astro.FITS.File=s}.call(this),define("fits",function(){}),define("FitsLoader",["fits"],function(){function e(e){var t=astro.FITS,n=new t.File(e),r=n.getHDU(),i=r.data,s,o=new Uint8Array(i.view.buffer,i.begin,i.length),u=i.arrayType.BYTES_PER_ELEMENT;for(var a=0;a<o.length;a+=u){var f;for(var l=0;l<u/2;l++)f=o[a+l],o[a+l]=o[a+u-1-l],o[a+u-1-l]=f}return n}var t=function(t,n,r,i){var s=new XMLHttpRequest;return s.onreadystatechange=function(i){if(s.readyState==4)if(s.status==200){if(s.response){var o=e(s.response);n&&n(o)}}else console.log("Error while loading "+t),r&&r()},s.onprogress=i,s.open("GET",t),s.responseType="arraybuffer",s.send(),s};return{loadFits:t,parseFits:e}}),void function(e,t){typeof module=="object"?module.exports=t():typeof define=="function"?define("crc32",t):e.crc32=t()}(this,function(){function n(){var n,r,i;for(r=0;r<256;r+=1){n=r;for(i=0;i<8;i+=1)n&1?n=t^n>>>1:n>>>=1;e[r]=n>>>0}}function r(e){return Array.prototype.map.call(e,function(e){return e.charCodeAt(0)})}function i(e){var n=-1,r,i,s,o;for(r=0,s=e.length;r<s;r+=1){o=(n^e[r])&255;for(i=0;i<8;i+=1)(o&1)===1?o=o>>>1^t:o>>>=1;n=n>>>8^o}return n^-1}function s(t,n){var r,i,o;if(typeof s.crc=="undefined"||!n||!t){s.crc=-1;if(!t)return}r=s.crc;for(i=0,o=t.length;i<o;i+=1)r=r>>>8^e[(r^t[i])&255];return s.crc=r,r^-1}var e=[],t=3988292384;n();var o=function(e,t){var e=typeof e=="string"?r(e):e,n=t?i(e):s(e);return(n>>>0).toString(16)};return o.direct=i,o.table=s,o}),define("inflate-js",[],function(){function O(){this.next=null,this.list=null}function M(){this.e=0,this.b=0,this.n=0,this.t=null}function _(e,t,n,r,i,s){this.BMAX=16,this.N_MAX=288,this.status=0,this.root=null,this.m=0;var o,u=[],a,f,l,c,h,p,d,v=[],m,g,y,b=new M,w=[],E=[],S,x=[],T,N,C,k,L;L=this.root=null;for(h=0;h<this.BMAX+1;h++)u[h]=0;for(h=0;h<this.BMAX+1;h++)v[h]=0;for(h=0;h<this.BMAX;h++)w[h]=null;for(h=0;h<this.N_MAX;h++)E[h]=0;for(h=0;h<this.BMAX+1;h++)x[h]=0;a=t>256?e[256]:this.BMAX,m=e,g=0,h=t;do u[m[g]]++,g++;while(--h>0);if(u[0]===t){this.root=null,this.m=0,this.status=0;return}for(p=1;p<=this.BMAX;p++)if(u[p]!==0)break;d=p,s<p&&(s=p);for(h=this.BMAX;h!==0;h--)if(u[h]!==0)break;l=h,s>h&&(s=h);for(N=1<<p;p<h;p++,N<<=1)if((N-=u[p])<0){this.status=2,this.m=s;return}if((N-=u[h])<0){this.status=2,this.m=s;return}u[h]+=N,x[1]=p=0,m=u,g=1,T=2;while(--h>0)x[T++]=p+=m[g++];m=e,g=0,h=0;do(p=m[g++])!==0&&(E[x[p]++]=h);while(++h<t);t=x[l],x[0]=h=0,m=E,g=0,c=-1,S=v[0]=0,y=null,C=0;for(null;d<=l;d++){o=u[d];while(o-->0){while(d>S+v[1+c]){S+=v[1+c],c++,C=(C=l-S)>s?s:C;if((f=1<<(p=d-S))>o+1){f-=o+1,T=d;while(++p<C){if((f<<=1)<=u[++T])break;f-=u[T]}}S+p>a&&S<a&&(p=a-S),C=1<<p,v[1+c]=p,y=[];for(k=0;k<C;k++)y[k]=new M;L?L=L.next=new O:L=this.root=new O,L.next=null,L.list=y,w[c]=y,c>0&&(x[c]=h,b.b=v[c],b.e=16+p,b.t=y,p=(h&(1<<S)-1)>>S-v[c],w[c-1][p].e=b.e,w[c-1][p].b=b.b,w[c-1][p].n=b.n,w[c-1][p].t=b.t)}b.b=d-S,g>=t?b.e=99:m[g]<n?(b.e=m[g]<256?16:15,b.n=m[g++]):(b.e=i[m[g]-n],b.n=r[m[g++]-n]),f=1<<d-S;for(p=h>>S;p<C;p+=f)y[p].e=b.e,y[p].b=b.b,y[p].n=b.n,y[p].t=b.t;for(p=1<<d-1;(h&p)!==0;p>>=1)h^=p;h^=p;while((h&(1<<S)-1)!==x[c])S-=v[c],c--}}this.m=v[1],this.status=N!==0&&l!==1?1:0}function D(){return S.length===x?-1:S[x++]&255}function P(e){while(p<e)h|=D()<<p,p+=8}function H(e){return h&T[e]}function B(e){h>>=e,p-=e}function j(t,n,r){var i,s,a;if(r===0)return 0;a=0;for(;;){P(w),s=y.list[H(w)],i=s.e;while(i>16){if(i===99)return-1;B(s.b),i-=16,P(i),s=s.t[H(i)],i=s.e}B(s.b);if(i===16){u&=e-1,t[n+a++]=o[u++]=s.n;if(a===r)return r;continue}if(i===15)break;P(i),m=s.n+H(i),B(i),P(E),s=b.list[H(E)],i=s.e;while(i>16){if(i===99)return-1;B(s.b),i-=16,P(i),s=s.t[H(i)],i=s.e}B(s.b),P(i),g=u-s.n-H(i),B(i);while(m>0&&a<r)m--,g&=e-1,u&=e-1,t[n+a++]=o[u++]=o[g++];if(a===r)return r}return d=-1,a}function F(t,n,r){var i;i=p&7,B(i),P(16),i=H(16),B(16),P(16);if(i!==(~h&65535))return-1;B(16),m=i,i=0;while(m>0&&i<r)m--,u&=e-1,P(8),t[n+i++]=o[u++]=H(8),B(8);return m===0&&(d=-1),i}function I(e,t,n){if(!a){var r,i=[],s;for(r=0;r<144;r++)i[r]=8;for(null;r<256;r++)i[r]=9;for(null;r<280;r++)i[r]=7;for(null;r<288;r++)i[r]=8;l=7,s=new _(i,288,257,N,C,l);if(s.status!==0)return console.error("HufBuild error: "+s.status),-1;a=s.root,l=s.m;for(r=0;r<30;r++)i[r]=5;c=5,s=new _(i,30,0,k,L,c);if(s.status>1)return a=null,console.error("HufBuild error: "+s.status),-1;f=s.root,c=s.m}return y=a,b=f,w=l,E=c,j(e,t,n)}function q(e,t,n){var r,o,u,a,f,l,c,h,p=[],d;for(r=0;r<316;r++)p[r]=0;P(5),c=257+H(5),B(5),P(5),h=1+H(5),B(5),P(4),l=4+H(4),B(4);if(c>286||h>30)return-1;for(o=0;o<l;o++)P(3),p[A[o]]=H(3),B(3);for(null;o<19;o++)p[A[o]]=0;w=7,d=new _(p,19,19,null,null,w);if(d.status!==0)return-1;y=d.root,w=d.m,a=c+h,r=u=0;while(r<a){P(w),f=y.list[H(w)],o=f.b,B(o),o=f.n;if(o<16)p[r++]=u=o;else if(o===16){P(2),o=3+H(2),B(2);if(r+o>a)return-1;while(o-->0)p[r++]=u}else if(o===17){P(3),o=3+H(3),B(3);if(r+o>a)return-1;while(o-->0)p[r++]=0;u=0}else{P(7),o=11+H(7),B(7);if(r+o>a)return-1;while(o-->0)p[r++]=0;u=0}}w=i,d=new _(p,c,257,N,C,w),w===0&&(d.status=1);if(d.status!==0&&d.status!==1)return-1;y=d.root,w=d.m;for(r=0;r<h;r++)p[r]=p[r+c];return E=s,d=new _(p,h,0,k,L,E),b=d.root,E=d.m,E===0&&c>257?-1:d.status!==0?-1:j(e,t,n)}function R(){o||(o=[]),u=0,h=0,p=0,d=-1,v=!1,m=g=0,y=null}function U(i,s,a){var f,l;f=0;while(f<a){if(v&&d===-1)return f;if(m>0){if(d!==t)while(m>0&&f<a)m--,g&=e-1,u&=e-1,i[s+f++]=o[u++]=o[g++];else{while(m>0&&f<a)m--,u&=e-1,P(8),i[s+f++]=o[u++]=H(8),B(8);m===0&&(d=-1)}if(f===a)return f}if(d===-1){if(v)break;P(1),H(1)!==0&&(v=!0),B(1),P(2),d=H(2),B(2),y=null,m=0}switch(d){case t:l=F(i,s+f,a-f);break;case n:y?l=j(i,s+f,a-f):l=I(i,s+f,a-f);break;case r:y?l=j(i,s+f,a-f):l=q(i,s+f,a-f);break;default:l=-1}if(l===-1)return v?0:-1;f+=l}return f}function z(e){var t=[],n;R(),S=e,x=0;do n=U(t,t.length,1024);while(n>0);return S=null,t}var e=32768,t=0,n=1,r=2,i=9,s=6,o,u,a=null,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],N=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],C=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],k=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],L=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],A=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];return{inflate:z}}),define("deflate-js",[],function(){function It(){this.fc=0,this.dl=0}function qt(){this.dyn_tree=null,this.static_tree=null,this.extra_bits=null,this.extra_base=0,this.elems=0,this.max_length=0,this.max_code=0}function Rt(e,t,n,r){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r}function Ut(){this.next=null,this.len=0,this.ptr=[],this.off=0}function Jt(e){var t;e?e<1?e=1:e>9&&(e=9):e=i,ft=e,I=!1,st=!1;if(q!==null)return;B=j=F=null,q=[],W=[],X=[],V=[],$=[],ht=[];for(t=0;t<P;t++)ht[t]=new It;pt=[];for(t=0;t<2*A+1;t++)pt[t]=new It;dt=[];for(t=0;t<L+2;t++)dt[t]=new It;vt=[];for(t=0;t<A;t++)vt[t]=new It;mt=[];for(t=0;t<2*O+1;t++)mt[t]=new It;gt=new qt,yt=new qt,bt=new qt,wt=[],Et=[],Tt=[],Nt=[],Ct=[],kt=[],Lt=[],At=[]}function Kt(){B=j=F=null,q=null,W=null,X=null,V=null,$=null,ht=null,pt=null,dt=null,vt=null,mt=null,gt=null,yt=null,bt=null,wt=null,Et=null,Tt=null,Nt=null,Ct=null,kt=null,Lt=null,At=null}function Qt(e){e.next=B,B=e}function Gt(){var e;return B!==null?(e=B,B=B.next):e=new Ut,e.next=null,e.len=e.off=0,e}function Yt(t){return $[e+t]}function Zt(t,n){return $[e+t]=n}function en(e){q[U+R++]=e,U+R===u&&Dn()}function tn(e){e&=65535,U+R<u-2?(q[U+R++]=e&255,q[U+R++]=e>>>8):(en(e&255),en(e>>>8))}function nn(){G=(G<<H^W[rt+f-1]&255)&m,Y=Yt(G),$[rt&g]=Y,Zt(G,rt)}function rn(e,t){On(t[e].fc,t[e].dl)}function sn(e){return(e<256?Ct[e]:Ct[256+(e>>7)])&255}function on(e,t,n){return e[t].fc<e[n].fc||e[t].fc===e[n].fc&&Tt[t]<=Tt[n]}function un(e,t,n){var r;for(r=0;r<n&&Ft<jt.length;r++)e[t+r]=jt[Ft++]&255;return r}function an(){var t;for(t=0;t<v;t++)$[e+t]=0;at=$t[ft].max_lazy,lt=$t[ft].good_length,s||(ct=$t[ft].nice_length),ut=$t[ft].max_chain,rt=0,Q=0,ot=un(W,0,2*e);if(ot<=0){st=!0,ot=0;return}st=!1;while(ot<w&&!st)ln();G=0;for(t=0;t<f-1;t++)G=(G<<H^W[t]&255)&m}function fn(e){var t=ut,n=rt,r,i,o=nt,u=rt>E?rt-E:y,a=rt+l,f=W[n+o-1],c=W[n+o],h,p;nt>=lt&&(t>>=2);do{r=e;if(W[r+o]!==c||W[r+o-1]!==f||W[r]!==W[n]||W[++r]!==W[n+1])continue;n+=2,r++;while(n<a){p=!1;for(h=0;h<8;h+=1){n+=1,r+=1;if(W[n]!==W[r]){p=!0;break}}if(p)break}i=l-(a-n),n=a-l;if(i>o){it=e,o=i;if(s){if(i>=l)break}else if(i>=ct)break;f=W[n+o-1],c=W[n+o]}}while((e=$[e&g])>u&&--t!==0);return o}function ln(){var t,n,r=a-ot-rt;if(r===-1)r--;else if(rt>=e+E){for(t=0;t<e;t++)W[t]=W[t+e];it-=e,rt-=e,Q-=e;for(t=0;t<v;t++)n=Yt(t),Zt(t,n>=e?n-e:y);for(t=0;t<e;t++)n=$[t],$[t]=n>=e?n-e:y;r+=e}st||(t=un(W,rt+ot,r),t<=0?st=!0:ot+=t)}function cn(){while(ot!==0&&j===null){var e;nn(),Y!==y&&rt-Y<=E&&(tt=fn(Y),tt>ot&&(tt=ot));if(tt>=f){e=kn(rt-it,tt-f),ot-=tt;if(tt<=at){tt--;do rt++,nn();while(--tt!==0);rt++}else rt+=tt,tt=0,G=W[rt]&255,G=(G<<H^W[rt+1]&255)&m}else e=kn(0,W[rt]&255),ot--,rt++;e&&(Cn(0),Q=rt);while(ot<w&&!st)ln()}}function hn(){while(ot!==0&&j===null){nn(),nt=tt,Z=it,tt=f-1,Y!==y&&nt<at&&rt-Y<=E&&(tt=fn(Y),tt>ot&&(tt=ot),tt===f&&rt-it>b&&tt--);if(nt>=f&&tt<=nt){var e;e=kn(rt-1-Z,nt-f),ot-=nt-1,nt-=2;do rt++,nn();while(--nt!==0);et=!1,tt=f-1,rt++,e&&(Cn(0),Q=rt)}else et?(kn(0,W[rt-1]&255)&&(Cn(0),Q=rt),rt++,ot--):(et=!0,rt++,ot--);while(ot<w&&!st)ln()}}function pn(){if(st)return;J=0,K=0,mn(),an(),j=null,R=0,U=0,ft<=3?(nt=f-1,tt=0):(tt=f-1,et=!1),z=!1}function dn(e,t,n){var r;if(!I){pn(),I=!0;if(ot===0)return z=!0,0}return r=vn(e,t,n),r===n?n:z?r:(ft<=3?cn():hn(),ot===0&&(et&&kn(0,W[rt-1]&255),Cn(1),z=!0),r+vn(e,r+t,n-r))}function vn(e,t,n){var r,i,s;r=0;while(j!==null&&r<n){i=n-r,i>j.len&&(i=j.len);for(s=0;s<i;s++)e[t+r+s]=j.ptr[j.off+s];j.off+=i,j.len-=i,r+=i;if(j.len===0){var o;o=j,j=j.next,Qt(o)}}if(r===n)return r;if(U<R){i=n-r,i>R-U&&(i=R-U);for(s=0;s<i;s++)e[t+r+s]=q[U+s];U+=i,r+=i,R===U&&(R=U=0)}return r}function mn(){var e,t,n,r,i;if(vt[0].dl!==0)return;gt.dyn_tree=ht,gt.static_tree=dt,gt.extra_bits=zt,gt.extra_base=C+1,gt.elems=L,gt.max_length=x,gt.max_code=0,yt.dyn_tree=pt,yt.static_tree=vt,yt.extra_bits=Wt,yt.extra_base=0,yt.elems=A,yt.max_length=x,yt.max_code=0,bt.dyn_tree=mt,bt.static_tree=null,bt.extra_bits=Xt,bt.extra_base=0,bt.elems=O,bt.max_length=T,bt.max_code=0,n=0;for(r=0;r<N-1;r++){kt[r]=n;for(e=0;e<1<<zt[r];e++)Nt[n++]=r}Nt[n-1]=r,i=0;for(r=0;r<16;r++){Lt[r]=i;for(e=0;e<1<<Wt[r];e++)Ct[i++]=r}for(i>>=7;r<A;r++){Lt[r]=i<<7;for(e=0;e<1<<Wt[r]-7;e++)Ct[256+i++]=r}for(t=0;t<=x;t++)wt[t]=0;e=0;while(e<=143)dt[e++].dl=8,wt[8]++;while(e<=255)dt[e++].dl=9,wt[9]++;while(e<=279)dt[e++].dl=7,wt[7]++;while(e<=287)dt[e++].dl=8,wt[8]++;wn(dt,L+1);for(e=0;e<A;e++)vt[e].dl=5,vt[e].fc=Mn(e,5);gn()}function gn(){var e;for(e=0;e<L;e++)ht[e].fc=0;for(e=0;e<A;e++)pt[e].fc=0;for(e=0;e<O;e++)mt[e].fc=0;ht[k].fc=1,Ht=Bt=0,Ot=Mt=_t=0,Dt=0,Pt=1}function yn(e,t){var n=Et[t],r=t<<1;while(r<=St){r<St&&on(e,Et[r+1],Et[r])&&r++;if(on(e,n,Et[r]))break;Et[t]=Et[r],t=r,r<<=1}Et[t]=n}function bn(e){var t=e.dyn_tree,n=e.extra_bits,r=e.extra_base,i=e.max_code,s=e.max_length,o=e.static_tree,u,a,f,l,c,h,p=0;for(l=0;l<=x;l++)wt[l]=0;t[Et[xt]].dl=0;for(u=xt+1;u<P;u++){a=Et[u],l=t[t[a].dl].dl+1,l>s&&(l=s,p++),t[a].dl=l;if(a>i)continue;wt[l]++,c=0,a>=r&&(c=n[a-r]),h=t[a].fc,Ht+=h*(l+c),o!==null&&(Bt+=h*(o[a].dl+c))}if(p===0)return;do{l=s-1;while(wt[l]===0)l--;wt[l]--,wt[l+1]+=2,wt[s]--,p-=2}while(p>0);for(l=s;l!==0;l--){a=wt[l];while(a!==0){f=Et[--u];if(f>i)continue;t[f].dl!==l&&(Ht+=(l-t[f].dl)*t[f].fc,t[f].fc=l),a--}}}function wn(e,t){var n=[],r=0,i,s;for(i=1;i<=x;i++)r=r+wt[i-1]<<1,n[i]=r;for(s=0;s<=t;s++){var o=e[s].dl;if(o===0)continue;e[s].fc=Mn(n[o]++,o)}}function En(e){var t=e.dyn_tree,n=e.static_tree,r=e.elems,i,s,o=-1,u=r;St=0,xt=P;for(i=0;i<r;i++)t[i].fc!==0?(Et[++St]=o=i,Tt[i]=0):t[i].dl=0;while(St<2){var a=Et[++St]=o<2?++o:0;t[a].fc=1,Tt[a]=0,Ht--,n!==null&&(Bt-=n[a].dl)}e.max_code=o;for(i=St>>1;i>=1;i--)yn(t,i);do i=Et[S],Et[S]=Et[St--],yn(t,S),s=Et[S],Et[--xt]=i,Et[--xt]=s,t[u].fc=t[i].fc+t[s].fc,Tt[i]>Tt[s]+1?Tt[u]=Tt[i]:Tt[u]=Tt[s]+1,t[i].dl=t[s].dl=u,Et[S]=u++,yn(t,S);while(St>=2);Et[--xt]=Et[S],bn(e),wn(t,o)}function Sn(e,t){var n,r=-1,i,s=e[0].dl,o=0,u=7,a=4;s===0&&(u=138,a=3),e[t+1].dl=65535;for(n=0;n<=t;n++){i=s,s=e[n+1].dl;if(++o<u&&i===s)continue;o<a?mt[i].fc+=o:i!==0?(i!==r&&mt[i].fc++,mt[M].fc++):o<=10?mt[_].fc++:mt[D].fc++,o=0,r=i,s===0?(u=138,a=3):i===s?(u=6,a=3):(u=7,a=4)}}function xn(e,t){var n,r=-1,i,s=e[0].dl,o=0,u=7,a=4;s===0&&(u=138,a=3);for(n=0;n<=t;n++){i=s,s=e[n+1].dl;if(++o<u&&i===s)continue;if(o<a){do rn(i,mt);while(--o!==0)}else i!==0?(i!==r&&(rn(i,mt),o--),rn(M,mt),On(o-3,2)):o<=10?(rn(_,mt),On(o-3,3)):(rn(D,mt),On(o-11,7));o=0,r=i,s===0?(u=138,a=3):i===s?(u=6,a=3):(u=7,a=4)}}function Tn(){var e;Sn(ht,gt.max_code),Sn(pt,yt.max_code),En(bt);for(e=O-1;e>=3;e--)if(mt[Vt[e]].dl!==0)break;return Ht+=3*(e+1)+5+5+4,e}function Nn(e,t,n){var r;On(e-257,5),On(t-1,5),On(n-4,4);for(r=0;r<n;r++)On(mt[Vt[r]].dl,3);xn(ht,e-1),xn(pt,t-1)}function Cn(e){var i,s,o,u,a;u=rt-Q,At[_t]=Dt,En(gt),En(yt),o=Tn(),i=Ht+3+7>>3,s=Bt+3+7>>3,s<=i&&(i=s);if(u+4<=i&&Q>=0){On((t<<1)+e,3),_n(),tn(u),tn(~u);for(a=0;a<u;a++)en(W[Q+a])}else s===i?(On((n<<1)+e,3),Ln(dt,vt)):(On((r<<1)+e,3),Nn(gt.max_code+1,yt.max_code+1,o+1),Ln(ht,pt));gn(),e!==0&&_n()}function kn(e,t){V[Ot++]=t,e===0?ht[t].fc++:(e--,ht[Nt[t]+C+1].fc++,pt[sn(e)].fc++,X[Mt++]=e,Dt|=Pt),Pt<<=1,(Ot&7)===0&&(At[_t++]=Dt,Dt=0,Pt=1);if(ft>2&&(Ot&4095)===0){var n=Ot*8,r=rt-Q,i;for(i=0;i<A;i++)n+=pt[i].fc*(5+Wt[i]);n>>=3;if(Mt<parseInt(Ot/2,10)&&n<parseInt(r/2,10))return!0}return Ot===h-1||Mt===d}function Ln(e,t){var n,r,i=0,s=0,o=0,u=0,a,f;if(Ot!==0)do(i&7)===0&&(u=At[o++]),r=V[i++]&255,(u&1)===0?rn(r,e):(a=Nt[r],rn(a+C+1,e),f=zt[a],f!==0&&(r-=kt[a],On(r,f)),n=X[s++],a=sn(n),rn(a,t),f=Wt[a],f!==0&&(n-=Lt[a],On(n,f))),u>>=1;while(i<Ot);rn(k,e)}function On(e,t){K>An-t?(J|=e<<K,tn(J),J=e>>An-K,K+=t-An):(J|=e<<K,K+=t)}function Mn(e,t){var n=0;do n|=e&1,e>>=1,n<<=1;while(--t>0);return n>>1}function _n(){K>8?tn(J):K>0&&en(J),J=0,K=0}function Dn(){var e,t;if(R!==0){e=Gt(),j===null?j=F=e:F=F.next=e,e.len=R-U;for(t=0;t<e.len;t++)e.ptr[t]=q[U+t];R=U=0}}function Pn(e,t){var n,r,s;jt=e,Ft=0,typeof t=="undefined"&&(t=i),Jt(t),s=[];do n=dn(s,s.length,1024);while(n>0);return jt=null,s}var e=32768,t=0,n=1,r=2,i=6,s=!1,o=32768,u=8192,a=2*e,f=3,l=258,c=16,h=8192,p=15,d=h,v=1<<p,m=v-1,g=e-1,y=0,b=4096,w=l+f+1,E=e-w,S=1,x=15,T=7,N=29,C=256,k=256,L=C+1+N,A=30,O=19,M=16,_=17,D=18,P=2*L+1,H=parseInt((p+f-1)/f,10),B,j,F,I,q=null,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,et,tt,nt,rt,it,st,ot,ut,at,ft,lt,ct,ht,pt,dt,vt,mt,gt,yt,bt,wt,Et,St,xt,Tt,Nt,Ct,kt,Lt,At,Ot,Mt,_t,Dt,Pt,Ht,Bt,jt,Ft;h>o&&console.error("error: INBUFSIZ is too small"),e<<1>1<<c&&console.error("error: WSIZE is too large"),p>c-1&&console.error("error: HASH_BITS is too large"),(p<8||l!==258)&&console.error("error: Code too clever");var zt=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Wt=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Xt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Vt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],$t=[new Rt(0,0,0,0),new Rt(4,4,8,4),new Rt(4,5,16,8),new Rt(4,6,32,32),new Rt(4,4,16,16),new Rt(8,16,32,32),new Rt(8,16,128,128),new Rt(8,32,128,256),new Rt(32,128,258,1024),new Rt(32,258,258,4096)],An=16;return{deflate:Pn}}),define("gzip",["crc32","inflate-js","deflate-js"],function(e,t,n){function r(e,t){t.push(e&255)}function i(e,t){t.push(e&255),t.push(e>>>8)}function s(e,t){i(e&65535,t),i(e>>>16,t)}function o(e,t){var n,i=e.length;for(n=0;n<i;n+=1)r(e.charCodeAt(n),t)}function u(e){return e.shift()}function a(e){return e.shift()|e.shift()<<8}function f(e){var t=a(e),n=a(e);return n>32768?(n-=32768,(n<<16|t)+32768*Math.pow(2,16)):n<<16|t}function l(e){var t=[];while(e[0]!==0)t.push(String.fromCharCode(e.shift()));return e.shift(),t.join("")}function c(e,t){var n,r=[];for(n=0;n<t;n+=1)r.push(e.shift());return r}function h(t,i){var u=0,a,f,l=[];return i||(i={}),a=i.level||DEFAULT_LEVEL,typeof t=="string"&&(t=Array.prototype.map.call(t,function(e){return e.charCodeAt(0)})),r(ID1,l),r(ID2,l),r(compressionMethods.deflate,l),i.name&&(u|=possibleFlags.FNAME),r(u,l),s(i.timestamp||parseInt(Date.now()/1e3,10),l),a===1?r(4,l):a===9?r(2,l):r(0,l),r(osMap[os],l),i.name&&(o(i.name.substring(i.name.lastIndexOf("/")+1),l),r(0,l)),n.deflate(t,a).forEach(function(e){r(e,l)}),s(parseInt(e(t),16),l),s(t.length,l),l}function p(n,r){var i=Array.prototype.slice.call(n,0),s,o,h,p,d,v,m,g,y,b;if(u(i)!==ID1||u(i)!==ID2)throw"Not a GZIP file";s=u(i),s=Object.keys(compressionMethods).some(function(e){return o=e,compressionMethods[e]===s});if(!s)throw"Unsupported compression method";h=u(i),p=f(i),d=u(i),s=u(i),Object.keys(osMap).some(function(e){if(osMap[e]===s)return m=e,!0}),h&possibleFlags.FEXTRA&&(s=a(i),c(i,s)),h&possibleFlags.FNAME&&l(i),h&possibleFlags.FCOMMENT&&l(i),h&possibleFlags.FHCRC&&a(i),o==="deflate"&&(b=t.inflate(i.splice(0,i.length-8))),h&possibleFlags.FTEXT&&(b=Array.prototype.map.call(b,function(e){return String.fromCharCode(e)}).join("")),g=f(i);if(g!==parseInt(e(b),16))throw"Checksum does not match";y=f(i);if(y!==b.length)throw"Size of decompressed file not correct";return b}return ID1=31,ID2=139,compressionMethods={deflate:8},possibleFlags={FTEXT:1,FHCRC:2,FEXTRA:4,FNAME:8,FCOMMENT:16},osMap={fat:0,amiga:1,vmz:2,unix:3,"vm/cms":4,atari:5,hpfs:6,macintosh:7,"z-system":8,cplm:9,"tops-20":10,ntfs:11,qdos:12,acorn:13,vfat:14,vms:15,beos:16,tandem:17,theos:18},os="unix",DEFAULT_LEVEL=6,{zip:h,unzip:p,get DEFAULT_LEVEL(){return DEFAULT_LEVEL}}}),define("FitsRequest",["gw/ImageRequest"],function(e){e.prototype.send=function(e){var t=this;if(e.search("fits")>0){var n=new XMLHttpRequest;n.onreadystatechange=function(r){n&&n.readyState==4&&(n.status==200?n.response&&(t.image=n.response,t.successCallback&&t.successCallback(t)):n.status!=0&&(console.log("Error while loading "+e),t.failCallback&&t.failCallback(t)),n=null)},n.onabort=function(e){t.abortCallback&&t.abortCallback(t),t.xhr=null},n.open("GET",e),n.responseType="arraybuffer",n.send(),this.xhr=n}else this.image=new Image,this.image.aborted=!1,this.image.crossOrigin="",this.image.dataType="byte",this.image.onload=function(){var e=t.image.naturalWidth!=0&&t.image.complete;e&&!this.aborted&&t.successCallback.call(t)},this.image.onerror=function(){t.failCallback&&!this.aborted&&t.failCallback(t)},this.image.src=e},e.prototype.abort=function(){this.xhr?this.xhr.abort():(this.abortCallback&&(this.image.aborted=!0,this.abortCallback(this)),this.image.src="")}}),define("HEALPixFITSLayer",["gw/Utils","gw/HEALPixTiling","gw/RasterLayer","gw/DynamicImage","./FitsLoader","gzip","gw/ImageRequest","./FitsRequest"],function(e,t,n,r,i,s,o){var u=function(e){n.prototype.constructor.call(this,e),this.tilePixelSize=e.tilePixelSize||512,this.tiling=new t(e.baseLevel||2,e),this.numberOfLevels=e.numberOfLevels||10,this.type="ImageryRaster",this.baseUrl=e.baseUrl,this.dataType=e.dataType||"fits",this.coordSystem=e.coordSystem||"EQ",this._ready=!1,this.fitsSupported=!0,this.levelZeroImage=null,this.rawFragShader="		precision lowp float; \n		varying vec2 texCoord;\n		uniform sampler2D colorTexture; \n		uniform float opacity; \n		uniform float inversed; \n		bool isnan(float val) {\n				return (val <= 0.0 || 0.0 <= val) ? ((val == 5e-324) ? true : false) : true;\n		}\n		void main(void)\n		{\n			vec4 color = texture2D(colorTexture, vec2(texCoord.x, (inversed == 1.) ? 1.0 - texCoord.y : texCoord.y));\n			gl_FragColor = vec4(color.r,color.g,color.b, color.a*opacity);\n			if (isnan( (gl_FragColor.r + gl_FragColor.g + gl_FragColor.b) / 3. ) )\n			{\n				gl_FragColor.a = 0.;\n			}\n		}\n		",this.colormapFragShader="		precision lowp float; \n		varying vec2 texCoord;\n		uniform sampler2D colorTexture; \n		uniform sampler2D colormap; \n		uniform float min; \n		uniform float max; \n		uniform float opacity; \n		bool isnan(float val) {\n			return (val <= 0.0 || 0.0 <= val) ? false : true;\n		}\n		void main(void)\n		{\n			float i = texture2D(colorTexture,vec2(texCoord.x, 1.0 - texCoord.y)).r;\n			float d = clamp( ( i - min ) / (max - min), 0.0, 1.0 );\n			vec4 cmValue = texture2D(colormap, vec2(d,0.));\n			gl_FragColor = vec4(cmValue.r,cmValue.g,cmValue.b, cmValue.a*opacity);\n			if (isnan( i ) )\n			{\n				 gl_FragColor.a = 0.;\n			}\n		}\n		",this.customShader={fragmentCode:this.rawFragShader,updateUniforms:function(e,t){e.uniform1f(t.uniforms.inversed,i.inversed),i.levelZeroImage&&(e.uniform1f(t.uniforms.max,i.levelZeroImage.tmax),e.uniform1f(t.uniforms.min,i.levelZeroImage.tmin),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,i.levelZeroImage.colormapTex),e.uniform1i(t.uniforms.colormap,1),e.uniform1f(t.uniforms.opacity,i.opacity()))}};var i=this;this.imageRequest=new o({successCallback:function(){i._ready=!0;if(i.dataType=="fits"){try{var t=new Uint8Array(i.imageRequest.image),n=s.unzip(t);i.imageRequest.image=(new Uint8Array(n)).buffer}catch(o){if(o!="Not a GZIP file"){console.error(o),this.failCallback();return}console.log("not gzipped"),t=null}i.handleImage(i.imageRequest);var u=i.imageRequest.image;if(i.globe){var a=i.globe.renderContext.gl;i.levelZeroImage=new r(i.globe.renderContext,u.typedArray,a.LUMINANCE,a.FLOAT,u.width,u.height),i.getLevelZeroTexture=function(){return i.levelZeroImage.texture}}}else i.levelZeroImage=this.image,i.getLevelZeroTexture=null;e.onready&&e.onready instanceof Function&&e.onready(i),i.globe&&i.globe.renderContext.requestFrame()},failCallback:function(){i.globe&&(i.globe.publish("baseLayersError",i),i._ready=!1,console.log("Error while loading background"))},abortCallback:function(e){i._ready=!1,console.log("Background image request has been aborted")}})};return e.inherits(n,u),u.prototype._attach=function(e){n.prototype._attach.call(this,e);var t=this.globe.renderContext.gl;this.requestLevelZeroImage();var r=t.getExtension("OES_texture_float");r||(console.error("no OES_texture_float"),this.fitsSupported=!1)},u.prototype._detach=function(){this._ready||this.imageRequest.abort(),this._ready=!1,this.disposeResources(),n.prototype._detach.call(this)},u.prototype.getUrl=function(e){var t=this.baseUrl;t+="/Norder",t+=e.order,t+="/Dir";var n=Math.floor(e.pixelIndex/1e4)*1e4;return t+=n,t+="/Npix",t+=e.pixelIndex,t+="."+this.dataType,t},u.prototype.extractFitsData=function(e,t,n,r){var i=64,s=this.levelZeroImage.height,o=this.levelZeroImage.width,u=this.levelZeroImage.pixels,a=i*o*(28-Math.floor(e/27))+e%27*i,f;for(var l=0;l<i;l++)f=u.subarray(a+l*o,a+l*o+i),t.set(f,r+l*128+n)},u.prototype.generateLevel0Textures=function(e,t){if(this.dataType!="fits"){var n=document.createElement("canvas");n.width=128,n.height=128;var r=n.getContext("2d");for(var i=0;i<e.length;i++){var s=e[i],o=s.pixelIndex*4,u=o%27*64,a=Math.floor(o/27)*64;r.drawImage(this.levelZeroImage,u,a,64,64,0,0,64,64),o=s.pixelIndex*4+2;var u=o%27*64,a=Math.floor(o/27)*64;r.drawImage(this.levelZeroImage,u,a,64,64,64,0,64,64),o=s.pixelIndex*4+1;var u=o%27*64,a=Math.floor(o/27)*64;r.drawImage(this.levelZeroImage,u,a,64,64,0,64,64,64),o=s.pixelIndex*4+3;var u=o%27*64,a=Math.floor(o/27)*64;r.drawImage(this.levelZeroImage,u,a,64,64,64,64,64,64);var f=r.getImageData(0,0,128,128);f.dataType="byte",s.texture=t.createGLTexture(f),s.imageSize=128}}else for(var i=0;i<e.length;i++){var s=e[i],l=new Float32Array(16384),o=s.pixelIndex*4;this.extractFitsData(o,l,0,8192),o=s.pixelIndex*4+2,this.extractFitsData(o,l,64,8192),o=s.pixelIndex*4+1,this.extractFitsData(o,l,0,0),o=s.pixelIndex*4+3,this.extractFitsData(o,l,64,0);var f={typedArray:l,width:128,height:128,dataType:"float"};s.texture=t.createGLTexture(f),s.imageSize=128}},u.prototype.handleImage=function(e){if(!(e.image instanceof Image)){var t=i.parseFits(e.image),n=t.getHDU().data,r=n.arrayType.BYTES_PER_ELEMENT,s;if(n.arrayType.name=="Float64Array"){var o=new Float64Array(n.view.buffer,n.begin,n.length/r),s=new Float32Array(n.length/r);for(var u=0;u<o.length;u++)s[u]=o[u]}else s=new Float32Array(n.view.buffer,n.begin,n.length/r);e.image={typedArray:s,width:n.width,height:n.height,dataType:"float"}}},u.prototype.requestLevelZeroImage=function(){this.fitsSupported||(this.dataType="jpg"),this.customShader.fragmentCode=this.rawFragShader,this.dataType=="fits"?this.inversed=1:this.inversed=0;var e=this.baseUrl+"/Norder3/Allsky."+this.dataType;this.imageRequest.send(e)},u.prototype.disposeResources=function(){this.levelZeroImage&&this.levelZeroImage.dispose&&this.levelZeroImage.dispose(),this.levelZeroTexture&&this.globe.renderContext.gl.deleteTexture(this.levelZeroTexture),this.levelZeroImage=null,this.levelZeroTexture=null},u.prototype.setDatatype=function(e){this._ready||this.imageRequest.abort(),this._ready=!1,this.dataType=e?"fits":"jpg"},u}),define("IFrame",["jquery"],function(e){function i(){n=e(t).appendTo("body"),r={pile:[],index:0,clicked:!1,clean:function(){this.pile.length=0,this.index=0,this.clicked=!1}},e("#previous").button({width:20,height:20,text:!1,icons:{primary:"ui-icon-circle-triangle-w"}}).click(function(e){e.preventDefault(),r.index>1&&(r.index--,r.clicked=!0,n.find("iframe")[0].contentWindow.history.back())}),e("#next").button({width:20,height:20,text:!1,icons:{secondary:"ui-icon-circle-triangle-e"}}).click(function(e){e.preventDefault(),r.index!=r.pile.length&&(r.index++,r.clicked=!0,n.find("iframe")[0].contentWindow.history.forward())}),n.find("iframe").on("load",function(){if(r.clicked)return r.clicked=!1,!1;r.pile.splice(r.index),r.pile.push(n.find("iframe")[0].attributes.src.nodeValue),r.index++})}var t='<div id="externalIFrame" class="contentBox">		<div id="IFrameToolbar" class="ui-widget-header ui-widget-header ui-corner-all">		  <button id="previous">Previous page</button>		  <button id="next">Next page</button>		</div>		<div class="closeBtn">			<span class="defaultImg"></span>			<span style="opacity: 0" class="hoverImg"></span>		</div>		<iframe src=""><p>Your browser does not support iframes.</p></iframe>	</div>',n,r;return{hide:function(){n&&n.animate({top:-1e3},800)},show:function(t){n||i(),r.clean(),historyClick=!1;var s=parseInt(e("#GlobWebCanvas").css("width")),o=parseInt(e("#GlobWebCanvas").css("height")),u=s*.8,a=o*.8,f=o*.1;n.find("iframe").css({width:u,height:a}).attr("src",t),n.animate({top:f},800)}}}),define("JsonProcessor",["gw/HEALPixLayer","gw/CoordinateSystem"],function(e,t){function r(t,n){for(var r in n.services){var i=n.services[r];t.subLayers||(t.subLayers=[]);switch(i.type){case"healpix":i.layer=new e({dataType:i.dataType,baseUrl:i.url,name:i.name,visible:!1,coordinates:n.geometry.coordinates[0]}),t.subLayers.push(i.layer),t.globe&&t.visible()&&t.globe.addLayer(i.layer);break;default:}}}var n=0;return{handleFeatureCollection:function(e,i){var s=i.features;for(var o=0;o<s.length;o++){var u=s[o],a="EQ";if(u.properties.crs){var f=u.properties.crs.properties.name;a=f.substr(0,f.indexOf("."));if(a.length>3)switch(a.toLowerCase()){case"equatorial":a="EQ";break;case"galactic":a="GAL";break;default:console.log("Not implemented")}}switch(u.geometry.type){case"Point":e.dataType?e.dataType!="point"&&(e.dataType="none"):e.dataType="point","EQ"!=a&&(u.geometry.coordinates=t.convert(u.geometry.coordinates,a,"EQ")),u.geometry.coordinates[0]>180&&(u.geometry.coordinates[0]-=360);break;case"Polygon":case"MultiPolygon":e.dataType?e.dataType!="line"&&(e.dataType="none"):e.dataType="line";var l=[],c=u.geometry;if(c["type"]=="MultiPolygon")for(var h=0;h<c.coordinates.length;h++)l.push(c.coordinates[h][0]);else l.push(c.coordinates[0]);for(var p=0;p<l.length;p++){var d=l[p],v=d.length;for(var h=0;h<v;h++)"EQ"!=a&&(d[h]=t.convert(d[h],a,"EQ")),d[h][0]>180&&(d[h][0]-=360)}if(u.properties._imageCoordinates){for(var p=0;p<u.properties._imageCoordinates[0].length;p++)u.properties._imageCoordinates[0][p][0]>180&&(u.properties._imageCoordinates[0][p][0]-=360);u.geometry._imageCoordinates=u.properties._imageCoordinates}break;default:}u.geometry.gid="jsonProc_"+n,n++,u.services&&r(e,u)}}}}),function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}},n=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};e=typeof exports!="undefined"&&exports!==null&&this||(this.WCS={}),e.Math={},e.Math.R2D=180/Math.PI,e.Math.D2R=Math.PI/180,e.Math.WCSTRIG_TOL=1e-10,e.Math.cosd=function(t){var n;if(t%90===0){n=Math.abs(Math.floor(t/90+.5))%4;switch(n){case 0:return 1;case 1:return 0;case 2:return-1;case 3:return 0}}return Math.cos(t*e.Math.D2R)},e.Math.sind=function(t){var n;if(t%90===0){n=Math.abs(Math.floor(t/90-.5))%4;switch(n){case 0:return 1;case 1:return 0;case 2:return-1;case 3:return 0}}return Math.sin(t*e.Math.D2R)},e.Math.sincosd=function(t){var n,r,i,s,o;if(t%90===0){r=Math.abs(Math.floor(t/90+.5))%4;switch(r){case 0:i=0,n=1;break;case 1:i=(s=t>0)!=null?s:{1:-1},n=0;break;case 2:i=0,n=-1;break;case 3:i=(o=t>0)!=null?o:-{1:1},n=0}return i*n}return i=Math.sin(t*e.Math.D2R),n=Math.cos(t*e.Math.D2R),i*n},e.Math.tand=function(t){var n;return n=t&360,n===0||Math.abs(n)===180?0:n===45||n===225?1:n===-135||n===-315?-1:Math.tan(t*e.Math.D2R)},e.Math.acosd=function(t){if(t>=1){if(t-1<e.Math.WCSTRIG_TOL)return 0}else{if(t===0)return 90;if(t<=-1&&t+1>-e.Math.WCSTRIG_TOL)return 180}return Math.acos(t)*e.Math.R2D},e.Math.asind=function(t){if(t<=-1){if(t+1>-e.Math.WCSTRIG_TOL)return-90;if(t===0)return 0;if(t>=1&&t-1<e.Math.WCSTRIG_TOL)return 90}return Math.asin(t)*e.Math.R2D},e.Math.atand=function(t){return t===-1?-45:t===0?0:t===1?45:Math.atan(t)*e.Math.R2D},e.Math.atan2d=function(t,n){if(t===0){if(n>=0)return 0;if(n<0)return 180}else if(n===0){if(t>0)return 90;if(t<0)return-90}return Math.atan2(t,n)*e.Math.R2D},e.Math.toRightTriangular=function(e){var t,n,r,i,s,o,u,a,f;u=e.length,i=u,s=e[0].length;for(;;){n=i-u;if(e[n][n]===0){r=n+1;while(r<i){if(e[r][n]!==0){t=[],a=s;for(;;){f=s-a,t.push(e[n][f]+e[r][f]);if(!--a)break}e[n]=t;break}r+=1}}if(e[n][n]!==0){r=n+1;while(r<i){o=e[r][n]/e[n][n],t=[],a=s;for(;;){f=s-a,t.push(f<=n?0:e[r][f]-e[n][f]*o);if(!--a)break}e[r]=t,r+=1}}if(!--u)break}return e},e.Math.determinant=function(t){var n,r,i,s,o;s=e.Math.toRightTriangular(t),n=s[0][0],o=s.length-1,i=o;for(;;){r=i-o+1,n*=s[r][r];if(!--o)break}return n},e.Math.matrixInverse=function(t){var n,r,i,s,o,u,a,f;f=t[0].length,r=t.length,n=new Array(r),s=new Array(r),a=[],u=[],o=0;while(o<r){u[o]=[],i=0;while(i<f)u[o][i]=t[o][i],i+=1;o+=1}o=0;while(o<r){n[o]=new Array(f),s[o]=new Array(f),i=0;while(i<f)n[o][i]=i===o?1:0,i+=1;a[o]=u[o].concat(n[o]),o+=1}e.Math.gaussJordan(a),o=0;while(o<r)s[o]=a[o].slice(f,2*f),o+=1;return s},e.Math.gaussJordan=function(e,t){t||(t=1e-10);var n,r,i,s,o,u,a,f;n=e.length,r=e[0].length,i=-1;while(++i<n){u=i,s=i;while(++s<n)Math.abs(e[s][i])>Math.abs(e[u][i])&&(u=s);a=e[i],e[i]=e[u],e[u]=a;if(Math.abs(e[i][i])<=t)return!1;s=i;while(++s<n){f=e[s][i]/e[i][i],o=i-1;while(++o<r)e[s][o]-=e[i][o]*f}}i=n;while(--i>=0){f=e[i][i],s=-1;while(++s<i){o=r;while(--o>=i)e[s][o]-=e[i][o]*e[s][i]/f}e[i][i]/=f,o=n-1;while(++o<r)e[i][o]/=f}return!0},e.Mapper=function(){function r(e){this.coordinateToPixel=t(this.coordinateToPixel,this),this.pixelToCoordinate=t(this.pixelToCoordinate,this),this.fromCelestial=t(this.fromCelestial,this),this.toCelestial=t(this.toCelestial,this),this.fromIntermediate=t(this.fromIntermediate,this),this.toIntermediate=t(this.toIntermediate,this),this.computeCelestialParameters=t(this.computeCelestialParameters,this),this.getSipCoefficients=t(this.getSipCoefficients,this),this.setProjection=t(this.setProjection,this),this.derivePC=t(this.derivePC,this),this.checkCard=t(this.checkCard,this),this.verifyHeader=t(this.verifyHeader,this),this.wcsobj={},this.projection=void 0,this.longitudeAxis=void 0,this.latitudeAxis=void 0,this.sip=void 0,this.verifyHeader(e),this.setProjection(e)}return r.prototype.verifyHeader=function(t){var n,r,i,s,o,u,a,f,l,c,h;this.wcsobj.naxis=u=t.NAXIS||t.WCSAXES||2,this.wcsobj.radesys=t.RADESYS||"ICRS",a=["CRPIX","CRVAL","CTYPE"],this.wcsobj.crpix=[],this.wcsobj.crval=[],this.wcsobj.ctype=[];for(r=f=1;1<=u?f<=u:f>=u;r=1<=u?++f:--f)for(s=l=0,h=a.length-1;0<=h?l<=h:l>=h;s=0<=h?++l:--l){o=a[s]+r;if(!t.hasOwnProperty(o))throw"Not enough information to compute WCS, missing required keyword "+o;n=a[s].toLowerCase(),this.wcsobj[n].push(t[o])}this.wcsobj.cunit=[],this.wcsobj.cdelt=[];for(r=c=1;1<=u?c<=u:c>=u;r=1<=u?++c:--c)o="CUNIT"+r,this.wcsobj.cunit.push(t[o]||"deg"),o="CDELT"+r,this.wcsobj.cdelt.push(t[o]||1);this.wcsobj.lonpole=t.LONPOLE||0,this.wcsobj.latpole=t.LATPOLE||0,this.wcsobj.equinox=t.EQUINOX||2e3,i=new Date,this.wcsobj.dateObs=t.DATE_OBS||i.getFullYear()+"-"+(i.getMonth()+1)+"-"+i.getDate(),this.wcsobj.dateObs=t.DATE_OBS||""+i.getFullYear()+"-"+(i.getMonth()+1)+"-"+i.getDate(),this.wcsobj.pc=this.checkCard(t,"PC",u)||this.derivePC(t),this.wcsobj.pcInv=e.Math.matrixInverse(this.wcsobj.pc),this.wcsobj.cd=this.checkCard(t,"CD",u);if(this.wcsobj.cd!=null)return this.wcsobj.cdInv=e.Math.matrixInverse(this.wcsobj.cd)},r.prototype.checkCard=function(e,t,n){var r,i,s,o,u,a;o=[];for(i=u=1;1<=n?u<=n:u>=n;i=1<=n?++u:--u){o[i-1]=[];for(s=a=1;1<=n?a<=n:a>=n;s=1<=n?++a:--a){r=""+t+i+"_"+s;if(!e.hasOwnProperty(r))return;o[i-1].push(e[r])}}return o},r.prototype.derivePC=function(e){var t,n,r,i,s,o,u,a,f,l,c;return e.hasOwnProperty("CROTA2")?(u=e.CROTA2,a=this.wcsobj.cdelt[1]/this.wcsobj.cdelt[0]):(t=this.checkCard(e,"CD",this.wcsobj.naxis),t==null?(c=[0,1],u=c[0],a=c[1]):(n=t[0][0],r=t[0][1],i=t[1][0],s=t[1][1],i>0?f=Math.atan2(i,n):i===0?f=0:f=Math.atan2(-i,-n),r>0?l=Math.atan2(r,-s):r===0?l=0:l=Math.atan2(-i,s),u=.5*(f+l),o=Math.cos(u),this.wcsobj.cdelt1=n/o,this.wcsobj.cdelt2=s/o,a=this.wcsobj.cdelt2/this.wcsobj.cdelt1)),t},r.prototype.setProjection=function(t){var r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E=this;c=["AIR","ARC","AZP","NCP","SIN","STG","SZP","TAN","TAN-SIP","ZEA","ZPN"],i=["CYP","CEA","CAR","MER","SFL","PAR","MOL","AIT"],r=["COP","COE","COD","COO"],f=["BON","PCO"],l=["TSC","CSC","QSC"],this.projection=this.wcsobj.ctype[0].slice(5),this.longitudeAxis=this.wcsobj.ctype[0].match("RA|GLON|ELON|HLON|SLON")?1:2,this.latitudeAxis=this.wcsobj.ctype[1].match("DEC|GLAT|ELAT|HLAT|SLAT")?2:1;if(h=this.projection,n.call(c,h)>=0){this.wcsobj.phi0=0,this.wcsobj.theta0=90,this.wcsobj.alphaP=this.wcsobj.crval[0],this.wcsobj.deltaP=this.wcsobj.crval[1],this.wcsobj.lonpole=this.wcsobj.crval[1]>=this.wcsobj.theta0?0:180;switch(this.projection){case"AIR":s="PV"+this.latitudeAxis+"_1",this.wcsobj.thetaB=t.hasOwnProperty(s)?parseFloat(t[s]):90,this.wcsobj.etaB=(90-this.wcsobj.thetaB)/2,{toSpherical:function(e,t){throw"Sorry, not yet implemented!"},fromSpherical:function(e,t){throw"Sorry, not yet implemented!"}};break;case"ARC":this.toSpherical=function(t,n){var r,i,s;return i=Math.sqrt(t*t+n*n),s=E.wcsobj.theta0-i,r=e.Math.atan2d(t,-n),[r,s]},this.fromSpherical=function(t,n){var r,i,s;return r=90-n,i=r*e.Math.sind(t),s=-r*e.Math.cosd(t),[i,s]};break;case"AZP":p=["PV"+this.latitudeAxis+"_1","PV"+this.latitudeAxis+"_2"],o=p[0],u=p[1],this.wcsobj.mu=t.hasOwnProperty(o)?parseFloat(t[o]):0,this.wcsobj.gamma=t.hasOwnProperty(u)?parseFloat(t[u]):0,this.toSpherical=function(e,t){throw"Sorry, not yet implemented!"},this.fromSpherical=function(e,t){throw"Sorry, not yet implemented!"};break;case"NCP":this.toSpherical=function(e,t){throw"Sorry, not yet implemented!"},this.fromSpherical=function(e,t){throw"Sorry, not yet implemented!"};break;case"SIN":d=["PV"+this.latitudeAxis+"_1","PV"+this.latitudeAxis+"_2"],o=d[0],u=d[1],this.wcsobj.eta=t.hasOwnProperty(o)?parseFloat(t[o]):0,this.wcsobj.nu=t.hasOwnProperty(u)?parseFloat(t[u]):0,this.toSpherical=function(t,n){var r,i,s;return i=Math.sqrt(t*t+n*n),s=e.Math.acosd(Math.PI*i/180),r=e.Math.atan2d(t,-n),[r,s]},this.fromSpherical=function(t,n){var r,i,s;return r=180/Math.PI*e.Math.cosd(n),i=r*e.Math.sind(t),s=-r*e.Math.cosd(t),[i,s]};break;case"STG":this.toSpherical=function(t,n){var r,i,s;return i=Math.sqrt(t*t+n*n),s=E.wcsobj.theta0-2*e.Math.atand(Math.PI*i/360),r=e.Math.atan2d(t,-n),[r,s]},this.fromSpherical=function(t,n){var r,i,s;return r=360/Math.PI*e.Math.tand((90-n)/2),i=r*e.Math.sind(t),s=-r*e.Math.cosd(t),[i,s]};break;case"SZP":v=["PV"+this.latitudeAxis+"_1","PV"+this.latitudeAxis+"_2","PV"+this.latitudeAxis+"_3"],o=v[0],u=v[1],a=v[2],this.wcsobj.mu=t.hasOwnProperty(o)?parseFloat(t[o]):0,this.wcsobj.phiC=t.hasOwnProperty(u)?parseFloat(t[u]):0,this.wcsobj.thetaC=t.hasOwnProperty(a)?parseFloat(t[a]):90,this.wcsobj.xp=-this.wcsobj.mu*e.Math.cosd(this.wcsobj.thetaC)*e.Math.sind(this.wcsobj.phiC),this.wcsobj.yp=this.wcsobj.mu*e.Math.cosd(this.wcsobj.thetaC)*e.Math.cosd(this.wcsobj.phiC),this.wcsobj.zp=this.wcsobj.mu*e.Math.sind(this.wcsobj.thetaC)+1,this.toSpherical=function(e,t){throw"Sorry, not yet implemented"},this.fromSpherical=function(t,n){var r,i,s;throw"Sorry, not yet implemented"};break;case"TAN":this.toSpherical=function(t,n){var r,i,s;return i=Math.sqrt(t*t+n*n),s=e.Math.atand(180/(Math.PI*i)),r=e.Math.atan2d(t,-n),[r,s]},this.fromSpherical=function(t,n){var r,i,s;return r=180/(Math.PI*e.Math.tand(n)),i=r*e.Math.sind(t),s=-r*e.Math.cosd(t),[i,s]};break;case"TAN-SIP":this.getSipCoefficients(t),this.f=function(e,t,n){var r,i,s,o,u,a;o=0,r=n[0].length-1;for(i=u=0;0<=r?u<=r:u>=r;i=0<=r?++u:--u)for(s=a=0;0<=r?a<=r:a>=r;s=0<=r?++a:--a)o+=n[i][s]*Math.pow(e,i)*Math.pow(t,s);return o},this.toIntermediate=function(e){var t,n,r,i,s,o,u,a,f,l,c;s=[],o=e[0]-E.wcsobj.crpix[0],u=e[1]-E.wcsobj.crpix[1],t=n=0,t=E.f(o,u,E.sip.aCoeffs),n=E.f(o,u,E.sip.bCoeffs),e[0]=e[0]+t,e[1]=e[1]+n;for(r=a=0,l=E.wcsobj.naxis-1;0<=l?a<=l:a>=l;r=0<=l?++a:--a){s[r]=0,e[r]-=E.wcsobj.crpix[r];for(i=f=0,c=E.wcsobj-1;0<=c?f<=c:f>=c;i=0<=c?++f:--f)s[r]+=E.wcsobj.cd[r][i]*e[i]}return s},this.fromIntermediate=function(e){var t,n,r,i,s,o,u,a,f,l;o=[];for(r=u=0,f=E.wcsobj.naxis-1;0<=f?u<=f:u>=f;r=0<=f?++u:--u){o[r]=0;for(i=a=0,l=E.wcsobj.naxis-1;0<=l?a<=l:a>=l;i=0<=l?++a:--a)o[r]+=E.wcsobj.cdInv[r][i]*e[i];o[r]+=E.wcsobj.crpix[r]}return t=n=0,t=E.f(o[0],o[1],E.sip.apCoeffs),n=E.f(o[0],o[1],E.sip.bpCoeffs),s=[],s[0]=o[0]+t,s[1]=o[1]+n,s[0]+=E.wcsobj.crpix[0],s[1]+=E.wcsobj.crpix[1],s},this.toSpherical=function(t,n){var r,i,s;return i=Math.sqrt(t*t+n*n),s=e.Math.atand(180/(Math.PI*i)),r=e.Math.atan2d(t,-n),[r,s]},this.fromSpherical=function(t,n){var r,i,s;return r=180/(Math.PI*e.Math.tand(n)),i=r*e.Math.sind(t),s=-r*e.Math.cosd(t),[i,s]};break;case"ZEA":this.toSpherical=function(t,n){var r,i,s;return i=Math.sqrt(t*t+n*n),s=E.wcsobj.theta0-2*e.Math.asind(Math.PI*i/360),r=e.Math.atan2d(t,-n),[r,s]},this.fromSpherical=function(t,n){var r,i,s;return r=360/Math.PI*e.Math.sind((90-n)/2),i=r*e.Math.sind(t),s=-r*e.Math.cosd(t),[i,s]};break;case"ZPN":this.toSpherical=function(e,t){throw"Sorry, not yet implemented!"},this.fromSpherical=function(e,t){throw"Sorry, not yet implemented!"}}}if(m=this.projection,n.call(i,m)>=0){this.wcsobj.phi0=0,this.wcsobj.theta0=0,this.computeCelestialParameters(this.wcsobj.phi0,this.wcsobj.theta0);switch(this.projection){case"CYP":g=["PV"+this.latitudeAxis+"_1,","PV"+this.latitudeAxis+"_2"],o=g[0],u=g[1],this.wcsobj.mu=t.hasOwnProperty(o)?parseFloat(t[o]):1,this.wcsobj.lambda=t.hasOwnProperty(u)?parseFloat(t[u]):1,this.wcsobj.mu+this.wcsobj.lambda===0&&raise("Divide by zero error"),this.toSpherical=function(t,n){var r,i,s;return r=Math.PI*n/(180*(E.wcsobj.mu+E.wcsobj.lambda)),s=e.Math.atan2d(r,1)+e.Math.asind(r*E.wcsobj.mu/Math.sqrt(r*r+1)),i=t/E.wcsobj.lambda,[i,s]},this.fromSpherical=function(t,n){var r,i;return r=E.wcsobj.lambda*t,i=180/Math.PI*((E.wcsobj.mu+E.wcsobj.lambda)/(E.wcsobj.mu+e.Math.cosd(n)))*e.Math.sind(n),[r,i]};break;case"CEA":s="PV"+this.latitudeAxis+"_1",this.wcsobj.lambda=t.hasOwnProperty(s)?parseFloat(t[s]):1,this.toSpherical=function(t,n){var r;return r=e.Math.asind(Math.PI*E.wcsobj.lambda*n/180),[t,r]},this.fromSpherical=function(t,n){var r;return r=180/Math.PI*e.Math.sind(n)/E.wcsobj.lambda,[t,r]};break;case"CAR":this.toSpherical=function(e,t){return[e,t]},this.fromSpherical=function(e,t){return[e,t]};break;case"MER":this.toSpherical=function(t,n){var r;return r=2*e.Math.atand(Math.exp(n*Math.PI/180))-90,[t,r]},this.fromSpherical=function(t,n){var r;return r=180/Math.PI*Math.log(e.Math.tand((90+n)/2)),[t,r]};break;case"SFL":this.toSpherical=function(t,n){var r;return r=t/e.Math.cosd(n),[r,n]},this.fromSpherical=function(t,n){var r;return r=t*e.Math.cosd(n),[r,n]};break;case"PAR":this.toSpherical=function(t,n){var r,i;return i=3*e.Math.asind(n/180),r=t/(1-4*Math.pow(n/180,2)),[r,i]},this.fromSpherical=function(t,n){var r,i;return r=t*(2*e.Math.cosd(2*n/3)-1),i=180*e.Math.sind(n/3),[r,i]};break;case"MOL":this.toSpherical=function(t,n){var r,i;return i=e.Math.asind(e.Math.asind(Math.PI*n/(180*Math.sqrt(2)))/90+n/180*Math.sqrt(2-Math.pow(Math.PI*n/180,2))),r=Math.PI*t/(2*Math.sqrt(2-Math.pow(Math.PI*n/180,2))),[r,i]},this.fromSpherical=function(t,n){var r,i;throw"Sorry, not yet implemented!"};break;case"AIT":this.toSpherical=function(t,n){var r,i,s,o,u;return s=Math.pow(Math.PI*t/720,2),o=Math.pow(Math.PI*n/360,2),u=Math.sqrt(1-s-o),i=e.Math.asind(Math.PI*n*u/180),r=2*e.Math.atan2d(Math.PI*u*t/360,2*u*u-1),[r,i]},this.fromSpherical=function(t,n){var r,i,s;return r=180/Math.PI*Math.sqrt(2/(1+e.Math.cosd(n)*e.Math.cosd(t/2))),i=2*r*e.Math.cosd(n)*e.Math.sind(t/2),s=r*e.Math.sind(n),[i,s]}}}if(y=this.projection,n.call(r,y)>=0)throw s="PV"+this.latitudeAxis+"_1",this.wcsobj.phi0=0,this.wcsobj.theta0=t.hasOwnProperty(s)?t[s]:0,"Sorry, not yet implemented!";if(b=this.projection,n.call(f,b)>=0)throw this.wcsobj.phi0=0,this.wcsobj.theta0=0,"Sorry, not yet implemented!";if(w=this.projection,n.call(l,w)>=0)throw this.wcsobj.phi0=0,this.wcsobj.theta0=0,"Sorry, not yet implemented!"},r.prototype.getSipCoefficients=function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b;if(!e.hasOwnProperty("A_ORDER")&&!e.hasOwnProperty("B_ORDER"))throw"What's the polynomial order, man!";this.sip={},this.sip.aOrder=e.A_ORDER,this.sip.bOrder=e.B_ORDER,this.sip.apOrder=e.AP_ORDER||0,this.sip.bpOrder=e.BP_ORDER||0,this.sip.aCoeffs=[],this.sip.bCoeffs=[],this.sip.apCoeffs=[],this.sip.bpCoeffs=[];for(t=i=0,h=this.sip.aOrder;0<=h?i<=h:i>=h;t=0<=h?++i:--i){this.sip.aCoeffs[t]=[];for(n=s=0,p=this.sip.aOrder;0<=p?s<=p:s>=p;n=0<=p?++s:--s)r="A_"+t+"_"+n,this.sip.aCoeffs[t][n]=e[r]||0}for(t=o=0,d=this.sip.bOrder;0<=d?o<=d:o>=d;t=0<=d?++o:--o){this.sip.bCoeffs[t]=[];for(n=u=0,v=this.sip.bOrder;0<=v?u<=v:u>=v;n=0<=v?++u:--u)r="B_"+t+"_"+n,this.sip.bCoeffs[t][n]=e[r]||0}for(t=a=0,m=this.sip.apOrder;0<=m?a<=m:a>=m;t=0<=m?++a:--a){this.sip.apCoeffs[t]=[];for(n=f=0,g=this.sip.apOrder;0<=g?f<=g:f>=g;n=0<=g?++f:--f)r="AP_"+t+"_"+n,this.sip.apCoeffs[t][n]=e[r]||0}for(t=l=0,y=this.sip.bpOrder;0<=y?l<=y:l>=y;t=0<=y?++l:--l){this.sip.bpCoeffs[t]=[];for(n=c=0,b=this.sip.bpOrder;0<=b?c<=b:c>=b;n=0<=b?++c:--c)r="BP_"+t+"_"+n,this.sip.bpCoeffs[t][n]=e[r]||0}if(!this.sip.aCoeffs&&!this.sip.bCoeffs)throw"Where are the coefficients dude!"},r.prototype.computeCelestialParameters=function(t,n){var r,i,s,o,u,a,f,l,c,h,p,d;return p=this.wcsobj.crval,r=p[0],i=p[1],d=[this.wcsobj.lonpole,this.wcsobj.latpole],f=d[0],h=d[1],s=e.Math.atan2d(e.Math.sind(this.wcsobj.theta0),e.Math.cosd(this.wcsobj.theta0*e.Math.cosd(f-this.wcsobj.phi0))),o=e.Math.acosd(e.Math.sind(i)/Math.sqrt(1-Math.pow(e.Math.cosd(this.wcsobj.theta0),2)*Math.pow(e.Math.sind(f-this.wcsobj.phi0),2))),l=c=!1,s+o>=-90&&s+o<=90&&(l=!0),s-o>=-90&&s-o<=90&&(c=!0),l&&c?(u=Math.abs(s+o-h),a=Math.abs(s-o-h),this.wcsobj.deltaP=u<a?s+o:s-o):l?this.wcsobj.deltaP=s+o:c?this.wcsobj.deltaP=s-o:this.wcsobj.deltaP=h,this.wcsobj.alphaP=Math.abs(i)===90?r:r-e.Math.asind(e.Math.sind(f-this.wcsobj.phi0)*e.Math.cosd(this.wcsobj.theta0)/e.Math.cosd(i))},r.prototype.toIntermediate=function(e){var t,n,r,i,s,o,u;r=[];for(t=i=0,o=this.wcsobj.naxis-1;0<=o?i<=o:i>=o;t=0<=o?++i:--i){r[t]=0,e[t]-=this.wcsobj.crpix[t];for(n=s=0,u=this.wcsobj.naxis-1;0<=u?s<=u:s>=u;n=0<=u?++s:--s)r[t]+=this.wcsobj.cdelt[t]*this.wcsobj.pc[t][n]*e[n]}return r},r.prototype.fromIntermediate=function(e){var t,n,r,i,s,o,u;r=[];for(t=i=0,o=this.wcsobj.naxis-1;0<=o?i<=o:i>=o;t=0<=o?++i:--i){r[t]=0;for(n=s=0,u=this.wcsobj.naxis-1;0<=u?s<=u:s>=u;n=0<=u?++s:--s)r[t]+=this.wcsobj.pcInv[t][n]*e[n]/this.wcsobj.cdelt[t];r[t]+=this.wcsobj.crpix[t]}return r},r.prototype.toCelestial=function(t,n){var r,i,s,o,u,a,f,l,c,h,p;return l=e.Math.sind(n),s=e.Math.cosd(n),f=e.Math.sind(t-this.wcsobj.lonpole),i=e.Math.cosd(t-this.wcsobj.lonpole),a=e.Math.sind(this.wcsobj.deltaP),r=e.Math.cosd(this.wcsobj.deltaP),c=l*r-s*a*i,h=-s*f,p=l*a+s*r*i,u=e.Math.atan2d(h,c)+this.wcsobj.alphaP,u=(u+360)%360,o=e.Math.asind(p),[u,o]},r.prototype.fromCelestial=function(t,n){var r,i,s,o,u,a,f,l,c,h;return a=e.Math.sind(n),i=e.Math.cosd(n),f=e.Math.sind(this.wcsobj.deltaP),s=e.Math.cosd(this.wcsobj.deltaP),u=e.Math.sind(t-this.wcsobj.alphaP),r=e.Math.cosd(t-this.wcsobj.alphaP),c=a*s-i*f*r,h=-i*u,o=this.wcsobj.lonpole+e.Math.atan2d(h,c),l=e.Math.asind(a*f+i*s*r),[o,l]},r.prototype.pixelToCoordinate=function(){var e;return e=this.toIntermediate(arguments[0],arguments[1]),e=this.toSpherical(e[0],e[1]),e=this.toCelestial(e[0],e[1]),{ra:e[this.longitudeAxis-1],dec:e[this.latitudeAxis-1]}},r.prototype.coordinateToPixel=function(){var e;return e=this.fromCelestial(arguments[0],arguments[1]),e=this.fromSpherical(e[0],e[1]),e=this.fromIntermediate(e),{x:e[0],y:e[1]}},r}()}.call(this),define("wcs",function(){}),define("Utils",["gw/CoordinateSystem","wcs"],function(e){function n(e,t,n){var i=Math.floor(e*6),s=e*6-i,o=n*(1-t),u=n*(1-s*t),a=n*(1-(1-s)*t);switch(i){case 0:r=n,g=a,b=o;break;case 1:r=u,g=n,b=o;break;case 2:r=o,g=n,b=a;break;case 3:r=o,g=u,b=n;break;case 4:r=a,g=o,b=n;break;case 5:r=n,g=o,b=u;break;default:r=1,g=1,b=1}return[r,g,b]}function i(e,t){var n=wcs.pixelToCoordinate([e,t]);return n.ra>180&&(n.ra-=360),[n.ra,n.dec]}var t;return{init:function(e){t=e},roundNumber:function(e,t){var n=Math.round(e*Math.pow(10,t))/Math.pow(10,t);return n},inherits:function(e,t){function n(){}n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t},generateColor:function(){var e=.618033988749895,t=Math.random();return t+=e,t%=1,n(t,.5,.95)},formatCoordinates:function(t){var n=[];return e.type=="EQ"?e.fromGeoToEquatorial([t[0],t[1]],n):(t=e.convert(t,"EQ",e.type),t[0]<0&&(t[0]+=360),n[0]=this.roundNumber(t[0],4),n[0]+="¬∞",n[1]=this.roundNumber(t[1],4),n[1]+="¬∞"),n},formatId:function(e){return e.replace(/\s{1,}|\.{1,}|\[{1,}|\]{1,}|\({1,}|\){1,}|\~{1,}|\+{1,}|\¬∞{1,}|\-{1,}|\'{1,}|\"{1,}/g,"")},getPolygonCoordinatesFromFits:function(e){var t=e.getHDU(),n=t.data;wcs=new WCS.Mapper(t.header);var r=[],s=wcs.coordinateToPixel(99.77120833333333,5.540722222222222),o=wcs.pixelToCoordinate([4844.563607341353,.46768419804220684]);return r.push(i(0,n.height)),r.push(i(n.width,n.height)),r.push(i(n.width,0)),r.push(i(0,0)),r.push(r[0]),r},computeGeometryBarycenter:function(e){switch(e.type){case"Point":return[e.coordinates[0],e.coordinates[1]];case"Polygon":var t=0,n=0,r=0;for(var i=0;i<e.coordinates[0].length-1;i++)t+=e.coordinates[0][i][0],n+=e.coordinates[0][i][1],r++;break;case"MultiPolygon":var t=0,n=0,r=0;for(var i=0;i<e.coordinates.length;i++){var s=e.coordinates[i][0];for(var o=0;o<s.length-1;o++)t+=s[o][0],n+=s[o][1],r++}break;default:return}return[t/r,n/r]},pointInRing:function(e,t){var n=t.length;t[0][0]==t[n-1][0]&&t[0][1]==t[n-1][1]&&n--;var r=!1,i=n-1;for(var s=0;s<n;i=s++)t[s][1]>e[1]!=t[i][1]>e[1]&&e[0]<(t[i][0]-t[s][0])*(e[1]-t[s][1])/(t[i][1]-t[s][1])+t[s][0]&&(r=!r);return r},pointInSphere:function(n,r,i){var s=[],o=[],u=t.renderContext.computePixelSizeVector();e.fromGeoTo3D(n,s),e.fromGeoTo3D(r,o);var a=i*(u[0]*o[0]+u[1]*o[1]+u[2]*o[2]+u[3]),f=[];return vec3.subtract(s,o,f),f=vec3.dot(f,f),f<a*a?!0:!1}}}),define("SelectionTool",["jquery","gw/VectorLayer","gw/FeatureStyle","gw/Numeric","gw/CoordinateSystem","./Utils","gw/glMatrix"],function(e,t,n,r,i,s){var o=function(e){var r=e.globe,i=e.navigation,o=e.onselect;this.activated=!1,this.renderContext=r.renderContext;var u;e&&e.style?u=e.style:u=new n,u.zIndex=2,this.selectionLayer=new t({style:u}),r.addLayer(this.selectionLayer),this.selectionFeature=null,this.radius,this.pickPoint,this.geoRadius,this.geoPickPoint;var a=this,f=!1,l;this.renderContext.canvas.addEventListener("mousedown",function(e){var t=[e.clientX,e.clientY],n=r.getLonLatFromPixel(e.clientX,e.clientY);if(!a.activated&&!a.selectionFeature)return;if(a.activated)i.stop(),f=!0,a.pickPoint=t,a.geoPickPoint=n,a.radius=0,l="resize";else{var o=s.pointInRing(n,a.selectionFeature.geometry.coordinates[0]);if(!o)return;i.stop(),f=!0;var u=!1;for(var c=0;c<a.selectionFeature.geometry.coordinates[0].length;c++){var h=a.selectionFeature.geometry.coordinates[0][c];u|=s.pointInSphere(n,h,20)}u?l="resize":l="move"}}),this.renderContext.canvas.addEventListener("mousemove",function(e){if(!f)return;var t=r.getLonLatFromPixel(e.clientX,e.clientY);l=="resize"?(a.radius=Math.sqrt(Math.pow(e.clientX-a.pickPoint[0],2)+Math.pow(e.clientY-a.pickPoint[1],2)),a.computeGeoRadius(t)):l=="move"&&(a.pickPoint=[e.clientX,e.clientY],a.geoPickPoint=r.getLonLatFromPixel(e.clientX,e.clientY)),a.updateSelection()}),this.renderContext.canvas.addEventListener("mouseup",function(e){if(!f)return;var t=r.getLonLatFromPixel(e.clientX,e.clientY);a.activated&&o&&o(),i.start(),f=!1})};return o.prototype.computeGeoRadius=function(e){var t=vec3.dot(i.fromGeoTo3D(e),i.fromGeoTo3D(this.geoPickPoint)),n=Math.acos(t);this.geoRadius=r.toDegree(n)},o.prototype.computeSelection=function(){var e=this.renderContext,t=mat4.create();mat4.inverse(e.viewMatrix,t);var n=[t[12],t[13],t[14]];mat4.multiply(e.projectionMatrix,e.viewMatrix,t),mat4.inverse(t);var s=2/e.canvas.width,o=2/e.canvas.height,u=[[(this.pickPoint[0]-this.radius)*s-1,(e.canvas.height-this.pickPoint[1]-this.radius)*o-1,1,1],[(this.pickPoint[0]-this.radius)*s-1,(e.canvas.height-this.pickPoint[1]+this.radius)*o-1,1,1],[(this.pickPoint[0]+this.radius)*s-1,(e.canvas.height-this.pickPoint[1]+this.radius)*o-1,1,1],[(this.pickPoint[0]+this.radius)*s-1,(e.canvas.height-this.pickPoint[1]-this.radius)*o-1,1,1]],a=vec3.create(),f=[0,0,0];for(var l=0;l<4;l++){mat4.multiplyVec4(t,u[l]),vec3.scale(u[l],1/u[l][3]),vec3.subtract(u[l],n,u[l]),vec3.normalize(u[l]);var c=r.raySphereIntersection(n,u[l],f,i.radius);if(c<0)return null;u[l]=i.from3DToGeo(r.pointOnRay(n,u[l],c,a))}return u},o.prototype.updateSelection=function(){this.selectionFeature&&this.selectionLayer.removeFeature(this.selectionFeature);var e=this.computeSelection();e.push(e[0]),this.selectionFeature={geometry:{gid:"selectionShape",coordinates:[e],type:"Polygon"},type:"Feature"},this.selectionLayer.addFeature(this.selectionFeature)},o.prototype.toggle=function(){this.activated=!this.activated,this.activated?e(this.renderContext.canvas).css("cursor","url(css/images/selectionCursor.png)"):e(this.renderContext.canvas).css("cursor","default")},o.prototype.clear=function(){this.selectionFeature&&this.selectionLayer.removeFeature(this.selectionFeature),this.pickPoint=null,this.radius=null,this.geoPickPoint=null,this.geoRadius=null},o}),define("UWSBase",["jquery"],function(e){var t=function(e,t,n){this.name=e,this.baseUrl=t,this.successCallback=null,this.failCallback=null,this.onloadCallback=null,this.checkFn=null,this.checkDelay=n&&n.hasOwnProperty("checkDelay")?n.checkDelay:2e3,this.currentJob};return t.prototype.getJobResults=function(){var t=this;e.ajax({type:"GET",url:this.baseUrl+"/"+this.currentJob+"/results?media=json",success:function(e,n,r){t.successCallback&&t.successCallback(e,t.currentJob)},error:function(e,n,r){t.failCallback&&t.failCallback("Internal server error")}})},t.prototype.checkPhase=function(){var t=this;e.ajax({type:"GET",url:this.baseUrl+"/"+this.currentJob+"/phase",success:function(e,n,r){t.onloadCallback&&t.onloadCallback(e),e=="COMPLETED"?(window.clearInterval(t.checkFn),t.getJobResults()):e=="ERROR"&&(window.clearInterval(t.checkFn),t.failCallback&&t.failCallback("Internal server error"))},error:function(e,n,r){window.clearInterval(t.checkFn),t.failCallback&&t.failCallback(t.name+" service: "+r),console.error(e.responseText)}})},t.prototype.post=function(t,n){this.successCallback=n.successCallback,this.onloadCallback=n.onloadCallback,this.failCallback=n.failCallback;if(!this.baseUrl)this.failCallback&&this.failCallback(this.name+" service: baseUrl is undefined"),console.error(this.name+" service baseUrl is undefined");else{window.clearInterval(this.checkFn);var r=this;e.ajax({type:"POST",url:this.baseUrl,dataType:"xml",data:t,success:function(t,n,i){var s=e.parseXML(i.responseText);r.currentJob=e(s).find("uws\\:jobId, jobId").text(),r.checkFn=window.setInterval(function(){r.checkPhase.call(r)},r.checkDelay)},error:function(e,t,n){window.clearInterval(r.checkFn),r.failCallback&&r.failCallback(r.name+" service: "+n),console.error(e.responseText)}})}},t.prototype.delete=function(t,n){var r=n.successCallback,i=n.failCallback;if(!this.baseUrl)this.failCallback&&this.failCallback(this.name+" service: baseUrl is undefined"),console.error(this.name+" service baseUrl is undefined");else{var s=this;e.ajax({type:"DELETE",url:this.baseUrl+"/"+t,success:function(e,t,n){r&&r()},error:function(e,t,n){i&&i(s.name+" service: "+n),console.error(e.responseText)}})}},t}),define("UWSManager",["./UWSBase"],function(e){var t,n,r;return{init:function(i){i.cutOut&&(t=new e("CutOut",i.cutOut.baseUrl)),i.healpixcut&&(r=new e("HealpixCut",i.healpixcut.baseUrl)),i.zScale&&(n=new e("ZScale",i.zScale.baseUrl))},post:function(e,i,s){switch(e){case"cutout":t.post(i,s);break;case"healpixcut":r.post(i,s);break;case"zscale":n.post(i,s);break;default:console.error("Not supported")}},"delete":function(e,i,s){switch(e){case"cutout":t.delete(i,s);break;case"healpixcut":r.delete(i,s);break;case"zscale":n.delete(i,s);break;default:console.error("Not supported")}}}});var samp=function(){var e=21012,t="/",n="samp.webhub.",r="";TYPE_STRING="string",TYPE_LIST="list",TYPE_MAP="map";var i=function(e){function t(){}return t.prototype=e,new t},s=function(e){if(typeof e=="string")return TYPE_STRING;if(e instanceof Array)return TYPE_LIST;if(e instanceof Object&&e!==null)return TYPE_MAP;throw new Error("Not legal SAMP object type: "+e)},o=function(e,t){var n=e.childNodes,r,i=[],s;for(s=0;s<n.length;s++){r=n[s];if(r.nodeType===1){if(t&&r.tagName!==t)throw new Error("Child <"+n[s].tagName+">"+" of <"+e.tagName+">"+" is not a <"+t+">");i.push(r)}}return i},u=function(e,t){var n=o(e,t);if(n.length===1)return n[0];throw new Error("No sole child of <"+e.tagName+">")},a=function(e){var t="",n,r;for(n=0;n<e.childNodes.length;n++){r=e.childNodes[n];if(r.nodeType===1)throw new Error("Element found in text content");if(r.nodeType===3||r.nodeType===4)t+=r.nodeValue}return t},f=function(e){return typeof JSON=="undefined"?"...":JSON.stringify(e)},l={};l.escapeXml=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},l.checkParams=function(e,t){var n;for(n=0;n<t.length;n++)if(t[n]!==TYPE_STRING&&t[n]!==TYPE_LIST&&t[n]!==TYPE_MAP)throw new Error("Unknown type "+t[n]+" in check list");var r=e.length,i=[],o=!0;for(n=0;n<r;n++)i.push(s(e[n]));o=o&&t.length===r;for(n=0;o&&n<r;n++)o=o&&t[n]===i[n];if(!o)throw new Error("Param type list mismatch: ["+t+"] != "+"["+i+"]")},l.valueToXml=function x(e,t){t=t||"";var n,r,i,o=s(e);if(o===TYPE_STRING)return t+"<value><string>"+l.escapeXml(e)+"</string></value>";if(o===TYPE_LIST){i=[],i.push(t+"<value>",t+"  <array>",t+"    <data>");for(r=0;r<e.length;r++)i.push(x(e[r],t+"      "));return i.push(t+"    </data>",t+"  </array>",t+"</value>"),i.join("\n")}if(o===TYPE_MAP){i=[],i.push(t+"<value>"),i.push(t+"  <struct>");for(r in e)i.push(t+"    <member>"),i.push(t+"      <name>"+l.escapeXml(r)+"</name>"),i.push(x(e[r],t+"      ")),i.push(t+"    </member>");return i.push(t+"  </struct>"),i.push(t+"</value>"),i.join("\n")}throw new Error("bad type")},l.xmlToValue=function T(e,t){var n=o(e),r,i,s,f,l,c;if(n.length===0)return a(e);if(n.length===1){l=n[0],c=l.tagName;if(c==="string")return a(l);if(c==="array"){var h=o(u(l,"data"),"value"),p=[];for(r=0;r<h.length;r++)p.push(T(h[r],t));return p}if(c==="struct"){var d=o(l,"member"),v={},m,g,y;for(r=0;r<d.length;r++){m=undefined,g=undefined;for(i=0;i<d[r].childNodes.length;i++)y=d[r].childNodes[i],y.nodeType==1&&(y.tagName==="name"?m=a(y):y.tagName==="value"&&(g=T(y,t)));if(m===undefined||g===undefined)throw new Error("No <name> and/or <value> in <member>?");v[m]=g}return v}if(!t||c!=="int"&&c!=="i4")throw new Error("Non SAMP-friendly value content: <"+c+">");return a(l)}throw new Error("Bad XML-RPC <value> content - multiple elements")},l.decodeParams=function(e){var t=o(e,"param"),n,r=[];for(n=0;n<t.length;n++)r.push(l.xmlToValue(u(t[n],"value")));return r},l.decodeFault=function(e){var t=l.xmlToValue(u(e,"value"),!0);return new l.Fault(t.faultString,t.faultCode)},l.decodeResponse=function(e){var t=e.documentElement;if(t.tagName!=="methodResponse")throw new Error("Response element is not <methodResponse>");var n=u(t);if(n.tagName==="fault")return l.decodeFault(n);if(n.tagName==="params")return l.decodeParams(n)[0];throw new Error("Bad XML-RPC response - unknown element <"+n.tagName+">")},l.Fault=function(e,t){this.faultString=e,this.faultCode=t},l.Fault.prototype.toString=function(){return"XML-RPC Fault ("+this.faultCode+"): "+this.faultString};var c=function(e,t){this.methodName=e,this.params=t||[]};c.prototype.toString=function(){return this.methodName+"("+f(this.params)+")"},c.prototype.addParam=function(e){return this.params.push(e),this},c.prototype.addParams=function(e){var t;for(t=0;t<e.length;t++)this.params.push(e[t]);return this},c.prototype.checkParams=function(e){l.checkParams(this.params,e)},c.prototype.toXml=function(){var e=[];e.push("<?xml version='1.0'?>","<methodCall>","  <methodName>"+this.methodName+"</methodName>","  <params>");for(var t=0;t<this.params.length;t++)e.push("    <param>",l.valueToXml(this.params[t],"      "),"    </param>");return e.push("  </params>","</methodCall>"),e.join("\n")};var h=function(n){this.endpoint=n||"http://localhost:"+e+t};h.createXHR=function(){var e=function(e){this.xhr=e,e.onreadystatechange=function(t){return function(){if(e.readyState!==4)return;t.completed||+e.status===200&&(t.completed=!0,t.responseText=e.responseText,t.responseXML=e.responseXML,t.onload&&t.onload())}}(this),e.onerror=function(e){return function(t){e.completed||(e.completed=!0,e.onerror&&(t?t.toString=function(){return"No hub?"}:t="No hub?",e.onerror(t)))}}(this),e.ontimeout=function(e){return function(t){e.completed||(e.completed=!0,e.onerror&&e.onerror("timeout"))}}(this)};e.prototype.open=function(e,t){this.xhr.open(e,t)},e.prototype.send=function(e){this.xhr.send(e)},e.prototype.abort=function(){this.xhr.abort()},e.prototype.setContentType=function(e){"setRequestHeader"in this.xhr&&this.xhr.setRequestHeader("Content-Type",e)};var t=function(e){this.xdr=e,e.onload=function(t){return function(){var n;t.responseText=e.responseText;if(e.contentType==="text/xml"||e.contentType==="application/xml"||/\/x-/.test(e.contentType))try{var r=new ActiveXObject("Microsoft.XMLDOM");r.loadXML(e.responseText),t.responseXML=r}catch(n){t.responseXML=n}t.onload&&t.onload()}}(this),e.onerror=function(e){return function(t){e.onerror&&e.onerror(t)}}(this),e.ontimeout=function(e){return function(t){e.onerror&&e.onerror(t)}}(this)};t.prototype.open=function(e,t){this.xdr.open(e,t)},t.prototype.send=function(e){this.xdr.send(e)},t.prototype.abort=function(){this.xdr.abort()},t.prototype.setContentType=function(e){};if(typeof XMLHttpRequest!="undefined"){var n=new XMLHttpRequest;if("withCredentials"in n)return new e(n)}if(typeof XDomainRequest!="undefined")return new t(new XDomainRequest);if(typeof flensed.flXHR!="undefined")return new e(new flensed.flXHR({instancePooling:!0}));throw new Error("no cross-origin mechanism available")},h.prototype.execute=function(e,t,n){(function(r){var i,s;try{i=h.createXHR(),i.open("POST",r.endpoint),i.setContentType("text/xml")}catch(s){throw n(s),s}return i.onload=function(){var e=i.responseXML,r,s;if(!e){n&&n("no XML response");return}try{r=l.decodeResponse(e)}catch(s){n&&n(s);return}r instanceof l.Fault?n&&n(r):t&&t(r)},i.onerror=function(e){e?e.toString=function(){return"No hub?"}:e="No hub",n&&n(e)},i.send(e.toXml()),i})(this)};var p=function(e,t){this["samp.mtype"]=e,this["samp.params"]=t},d=function(e){this.regInfo=e,this.privateKey=e["samp.private-key"];if(!typeof this.privateKey==="string")throw new Error("Bad registration object");this.xClient=new h};(function(){var e={call:[TYPE_STRING,TYPE_STRING,TYPE_MAP],callAll:[TYPE_STRING,TYPE_MAP],callAndWait:[TYPE_STRING,TYPE_MAP,TYPE_STRING],declareMetadata:[TYPE_MAP],declareSubscriptions:[TYPE_MAP],getMetadata:[TYPE_STRING],getRegisteredClients:[],getSubscribedClients:[TYPE_STRING],getSubscriptions:[TYPE_STRING],notify:[TYPE_STRING,TYPE_MAP],notifyAll:[TYPE_MAP],ping:[],reply:[TYPE_STRING,TYPE_MAP]},t,r;for(t in e)(function(e,t){d.prototype[e]=function(r,i,s){var o=function(e){return function(){e.close()}}(this);s=s||o,l.checkParams(r,t);var u=new c(n+e);return u.addParam(this.privateKey),u.addParams(r),this.xClient.execute(u,i,s)}})(t,e[t])})(),d.prototype.unregister=function(){var e;if(this.callbackRequest)try{this.callbackRequest.abort()}catch(e){}var t=new c(n+"unregister");t.addParam(this.privateKey);try{this.xClient.execute(t)}catch(e){}delete this.regInfo,delete this.privateKey},d.prototype.close=function(){var e;if(this.closed)return;this.closed=!0;try{this.regInfo&&this.unregister()}catch(e){}if(this.onclose){oc=this.onclose,delete this.onclose;try{oc()}catch(e){}}},d.prototype.setCallable=function(e,t){var i;if(this.callbackRequest)try{this.callbackRequest.abort()}catch(i){}finally{delete this.callbackRequest}if(!e&&!this.regInfo)return;var o=new c(n+"allowReverseCallbacks");o.addParam(this.privateKey),o.addParam(e?"1":"0");var u=function(e){return function(){e.close()}}(this);e?function(i){var a=function(t){var n=t["samp.methodName"],i=t["samp.params"],s=undefined;n===r+"receiveNotification"?s=e.receiveNotification:n===r+"receiveCall"?s=e.receiveCall:n===r+"receiveResponse"&&(s=e.receiveResponse),s&&s.apply(e,i)},f,l=function(e){if(s(e)!=TYPE_LIST){h(new Error("pullCallbacks result not List"));return}var t,n;for(t=0;t<e.length;t++)try{a(e[t])}catch(n){}p()},h=function(e){var t=(new Date).getTime()-f;t<1e3?i.close():p()},p=function(){if(!i.regInfo)return;var e=new c(n+"pullCallbacks");e.addParam(i.privateKey),e.addParam("600"),f=(new Date).getTime(),i.callbackRequest=i.xClient.execute(e,l,h)},d=function(){p(),t()};i.xClient.execute(o,d,u)}(this):this.xClient.execute(o,t,u)},d.prototype.translateUrl=function(e){var t=this.regInfo["samp.url-translator"]||"";return t+e},d.Action=function(e,t,n){this.actName=e,this.actArgs=t,this.resultKey=n};var v=function(e){this.callHandler={},this.replyHandler={}};v.prototype.init=function(e){},v.prototype.receiveNotification=function(e,t){var n=t["samp.mtype"],r=!1,i;if(n in this.callHandler){try{this.callHandler[n](e,t,!1)}catch(i){}r=!0}return r},v.prototype.receiveCall=function(e,t,n){var r=n["samp.mtype"],i=!1,s,o,u;if(r in this.callHandler)try{o=this.callHandler[r](e,n,!0)||{},s={"samp.status":"samp.ok","samp.result":o},i=!0}catch(u){s={"samp.status":"samp.error","samp.error":{"samp.errortxt":u.toString()}}}else s={"samp.status":"samp.warning","samp.result":{},"samp.error":{"samp.errortxt":"no action"}};return this.connection.reply([t,s]),i},v.prototype.receiveResponse=function(e,t,n){var r=!1,i;if(t in this.replyHandler)try{this.replyHandler[t](e,t,n),r=!0}catch(i){}return r},v.prototype.calculateSubscriptions=function(){var e={},t;for(t in this.callHandler)e[t]={};return e};var m=function(){var e=this;this.ids={},this.metas={},this.subs={},this.replyHandler={},this.callHandler={"samp.hub.event.shutdown":function(t,n){e.connection.close()},"samp.hub.disconnect":function(t,n){e.connection.close()},"samp.hub.event.register":function(t,n){var r=n["samp.params"].id;e.ids[r]=!0,e.changed(r,"register",null)},"samp.hub.event.unregister":function(t,n){var r=n["samp.params"].id;delete e.ids[r],delete e.metas[r],delete e.subs[r],e.changed(r,"unregister",null)},"samp.hub.event.metadata":function(t,n){var r=n["samp.params"].id,i=n["samp.params"].metadata;e.metas[r]=i,e.changed(r,"meta",i)},"samp.hub.event.subscriptions":function(t,n){var r=n["samp.params"].id,i=n["samp.params"].subscriptions;e.subs[r]=i,e.changed(r,"subs",i)}}};m.prototype=i(v.prototype),m.prototype.changed=function(e,t,n){this.onchange&&this.onchange(e,t,n)},m.prototype.init=function(e){var t=this;this.connection=e;var n=function(n,r,i,s){e[i]([n],function(e){s[n]=e,t.changed(n,r,e)})};e.getRegisteredClients([],function(e){var r,i;t.ids={};for(r=0;r<e.length;r++)i=e[r],t.ids[i]=!0,n(i,"meta","getMetadata",t.metas),n(i,"subs","getSubscriptions",t.subs);t.changed(null,"ids",null)})},m.prototype.getName=function(e){var t=this.metas[e];return t&&t["samp.name"]?t["samp.name"]:"["+e+"]"};var g=function(e,t,n,r){this.name=e,this.meta=t,this.callableClient=n,this.subs=r,this.regTextNodes=[],this.whenRegs=[],this.whenUnregs=[],this.connection=undefined,this.onreg=undefined,this.onunreg=undefined},y=function(e,t){var n,r=e.regTextNodes,i;for(n=0;n<r.length;n++)i=r[n],i.innerHTML="",i.appendChild(document.createTextNode(t))};g.prototype.setConnection=function(e){var t=this,n;if(this.connection){this.connection.close();if(this.onunreg)try{this.onunreg()}catch(n){}}this.connection=e;if(e){e.onclose=function(){t.connection=null;if(t.onunreg)try{t.onunreg()}catch(e){}t.update()},this.meta&&e.declareMetadata([this.meta]),this.callableClient&&(this.callableClient.init&&this.callableClient.init(e),e.setCallable(this.callableClient,function(){e.declareSubscriptions([t.subs])}));if(this.onreg)try{this.onreg(e)}catch(n){}}this.update()},g.prototype.register=function(){var e=this,t=function(t){y(e,"no ("+t.toString()+")")},n=function(t){e.setConnection(t),y(e,t?"Yes":"No")};w(this.name,n,t)},g.prototype.unregister=function(){this.connection&&(this.connection.unregister([]),this.setConnection(null))},g.prototype.createRegButtons=function(){var e=this,t=document.createElement("button");t.setAttribute("type","button"),t.appendChild(document.createTextNode("Register")),t.onclick=function(){e.register()},this.whenUnregs.push(t);var n=document.createElement("button");n.setAttribute("type","button"),n.appendChild(document.createTextNode("Unregister")),n.onclick=function(){e.unregister()},this.whenRegs.push(n);var r=document.createElement("span");this.regTextNodes.push(r);var i=document.createDocumentFragment();i.appendChild(t),i.appendChild(document.createTextNode(" ")),i.appendChild(n);var s=document.createElement("span");return s.innerHTML=" <strong>Registered: </strong>",i.appendChild(s),i.appendChild(r),this.update(),i},g.prototype.update=function(){var e,t=!!this.connection,n=t?this.whenRegs:this.whenUnregs,r=t?this.whenUnregs:this.whenRegs;for(e=0;e<n.length;e++)n[e].removeAttribute("disabled");for(e=0;e<r.length;e++)r[e].setAttribute("disabled","disabled");y(this,"No")},g.prototype.runWithConnection=function(e,t){var n=this,r=function(t){n.setConnection(t),e(t)},i=function(e){n.setConnection(undefined),t(e)},s=function(t){e(n.connection)},o=function(e){w(this.name,r,i)};this.connection?this.connection.getRegisteredClients([],s,o):w(this.name,r,i)},g.prototype.onHubAvailability=function(e,t){return samp.ping(e),setInterval(function(){samp.ping(e)},t)};var b=function(e,t){var n=function(e,t){if(e==t)return!0;if(e==="*")return!0;var n,i=/^(.*)\.\*$/.exec(r);if(i){n=i[1];if(n===t.substring(0,n.length))return!0}return!1},r;for(r in e)if(n(r,t))return!0;return!1},w=function(e,t,r){var i=new h,s=new c(n+"register"),o={"samp.name":e};s.addParam(o),s.checkParams([TYPE_MAP]);var u=function(e){var n,i;try{n=new d(e)}catch(i){r(i);return}t(n)};i.execute(s,u,r)},E=function(e){var t=new h,r=new c(n+"ping"),i=function(t){e(!0)},s=function(t){e(!1)};t.execute(r,i,s)},S={};return S.XmlRpcRequest=c,S.XmlRpcClient=h,S.Message=p,S.TYPE_STRING=TYPE_STRING,S.TYPE_LIST=TYPE_LIST,S.TYPE_MAP=TYPE_MAP,S.register=w,S.ping=E,S.isSubscribed=b,S.Connector=g,S.CallableClient=v,S.ClientTracker=m,S}();return define("samp",function(){}),function(e){"function"==typeof define&&define.amd?define("jquery.ui",["jquery"],e):e(jQuery)}(function(e){function t(t,r){var i,s,o,u=t.nodeName.toLowerCase();return"area"===u?(i=t.parentNode,s=i.name,t.href&&s&&"map"===i.nodeName.toLowerCase()?(o=e("img[usemap=#"+s+"]")[0],!!o&&n(o)):!1):(/input|select|textarea|button|object/.test(u)?!t.disabled:"a"===u?t.href||r:r)&&n(t)}function n(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}function r(e){for(var t,n;e.length&&e[0]!==document;){if(t=e.css("position"),("absolute"===t||"relative"===t||"fixed"===t)&&(n=parseInt(e.css("zIndex"),10),!isNaN(n)&&0!==n))return n;e=e.parent()}return 0}function i(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},e.extend(this._defaults,this.regional[""]),this.regional.en=e.extend(!0,{},this.regional[""]),this.regional["en-US"]=e.extend(!0,{},this.regional.en),this.dpDiv=s(e("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function s(t){var n="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.delegate(n,"mouseout",function(){e(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).removeClass("ui-datepicker-next-hover")}).delegate(n,"mouseover",function(){e.datepicker._isDisabledDatepicker(m.inline?t.parent()[0]:m.input[0])||(e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),e(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).addClass("ui-datepicker-next-hover"))})}function o(t,n){e.extend(t,n);for(var r in n)null==n[r]&&(t[r]=n[r]);return t}function u(e){return function(){var t=this.element.val();e.apply(this,arguments),this._refresh(),t!==this.element.val()&&this._trigger("change")}}e.ui=e.ui||{},e.extend(e.ui,{version:"1.11.0",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({scrollParent:function(){var t=this.css("position"),n="absolute"===t,r=this.parents().filter(function(){var t=e(this);return n&&"static"===t.css("position")?!1:/(auto|scroll)/.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==t&&r.length?r:e(this[0].ownerDocument||document)},uniqueId:function(){var e=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,r){return!!e.data(t,r[3])},focusable:function(n){return t(n,!isNaN(e.attr(n,"tabindex")))},tabbable:function(n){var r=e.attr(n,"tabindex"),i=isNaN(r);return(i||r>=0)&&t(n,!i)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(t,n){function r(t,n,r,s){return e.each(i,function(){n-=parseFloat(e.css(t,"padding"+this))||0,r&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),s&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var i="Width"===n?["Left","Right"]:["Top","Bottom"],s=n.toLowerCase(),o={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+n]=function(t){return void 0===t?o["inner"+n].call(this):this.each(function(){e(this).css(s,r(this,t)+"px")})},e.fn["outer"+n]=function(t,i){return"number"!=typeof t?o["outer"+n].call(this,t):this.each(function(){e(this).css(s,r(this,t,!0,i)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(n){return arguments.length?t.call(this,e.camelCase(n)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.fn.extend({focus:function(t){return function(n,r){return"number"==typeof n?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),r&&r.call(t)},n)}):t.apply(this,arguments)}}(e.fn.focus),disableSelection:function(){var e="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(e+".ui-disableSelection",function(e){e.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(t){if(void 0!==t)return this.css("zIndex",t);if(this.length)for(var n,r,i=e(this[0]);i.length&&i[0]!==document;){if(n=i.css("position"),("absolute"===n||"relative"===n||"fixed"===n)&&(r=parseInt(i.css("zIndex"),10),!isNaN(r)&&0!==r))return r;i=i.parent()}return 0}}),e.ui.plugin={add:function(t,n,r){var i,s=e.ui[t].prototype;for(i in r)s.plugins[i]=s.plugins[i]||[],s.plugins[i].push([n,r[i]])},call:function(e,t,n,r){var i,s=e.plugins[t];if(s&&(r||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(i=0;s.length>i;i++)e.options[s[i][0]]&&s[i][1].apply(e.element,n)}};var a=0,f=Array.prototype.slice;e.cleanData=function(t){return function(n){for(var r,i=0;null!=(r=n[i]);i++)try{e(r).triggerHandler("remove")}catch(s){}t(n)}}(e.cleanData),e.widget=function(t,n,r){var i,s,o,u,a={},f=t.split(".")[0];return t=t.split(".")[1],i=f+"-"+t,r||(r=n,n=e.Widget),e.expr[":"][i.toLowerCase()]=function(t){return!!e.data(t,i)},e[f]=e[f]||{},s=e[f][t],o=e[f][t]=function(e,t){return this._createWidget?(arguments.length&&this._createWidget(e,t),void 0):new o(e,t)},e.extend(o,s,{version:r.version,_proto:e.extend({},r),_childConstructors:[]}),u=new n,u.options=e.widget.extend({},u.options),e.each(r,function(t,r){return e.isFunction(r)?(a[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},i=function(e){return n.prototype[t].apply(this,e)};return function(){var t,n=this._super,s=this._superApply;return this._super=e,this._superApply=i,t=r.apply(this,arguments),this._super=n,this._superApply=s,t}}(),void 0):(a[t]=r,void 0)}),o.prototype=e.widget.extend(u,{widgetEventPrefix:s?u.widgetEventPrefix||t:t},a,{constructor:o,namespace:f,widgetName:t,widgetFullName:i}),s?(e.each(s._childConstructors,function(t,n){var r=n.prototype;e.widget(r.namespace+"."+r.widgetName,o,n._proto)}),delete s._childConstructors):n._childConstructors.push(o),e.widget.bridge(t,o),o},e.widget.extend=function(t){for(var n,r,i=f.call(arguments,1),s=0,o=i.length;o>s;s++)for(n in i[s])r=i[s][n],i[s].hasOwnProperty(n)&&void 0!==r&&(t[n]=e.isPlainObject(r)?e.isPlainObject(t[n])?e.widget.extend({},t[n],r):e.widget.extend({},r):r);return t},e.widget.bridge=function(t,n){var r=n.prototype.widgetFullName||t;e.fn[t]=function(i){var s="string"==typeof i,o=f.call(arguments,1),u=this;return i=!s&&o.length?e.widget.extend.apply(null,[i].concat(o)):i,s?this.each(function(){var n,s=e.data(this,r);return"instance"===i?(u=s,!1):s?e.isFunction(s[i])&&"_"!==i.charAt(0)?(n=s[i].apply(s,o),n!==s&&void 0!==n?(u=n&&n.jquery?u.pushStack(n.get()):n,!1):void 0):e.error("no such method '"+i+"' for "+t+" widget instance"):e.error("cannot call methods on "+t+" prior to initialization; "+"attempted to call method '"+i+"'")}):this.each(function(){var t=e.data(this,r);t?(t.option(i||{}),t._init&&t._init()):e.data(this,r,new n(i,this))}),u}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,n){n=e(n||this.defaultElement||this)[0],this.element=e(n),this.uuid=a++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),n!==this&&(e.data(n,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===n&&this.destroy()}}),this.document=e(n.style?n.ownerDocument:n.document||n),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(t,n){var r,i,s,o=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(o={},r=t.split("."),t=r.shift(),r.length){for(i=o[t]=e.widget.extend({},this.options[t]),s=0;r.length-1>s;s++)i[r[s]]=i[r[s]]||{},i=i[r[s]];if(t=r.pop(),1===arguments.length)return void 0===i[t]?null:i[t];i[t]=n}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];o[t]=n}return this._setOptions(o),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(t,n,r){var i,s=this;"boolean"!=typeof t&&(r=n,n=t,t=!1),r?(n=i=e(n),this.bindings=this.bindings.add(n)):(r=n,n=this.element,i=this.widget()),e.each(r,function(r,o){function u(){return t||s.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof o?s[o]:o).apply(s,arguments):void 0}"string"!=typeof o&&(u.guid=o.guid=o.guid||u.guid||e.guid++);var a=r.match(/^([\w:-]*)\s*(.*)$/),f=a[1]+s.eventNamespace,l=a[2];l?i.delegate(l,f,u):n.bind(f,u)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return("string"==typeof e?r[e]:e).apply(r,arguments)}var r=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,r){var i,s,o=this.options[t];if(r=r||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],s=n.originalEvent)for(i in s)i in n||(n[i]=s[i]);return this.element.trigger(n,r),!(e.isFunction(o)&&o.apply(this.element[0],[n].concat(r))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(r,i,s){"string"==typeof i&&(i={effect:i});var o,u=i?i===!0||"number"==typeof i?n:i.effect||n:t;i=i||{},"number"==typeof i&&(i={duration:i}),o=!e.isEmptyObject(i),i.complete=s,i.delay&&r.delay(i.delay),o&&e.effects&&e.effects.effect[u]?r[t](i):u!==t&&r[u]?r[u](i.duration,i.easing,s):r.queue(function(n){e(this)[t](),s&&s.call(r[0]),n()})}}),e.widget;var l=!1;e(document).mouseup(function(){l=!1}),e.widget("ui.mouse",{version:"1.11.0",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(n){return!0===e.data(n.target,t.widgetName+".preventClickEvent")?(e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!l){this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var n=this,r=1===t.which,i="string"==typeof this.options.cancel&&t.target.nodeName?e(t.target).closest(this.options.cancel).length:!1;return r&&!i&&this._mouseCapture(t)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){n.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(t)!==!1,!this._mouseStarted)?(t.preventDefault(),!0):(!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return n._mouseMove(e)},this._mouseUpDelegate=function(e){return n._mouseUp(e)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),l=!0,!0)):!0}},_mouseMove:function(t){return e.ui.ie&&(!document.documentMode||9>document.documentMode)&&!t.button?this._mouseUp(t):t.which?this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted):this._mouseUp(t)},_mouseUp:function(t){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),l=!1,!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),function(){function t(e,t,n){return[parseFloat(e[0])*(p.test(e[0])?t/100:1),parseFloat(e[1])*(p.test(e[1])?n/100:1)]}function n(t,n){return parseInt(e.css(t,n),10)||0}function r(t){var n=t[0];return 9===n.nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(n)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:n.preventDefault?{width:0,height:0,offset:{top:n.pageY,left:n.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.ui=e.ui||{};var i,s,o=Math.max,u=Math.abs,a=Math.round,f=/left|center|right/,l=/top|center|bottom/,c=/[\+\-]\d+(\.[\d]+)?%?/,h=/^\w+/,p=/%$/,d=e.fn.position;e.position={scrollbarWidth:function(){if(void 0!==i)return i;var t,n,r=e("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),s=r.children()[0];return e("body").append(r),t=s.offsetWidth,r.css("overflow","scroll"),n=s.offsetWidth,t===n&&(n=r[0].clientWidth),r.remove(),i=t-n},getScrollInfo:function(t){var n=t.isWindow||t.isDocument?"":t.element.css("overflow-x"),r=t.isWindow||t.isDocument?"":t.element.css("overflow-y"),i="scroll"===n||"auto"===n&&t.width<t.element[0].scrollWidth,s="scroll"===r||"auto"===r&&t.height<t.element[0].scrollHeight;return{width:s?e.position.scrollbarWidth():0,height:i?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var n=e(t||window),r=e.isWindow(n[0]),i=!!n[0]&&9===n[0].nodeType;return{element:n,isWindow:r,isDocument:i,offset:n.offset()||{left:0,top:0},scrollLeft:n.scrollLeft(),scrollTop:n.scrollTop(),width:r?n.width():n.outerWidth(),height:r?n.height():n.outerHeight()}}},e.fn.position=function(i){if(!i||!i.of)return d.apply(this,arguments);i=e.extend({},i);var p,v,m,g,y,b,w=e(i.of),E=e.position.getWithinInfo(i.within),S=e.position.getScrollInfo(E),x=(i.collision||"flip").split(" "),T={};return b=r(w),w[0].preventDefault&&(i.at="left top"),v=b.width,m=b.height,g=b.offset,y=e.extend({},g),e.each(["my","at"],function(){var e,t,n=(i[this]||"").split(" ");1===n.length&&(n=f.test(n[0])?n.concat(["center"]):l.test(n[0])?["center"].concat(n):["center","center"]),n[0]=f.test(n[0])?n[0]:"center",n[1]=l.test(n[1])?n[1]:"center",e=c.exec(n[0]),t=c.exec(n[1]),T[this]=[e?e[0]:0,t?t[0]:0],i[this]=[h.exec(n[0])[0],h.exec(n[1])[0]]}),1===x.length&&(x[1]=x[0]),"right"===i.at[0]?y.left+=v:"center"===i.at[0]&&(y.left+=v/2),"bottom"===i.at[1]?y.top+=m:"center"===i.at[1]&&(y.top+=m/2),p=t(T.at,v,m),y.left+=p[0],y.top+=p[1],this.each(function(){var r,f,l=e(this),c=l.outerWidth(),h=l.outerHeight(),d=n(this,"marginLeft"),b=n(this,"marginTop"),N=c+d+n(this,"marginRight")+S.width,C=h+b+n(this,"marginBottom")+S.height,L=e.extend({},y),A=t(T.my,l.outerWidth(),l.outerHeight());"right"===i.my[0]?L.left-=c:"center"===i.my[0]&&(L.left-=c/2),"bottom"===i.my[1]?L.top-=h:"center"===i.my[1]&&(L.top-=h/2),L.left+=A[0],L.top+=A[1],s||(L.left=a(L.left),L.top=a(L.top)),r={marginLeft:d,marginTop:b},e.each(["left","top"],function(t,n){e.ui.position[x[t]]&&e.ui.position[x[t]][n](L,{targetWidth:v,targetHeight:m,elemWidth:c,elemHeight:h,collisionPosition:r,collisionWidth:N,collisionHeight:C,offset:[p[0]+A[0],p[1]+A[1]],my:i.my,at:i.at,within:E,elem:l})}),i.using&&(f=function(e){var t=g.left-L.left,n=t+v-c,r=g.top-L.top,s=r+m-h,a={target:{element:w,left:g.left,top:g.top,width:v,height:m},element:{element:l,left:L.left,top:L.top,width:c,height:h},horizontal:0>n?"left":t>0?"right":"center",vertical:0>s?"top":r>0?"bottom":"middle"};c>v&&v>u(t+n)&&(a.horizontal="center"),h>m&&m>u(r+s)&&(a.vertical="middle"),a.important=o(u(t),u(n))>o(u(r),u(s))?"horizontal":"vertical",i.using.call(this,e,a)}),l.offset(e.extend(L,{using:f}))})},e.ui.position={fit:{left:function(e,t){var n,r=t.within,i=r.isWindow?r.scrollLeft:r.offset.left,s=r.width,u=e.left-t.collisionPosition.marginLeft,a=i-u,f=u+t.collisionWidth-s-i;t.collisionWidth>s?a>0&&0>=f?(n=e.left+a+t.collisionWidth-s-i,e.left+=a-n):e.left=f>0&&0>=a?i:a>f?i+s-t.collisionWidth:i:a>0?e.left+=a:f>0?e.left-=f:e.left=o(e.left-u,e.left)},top:function(e,t){var n,r=t.within,i=r.isWindow?r.scrollTop:r.offset.top,s=t.within.height,u=e.top-t.collisionPosition.marginTop,a=i-u,f=u+t.collisionHeight-s-i;t.collisionHeight>s?a>0&&0>=f?(n=e.top+a+t.collisionHeight-s-i,e.top+=a-n):e.top=f>0&&0>=a?i:a>f?i+s-t.collisionHeight:i:a>0?e.top+=a:f>0?e.top-=f:e.top=o(e.top-u,e.top)}},flip:{left:function(e,t){var n,r,i=t.within,s=i.offset.left+i.scrollLeft,o=i.width,a=i.isWindow?i.scrollLeft:i.offset.left,f=e.left-t.collisionPosition.marginLeft,l=f-a,c=f+t.collisionWidth-o-a,h="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,p="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,d=-2*t.offset[0];0>l?(n=e.left+h+p+d+t.collisionWidth-o-s,(0>n||u(l)>n)&&(e.left+=h+p+d)):c>0&&(r=e.left-t.collisionPosition.marginLeft+h+p+d-a,(r>0||c>u(r))&&(e.left+=h+p+d))},top:function(e,t){var n,r,i=t.within,s=i.offset.top+i.scrollTop,o=i.height,a=i.isWindow?i.scrollTop:i.offset.top,f=e.top-t.collisionPosition.marginTop,l=f-a,c=f+t.collisionHeight-o-a,h="top"===t.my[1],p=h?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,d="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,v=-2*t.offset[1];0>l?(r=e.top+p+d+v+t.collisionHeight-o-s,e.top+p+d+v>l&&(0>r||u(l)>r)&&(e.top+=p+d+v)):c>0&&(n=e.top-t.collisionPosition.marginTop+p+d+v-a,e.top+p+d+v>c&&(n>0||c>u(n))&&(e.top+=p+d+v))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,n,r,i,o,u=document.getElementsByTagName("body")[0],a=document.createElement("div");t=document.createElement(u?"div":"body"),r={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},u&&e.extend(r,{position:"absolute",left:"-1000px",top:"-1000px"});for(o in r)t.style[o]=r[o];t.appendChild(a),n=u||document.documentElement,n.insertBefore(t,n.firstChild),a.style.cssText="position: absolute; left: 10.7432222px;",i=e(a).offset().left,s=i>10&&11>i,t.innerHTML="",n.removeChild(t)}()}(),e.ui.position,e.widget("ui.draggable",e.ui.mouse,{version:"1.11.0",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),"handle"===e&&this._setHandleClassName()},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?(this.destroyOnClear=!0,void 0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),this._mouseDestroy(),void 0)},_mouseCapture:function(t){var n=this.document[0],r=this.options;try{n.activeElement&&"body"!==n.activeElement.nodeName.toLowerCase()&&e(n.activeElement).blur()}catch(i){}return this.helper||r.disabled||e(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?(e(r.iframeFix===!0?"iframe":r.iframeFix).each(function(){e("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(t){var n=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,this.originalPageY=t.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,n){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo("absolute"),!n){var r=this._uiHash();if(this._trigger("drag",t,r)===!1)return this._mouseUp({}),!1;this.position=r.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var n=this,r=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(r=e.ui.ddmanager.drop(this,t)),this.dropped&&(r=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!r||"valid"===this.options.revert&&r||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,r)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){n._trigger("stop",t)!==!1&&n._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1},_mouseUp:function(t){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),this.element.focus(),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!e(t.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this._removeHandleClassName(),e(this.options.handle||this.element).addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.element.find(".ui-draggable-handle").addBack().removeClass("ui-draggable-handle")},_createHelper:function(t){var n=this.options,r=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t])):"clone"===n.helper?this.element.clone().removeAttr("id"):this.element;return r.parents("body").length||r.appendTo("parent"===n.appendTo?this.element[0].parentNode:n.appendTo),r[0]===this.element[0]||/(fixed|absolute)/.test(r.css("position"))||r.css("position","absolute"),r},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var t=this.offsetParent.offset(),n=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==n&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,r,i=this.options,s=this.document[0];return this.relative_container=null,i.containment?"window"===i.containment?(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||s.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):"document"===i.containment?(this.containment=[0,0,e(s).width()-this.helperProportions.width-this.margins.left,(e(s).height()||s.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):i.containment.constructor===Array?(this.containment=i.containment,void 0):("parent"===i.containment&&(i.containment=this.helper[0].parentNode),n=e(i.containment),r=n[0],r&&(t="hidden"!==n.css("overflow"),this.containment=[(parseInt(n.css("borderLeftWidth"),10)||0)+(parseInt(n.css("paddingLeft"),10)||0),(parseInt(n.css("borderTopWidth"),10)||0)+(parseInt(n.css("paddingTop"),10)||0),(t?Math.max(r.scrollWidth,r.offsetWidth):r.offsetWidth)-(parseInt(n.css("borderRightWidth"),10)||0)-(parseInt(n.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(r.scrollHeight,r.offsetHeight):r.offsetHeight)-(parseInt(n.css("borderBottomWidth"),10)||0)-(parseInt(n.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=n),void 0):(this.containment=null,void 0)},_convertPositionTo:function(e,t){t||(t=this.position);var n="absolute"===e?1:-1,r=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.offset.scroll.top:r?0:this.offset.scroll.top)*n,left:t.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.offset.scroll.left:r?0:this.offset.scroll.left)*n}},_generatePosition:function(e,t){var n,r,i,s,o=this.options,u=this._isRootNode(this.scrollParent[0]),a=e.pageX,f=e.pageY;return u&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),t&&(this.containment&&(this.relative_container?(r=this.relative_container.offset(),n=[this.containment[0]+r.left,this.containment[1]+r.top,this.containment[2]+r.left,this.containment[3]+r.top]):n=this.containment,e.pageX-this.offset.click.left<n[0]&&(a=n[0]+this.offset.click.left),e.pageY-this.offset.click.top<n[1]&&(f=n[1]+this.offset.click.top),e.pageX-this.offset.click.left>n[2]&&(a=n[2]+this.offset.click.left),e.pageY-this.offset.click.top>n[3]&&(f=n[3]+this.offset.click.top)),o.grid&&(i=o.grid[1]?this.originalPageY+Math.round((f-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,f=n?i-this.offset.click.top>=n[1]||i-this.offset.click.top>n[3]?i:i-this.offset.click.top>=n[1]?i-o.grid[1]:i+o.grid[1]:i,s=o.grid[0]?this.originalPageX+Math.round((a-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,a=n?s-this.offset.click.left>=n[0]||s-this.offset.click.left>n[2]?s:s-this.offset.click.left>=n[0]?s-o.grid[0]:s+o.grid[0]:s),"y"===o.axis&&(a=this.originalPageX),"x"===o.axis&&(f=this.originalPageY)),{top:f-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:u?0:this.offset.scroll.top),left:a-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:u?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_trigger:function(t,n,r){return r=r||this._uiHash(),e.ui.plugin.call(this,t,[n,r,this],!0),"drag"===t&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,t,n,r)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,n,r){var i=r.options,s=e.extend({},n,{item:r.element});r.sortables=[],e(i.connectToSortable).each(function(){var n=e(this).sortable("instance");n&&!n.options.disabled&&(r.sortables.push({instance:n,shouldRevert:n.options.revert}),n.refreshPositions(),n._trigger("activate",t,s))})},stop:function(t,n,r){var i=e.extend({},n,{item:r.element});e.each(r.sortables,function(){this.instance.isOver?(this.instance.isOver=0,r.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,"original"===r.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,i))})},drag:function(t,n,r){var i=this;e.each(r.sortables,function(){var s=!1,o=this;this.instance.positionAbs=r.positionAbs,this.instance.helperProportions=r.helperProportions,this.instance.offset.click=r.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(s=!0,e.each(r.sortables,function(){return this.instance.positionAbs=r.positionAbs,this.instance.helperProportions=r.helperProportions,this.instance.offset.click=r.offset.click,this!==o&&this.instance._intersectsWith(this.instance.containerCache)&&e.contains(o.instance.element[0],this.instance.element[0])&&(s=!1),s})),s?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(i).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return n.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=r.offset.click.top,this.instance.offset.click.left=r.offset.click.left,this.instance.offset.parent.left-=r.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=r.offset.parent.top-this.instance.offset.parent.top,r._trigger("toSortable",t),r.dropped=this.instance.element,r.currentItem=r.element,this.instance.fromOutside=r),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),r._trigger("fromSortable",t),r.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(t,n,r){var i=e("body"),s=r.options;i.css("cursor")&&(s._cursor=i.css("cursor")),i.css("cursor",s.cursor)},stop:function(t,n,r){var i=r.options;i._cursor&&e("body").css("cursor",i._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,n,r){var i=e(n.helper),s=r.options;i.css("opacity")&&(s._opacity=i.css("opacity")),i.css("opacity",s.opacity)},stop:function(t,n,r){var i=r.options;i._opacity&&e(n.helper).css("opacity",i._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(e,t,n){n.scrollParent[0]!==n.document[0]&&"HTML"!==n.scrollParent[0].tagName&&(n.overflowOffset=n.scrollParent.offset())},drag:function(t,n,r){var i=r.options,s=!1,o=r.document[0];r.scrollParent[0]!==o&&"HTML"!==r.scrollParent[0].tagName?(i.axis&&"x"===i.axis||(r.overflowOffset.top+r.scrollParent[0].offsetHeight-t.pageY<i.scrollSensitivity?r.scrollParent[0].scrollTop=s=r.scrollParent[0].scrollTop+i.scrollSpeed:t.pageY-r.overflowOffset.top<i.scrollSensitivity&&(r.scrollParent[0].scrollTop=s=r.scrollParent[0].scrollTop-i.scrollSpeed)),i.axis&&"y"===i.axis||(r.overflowOffset.left+r.scrollParent[0].offsetWidth-t.pageX<i.scrollSensitivity?r.scrollParent[0].scrollLeft=s=r.scrollParent[0].scrollLeft+i.scrollSpeed:t.pageX-r.overflowOffset.left<i.scrollSensitivity&&(r.scrollParent[0].scrollLeft=s=r.scrollParent[0].scrollLeft-i.scrollSpeed))):(i.axis&&"x"===i.axis||(t.pageY-e(o).scrollTop()<i.scrollSensitivity?s=e(o).scrollTop(e(o).scrollTop()-i.scrollSpeed):e(window).height()-(t.pageY-e(o).scrollTop())<i.scrollSensitivity&&(s=e(o).scrollTop(e(o).scrollTop()+i.scrollSpeed))),i.axis&&"y"===i.axis||(t.pageX-e(o).scrollLeft()<i.scrollSensitivity?s=e(o).scrollLeft(e(o).scrollLeft()-i.scrollSpeed):e(window).width()-(t.pageX-e(o).scrollLeft())<i.scrollSensitivity&&(s=e(o).scrollLeft(e(o).scrollLeft()+i.scrollSpeed)))),s!==!1&&e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(r,t)}}),e.ui.plugin.add("draggable","snap",{start:function(t,n,r){var i=r.options;r.snapElements=[],e(i.snap.constructor!==String?i.snap.items||":data(ui-draggable)":i.snap).each(function(){var t=e(this),n=t.offset();this!==r.element[0]&&r.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:n.top,left:n.left})})},drag:function(t,n,r){var i,s,o,u,a,f,l,c,h,p,d=r.options,v=d.snapTolerance,m=n.offset.left,g=m+r.helperProportions.width,y=n.offset.top,b=y+r.helperProportions.height;for(h=r.snapElements.length-1;h>=0;h--)a=r.snapElements[h].left,f=a+r.snapElements[h].width,l=r.snapElements[h].top,c=l+r.snapElements[h].height,a-v>g||m>f+v||l-v>b||y>c+v||!e.contains(r.snapElements[h].item.ownerDocument,r.snapElements[h].item)?(r.snapElements[h].snapping&&r.options.snap.release&&r.options.snap.release.call(r.element,t,e.extend(r._uiHash(),{snapItem:r.snapElements[h].item})),r.snapElements[h].snapping=!1):("inner"!==d.snapMode&&(i=v>=Math.abs(l-b),s=v>=Math.abs(c-y),o=v>=Math.abs(a-g),u=v>=Math.abs(f-m),i&&(n.position.top=r._convertPositionTo("relative",{top:l-r.helperProportions.height,left:0}).top-r.margins.top),s&&(n.position.top=r._convertPositionTo("relative",{top:c,left:0}).top-r.margins.top),o&&(n.position.left=r._convertPositionTo("relative",{top:0,left:a-r.helperProportions.width}).left-r.margins.left),u&&(n.position.left=r._convertPositionTo("relative",{top:0,left:f}).left-r.margins.left)),p=i||s||o||u,"outer"!==d.snapMode&&(i=v>=Math.abs(l-y),s=v>=Math.abs(c-b),o=v>=Math.abs(a-m),u=v>=Math.abs(f-g),i&&(n.position.top=r._convertPositionTo("relative",{top:l,left:0}).top-r.margins.top),s&&(n.position.top=r._convertPositionTo("relative",{top:c-r.helperProportions.height,left:0}).top-r.margins.top),o&&(n.position.left=r._convertPositionTo("relative",{top:0,left:a}).left-r.margins.left),u&&(n.position.left=r._convertPositionTo("relative",{top:0,left:f-r.helperProportions.width}).left-r.margins.left)),!r.snapElements[h].snapping&&(i||s||o||u||p)&&r.options.snap.snap&&r.options.snap.snap.call(r.element,t,e.extend(r._uiHash(),{snapItem:r.snapElements[h].item})),r.snapElements[h].snapping=i||s||o||u||p)}}),e.ui.plugin.add("draggable","stack",{start:function(t,n,r){var i,s=r.options,o=e.makeArray(e(s.stack)).sort(function(t,n){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(n).css("zIndex"),10)||0)});o.length&&(i=parseInt(e(o[0]).css("zIndex"),10)||0,e(o).each(function(t){e(this).css("zIndex",i+t)}),this.css("zIndex",i+o.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,n,r){var i=e(n.helper),s=r.options;i.css("zIndex")&&(s._zIndex=i.css("zIndex")),i.css("zIndex",s.zIndex)},stop:function(t,n,r){var i=r.options;i._zIndex&&e(n.helper).css("zIndex",i._zIndex)}}),e.ui.draggable,e.widget("ui.droppable",{version:"1.11.0",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t,n=this.options,r=n.accept;this.isover=!1,this.isout=!0,this.accept=e.isFunction(r)?r:function(e){return e.is(r)},this.proportions=function(){return arguments.length?(t=arguments[0],void 0):t?t:t={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},this._addToManager(n.scope),n.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(t){e.ui.ddmanager.droppables[t]=e.ui.ddmanager.droppables[t]||[],e.ui.ddmanager.droppables[t].push(this)},_splice:function(e){for(var t=0;e.length>t;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var t=e.ui.ddmanager.droppables[this.options.scope];this._splice(t),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,n){if("accept"===t)this.accept=e.isFunction(n)?n:function(e){return e.is(n)};else if("scope"===t){var r=e.ui.ddmanager.droppables[this.options.scope];this._splice(r),this._addToManager(n)}this._super(t,n)},_activate:function(t){var n=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),n&&this._trigger("activate",t,this.ui(n))},_deactivate:function(t){var n=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),n&&this._trigger("deactivate",t,this.ui(n))},_over:function(t){var n=e.ui.ddmanager.current;n&&(n.currentItem||n.element)[0]!==this.element[0]&&this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(n)))},_out:function(t){var n=e.ui.ddmanager.current;n&&(n.currentItem||n.element)[0]!==this.element[0]&&this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(n)))},_drop:function(t,n){var r=n||e.ui.ddmanager.current,i=!1;return r&&(r.currentItem||r.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var t=e(this).droppable("instance");return t.options.greedy&&!t.options.disabled&&t.options.scope===r.options.scope&&t.accept.call(t.element[0],r.currentItem||r.element)&&e.ui.intersect(r,e.extend(t,{offset:t.element.offset()}),t.options.tolerance)?(i=!0,!1):void 0}),i?!1:this.accept.call(this.element[0],r.currentItem||r.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(r)),this.element):!1):!1},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),e.ui.intersect=function(){function e(e,t,n){return e>=t&&t+n>e}return function(t,n,r){if(!n.offset)return!1;var i,s,o=(t.positionAbs||t.position.absolute).left,u=(t.positionAbs||t.position.absolute).top,a=o+t.helperProportions.width,f=u+t.helperProportions.height,l=n.offset.left,c=n.offset.top,h=l+n.proportions().width,p=c+n.proportions().height;switch(r){case"fit":return o>=l&&h>=a&&u>=c&&p>=f;case"intersect":return o+t.helperProportions.width/2>l&&h>a-t.helperProportions.width/2&&u+t.helperProportions.height/2>c&&p>f-t.helperProportions.height/2;case"pointer":return i=(t.positionAbs||t.position.absolute).left+(t.clickOffset||t.offset.click).left,s=(t.positionAbs||t.position.absolute).top+(t.clickOffset||t.offset.click).top,e(s,c,n.proportions().height)&&e(i,l,n.proportions().width);case"touch":return(u>=c&&p>=u||f>=c&&p>=f||c>u&&f>p)&&(o>=l&&h>=o||a>=l&&h>=a||l>o&&a>h);default:return!1}}}(),e.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,n){var r,i,s=e.ui.ddmanager.droppables[t.options.scope]||[],o=n?n.type:null,u=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(r=0;s.length>r;r++)if(!(s[r].options.disabled||t&&!s[r].accept.call(s[r].element[0],t.currentItem||t.element))){for(i=0;u.length>i;i++)if(u[i]===s[r].element[0]){s[r].proportions().height=0;continue e}s[r].visible="none"!==s[r].element.css("display"),s[r].visible&&("mousedown"===o&&s[r]._activate.call(s[r],n),s[r].offset=s[r].element.offset(),s[r].proportions({width:s[r].element[0].offsetWidth,height:s[r].element[0].offsetHeight}))}},drop:function(t,n){var r=!1;return e.each((e.ui.ddmanager.droppables[t.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance)&&(r=this._drop.call(this,n)||r),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,n)))}),r},dragStart:function(t,n){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,n)})},drag:function(t,n){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,n),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var r,i,s,o=e.ui.intersect(t,this,this.options.tolerance),u=!o&&this.isover?"isout":o&&!this.isover?"isover":null;u&&(this.options.greedy&&(i=this.options.scope,s=this.element.parents(":data(ui-droppable)").filter(function(){return e(this).droppable("instance").options.scope===i}),s.length&&(r=e(s[0]).droppable("instance"),r.greedyChild="isover"===u)),r&&"isover"===u&&(r.isover=!1,r.isout=!0,r._out.call(r,n)),this[u]=!0,this["isout"===u?"isover":"isout"]=!1,this["isover"===u?"_over":"_out"].call(this,n),r&&"isout"===u&&(r.isout=!1,r.isover=!0,r._over.call(r,n)))}})},dragStop:function(t,n){t.element.parentsUntil("body").unbind("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,n)}},e.ui.droppable,e.widget("ui.resizable",e.ui.mouse,{version:"1.11.0",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(e){return parseInt(e,10)||0},_isNumber:function(e){return!isNaN(parseInt(e,10))},_hasScroll:function(t,n){if("hidden"===e(t).css("overflow"))return!1;var r=n&&"left"===n?"scrollLeft":"scrollTop",i=!1;return t[r]>0?!0:(t[r]=1,i=t[r]>0,t[r]=0,i)},_create:function(){var t,n,r,i,s,o=this,u=this.options;if(this.element.addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!u.aspectRatio,aspectRatio:u.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:u.helper||u.ghost||u.animate?u.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(e("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=u.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),t=this.handles.split(","),this.handles={},n=0;t.length>n;n++)r=e.trim(t[n]),s="ui-resizable-"+r,i=e("<div class='ui-resizable-handle "+s+"'></div>"),i.css({zIndex:u.zIndex}),"se"===r&&i.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[r]=".ui-resizable-"+r,this.element.append(i);this._renderAxis=function(t){var n,r,i,s;t=t||this.element;for(n in this.handles)this.handles[n].constructor===String&&(this.handles[n]=this.element.children(this.handles[n]).first().show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(r=e(this.handles[n],this.element),s=/sw|ne|nw|se|n|s/.test(n)?r.outerHeight():r.outerWidth(),i=["padding",/ne|nw|n/.test(n)?"Top":/se|sw|s/.test(n)?"Bottom":/^e$/.test(n)?"Right":"Left"].join(""),t.css(i,s),this._proportionallyResize()),e(this.handles[n]).length},this._renderAxis(this.element),this._handles=e(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){o.resizing||(this.className&&(i=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),o.axis=i&&i[1]?i[1]:"se")}),u.autoHide&&(this._handles.hide(),e(this.element).addClass("ui-resizable-autohide").mouseenter(function(){u.disabled||(e(this).removeClass("ui-resizable-autohide"),o._handles.show())}).mouseleave(function(){u.disabled||o.resizing||(e(this).addClass("ui-resizable-autohide"),o._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var t,n=function(t){e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(n(this.element),t=this.element,this.originalElement.css({position:t.css("position"),width:t.outerWidth(),height:t.outerHeight(),top:t.css("top"),left:t.css("left")}).insertAfter(t),t.remove()),this.originalElement.css("resize",this.originalResizeStyle),n(this.originalElement),this},_mouseCapture:function(t){var n,r,i=!1;for(n in this.handles)r=e(this.handles[n])[0],(r===t.target||e.contains(r,t.target))&&(i=!0);return!this.options.disabled&&i},_mouseStart:function(t){var n,r,i,s=this.options,o=this.element;return this.resizing=!0,this._renderProxy(),n=this._num(this.helper.css("left")),r=this._num(this.helper.css("top")),s.containment&&(n+=e(s.containment).scrollLeft()||0,r+=e(s.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:n,top:r},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:o.width(),height:o.height()},this.originalSize=this._helper?{width:o.outerWidth(),height:o.outerHeight()}:{width:o.width(),height:o.height()},this.originalPosition={left:n,top:r},this.sizeDiff={width:o.outerWidth()-o.width(),height:o.outerHeight()-o.height()},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio="number"==typeof s.aspectRatio?s.aspectRatio:this.originalSize.width/this.originalSize.height||1,i=e(".ui-resizable-"+this.axis).css("cursor"),e("body").css("cursor","auto"===i?this.axis+"-resize":i),o.addClass("ui-resizable-resizing"),this._propagate("start",t),!0},_mouseDrag:function(t){var n,r=this.helper,i={},s=this.originalMousePosition,o=this.axis,u=t.pageX-s.left||0,a=t.pageY-s.top||0,f=this._change[o];return this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height},f?(n=f.apply(this,[t,u,a]),this._updateVirtualBoundaries(t.shiftKey),(this._aspectRatio||t.shiftKey)&&(n=this._updateRatio(n,t)),n=this._respectSize(n,t),this._updateCache(n),this._propagate("resize",t),this.position.top!==this.prevPosition.top&&(i.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(i.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(i.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(i.height=this.size.height+"px"),r.css(i),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),e.isEmptyObject(i)||this._trigger("resize",t,this.ui()),!1):!1},_mouseStop:function(t){this.resizing=!1;var n,r,i,s,o,u,a,f=this.options,l=this;return this._helper&&(n=this._proportionallyResizeElements,r=n.length&&/textarea/i.test(n[0].nodeName),i=r&&this._hasScroll(n[0],"left")?0:l.sizeDiff.height,s=r?0:l.sizeDiff.width,o={width:l.helper.width()-s,height:l.helper.height()-i},u=parseInt(l.element.css("left"),10)+(l.position.left-l.originalPosition.left)||null,a=parseInt(l.element.css("top"),10)+(l.position.top-l.originalPosition.top)||null,f.animate||this.element.css(e.extend(o,{top:a,left:u})),l.helper.height(l.size.height),l.helper.width(l.size.width),this._helper&&!f.animate&&this._proportionallyResize()),e("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(e){var t,n,r,i,s,o=this.options;s={minWidth:this._isNumber(o.minWidth)?o.minWidth:0,maxWidth:this._isNumber(o.maxWidth)?o.maxWidth:1/0,minHeight:this._isNumber(o.minHeight)?o.minHeight:0,maxHeight:this._isNumber(o.maxHeight)?o.maxHeight:1/0},(this._aspectRatio||e)&&(t=s.minHeight*this.aspectRatio,r=s.minWidth/this.aspectRatio,n=s.maxHeight*this.aspectRatio,i=s.maxWidth/this.aspectRatio,t>s.minWidth&&(s.minWidth=t),r>s.minHeight&&(s.minHeight=r),s.maxWidth>n&&(s.maxWidth=n),s.maxHeight>i&&(s.maxHeight=i)),this._vBoundaries=s},_updateCache:function(e){this.offset=this.helper.offset(),this._isNumber(e.left)&&(this.position.left=e.left),this._isNumber(e.top)&&(this.position.top=e.top),this._isNumber(e.height)&&(this.size.height=e.height),this._isNumber(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,n=this.size,r=this.axis;return this._isNumber(e.height)?e.width=e.height*this.aspectRatio:this._isNumber(e.width)&&(e.height=e.width/this.aspectRatio),"sw"===r&&(e.left=t.left+(n.width-e.width),e.top=null),"nw"===r&&(e.top=t.top+(n.height-e.height),e.left=t.left+(n.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,n=this.axis,r=this._isNumber(e.width)&&t.maxWidth&&t.maxWidth<e.width,i=this._isNumber(e.height)&&t.maxHeight&&t.maxHeight<e.height,s=this._isNumber(e.width)&&t.minWidth&&t.minWidth>e.width,o=this._isNumber(e.height)&&t.minHeight&&t.minHeight>e.height,u=this.originalPosition.left+this.originalSize.width,a=this.position.top+this.size.height,f=/sw|nw|w/.test(n),l=/nw|ne|n/.test(n);return s&&(e.width=t.minWidth),o&&(e.height=t.minHeight),r&&(e.width=t.maxWidth),i&&(e.height=t.maxHeight),s&&f&&(e.left=u-t.minWidth),r&&f&&(e.left=u-t.maxWidth),o&&l&&(e.top=a-t.minHeight),i&&l&&(e.top=a-t.maxHeight),e.width||e.height||e.left||!e.top?e.width||e.height||e.top||!e.left||(e.left=null):e.top=null,e},_proportionallyResize:function(){if(this._proportionallyResizeElements.length){var e,t,n,r,i,s=this.helper||this.element;for(e=0;this._proportionallyResizeElements.length>e;e++){if(i=this._proportionallyResizeElements[e],!this.borderDif)for(this.borderDif=[],n=[i.css("borderTopWidth"),i.css("borderRightWidth"),i.css("borderBottomWidth"),i.css("borderLeftWidth")],r=[i.css("paddingTop"),i.css("paddingRight"),i.css("paddingBottom"),i.css("paddingLeft")],t=0;n.length>t;t++)this.borderDif[t]=(parseInt(n[t],10)||0)+(parseInt(r[t],10)||0);i.css({height:s.height()-this.borderDif[0]-this.borderDif[2]||0,width:s.width()-this.borderDif[1]-this.borderDif[3]||0})}}},_renderProxy:function(){var t=this.element,n=this.options;this.elementOffset=t.offset(),this._helper?(this.helper=this.helper||e("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++n.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var n=this.originalSize,r=this.originalPosition;return{left:r.left+t,width:n.width-t}},n:function(e,t,n){var r=this.originalSize,i=this.originalPosition;return{top:i.top+n,height:r.height-n}},s:function(e,t,n){return{height:this.originalSize.height+n}},se:function(t,n,r){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,n,r]))},sw:function(t,n,r){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,n,r]))},ne:function(t,n,r){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,n,r]))},nw:function(t,n,r){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,n,r]))}},_propagate:function(t,n){e.ui.plugin.call(this,t,[n,this.ui()]),"resize"!==t&&this._trigger(t,n,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition,prevSize:this.prevSize,prevPosition:this.prevPosition}}}),e.ui.plugin.add("resizable","animate",{stop:function(t){var n=e(this).resizable("instance"),r=n.options,i=n._proportionallyResizeElements,s=i.length&&/textarea/i.test(i[0].nodeName),o=s&&n._hasScroll(i[0],"left")?0:n.sizeDiff.height,u=s?0:n.sizeDiff.width,a={width:n.size.width-u,height:n.size.height-o},f=parseInt(n.element.css("left"),10)+(n.position.left-n.originalPosition.left)||null,l=parseInt(n.element.css("top"),10)+(n.position.top-n.originalPosition.top)||null;n.element.animate(e.extend(a,l&&f?{top:l,left:f}:{}),{duration:r.animateDuration,easing:r.animateEasing,step:function(){var r={width:parseInt(n.element.css("width"),10),height:parseInt(n.element.css("height"),10),top:parseInt(n.element.css("top"),10),left:parseInt(n.element.css("left"),10)};i&&i.length&&e(i[0]).css({width:r.width,height:r.height}),n._updateCache(r),n._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(){var t,n,r,i,s,o,u,a=e(this).resizable("instance"),f=a.options,l=a.element,c=f.containment,h=c instanceof e?c.get(0):/parent/.test(c)?l.parent().get(0):c;h&&(a.containerElement=e(h),/document/.test(c)||c===document?(a.containerOffset={left:0,top:0},a.containerPosition={left:0,top:0},a.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}):(t=e(h),n=[],e(["Top","Right","Left","Bottom"]).each(function(e,r){n[e]=a._num(t.css("padding"+r))}),a.containerOffset=t.offset(),a.containerPosition=t.position(),a.containerSize={height:t.innerHeight()-n[3],width:t.innerWidth()-n[1]},r=a.containerOffset,i=a.containerSize.height,s=a.containerSize.width,o=a._hasScroll(h,"left")?h.scrollWidth:s,u=a._hasScroll(h)?h.scrollHeight:i,a.parentData={element:h,left:r.left,top:r.top,width:o,height:u}))},resize:function(t,n){var r,i,s,o,u=e(this).resizable("instance"),a=u.options,f=u.containerOffset,l=u.position,c=u._aspectRatio||t.shiftKey,h={top:0,left:0},p=u.containerElement,d=!0;p[0]!==document&&/static/.test(p.css("position"))&&(h=f),l.left<(u._helper?f.left:0)&&(u.size.width=u.size.width+(u._helper?u.position.left-f.left:u.position.left-h.left),c&&(u.size.height=u.size.width/u.aspectRatio,d=!1),u.position.left=a.helper?f.left:0),l.top<(u._helper?f.top:0)&&(u.size.height=u.size.height+(u._helper?u.position.top-f.top:u.position.top),c&&(u.size.width=u.size.height*u.aspectRatio,d=!1),u.position.top=u._helper?f.top:0),u.offset.left=u.parentData.left+u.position.left,u.offset.top=u.parentData.top+u.position.top,r=Math.abs((u._helper?u.offset.left-h.left:u.offset.left-f.left)+u.sizeDiff.width),i=Math.abs((u._helper?u.offset.top-h.top:u.offset.top-f.top)+u.sizeDiff.height),s=u.containerElement.get(0)===u.element.parent().get(0),o=/relative|absolute/.test(u.containerElement.css("position")),s&&o&&(r-=Math.abs(u.parentData.left)),r+u.size.width>=u.parentData.width&&(u.size.width=u.parentData.width-r,c&&(u.size.height=u.size.width/u.aspectRatio,d=!1)),i+u.size.height>=u.parentData.height&&(u.size.height=u.parentData.height-i,c&&(u.size.width=u.size.height*u.aspectRatio,d=!1)),d||(u.position.left=n.prevPosition.left,u.position.top=n.prevPosition.top,u.size.width=n.prevSize.width,u.size.height=n.prevSize.height)},stop:function(){var t=e(this).resizable("instance"),n=t.options,r=t.containerOffset,i=t.containerPosition,s=t.containerElement,o=e(t.helper),u=o.offset(),a=o.outerWidth()-t.sizeDiff.width,f=o.outerHeight()-t.sizeDiff.height;t._helper&&!n.animate&&/relative/.test(s.css("position"))&&e(this).css({left:u.left-i.left-r.left,width:a,height:f}),t._helper&&!n.animate&&/static/.test(s.css("position"))&&e(this).css({left:u.left-i.left-r.left,width:a,height:f})}}),e.ui.plugin.add("resizable","alsoResize",{start:function(){var t=e(this).resizable("instance"),n=t.options,r=function(t){e(t).each(function(){var t=e(this);t.data("ui-resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10)})})};"object"!=typeof n.alsoResize||n.alsoResize.parentNode?r(n.alsoResize):n.alsoResize.length?(n.alsoResize=n.alsoResize[0],r(n.alsoResize)):e.each(n.alsoResize,function(e){r(e)})},resize:function(t,n){var r=e(this).resizable("instance"),i=r.options,s=r.originalSize,o=r.originalPosition,u={height:r.size.height-s.height||0,width:r.size.width-s.width||0,top:r.position.top-o.top||0,left:r.position.left-o.left||0},a=function(t,r){e(t).each(function(){var t=e(this),i=e(this).data("ui-resizable-alsoresize"),s={},o=r&&r.length?r:t.parents(n.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(o,function(e,t){var n=(i[t]||0)+(u[t]||0);n&&n>=0&&(s[t]=n||null)}),t.css(s)})};"object"!=typeof i.alsoResize||i.alsoResize.nodeType?a(i.alsoResize):e.each(i.alsoResize,function(e,t){a(e,t)})},stop:function(){e(this).removeData("resizable-alsoresize")}}),e.ui.plugin.add("resizable","ghost",{start:function(){var t=e(this).resizable("instance"),n=t.options,r=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:r.height,width:r.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof n.ghost?n.ghost:""),t.ghost.appendTo(t.helper)},resize:function(){var t=e(this).resizable("instance");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=e(this).resizable("instance");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(){var t=e(this).resizable("instance"),n=t.options,r=t.size,i=t.originalSize,s=t.originalPosition,o=t.axis,u="number"==typeof n.grid?[n.grid,n.grid]:n.grid,a=u[0]||1,f=u[1]||1,l=Math.round((r.width-i.width)/a)*a,c=Math.round((r.height-i.height)/f)*f,h=i.width+l,p=i.height+c,d=n.maxWidth&&h>n.maxWidth,v=n.maxHeight&&p>n.maxHeight,m=n.minWidth&&n.minWidth>h,g=n.minHeight&&n.minHeight>p;n.grid=u,m&&(h+=a),g&&(p+=f),d&&(h-=a),v&&(p-=f),/^(se|s|e)$/.test(o)?(t.size.width=h,t.size.height=p):/^(ne)$/.test(o)?(t.size.width=h,t.size.height=p,t.position.top=s.top-c):/^(sw)$/.test(o)?(t.size.width=h,t.size.height=p,t.position.left=s.left-l):(p-f>0?(t.size.height=p,t.position.top=s.top-c):(t.size.height=f,t.position.top=s.top+i.height-f),h-a>0?(t.size.width=h,t.position.left=s.left-l):(t.size.width=a,t.position.left=s.left+i.width-a))}}),e.ui.resizable,e.widget("ui.selectable",e.ui.mouse,{version:"1.11.0",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var t,n=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){t=e(n.options.filter,n.element[0]),t.addClass("ui-selectee"),t.each(function(){var t=e(this),n=t.offset();e.data(this,"selectable-item",{element:this,$element:t,left:n.left,top:n.top,right:n.left+t.outerWidth(),bottom:n.top+t.outerHeight(),startselected:!1,selected:t.hasClass("ui-selected"),selecting:t.hasClass("ui-selecting"),unselecting:t.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=t.addClass("ui-selectee"),this._mouseInit(),this.helper=e("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(t){var n=this,r=this.options;this.opos=[t.pageX,t.pageY],this.options.disabled||(this.selectees=e(r.filter,this.element[0]),this._trigger("start",t),e(r.appendTo).append(this.helper),this.helper.css({left:t.pageX,top:t.pageY,width:0,height:0}),r.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var r=e.data(this,"selectable-item");r.startselected=!0,t.metaKey||t.ctrlKey||(r.$element.removeClass("ui-selected"),r.selected=!1,r.$element.addClass("ui-unselecting"),r.unselecting=!0,n._trigger("unselecting",t,{unselecting:r.element}))}),e(t.target).parents().addBack().each(function(){var r,i=e.data(this,"selectable-item");return i?(r=!t.metaKey&&!t.ctrlKey||!i.$element.hasClass("ui-selected"),i.$element.removeClass(r?"ui-unselecting":"ui-selected").addClass(r?"ui-selecting":"ui-unselecting"),i.unselecting=!r,i.selecting=r,i.selected=r,r?n._trigger("selecting",t,{selecting:i.element}):n._trigger("unselecting",t,{unselecting:i.element}),!1):void 0}))},_mouseDrag:function(t){if(this.dragged=!0,!this.options.disabled){var n,r=this,i=this.options,s=this.opos[0],o=this.opos[1],u=t.pageX,a=t.pageY;return s>u&&(n=u,u=s,s=n),o>a&&(n=a,a=o,o=n),this.helper.css({left:s,top:o,width:u-s,height:a-o}),this.selectees.each(function(){var n=e.data(this,"selectable-item"),f=!1;n&&n.element!==r.element[0]&&("touch"===i.tolerance?f=!(n.left>u||s>n.right||n.top>a||o>n.bottom):"fit"===i.tolerance&&(f=n.left>s&&u>n.right&&n.top>o&&a>n.bottom),f?(n.selected&&(n.$element.removeClass("ui-selected"),n.selected=!1),n.unselecting&&(n.$element.removeClass("ui-unselecting"),n.unselecting=!1),n.selecting||(n.$element.addClass("ui-selecting"),n.selecting=!0,r._trigger("selecting",t,{selecting:n.element}))):(n.selecting&&((t.metaKey||t.ctrlKey)&&n.startselected?(n.$element.removeClass("ui-selecting"),n.selecting=!1,n.$element.addClass("ui-selected"),n.selected=!0):(n.$element.removeClass("ui-selecting"),n.selecting=!1,n.startselected&&(n.$element.addClass("ui-unselecting"),n.unselecting=!0),r._trigger("unselecting",t,{unselecting:n.element}))),n.selected&&(t.metaKey||t.ctrlKey||n.startselected||(n.$element.removeClass("ui-selected"),n.selected=!1,n.$element.addClass("ui-unselecting"),n.unselecting=!0,r._trigger("unselecting",t,{unselecting:n.element})))))}),!1}},_mouseStop:function(t){var n=this;return this.dragged=!1,e(".ui-unselecting",this.element[0]).each(function(){var r=e.data(this,"selectable-item");r.$element.removeClass("ui-unselecting"),r.unselecting=!1,r.startselected=!1,n._trigger("unselected",t,{unselected:r.element})}),e(".ui-selecting",this.element[0]).each(function(){var r=e.data(this,"selectable-item");r.$element.removeClass("ui-selecting").addClass("ui-selected"),r.selecting=!1,r.selected=!0,r.startselected=!0,n._trigger("selected",t,{selected:r.element})}),this._trigger("stop",t),this.helper.remove(),!1}}),e.widget("ui.sortable",e.ui.mouse,{version:"1.11.0",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(e,t,n){return e>=t&&t+n>e},_isFloating:function(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))},_create:function(){var e=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===e.axis||this._isFloating(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(e,t){this._super(e,t),"handle"===e&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"),e.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(t,n){var r=null,i=!1,s=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(t),e(t.target).parents().each(function(){return e.data(this,s.widgetName+"-item")===s?(r=e(this),!1):void 0}),e.data(t.target,s.widgetName+"-item")===s&&(r=e(t.target)),r?!this.options.handle||n||(e(this.options.handle,r).find("*").addBack().each(function(){this===t.target&&(i=!0)}),i)?(this.currentItem=r,this._removeCurrentsFromItems(),!0):!1:!1)},_mouseStart:function(t,n,r){var i,s,o=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&"auto"!==o.cursor&&(s=this.document.find("body"),this.storedCursor=s.css("cursor"),s.css("cursor",o.cursor),this.storedStylesheet=e("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(s)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!r)for(i=this.containers.length-1;i>=0;i--)this.containers[i]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var n,r,i,s,o=this.options,u=!1;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=u=this.scrollParent[0].scrollTop+o.scrollSpeed:t.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=u=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=u=this.scrollParent[0].scrollLeft+o.scrollSpeed:t.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=u=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(t.pageY-e(document).scrollTop()<o.scrollSensitivity?u=e(document).scrollTop(e(document).scrollTop()-o.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<o.scrollSensitivity&&(u=e(document).scrollTop(e(document).scrollTop()+o.scrollSpeed)),t.pageX-e(document).scrollLeft()<o.scrollSensitivity?u=e(document).scrollLeft(e(document).scrollLeft()-o.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<o.scrollSensitivity&&(u=e(document).scrollLeft(e(document).scrollLeft()+o.scrollSpeed))),u!==!1&&e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),n=this.items.length-1;n>=0;n--)if(r=this.items[n],i=r.item[0],s=this._intersectsWithPointer(r),s&&r.instance===this.currentContainer&&i!==this.currentItem[0]&&this.placeholder[1===s?"next":"prev"]()[0]!==i&&!e.contains(this.placeholder[0],i)&&("semi-dynamic"===this.options.type?!e.contains(this.element[0],i):!0)){if(this.direction=1===s?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(r))break;this._rearrange(t,r),this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,n){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t),this.options.revert){var r=this,i=this.placeholder.offset(),s=this.options.axis,o={};s&&"x"!==s||(o.left=i.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),s&&"y"!==s||(o.top=i.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,e(this.helper).animate(o,parseInt(this.options.revert,10)||500,function(){r._clear(t)})}else this._clear(t,n);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var n=this._getItemsAsjQuery(t&&t.connected),r=[];return t=t||{},e(n).each(function(){var n=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);n&&r.push((t.key||n[1]+"[]")+"="+(t.key&&t.expression?n[1]:n[2]))}),!r.length&&t.key&&r.push(t.key+"="),r.join("&")},toArray:function(t){var n=this._getItemsAsjQuery(t&&t.connected),r=[];return t=t||{},n.each(function(){r.push(e(t.item||this).attr(t.attribute||"id")||"")}),r},_intersectsWith:function(e){var t=this.positionAbs.left,n=t+this.helperProportions.width,r=this.positionAbs.top,i=r+this.helperProportions.height,s=e.left,o=s+e.width,u=e.top,a=u+e.height,f=this.offset.click.top,l=this.offset.click.left,c="x"===this.options.axis||r+f>u&&a>r+f,h="y"===this.options.axis||t+l>s&&o>t+l,p=c&&h;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?p:t+this.helperProportions.width/2>s&&o>n-this.helperProportions.width/2&&r+this.helperProportions.height/2>u&&a>i-this.helperProportions.height/2},_intersectsWithPointer:function(e){var t="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height),n="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width),r=t&&n,i=this._getDragVerticalDirection(),s=this._getDragHorizontalDirection();return r?this.floating?s&&"right"===s||"down"===i?2:1:i&&("down"===i?2:1):!1},_intersectsWithSides:function(e){var t=this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),n=this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),r=this._getDragVerticalDirection(),i=this._getDragHorizontalDirection();return this.floating&&i?"right"===i&&n||"left"===i&&!n:r&&("down"===r&&t||"up"===r&&!t)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!==e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!==e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){function n(){u.push(this)}var r,i,s,o,u=[],a=[],f=this._connectWith();if(f&&t)for(r=f.length-1;r>=0;r--)for(s=e(f[r]),i=s.length-1;i>=0;i--)o=e.data(s[i],this.widgetFullName),o&&o!==this&&!o.options.disabled&&a.push([e.isFunction(o.options.items)?o.options.items.call(o.element):e(o.options.items,o.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),o]);for(a.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),r=a.length-1;r>=0;r--)a[r][0].each(n);return e(u)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(e){for(var n=0;t.length>n;n++)if(t[n]===e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var n,r,i,s,o,u,a,f,l=this.items,c=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],h=this._connectWith();if(h&&this.ready)for(n=h.length-1;n>=0;n--)for(i=e(h[n]),r=i.length-1;r>=0;r--)s=e.data(i[r],this.widgetFullName),s&&s!==this&&!s.options.disabled&&(c.push([e.isFunction(s.options.items)?s.options.items.call(s.element[0],t,{item:this.currentItem}):e(s.options.items,s.element),s]),this.containers.push(s));for(n=c.length-1;n>=0;n--)for(o=c[n][1],u=c[n][0],r=0,f=u.length;f>r;r++)a=e(u[r]),a.data(this.widgetName+"-item",o),l.push({item:a,instance:o,width:0,height:0,left:0,top:0})},refreshPositions:function(t){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var n,r,i,s;for(n=this.items.length-1;n>=0;n--)r=this.items[n],r.instance!==this.currentContainer&&this.currentContainer&&r.item[0]!==this.currentItem[0]||(i=this.options.toleranceElement?e(this.options.toleranceElement,r.item):r.item,t||(r.width=i.outerWidth(),r.height=i.outerHeight()),s=i.offset(),r.left=s.left,r.top=s.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(n=this.containers.length-1;n>=0;n--)s=this.containers[n].element.offset(),this.containers[n].containerCache.left=s.left,this.containers[n].containerCache.top=s.top,this.containers[n].containerCache.width=this.containers[n].element.outerWidth(),this.containers[n].containerCache.height=this.containers[n].element.outerHeight();return this},_createPlaceholder:function(t){t=t||this;var n,r=t.options;r.placeholder&&r.placeholder.constructor!==String||(n=r.placeholder,r.placeholder={element:function(){var r=t.currentItem[0].nodeName.toLowerCase(),i=e("<"+r+">",t.document[0]).addClass(n||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===r?t.currentItem.children().each(function(){e("<td>&#160;</td>",t.document[0]).attr("colspan",e(this).attr("colspan")||1).appendTo(i)}):"img"===r&&i.attr("src",t.currentItem.attr("src")),n||i.css("visibility","hidden"),i},update:function(e,i){(!n||r.forcePlaceholderSize)&&(i.height()||i.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),i.width()||i.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}}),t.placeholder=e(r.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),r.placeholder.update(t,t.placeholder)},_contactContainers:function(t){var n,r,i,s,o,u,a,f,l,c,h=null,p=null;for(n=this.containers.length-1;n>=0;n--)if(!e.contains(this.currentItem[0],this.containers[n].element[0]))if(this._intersectsWith(this.containers[n].containerCache)){if(h&&e.contains(this.containers[n].element[0],h.element[0]))continue;h=this.containers[n],p=n}else this.containers[n].containerCache.over&&(this.containers[n]._trigger("out",t,this._uiHash(this)),this.containers[n].containerCache.over=0);if(h)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(i=1e4,s=null,l=h.floating||this._isFloating(this.currentItem),o=l?"left":"top",u=l?"width":"height",c=l?"clientX":"clientY",r=this.items.length-1;r>=0;r--)e.contains(this.containers[p].element[0],this.items[r].item[0])&&this.items[r].item[0]!==this.currentItem[0]&&(a=this.items[r].item.offset()[o],f=!1,t[c]-a>this.items[r][u]/2&&(f=!0),i>Math.abs(t[c]-a)&&(i=Math.abs(t[c]-a),s=this.items[r],this.direction=f?"up":"down"));if(!s&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return;s?this._rearrange(t,s,null,!0):this._rearrange(t,null,this.containers[p].element,!0),this._trigger("change",t,this._uiHash()),this.containers[p]._trigger("change",t,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(t){var n=this.options,r=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t,this.currentItem])):"clone"===n.helper?this.currentItem.clone():this.currentItem;return r.parents("body").length||e("parent"!==n.appendTo?n.appendTo:this.currentItem[0].parentNode)[0].appendChild(r[0]),r[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!r[0].style.width||n.forceHelperSize)&&r.width(this.currentItem.width()),(!r[0].style.height||n.forceHelperSize)&&r.height(this.currentItem.height()),r},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,r,i=this.options;"parent"===i.containment&&(i.containment=this.helper[0].parentNode),("document"===i.containment||"window"===i.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,e("document"===i.containment?document:window).width()-this.helperProportions.width-this.margins.left,(e("document"===i.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(i.containment)||(t=e(i.containment)[0],n=e(i.containment).offset(),r="hidden"!==e(t).css("overflow"),this.containment=[n.left+(parseInt(e(t).css("borderLeftWidth"),10)||0)+(parseInt(e(t).css("paddingLeft"),10)||0)-this.margins.left,n.top+(parseInt(e(t).css("borderTopWidth"),10)||0)+(parseInt(e(t).css("paddingTop"),10)||0)-this.margins.top,n.left+(r?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css("borderLeftWidth"),10)||0)-(parseInt(e(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,n.top+(r?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css("borderTopWidth"),10)||0)-(parseInt(e(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,n){n||(n=this.position);var r="absolute"===t?1:-1,i="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,s=/(html|body)/i.test(i[0].tagName);return{top:n.top+this.offset.relative.top*r+this.offset.parent.top*r-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():s?0:i.scrollTop())*r,left:n.left+this.offset.relative.left*r+this.offset.parent.left*r-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():s?0:i.scrollLeft())*r}},_generatePosition:function(t){var n,r,i=this.options,s=t.pageX,o=t.pageY,u="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=/(html|body)/i.test(u[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(s=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(s=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),i.grid&&(n=this.originalPageY+Math.round((o-this.originalPageY)/i.grid[1])*i.grid[1],o=this.containment?n-this.offset.click.top>=this.containment[1]&&n-this.offset.click.top<=this.containment[3]?n:n-this.offset.click.top>=this.containment[1]?n-i.grid[1]:n+i.grid[1]:n,r=this.originalPageX+Math.round((s-this.originalPageX)/i.grid[0])*i.grid[0],s=this.containment?r-this.offset.click.left>=this.containment[0]&&r-this.offset.click.left<=this.containment[2]?r:r-this.offset.click.left>=this.containment[0]?r-i.grid[0]:r+i.grid[0]:r)),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():a?0:u.scrollTop()),left:s-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():a?0:u.scrollLeft())}},_rearrange:function(e,t,n,r){n?n[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var i=this.counter;this._delay(function(){i===this.counter&&this.refreshPositions(!r)})},_clear:function(e,t){function n(e,t,n){return function(r){n._trigger(e,r,t._uiHash(t))}}this.reverting=!1;var r,i=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(r in this._storedCSS)("auto"===this._storedCSS[r]||"static"===this._storedCSS[r])&&(this._storedCSS[r]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!t&&i.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||t||i.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(t||(i.push(function(e){this._trigger("remove",e,this._uiHash())}),i.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),i.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),r=this.containers.length-1;r>=0;r--)t||i.push(n("deactivate",this,this.containers[r])),this.containers[r].containerCache.over&&(i.push(n("out",this,this.containers[r])),this.containers[r].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!t){for(this._trigger("beforeStop",e,this._uiHash()),r=0;i.length>r;r++)i[r].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!1}if(t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!t){for(r=0;i.length>r;r++)i[r].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var n=t||this;return{helper:n.helper,placeholder:n.placeholder||e([]),position:n.position,originalPosition:n.originalPosition,offset:n.positionAbs,item:n.currentItem,sender:t?t.element:null}}}),e.widget("ui.accordion",{version:"1.11.0",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var t=this.options;this.prevShow=this.prevHide=e(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),t.collapsible||t.active!==!1&&null!=t.active||(t.active=0),this._processPanels(),0>t.active&&(t.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():e()}},_createIcons:function(){var t=this.options.icons;t&&(e("<span>").addClass("ui-accordion-header-icon ui-icon "+t.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(t.header).addClass(t.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").removeUniqueId(),this._destroyIcons(),e=this.headers.next().removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&e.css("height","")},_setOption:function(e,t){return"active"===e?(this._activate(t),void 0):("event"===e&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(t)),this._super(e,t),"collapsible"!==e||t||this.options.active!==!1||this._activate(0),"icons"===e&&(this._destroyIcons(),t&&this._createIcons()),"disabled"===e&&(this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!t)),void 0)},_keydown:function(t){if(!t.altKey&&!t.ctrlKey){var n=e.ui.keyCode,r=this.headers.length,i=this.headers.index(t.target),s=!1;switch(t.keyCode){case n.RIGHT:case n.DOWN:s=this.headers[(i+1)%r];break;case n.LEFT:case n.UP:s=this.headers[(i-1+r)%r];break;case n.SPACE:case n.ENTER:this._eventHandler(t);break;case n.HOME:s=this.headers[0];break;case n.END:s=this.headers[r-1]}s&&(e(t.target).attr("tabIndex",-1),e(s).attr("tabIndex",0),s.focus(),t.preventDefault())}},_panelKeyDown:function(t){t.keyCode===e.ui.keyCode.UP&&t.ctrlKey&&e(t.currentTarget).prev().focus()},refresh:function(){var t=this.options;this._processPanels(),t.active===!1&&t.collapsible===!0||!this.headers.length?(t.active=!1,this.active=e()):t.active===!1?this._activate(0):this.active.length&&!e.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(t.active=!1,this.active=e()):this._activate(Math.max(0,t.active-1)):t.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-state-default ui-corner-all"),this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide()},_refresh:function(){var t,n=this.options,r=n.heightStyle,i=this.element.parent();this.active=this._findActive(n.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(){var t=e(this),n=t.uniqueId().attr("id"),r=t.next(),i=r.uniqueId().attr("id");t.attr("aria-controls",i),r.attr("aria-labelledby",n)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(n.event),"fill"===r?(t=i.height(),this.element.siblings(":visible").each(function(){var n=e(this),r=n.css("position");"absolute"!==r&&"fixed"!==r&&(t-=n.outerHeight(!0))}),this.headers.each(function(){t-=e(this).outerHeight(!0)}),this.headers.next().each(function(){e(this).height(Math.max(0,t-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===r&&(t=0,this.headers.next().each(function(){t=Math.max(t,e(this).css("height","").height())}).height(t))},_activate:function(t){var n=this._findActive(t)[0];n!==this.active[0]&&(n=n||this.active[0],this._eventHandler({target:n,currentTarget:n,preventDefault:e.noop}))},_findActive:function(t){return"number"==typeof t?this.headers.eq(t):e()},_setupEvents:function(t){var n={keydown:"_keydown"};t&&e.each(t.split(" "),function(e,t){n[t]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,n),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(t){var n=this.options,r=this.active,i=e(t.currentTarget),s=i[0]===r[0],o=s&&n.collapsible,u=o?e():i.next(),a=r.next(),f={oldHeader:r,oldPanel:a,newHeader:o?e():i,newPanel:u};t.preventDefault(),s&&!n.collapsible||this._trigger("beforeActivate",t,f)===!1||(n.active=o?!1:this.headers.index(i),this.active=s?e():i,this._toggle(f),r.removeClass("ui-accordion-header-active ui-state-active"),n.icons&&r.children(".ui-accordion-header-icon").removeClass(n.icons.activeHeader).addClass(n.icons.header),s||(i.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),n.icons&&i.children(".ui-accordion-header-icon").removeClass(n.icons.header).addClass(n.icons.activeHeader),i.next().addClass("ui-accordion-content-active")))},_toggle:function(t){var n=t.newPanel,r=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=n,this.prevHide=r,this.options.animate?this._animate(n,r,t):(r.hide(),n.show(),this._toggleComplete(t)),r.attr({"aria-hidden":"true"}),r.prev().attr("aria-selected","false"),n.length&&r.length?r.prev().attr({tabIndex:-1,"aria-expanded":"false"}):n.length&&this.headers.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),n.attr("aria-hidden","false").prev().attr({"aria-selected":"true",tabIndex:0,"aria-expanded":"true"})},_animate:function(e,t,n){var r,i,s,o=this,u=0,a=e.length&&(!t.length||e.index()<t.index()),f=this.options.animate||{},l=a&&f.down||f,c=function(){o._toggleComplete(n)};return"number"==typeof l&&(s=l),"string"==typeof l&&(i=l),i=i||l.easing||f.easing,s=s||l.duration||f.duration,t.length?e.length?(r=e.show().outerHeight(),t.animate(this.hideProps,{duration:s,easing:i,step:function(e,t){t.now=Math.round(e)}}),e.hide().animate(this.showProps,{duration:s,easing:i,complete:c,step:function(e,n){n.now=Math.round(e),"height"!==n.prop?u+=n.now:"content"!==o.options.heightStyle&&(n.now=Math.round(r-t.outerHeight()-u),u=0)}}),void 0):t.animate(this.hideProps,s,i,c):e.animate(this.showProps,s,i,c)},_toggleComplete:function(e){var t=e.oldPanel;t.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),t.length&&(t.parent()[0].className=t.parent()[0].className),this._trigger("activate",null,e)}}),e.widget("ui.menu",{version:"1.11.0",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},items:"> *",menus:"ul",position:{my:"left-1 top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item":function(e){e.preventDefault()},"click .ui-menu-item":function(t){var n=e(t.target);!this.mouseHandled&&n.not(".ui-state-disabled").length&&(this.select(t),t.isPropagationStopped()||(this.mouseHandled=!0),n.has(".ui-menu").length?this.expand(t):!this.element.is(":focus")&&e(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){var n=e(t.currentTarget);n.siblings(".ui-state-active").removeClass("ui-state-active"),this.focus(t,n)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var n=this.active||this.element.find(this.options.items).eq(0);t||this.focus(e,n)},blur:function(t){this._delay(function(){e.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(e){this._closeOnDocumentClick(e)&&this.collapseAll(e),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-menu-icons ui-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var t=e(this);t.data("ui-menu-submenu-carat")&&t.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(t){function n(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var r,i,s,o,u,a=!0;switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case e.ui.keyCode.HOME:this._move("first","first",t);break;case e.ui.keyCode.END:this._move("last","last",t);break;case e.ui.keyCode.UP:this.previous(t);break;case e.ui.keyCode.DOWN:this.next(t);break;case e.ui.keyCode.LEFT:this.collapse(t);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(t);break;case e.ui.keyCode.ESCAPE:this.collapse(t);break;default:a=!1,i=this.previousFilter||"",s=String.fromCharCode(t.keyCode),o=!1,clearTimeout(this.filterTimer),s===i?o=!0:s=i+s,u=RegExp("^"+n(s),"i"),r=this.activeMenu.find(this.options.items).filter(function(){return u.test(e(this).text())}),r=o&&-1!==r.index(this.active.next())?this.active.nextAll(".ui-menu-item"):r,r.length||(s=String.fromCharCode(t.keyCode),u=RegExp("^"+n(s),"i"),r=this.activeMenu.find(this.options.items).filter(function(){return u.test(e(this).text())})),r.length?(this.focus(t,r),r.length>1?(this.previousFilter=s,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}a&&t.preventDefault()},_activate:function(e){this.active.is(".ui-state-disabled")||(this.active.is("[aria-haspopup='true']")?this.expand(e):this.select(e))},refresh:function(){var t,n,r=this,i=this.options.icons.submenu,s=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),s.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-front").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=e(this),n=t.parent(),r=e("<span>").addClass("ui-menu-icon ui-icon "+i).data("ui-menu-submenu-carat",!0);n.attr("aria-haspopup","true").prepend(r),t.attr("aria-labelledby",n.attr("id"))}),t=s.add(this.element),n=t.find(this.options.items),n.not(".ui-menu-item").each(function(){var t=e(this);r._isDivider(t)&&t.addClass("ui-widget-content ui-menu-divider")}),n.not(".ui-menu-item, .ui-menu-divider").addClass("ui-menu-item").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),n.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){"icons"===e&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this._super(e,t)},focus:function(e,t){var n,r;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(t),this.active=t.first(),r=this.active.addClass("ui-state-focus").removeClass("ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",r.attr("id")),this.active.parent().closest(".ui-menu-item").addClass("ui-state-active"),e&&"keydown"===e.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),n=t.children(".ui-menu"),n.length&&e&&/^mouse/.test(e.type)&&this._startOpening(n),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(t){var n,r,i,s,o,u;this._hasScroll()&&(n=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0,r=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0,i=t.offset().top-this.activeMenu.offset().top-n-r,s=this.activeMenu.scrollTop(),o=this.activeMenu.height(),u=t.outerHeight(),0>i?this.activeMenu.scrollTop(s+i):i+u>o&&this.activeMenu.scrollTop(s+i-o+u))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this.active.removeClass("ui-state-focus"),this.active=null,this._trigger("blur",e,{item:this.active}))},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(e)},this.delay))},_open:function(t){var n=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(n)},collapseAll:function(t,n){clearTimeout(this.timer),this.timer=this._delay(function(){var r=n?this.element:e(t&&t.target).closest(this.element.find(".ui-menu"));r.length||(r=this.element),this._close(r),this.blur(t),this.activeMenu=r},this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find(".ui-state-active").not(".ui-state-focus").removeClass("ui-state-active")},_closeOnDocumentClick:function(t){return!e(t.target).closest(".ui-menu").length},_isDivider:function(e){return!/[^\-\u2014\u2013\s]/.test(e.text())},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,n){var r;this.active&&(r="first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[e+"All"](".ui-menu-item").eq(0)),r&&r.length&&this.active||(r=this.activeMenu.find(this.options.items)[t]()),this.focus(n,r)},nextPage:function(t){var n,r,i;return this.active?(this.isLastItem()||(this._hasScroll()?(r=this.active.offset().top,i=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return n=e(this),0>n.offset().top-r-i}),this.focus(t,n)):this.focus(t,this.activeMenu.find(this.options.items)[this.active?"last":"first"]())),void 0):(this.next(t),void 0)},previousPage:function(t){var n,r,i;return this.active?(this.isFirstItem()||(this._hasScroll()?(r=this.active.offset().top,i=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return n=e(this),n.offset().top-r+i>0}),this.focus(t,n)):this.focus(t,this.activeMenu.find(this.options.items).first())),void 0):(this.next(t),void 0)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||e(t.target).closest(".ui-menu-item");var n={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,n)}}),e.widget("ui.autocomplete",{version:"1.11.0",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var t,n,r,i=this.element[0].nodeName.toLowerCase(),s="textarea"===i,o="input"===i;this.isMultiLine=s?!0:o?!1:this.element.prop("isContentEditable"),this.valueMethod=this.element[s||o?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(i){if(this.element.prop("readOnly"))return t=!0,r=!0,n=!0,void 0;t=!1,r=!1,n=!1;var s=e.ui.keyCode;switch(i.keyCode){case s.PAGE_UP:t=!0,this._move("previousPage",i);break;case s.PAGE_DOWN:t=!0,this._move("nextPage",i);break;case s.UP:t=!0,this._keyEvent("previous",i);break;case s.DOWN:t=!0,this._keyEvent("next",i);break;case s.ENTER:this.menu.active&&(t=!0,i.preventDefault(),this.menu.select(i));break;case s.TAB:this.menu.active&&this.menu.select(i);break;case s.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(i),i.preventDefault());break;default:n=!0,this._searchTimeout(i)}},keypress:function(r){if(t)return t=!1,(!this.isMultiLine||this.menu.element.is(":visible"))&&r.preventDefault(),void 0;if(!n){var i=e.ui.keyCode;switch(r.keyCode){case i.PAGE_UP:this._move("previousPage",r);break;case i.PAGE_DOWN:this._move("nextPage",r);break;case i.UP:this._keyEvent("previous",r);break;case i.DOWN:this._keyEvent("next",r)}}},input:function(e){return r?(r=!1,e.preventDefault(),void 0):(this._searchTimeout(e),void 0)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){return this.cancelBlur?(delete this.cancelBlur,void 0):(clearTimeout(this.searching),this.close(e),this._change(e),void 0)}}),this._initSource(),this.menu=e("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._on(this.menu.element,{mousedown:function(t){t.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var n=this.menu.element[0];e(t.target).closest(".ui-menu-item").length||this._delay(function(){var t=this;this.document.one("mousedown",function(r){r.target===t.element[0]||r.target===n||e.contains(n,r.target)||t.close()})})},menufocus:function(t,n){var r,i;return this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent&&/^mouse/.test(t.originalEvent.type))?(this.menu.blur(),this.document.one("mousemove",function(){e(t.target).trigger(t.originalEvent)}),void 0):(i=n.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",t,{item:i})&&t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(i.value),r=n.item.attr("aria-label")||i.value,r&&jQuery.trim(r).length&&(this.liveRegion.children().hide(),e("<div>").text(r).appendTo(this.liveRegion)),void 0)},menuselect:function(e,t){var n=t.item.data("ui-autocomplete-item"),r=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=r,this._delay(function(){this.previous=r,this.selectedItem=n})),!1!==this._trigger("select",e,{item:n})&&this._value(n.value),this.term=this._value(),this.close(e),this.selectedItem=n}}),this.liveRegion=e("<span>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this._appendTo()),"disabled"===e&&t&&this.xhr&&this.xhr.abort()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t&&t[0]||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_initSource:function(){var t,n,r=this;e.isArray(this.options.source)?(t=this.options.source,this.source=function(n,r){r(e.ui.autocomplete.filter(t,n.term))}):"string"==typeof this.options.source?(n=this.options.source,this.source=function(t,i){r.xhr&&r.xhr.abort(),r.xhr=e.ajax({url:n,data:t,dataType:"json",success:function(e){i(e)},error:function(){i([])}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay(function(){var t=this.term===this._value(),n=this.menu.element.is(":visible"),r=e.altKey||e.ctrlKey||e.metaKey||e.shiftKey;(!t||t&&!n&&!r)&&(this.selectedItem=null,this.search(null,e))},this.options.delay)},search:function(e,t){return e=null!=e?e:this._value(),this.term=this._value(),e.length<this.options.minLength?this.close(t):this._trigger("search",t)!==!1?this._search(e):void 0},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var t=++this.requestIndex;return e.proxy(function(e){t===this.requestIndex&&this.__response(e),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},this)},__response:function(e){e&&(e=this._normalize(e)),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,function(t){return"string"==typeof t?{label:t,value:t}:e.extend({},t,{label:t.label||t.value,value:t.value||t.label})})},_suggest:function(t){var n=this.menu.element.empty();this._renderMenu(n,t),this.isNewMenu=!0,this.menu.refresh(),n.show(),this._resizeMenu(),n.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,n){var r=this;e.each(n,function(e,n){r._renderItemData(t,n)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(t,n){return e("<li>").text(n.label).appendTo(t)},_move:function(e,t){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)?(this.isMultiLine||this._value(this.term),this.menu.blur(),void 0):(this.menu[e](t),void 0):(this.search(null,t),void 0)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(e,t),t.preventDefault())}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,n){var r=RegExp(e.ui.autocomplete.escapeRegex(n),"i");return e.grep(t,function(e){return r.test(e.label||e.value||e)})}}),e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(t){var n;this._superApply(arguments),this.options.disabled||this.cancelSearch||(n=t&&t.length?this.options.messages.results(t.length):this.options.messages.noResults,this.liveRegion.children().hide(),e("<div>").text(n).appendTo(this.liveRegion))}}),e.ui.autocomplete;var c,h="ui-button ui-widget ui-state-default ui-corner-all",p="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",d=function(){var t=e(this);setTimeout(function(){t.find(":ui-button").button("refresh")},1)},v=function(t){var n=t.name,r=t.form,i=e([]);return n&&(n=n.replace(/'/g,"\\'"),i=r?e(r).find("[name='"+n+"'][type=radio]"):e("[name='"+n+"'][type=radio]",t.ownerDocument).filter(function(){return!this.form})),i};e.widget("ui.button",{version:"1.11.0",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,d),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var t=this,n=this.options,r="checkbox"===this.type||"radio"===this.type,i=r?"":"ui-state-active";null===n.label&&(n.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(h).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){n.disabled||this===c&&e(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){n.disabled||e(this).removeClass(i)}).bind("click"+this.eventNamespace,function(e){n.disabled&&(e.preventDefault(),e.stopImmediatePropagation())}),this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}}),r&&this.element.bind("change"+this.eventNamespace,function(){t.refresh()}),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return n.disabled?!1:void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(n.disabled)return!1;e(this).addClass("ui-state-active"),t.buttonElement.attr("aria-pressed","true");var r=t.element[0];v(r).not(r).map(function(){return e(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return n.disabled?!1:(e(this).addClass("ui-state-active"),c=this,t.document.one("mouseup",function(){c=null}),void 0)}).bind("mouseup"+this.eventNamespace,function(){return n.disabled?!1:(e(this).removeClass("ui-state-active"),void 0)}).bind("keydown"+this.eventNamespace,function(t){return n.disabled?!1:((t.keyCode===e.ui.keyCode.SPACE||t.keyCode===e.ui.keyCode.ENTER)&&e(this).addClass("ui-state-active"),void 0)}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){e(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(t){t.keyCode===e.ui.keyCode.SPACE&&e(this).click()})),this._setOption("disabled",n.disabled),this._resetButton()},_determineButtonType:function(){var e,t,n;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(e=this.element.parents().last(),t="label[for='"+this.element.attr("id")+"']",this.buttonElement=e.find(t),this.buttonElement.length||(e=e.length?e.siblings():this.element.siblings(),this.buttonElement=e.filter(t),this.buttonElement.length||(this.buttonElement=e.find(t))),this.element.addClass("ui-helper-hidden-accessible"),n=this.element.is(":checked"),n&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",n)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(h+" ui-state-active "+p).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(e,t){return this._super(e,t),"disabled"===e?(this.widget().toggleClass("ui-state-disabled",!!t),this.element.prop("disabled",!!t),t&&("checkbox"===this.type||"radio"===this.type?this.buttonElement.removeClass("ui-state-focus"):this.buttonElement.removeClass("ui-state-focus ui-state-active")),void 0):(this._resetButton(),void 0)},refresh:function(){var t=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");t!==this.options.disabled&&this._setOption("disabled",t),"radio"===this.type?v(this.element[0]).each(function(){e(this).is(":checked")?e(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):e(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return this.options.label&&this.element.val(this.options.label),void 0;var t=this.buttonElement.removeClass(p),n=e("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(t.empty()).text(),r=this.options.icons,i=r.primary&&r.secondary,s=[];r.primary||r.secondary?(this.options.text&&s.push("ui-button-text-icon"+(i?"s":r.primary?"-primary":"-secondary")),r.primary&&t.prepend("<span class='ui-button-icon-primary ui-icon "+r.primary+"'></span>"),r.secondary&&t.append("<span class='ui-button-icon-secondary ui-icon "+r.secondary+"'></span>"),this.options.text||(s.push(i?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||t.attr("title",e.trim(n)))):s.push("ui-button-text-only"),t.addClass(s.join(" "))}}),e.widget("ui.buttonset",{version:"1.11.0",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(e,t){"disabled"===e&&this.buttons.button("option",e,t),this._super(e,t)},refresh:function(){var t="rtl"===this.element.css("direction"),n=this.element.find(this.options.items),r=n.filter(":ui-button");n.not(":ui-button").button(),r.button("refresh"),this.buttons=n.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(t?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}}),e.ui.button,e.extend(e.ui,{datepicker:{version:"1.11.0"}});var m;e.extend(i.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return o(this._defaults,e||{}),this},_attachDatepicker:function(t,n){var r,i,s;r=t.nodeName.toLowerCase(),i="div"===r||"span"===r,t.id||(this.uuid+=1,t.id="dp"+this.uuid),s=this._newInst(e(t),i),s.settings=e.extend({},n||{}),"input"===r?this._connectDatepicker(t,s):i&&this._inlineDatepicker(t,s)},_newInst:function(t,n){var r=t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:r,input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:n,dpDiv:n?s(e("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,n){var r=e(t);n.append=e([]),n.trigger=e([]),r.hasClass(this.markerClassName)||(this._attachments(r,n),r.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(n),e.data(t,"datepicker",n),n.settings.disabled&&this._disableDatepicker(t))},_attachments:function(t,n){var r,i,s,o=this._get(n,"appendText"),u=this._get(n,"isRTL");n.append&&n.append.remove(),o&&(n.append=e("<span class='"+this._appendClass+"'>"+o+"</span>"),t[u?"before":"after"](n.append)),t.unbind("focus",this._showDatepicker),n.trigger&&n.trigger.remove(),r=this._get(n,"showOn"),("focus"===r||"both"===r)&&t.focus(this._showDatepicker),("button"===r||"both"===r)&&(i=this._get(n,"buttonText"),s=this._get(n,"buttonImage"),n.trigger=e(this._get(n,"buttonImageOnly")?e("<img/>").addClass(this._triggerClass).attr({src:s,alt:i,title:i}):e("<button type='button'></button>").addClass(this._triggerClass).html(s?e("<img/>").attr({src:s,alt:i,title:i}):i)),t[u?"before":"after"](n.trigger),n.trigger.click(function(){return e.datepicker._datepickerShowing&&e.datepicker._lastInput===t[0]?e.datepicker._hideDatepicker():e.datepicker._datepickerShowing&&e.datepicker._lastInput!==t[0]?(e.datepicker._hideDatepicker(),e.datepicker._showDatepicker(t[0])):e.datepicker._showDatepicker(t[0]),!1}))},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,n,r,i,s=new Date(2009,11,20),o=this._get(e,"dateFormat");o.match(/[DM]/)&&(t=function(e){for(n=0,r=0,i=0;e.length>i;i++)e[i].length>n&&(n=e[i].length,r=i);return r},s.setMonth(t(this._get(e,o.match(/MM/)?"monthNames":"monthNamesShort"))),s.setDate(t(this._get(e,o.match(/DD/)?"dayNames":"dayNamesShort"))+20-s.getDay())),e.input.attr("size",this._formatDate(e,s).length)}},_inlineDatepicker:function(t,n){var r=e(t);r.hasClass(this.markerClassName)||(r.addClass(this.markerClassName).append(n.dpDiv),e.data(t,"datepicker",n),this._setDate(n,this._getDefaultDate(n),!0),this._updateDatepicker(n),this._updateAlternate(n),n.settings.disabled&&this._disableDatepicker(t),n.dpDiv.css("display","block"))},_dialogDatepicker:function(t,n,r,i,s){var u,a,f,l,c,h=this._dialogInst;return h||(this.uuid+=1,u="dp"+this.uuid,this._dialogInput=e("<input type='text' id='"+u+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),e("body").append(this._dialogInput),h=this._dialogInst=this._newInst(this._dialogInput,!1),h.settings={},e.data(this._dialogInput[0],"datepicker",h)),o(h.settings,i||{}),n=n&&n.constructor===Date?this._formatDate(h,n):n,this._dialogInput.val(n),this._pos=s?s.length?s:[s.pageX,s.pageY]:null,this._pos||(a=document.documentElement.clientWidth,f=document.documentElement.clientHeight,l=document.documentElement.scrollLeft||document.body.scrollLeft,c=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[a/2-100+l,f/2-150+c]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),h.settings.onSelect=r,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),e.blockUI&&e.blockUI(this.dpDiv),e.data(this._dialogInput[0],"datepicker",h),this},_destroyDatepicker:function(t){var n,r=e(t),i=e.data(t,"datepicker");r.hasClass(this.markerClassName)&&(n=t.nodeName.toLowerCase(),e.removeData(t,"datepicker"),"input"===n?(i.append.remove(),i.trigger.remove(),r.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===n||"span"===n)&&r.removeClass(this.markerClassName).empty())},_enableDatepicker:function(t){var n,r,i=e(t),s=e.data(t,"datepicker");i.hasClass(this.markerClassName)&&(n=t.nodeName.toLowerCase(),"input"===n?(t.disabled=!1,s.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===n||"span"===n)&&(r=i.children("."+this._inlineClass),r.children().removeClass("ui-state-disabled"),r.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}))},_disableDatepicker:function(t){var n,r,i=e(t),s=e.data(t,"datepicker");i.hasClass(this.markerClassName)&&(n=t.nodeName.toLowerCase(),"input"===n?(t.disabled=!0,s.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===n||"span"===n)&&(r=i.children("."+this._inlineClass),r.children().addClass("ui-state-disabled"),r.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t)},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;this._disabledInputs.length>t;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(t){try{return e.data(t,"datepicker")}catch(n){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(t,n,r){var i,s,u,a,f=this._getInst(t);return 2===arguments.length&&"string"==typeof n?"defaults"===n?e.extend({},e.datepicker._defaults):f?"all"===n?e.extend({},f.settings):this._get(f,n):null:(i=n||{},"string"==typeof n&&(i={},i[n]=r),f&&(this._curInst===f&&this._hideDatepicker(),s=this._getDateDatepicker(t,!0),u=this._getMinMaxDate(f,"min"),a=this._getMinMaxDate(f,"max"),o(f.settings,i),null!==u&&void 0!==i.dateFormat&&void 0===i.minDate&&(f.settings.minDate=this._formatDate(f,u)),null!==a&&void 0!==i.dateFormat&&void 0===i.maxDate&&(f.settings.maxDate=this._formatDate(f,a)),"disabled"in i&&(i.disabled?this._disableDatepicker(t):this._enableDatepicker(t)),this._attachments(e(t),f),this._autoSize(f),this._setDate(f,s),this._updateAlternate(f),this._updateDatepicker(f)),void 0)},_changeDatepicker:function(e,t,n){this._optionDatepicker(e,t,n)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var n=this._getInst(e);n&&(this._setDate(n,t),this._updateDatepicker(n),this._updateAlternate(n))},_getDateDatepicker:function(e,t){var n=this._getInst(e);return n&&!n.inline&&this._setDateFromField(n,t),n?this._getDate(n):null},_doKeyDown:function(t){var n,r,i,s=e.datepicker._getInst(t.target),o=!0,u=s.dpDiv.is(".ui-datepicker-rtl");if(s._keyEvent=!0,e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker(),o=!1;break;case 13:return i=e("td."+e.datepicker._dayOverClass+":not(."+e.datepicker._currentClass+")",s.dpDiv),i[0]&&e.datepicker._selectDay(t.target,s.selectedMonth,s.selectedYear,i[0]),n=e.datepicker._get(s,"onSelect"),n?(r=e.datepicker._formatDate(s),n.apply(s.input?s.input[0]:null,[r,s])):e.datepicker._hideDatepicker(),!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(s,"stepBigMonths"):-e.datepicker._get(s,"stepMonths"),"M");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(s,"stepBigMonths"):+e.datepicker._get(s,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&e.datepicker._clearDate(t.target),o=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&e.datepicker._gotoToday(t.target),o=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,u?1:-1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(s,"stepBigMonths"):-e.datepicker._get(s,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,-7,"D"),o=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,u?-1:1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(s,"stepBigMonths"):+e.datepicker._get(s,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,7,"D"),o=t.ctrlKey||t.metaKey;break;default:o=!1}else 36===t.keyCode&&t.ctrlKey?e.datepicker._showDatepicker(this):o=!1;o&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var n,r,i=e.datepicker._getInst(t.target);return e.datepicker._get(i,"constrainInput")?(n=e.datepicker._possibleChars(e.datepicker._get(i,"dateFormat")),r=String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||" ">r||!n||n.indexOf(r)>-1):void 0},_doKeyUp:function(t){var n,r=e.datepicker._getInst(t.target);if(r.input.val()!==r.lastVal)try{n=e.datepicker.parseDate(e.datepicker._get(r,"dateFormat"),r.input?r.input.val():null,e.datepicker._getFormatConfig(r)),n&&(e.datepicker._setDateFromField(r),e.datepicker._updateAlternate(r),e.datepicker._updateDatepicker(r))}catch(i){}return!0},_showDatepicker:function(t){if(t=t.target||t,"input"!==t.nodeName.toLowerCase()&&(t=e("input",t.parentNode)[0]),!e.datepicker._isDisabledDatepicker(t)&&e.datepicker._lastInput!==t){var n,i,s,u,a,f,l;n=e.datepicker._getInst(t),e.datepicker._curInst&&e.datepicker._curInst!==n&&(e.datepicker._curInst.dpDiv.stop(!0,!0),n&&e.datepicker._datepickerShowing&&e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])),i=e.datepicker._get(n,"beforeShow"),s=i?i.apply(t,[t,n]):{},s!==!1&&(o(n.settings,s),n.lastVal=null,e.datepicker._lastInput=t,e.datepicker._setDateFromField(n),e.datepicker._inDialog&&(t.value=""),e.datepicker._pos||(e.datepicker._pos=e.datepicker._findPos(t),e.datepicker._pos[1]+=t.offsetHeight),u=!1,e(t).parents().each(function(){return u|="fixed"===e(this).css("position"),!u}),a={left:e.datepicker._pos[0],top:e.datepicker._pos[1]},e.datepicker._pos=null,n.dpDiv.empty(),n.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),e.datepicker._updateDatepicker(n),a=e.datepicker._checkOffset(n,a,u),n.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?"static":u?"fixed":"absolute",display:"none",left:a.left+"px",top:a.top+"px"}),n.inline||(f=e.datepicker._get(n,"showAnim"),l=e.datepicker._get(n,"duration"),n.dpDiv.css("z-index",r(e(t))+1),e.datepicker._datepickerShowing=!0,e.effects&&e.effects.effect[f]?n.dpDiv.show(f,e.datepicker._get(n,"showOptions"),l):n.dpDiv[f||"show"](f?l:null),e.datepicker._shouldFocusInput(n)&&n.input.focus(),e.datepicker._curInst=n))}},_updateDatepicker:function(t){this.maxRows=4,m=t,t.dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t),t.dpDiv.find("."+this._dayOverClass+" a");var n,r=this._getNumberOfMonths(t),i=r[1],s=17;t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),i>1&&t.dpDiv.addClass("ui-datepicker-multi-"+i).css("width",s*i+"em"),t.dpDiv[(1!==r[0]||1!==r[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t===e.datepicker._curInst&&e.datepicker._datepickerShowing&&e.datepicker._shouldFocusInput(t)&&t.input.focus(),t.yearshtml&&(n=t.yearshtml,setTimeout(function(){n===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),n=t.yearshtml=null},0))},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(t,n,r){var i=t.dpDiv.outerWidth(),s=t.dpDiv.outerHeight(),o=t.input?t.input.outerWidth():0,u=t.input?t.input.outerHeight():0,a=document.documentElement.clientWidth+(r?0:e(document).scrollLeft()),f=document.documentElement.clientHeight+(r?0:e(document).scrollTop());return n.left-=this._get(t,"isRTL")?i-o:0,n.left-=r&&n.left===t.input.offset().left?e(document).scrollLeft():0,n.top-=r&&n.top===t.input.offset().top+u?e(document).scrollTop():0,n.left-=Math.min(n.left,n.left+i>a&&a>i?Math.abs(n.left+i-a):0),n.top-=Math.min(n.top,n.top+s>f&&f>s?Math.abs(s+u):0),n},_findPos:function(t){for(var n,r=this._getInst(t),i=this._get(r,"isRTL");t&&("hidden"===t.type||1!==t.nodeType||e.expr.filters.hidden(t));)t=t[i?"previousSibling":"nextSibling"];return n=e(t).offset(),[n.left,n.top]},_hideDatepicker:function(t){var n,r,i,s,o=this._curInst;!o||t&&o!==e.data(t,"datepicker")||this._datepickerShowing&&(n=this._get(o,"showAnim"),r=this._get(o,"duration"),i=function(){e.datepicker._tidyDialog(o)},e.effects&&(e.effects.effect[n]||e.effects[n])?o.dpDiv.hide(n,e.datepicker._get(o,"showOptions"),r,i):o.dpDiv["slideDown"===n?"slideUp":"fadeIn"===n?"fadeOut":"hide"](n?r:null,i),n||i(),this._datepickerShowing=!1,s=this._get(o,"onClose"),s&&s.apply(o.input?o.input[0]:null,[o.input?o.input.val():"",o]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),e.blockUI&&(e.unblockUI(),e("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(e.datepicker._curInst){var n=e(t.target),r=e.datepicker._getInst(n[0]);(n[0].id!==e.datepicker._mainDivId&&0===n.parents("#"+e.datepicker._mainDivId).length&&!n.hasClass(e.datepicker.markerClassName)&&!n.closest("."+e.datepicker._triggerClass).length&&e.datepicker._datepickerShowing&&(!e.datepicker._inDialog||!e.blockUI)||n.hasClass(e.datepicker.markerClassName)&&e.datepicker._curInst!==r)&&e.datepicker._hideDatepicker()}},_adjustDate:function(t,n,r){var i=e(t),s=this._getInst(i[0]);this._isDisabledDatepicker(i[0])||(this._adjustInstDate(s,n+("M"===r?this._get(s,"showCurrentAtPos"):0),r),this._updateDatepicker(s))},_gotoToday:function(t){var n,r=e(t),i=this._getInst(r[0]);this._get(i,"gotoCurrent")&&i.currentDay?(i.selectedDay=i.currentDay,i.drawMonth=i.selectedMonth=i.currentMonth,i.drawYear=i.selectedYear=i.currentYear):(n=new Date,i.selectedDay=n.getDate(),i.drawMonth=i.selectedMonth=n.getMonth(),i.drawYear=i.selectedYear=n.getFullYear()),this._notifyChange(i),this._adjustDate(r)},_selectMonthYear:function(t,n,r){var i=e(t),s=this._getInst(i[0]);s["selected"+("M"===r?"Month":"Year")]=s["draw"+("M"===r?"Month":"Year")]=parseInt(n.options[n.selectedIndex].value,10),this._notifyChange(s),this._adjustDate(i)},_selectDay:function(t,n,r,i){var s,o=e(t);e(i).hasClass(this._unselectableClass)||this._isDisabledDatepicker(o[0])||(s=this._getInst(o[0]),s.selectedDay=s.currentDay=e("a",i).html(),s.selectedMonth=s.currentMonth=n,s.selectedYear=s.currentYear=r,this._selectDate(t,this._formatDate(s,s.currentDay,s.currentMonth,s.currentYear)))},_clearDate:function(t){var n=e(t);this._selectDate(n,"")},_selectDate:function(t,n){var r,i=e(t),s=this._getInst(i[0]);n=null!=n?n:this._formatDate(s),s.input&&s.input.val(n),this._updateAlternate(s),r=this._get(s,"onSelect"),r?r.apply(s.input?s.input[0]:null,[n,s]):s.input&&s.input.trigger("change"),s.inline?this._updateDatepicker(s):(this._hideDatepicker(),this._lastInput=s.input[0],"object"!=typeof s.input[0]&&s.input.focus(),this._lastInput=null)},_updateAlternate:function(t){var n,r,i,s=this._get(t,"altField");s&&(n=this._get(t,"altFormat")||this._get(t,"dateFormat"),r=this._getDate(t),i=this.formatDate(n,r,this._getFormatConfig(t)),e(s).each(function(){e(this).val(i)}))},noWeekends:function(e){var t=e.getDay();return[t>0&&6>t,""]},iso8601Week:function(e){var t,n=new Date(e.getTime());return n.setDate(n.getDate()+4-(n.getDay()||7)),t=n.getTime(),n.setMonth(0),n.setDate(1),Math.floor(Math.round((t-n)/864e5)/7)+1},parseDate:function(t,n,r){if(null==t||null==n)throw"Invalid arguments";if(n="object"==typeof n?""+n:n+"",""===n)return null;var i,s,o,u,a=0,f=(r?r.shortYearCutoff:null)||this._defaults.shortYearCutoff,l="string"!=typeof f?f:(new Date).getFullYear()%100+parseInt(f,10),c=(r?r.dayNamesShort:null)||this._defaults.dayNamesShort,h=(r?r.dayNames:null)||this._defaults.dayNames,p=(r?r.monthNamesShort:null)||this._defaults.monthNamesShort,d=(r?r.monthNames:null)||this._defaults.monthNames,v=-1,m=-1,g=-1,y=-1,b=!1,w=function(e){var n=t.length>i+1&&t.charAt(i+1)===e;return n&&i++,n},E=function(e){var t=w(e),r="@"===e?14:"!"===e?20:"y"===e&&t?4:"o"===e?3:2,i=RegExp("^\\d{1,"+r+"}"),s=n.substring(a).match(i);if(!s)throw"Missing number at position "+a;return a+=s[0].length,parseInt(s[0],10)},S=function(t,r,i){var s=-1,o=e.map(w(t)?i:r,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});if(e.each(o,function(e,t){var r=t[1];return n.substr(a,r.length).toLowerCase()===r.toLowerCase()?(s=t[0],a+=r.length,!1):void 0}),-1!==s)return s+1;throw"Unknown name at position "+a},x=function(){if(n.charAt(a)!==t.charAt(i))throw"Unexpected literal at position "+a;a++};for(i=0;t.length>i;i++)if(b)"'"!==t.charAt(i)||w("'")?x():b=!1;else switch(t.charAt(i)){case"d":g=E("d");break;case"D":S("D",c,h);break;case"o":y=E("o");break;case"m":m=E("m");break;case"M":m=S("M",p,d);break;case"y":v=E("y");break;case"@":u=new Date(E("@")),v=u.getFullYear(),m=u.getMonth()+1,g=u.getDate();break;case"!":u=new Date((E("!")-this._ticksTo1970)/1e4),v=u.getFullYear(),m=u.getMonth()+1,g=u.getDate();break;case"'":w("'")?x():b=!0;break;default:x()}if(n.length>a&&(o=n.substr(a),!/^\s+/.test(o)))throw"Extra/unparsed characters found in date: "+o;if(-1===v?v=(new Date).getFullYear():100>v&&(v+=(new Date).getFullYear()-(new Date).getFullYear()%100+(l>=v?0:-100)),y>-1)for(m=1,g=y;;){if(s=this._getDaysInMonth(v,m-1),s>=g)break;m++,g-=s}if(u=this._daylightSavingAdjust(new Date(v,m-1,g)),u.getFullYear()!==v||u.getMonth()+1!==m||u.getDate()!==g)throw"Invalid date";return u},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:864e9*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(e,t,n){if(!t)return"";var r,i=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,s=(n?n.dayNames:null)||this._defaults.dayNames,o=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,u=(n?n.monthNames:null)||this._defaults.monthNames,a=function(t){var n=e.length>r+1&&e.charAt(r+1)===t;return n&&r++,n},f=function(e,t,n){var r=""+t;if(a(e))for(;n>r.length;)r="0"+r;return r},l=function(e,t,n,r){return a(e)?r[t]:n[t]},c="",h=!1;if(t)for(r=0;e.length>r;r++)if(h)"'"!==e.charAt(r)||a("'")?c+=e.charAt(r):h=!1;else switch(e.charAt(r)){case"d":c+=f("d",t.getDate(),2);break;case"D":c+=l("D",t.getDay(),i,s);break;case"o":c+=f("o",Math.round(((new Date(t.getFullYear(),t.getMonth(),t.getDate())).getTime()-(new Date(t.getFullYear(),0,0)).getTime())/864e5),3);break;case"m":c+=f("m",t.getMonth()+1,2);break;case"M":c+=l("M",t.getMonth(),o,u);break;case"y":c+=a("y")?t.getFullYear():(10>t.getYear()%100?"0":"")+t.getYear()%100;break;case"@":c+=t.getTime();break;case"!":c+=1e4*t.getTime()+this._ticksTo1970;break;case"'":a("'")?c+="'":h=!0;break;default:c+=e.charAt(r)}return c},_possibleChars:function(e){var t,n="",r=!1,i=function(n){var r=e.length>t+1&&e.charAt(t+1)===n;return r&&t++,r};for(t=0;e.length>t;t++)if(r)"'"!==e.charAt(t)||i("'")?n+=e.charAt(t):r=!1;else switch(e.charAt(t)){case"d":case"m":case"y":case"@":n+="0123456789";break;case"D":case"M":return null;case"'":i("'")?n+="'":r=!0;break;default:n+=e.charAt(t)}return n},_get:function(e,t){return void 0!==e.settings[t]?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()!==e.lastVal){var n=this._get(e,"dateFormat"),r=e.lastVal=e.input?e.input.val():null,i=this._getDefaultDate(e),s=i,o=this._getFormatConfig(e);try{s=this.parseDate(n,r,o)||i}catch(u){r=t?"":r}e.selectedDay=s.getDate(),e.drawMonth=e.selectedMonth=s.getMonth(),e.drawYear=e.selectedYear=s.getFullYear(),e.currentDay=r?s.getDate():0,e.currentMonth=r?s.getMonth():0,e.currentYear=r?s.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(t,n,r){var i=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},s=function(n){try{return e.datepicker.parseDate(e.datepicker._get(t,"dateFormat"),n,e.datepicker._getFormatConfig(t))}catch(r){}for(var i=(n.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,s=i.getFullYear(),o=i.getMonth(),u=i.getDate(),a=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,f=a.exec(n);f;){switch(f[2]||"d"){case"d":case"D":u+=parseInt(f[1],10);break;case"w":case"W":u+=7*parseInt(f[1],10);break;case"m":case"M":o+=parseInt(f[1],10),u=Math.min(u,e.datepicker._getDaysInMonth(s,o));break;case"y":case"Y":s+=parseInt(f[1],10),u=Math.min(u,e.datepicker._getDaysInMonth(s,o))}f=a.exec(n)}return new Date(s,o,u)},o=null==n||""===n?r:"string"==typeof n?s(n):"number"==typeof n?isNaN(n)?r:i(n):new Date(n.getTime());return o=o&&"Invalid Date"==""+o?r:o,o&&(o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)),this._daylightSavingAdjust(o)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,n){var r=!t,i=e.selectedMonth,s=e.selectedYear,o=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=o.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=o.getMonth(),e.drawYear=e.selectedYear=e.currentYear=o.getFullYear(),i===e.selectedMonth&&s===e.selectedYear||n||this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(r?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&""===e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(t){var n=this._get(t,"stepMonths"),r="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){e.datepicker._adjustDate(r,-n,"M")},next:function(){e.datepicker._adjustDate(r,+n,"M")},hide:function(){e.datepicker._hideDatepicker()},today:function(){e.datepicker._gotoToday(r)},selectDay:function(){return e.datepicker._selectDay(r,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return e.datepicker._selectMonthYear(r,this,"M"),!1},selectYear:function(){return e.datepicker._selectMonthYear(r,this,"Y"),!1}};e(this).bind(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q=new Date,R=this._daylightSavingAdjust(new Date(q.getFullYear(),q.getMonth(),q.getDate())),U=this._get(e,"isRTL"),z=this._get(e,"showButtonPanel"),W=this._get(e,"hideIfNoPrevNext"),X=this._get(e,"navigationAsDateFormat"),V=this._getNumberOfMonths(e),$=this._get(e,"showCurrentAtPos"),J=this._get(e,"stepMonths"),K=1!==V[0]||1!==V[1],Q=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),G=this._getMinMaxDate(e,"min"),Y=this._getMinMaxDate(e,"max"),Z=e.drawMonth-$,et=e.drawYear;if(0>Z&&(Z+=12,et--),Y)for(t=this._daylightSavingAdjust(new Date(Y.getFullYear(),Y.getMonth()-V[0]*V[1]+1,Y.getDate())),t=G&&G>t?G:t;this._daylightSavingAdjust(new Date(et,Z,1))>t;)Z--,0>Z&&(Z=11,et--);for(e.drawMonth=Z,e.drawYear=et,n=this._get(e,"prevText"),n=X?this.formatDate(n,this._daylightSavingAdjust(new Date(et,Z-J,1)),this._getFormatConfig(e)):n,r=this._canAdjustMonth(e,-1,et,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"e":"w")+"'>"+n+"</span></a>":W?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"e":"w")+"'>"+n+"</span></a>",i=this._get(e,"nextText"),i=X?this.formatDate(i,this._daylightSavingAdjust(new Date(et,Z+J,1)),this._getFormatConfig(e)):i,s=this._canAdjustMonth(e,1,et,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"w":"e")+"'>"+i+"</span></a>":W?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"w":"e")+"'>"+i+"</span></a>",o=this._get(e,"currentText"),u=this._get(e,"gotoCurrent")&&e.currentDay?Q:R,o=X?this.formatDate(o,u,this._getFormatConfig(e)):o,a=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",f=z?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(U?a:"")+(this._isInRange(e,u)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+o+"</button>":"")+(U?"":a)+"</div>":"",l=parseInt(this._get(e,"firstDay"),10),l=isNaN(l)?0:l,c=this._get(e,"showWeek"),h=this._get(e,"dayNames"),p=this._get(e,"dayNamesMin"),d=this._get(e,"monthNames"),v=this._get(e,"monthNamesShort"),m=this._get(e,"beforeShowDay"),g=this._get(e,"showOtherMonths"),y=this._get(e,"selectOtherMonths"),b=this._getDefaultDate(e),w="",S=0;V[0]>S;S++){for(x="",this.maxRows=4,T=0;V[1]>T;T++){if(N=this._daylightSavingAdjust(new Date(et,Z,e.selectedDay)),C=" ui-corner-all",k="",K){if(k+="<div class='ui-datepicker-group",V[1]>1)switch(T){case 0:k+=" ui-datepicker-group-first",C=" ui-corner-"+(U?"right":"left");break;case V[1]-1:k+=" ui-datepicker-group-last",C=" ui-corner-"+(U?"left":"right");break;default:k+=" ui-datepicker-group-middle",C=""}k+="'>"}for(k+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+C+"'>"+(/all|left/.test(C)&&0===S?U?s:r:"")+(/all|right/.test(C)&&0===S?U?r:s:"")+this._generateMonthYearHeader(e,Z,et,G,Y,S>0||T>0,d,v)+"</div><table class='ui-datepicker-calendar'><thead>"+"<tr>",L=c?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"",E=0;7>E;E++)A=(E+l)%7,L+="<th scope='col'"+((E+l+6)%7>=5?" class='ui-datepicker-week-end'":"")+">"+"<span title='"+h[A]+"'>"+p[A]+"</span></th>";for(k+=L+"</tr></thead><tbody>",O=this._getDaysInMonth(et,Z),et===e.selectedYear&&Z===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,O)),M=(this._getFirstDayOfMonth(et,Z)-l+7)%7,_=Math.ceil((M+O)/7),D=K?this.maxRows>_?this.maxRows:_:_,this.maxRows=D,P=this._daylightSavingAdjust(new Date(et,Z,1-M)),H=0;D>H;H++){for(k+="<tr>",B=c?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(P)+"</td>":"",E=0;7>E;E++)j=m?m.apply(e.input?e.input[0]:null,[P]):[!0,""],F=P.getMonth()!==Z,I=F&&!y||!j[0]||G&&G>P||Y&&P>Y,B+="<td class='"+((E+l+6)%7>=5?" ui-datepicker-week-end":"")+(F?" ui-datepicker-other-month":"")+(P.getTime()===N.getTime()&&Z===e.selectedMonth&&e._keyEvent||b.getTime()===P.getTime()&&b.getTime()===N.getTime()?" "+this._dayOverClass:"")+(I?" "+this._unselectableClass+" ui-state-disabled":"")+(F&&!g?"":" "+j[1]+(P.getTime()===Q.getTime()?" "+this._currentClass:"")+(P.getTime()===R.getTime()?" ui-datepicker-today":""))+"'"+(F&&!g||!j[2]?"":" title='"+j[2].replace(/'/g,"&#39;")+"'")+(I?"":" data-handler='selectDay' data-event='click' data-month='"+P.getMonth()+"' data-year='"+P.getFullYear()+"'")+">"+(F&&!g?"&#xa0;":I?"<span class='ui-state-default'>"+P.getDate()+"</span>":"<a class='ui-state-default"+(P.getTime()===R.getTime()?" ui-state-highlight":"")+(P.getTime()===Q.getTime()?" ui-state-active":"")+(F?" ui-priority-secondary":"")+"' href='#'>"+P.getDate()+"</a>")+"</td>",P.setDate(P.getDate()+1),P=this._daylightSavingAdjust(P);k+=B+"</tr>"}Z++,Z>11&&(Z=0,et++),k+="</tbody></table>"+(K?"</div>"+(V[0]>0&&T===V[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),x+=k}w+=x}return w+=f,e._keyEvent=!1,w},_generateMonthYearHeader:function(e,t,n,r,i,s,o,u){var a,f,l,c,h,p,d,v,m=this._get(e,"changeMonth"),g=this._get(e,"changeYear"),y=this._get(e,"showMonthAfterYear"),b="<div class='ui-datepicker-title'>",w="";if(s||!m)w+="<span class='ui-datepicker-month'>"+o[t]+"</span>";else{for(a=r&&r.getFullYear()===n,f=i&&i.getFullYear()===n,w+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",l=0;12>l;l++)(!a||l>=r.getMonth())&&(!f||i.getMonth()>=l)&&(w+="<option value='"+l+"'"+(l===t?" selected='selected'":"")+">"+u[l]+"</option>");w+="</select>"}if(y||(b+=w+(!s&&m&&g?"":"&#xa0;")),!e.yearshtml)if(e.yearshtml="",s||!g)b+="<span class='ui-datepicker-year'>"+n+"</span>";else{for(c=this._get(e,"yearRange").split(":"),h=(new Date).getFullYear(),p=function(e){var t=e.match(/c[+\-].*/)?n+parseInt(e.substring(1),10):e.match(/[+\-].*/)?h+parseInt(e,10):parseInt(e,10);return isNaN(t)?h:t},d=p(c[0]),v=Math.max(d,p(c[1]||"")),d=r?Math.max(d,r.getFullYear()):d,v=i?Math.min(v,i.getFullYear()):v,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";v>=d;d++)e.yearshtml+="<option value='"+d+"'"+(d===n?" selected='selected'":"")+">"+d+"</option>";e.yearshtml+="</select>",b+=e.yearshtml,e.yearshtml=null}return b+=this._get(e,"yearSuffix"),y&&(b+=(!s&&m&&g?"":"&#xa0;")+w),b+="</div>"},_adjustInstDate:function(e,t,n){var r=e.drawYear+("Y"===n?t:0),i=e.drawMonth+("M"===n?t:0),s=Math.min(e.selectedDay,this._getDaysInMonth(r,i))+("D"===n?t:0),o=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(r,i,s)));e.selectedDay=o.getDate(),e.drawMonth=e.selectedMonth=o.getMonth(),e.drawYear=e.selectedYear=o.getFullYear(),("M"===n||"Y"===n)&&this._notifyChange(e)},_restrictMinMax:function(e,t){var n=this._getMinMaxDate(e,"min"),r=this._getMinMaxDate(e,"max"),i=n&&n>t?n:t;return r&&i>r?r:i},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return null==t?[1,1]:"number"==typeof t?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return(new Date(e,t,1)).getDay()},_canAdjustMonth:function(e,t,n,r){var i=this._getNumberOfMonths(e),s=this._daylightSavingAdjust(new Date(n,r+(0>t?t:i[0]*i[1]),1));return 0>t&&s.setDate(this._getDaysInMonth(s.getFullYear(),s.getMonth())),this._isInRange(e,s)},_isInRange:function(e,t){var n,r,i=this._getMinMaxDate(e,"min"),s=this._getMinMaxDate(e,"max"),o=null,u=null,a=this._get(e,"yearRange");return a&&(n=a.split(":"),r=(new Date).getFullYear(),o=parseInt(n[0],10),u=parseInt(n[1],10),n[0].match(/[+\-].*/)&&(o+=r),n[1].match(/[+\-].*/)&&(u+=r)),(!i||t.getTime()>=i.getTime())&&(!s||t.getTime()<=s.getTime())&&(!o||t.getFullYear()>=o)&&(!u||u>=t.getFullYear())},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,n,r){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var i=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(r,n,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),i,this._getFormatConfig(e))}}),e.fn.datepicker=function(t){if(!this.length)return this;e.datepicker.initialized||(e(document).mousedown(e.datepicker._checkExternalClick),e.datepicker.initialized=!0),0===e("#"+e.datepicker._mainDivId).length&&e("body").append(e.datepicker.dpDiv);var n=Array.prototype.slice.call(arguments,1);return"string"!=typeof t||"isDisabled"!==t&&"getDate"!==t&&"widget"!==t?"option"===t&&2===arguments.length&&"string"==typeof arguments[1]?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(n)):this.each(function(){"string"==typeof t?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this].concat(n)):e.datepicker._attachDatepicker(this,t)}):e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(n))},e.datepicker=new i,e.datepicker.initialized=!1,e.datepicker.uuid=(new Date).getTime(),e.datepicker.version="1.11.0",e.datepicker,e.widget("ui.dialog",{version:"1.11.0",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"Close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var n=e(this).css(t).offset().top;0>n&&e(this).css("top",t.top-n)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&e.fn.draggable&&this._makeDraggable(),this.options.resizable&&e.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var t=this.options.appendTo;return t&&(t.jquery||t.nodeType)?e(t):this.document.find(t||"body").eq(0)},_destroy:function(){var e,t=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),e=t.parent.children().eq(t.index),e.length&&e[0]!==this.element[0]?e.before(this.element):t.parent.append(this.element)},widget:function(){return this.uiDialog},disable:e.noop,enable:e.noop,close:function(t){var n,r=this;if(this._isOpen&&this._trigger("beforeClose",t)!==!1){if(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),!this.opener.filter(":focusable").focus().length)try{n=this.document[0].activeElement,n&&"body"!==n.nodeName.toLowerCase()&&e(n).blur()}catch(i){}this._hide(this.uiDialog,this.options.hide,function(){r._trigger("close",t)})}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(t,n){var r=!1,i=this.uiDialog.siblings(".ui-front:visible").map(function(){return+e(this).css("z-index")}).get(),s=Math.max.apply(null,i);return s>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",s+1),r=!0),r&&!n&&this._trigger("focus",t),r},open:function(){var t=this;return this._isOpen?(this._moveToTop()&&this._focusTabbable(),void 0):(this._isOpen=!0,this.opener=e(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this._show(this.uiDialog,this.options.show,function(){t._focusTabbable(),t._trigger("focus")}),this._trigger("open"),void 0)},_focusTabbable:function(){var e=this._focusedElement;e||(e=this.element.find("[autofocus]")),e.length||(e=this.element.find(":tabbable")),e.length||(e=this.uiDialogButtonPane.find(":tabbable")),e.length||(e=this.uiDialogTitlebarClose.filter(":tabbable")),e.length||(e=this.uiDialog),e.eq(0).focus()},_keepFocus:function(t){function n(){var t=this.document[0].activeElement,n=this.uiDialog[0]===t||e.contains(this.uiDialog[0],t);n||this._focusTabbable()}t.preventDefault(),n.call(this),this._delay(n)},_createWrapper:function(){this.uiDialog=e("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(t){if(this.options.closeOnEscape&&!t.isDefaultPrevented()&&t.keyCode&&t.keyCode===e.ui.keyCode.ESCAPE)return t.preventDefault(),this.close(t),void 0;if(t.keyCode===e.ui.keyCode.TAB&&!t.isDefaultPrevented()){var n=this.uiDialog.find(":tabbable"),r=n.filter(":first"),i=n.filter(":last");t.target!==i[0]&&t.target!==this.uiDialog[0]||t.shiftKey?t.target!==r[0]&&t.target!==this.uiDialog[0]||!t.shiftKey||(this._delay(function(){i.focus()}),t.preventDefault()):(this._delay(function(){r.focus()}),t.preventDefault())}},mousedown:function(e){this._moveToTop(e)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var t;this.uiDialogTitlebar=e("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(t){e(t.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=e("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(e){e.preventDefault(),this.close(e)}}),t=e("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(t),this.uiDialog.attr({"aria-labelledby":t.attr("id")})},_title:function(e){this.options.title||e.html("&#160;"),e.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=e("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=e("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var t=this,n=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),e.isEmptyObject(n)||e.isArray(n)&&!n.length?(this.uiDialog.removeClass("ui-dialog-buttons"),void 0):(e.each(n,function(n,r){var i,s;r=e.isFunction(r)?{click:r,text:n}:r,r=e.extend({type:"button"},r),i=r.click,r.click=function(){i.apply(t.element[0],arguments)},s={icons:r.icons,text:r.showText},delete r.icons,delete r.showText,e("<button></button>",r).button(s).appendTo(t.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog),void 0)},_makeDraggable:function(){function t(e){return{position:e.position,offset:e.offset}}var n=this,r=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(r,i){e(this).addClass("ui-dialog-dragging"),n._blockFrames(),n._trigger("dragStart",r,t(i))},drag:function(e,r){n._trigger("drag",e,t(r))},stop:function(i,s){var o=s.offset.left-n.document.scrollLeft(),u=s.offset.top-n.document.scrollTop();r.position={my:"left top",at:"left"+(o>=0?"+":"")+o+" "+"top"+(u>=0?"+":"")+u,of:n.window},e(this).removeClass("ui-dialog-dragging"),n._unblockFrames(),n._trigger("dragStop",i,t(s))}})},_makeResizable:function(){function t(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}var n=this,r=this.options,i=r.resizable,s=this.uiDialog.css("position"),o="string"==typeof i?i:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:r.maxWidth,maxHeight:r.maxHeight,minWidth:r.minWidth,minHeight:this._minHeight(),handles:o,start:function(r,i){e(this).addClass("ui-dialog-resizing"),n._blockFrames(),n._trigger("resizeStart",r,t(i))},resize:function(e,r){n._trigger("resize",e,t(r))},stop:function(i,s){var o=n.uiDialog.offset(),u=o.left-n.document.scrollLeft(),a=o.top-n.document.scrollTop();r.height=n.uiDialog.height(),r.width=n.uiDialog.width(),r.position={my:"left top",at:"left"+(u>=0?"+":"")+u+" "+"top"+(a>=0?"+":"")+a,of:n.window},e(this).removeClass("ui-dialog-resizing"),n._unblockFrames(),n._trigger("resizeStop",i,t(s))}}).css("position",s)},_trackFocus:function(){this._on(this.widget(),{focusin:function(t){this._untrackInstance(),this._trackingInstances().unshift(this),this._focusedElement=e(t.target)}})},_untrackInstance:function(){var t=this._trackingInstances(),n=e.inArray(this,t);-1!==n&&t.splice(n,1)},_trackingInstances:function(){var e=this.document.data("ui-dialog-instances");return e||(e=[],this.document.data("ui-dialog-instances",e)),e},_minHeight:function(){var e=this.options;return"auto"===e.height?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(){var e=this.uiDialog.is(":visible");e||this.uiDialog.show(),this.uiDialog.position(this.options.position),e||this.uiDialog.hide()},_setOptions:function(t){var n=this,r=!1,i={};e.each(t,function(e,t){n._setOption(e,t),e in n.sizeRelatedOptions&&(r=!0),e in n.resizableRelatedOptions&&(i[e]=t)}),r&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",i)},_setOption:function(e,t){var n,r,i=this.uiDialog;"dialogClass"===e&&i.removeClass(this.options.dialogClass).addClass(t),"disabled"!==e&&(this._super(e,t),"appendTo"===e&&this.uiDialog.appendTo(this._appendTo()),"buttons"===e&&this._createButtons(),"closeText"===e&&this.uiDialogTitlebarClose.button({label:""+t}),"draggable"===e&&(n=i.is(":data(ui-draggable)"),n&&!t&&i.draggable("destroy"),!n&&t&&this._makeDraggable()),"position"===e&&this._position(),"resizable"===e&&(r=i.is(":data(ui-resizable)"),r&&!t&&i.resizable("destroy"),r&&"string"==typeof t&&i.resizable("option","handles",t),r||t===!1||this._makeResizable()),"title"===e&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var e,t,n,r=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),r.minWidth>r.width&&(r.width=r.minWidth),e=this.uiDialog.css({height:"auto",width:r.width}).outerHeight(),t=Math.max(0,r.minHeight-e),n="number"==typeof r.maxHeight?Math.max(0,r.maxHeight-e):"none","auto"===r.height?this.element.css({minHeight:t,maxHeight:n,height:"auto"}):this.element.height(Math.max(0,r.height-e)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var t=e(this);return e("<div>").css({position:"absolute",width:t.outerWidth(),height:t.outerHeight()}).appendTo(t.parent()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(t){return e(t.target).closest(".ui-dialog").length?!0:!!e(t.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var t=!0;this._delay(function(){t=!1}),this.document.data("ui-dialog-overlays")||this._on(this.document,{focusin:function(e){t||this._allowInteraction(e)||(e.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=e("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var e=this.document.data("ui-dialog-overlays")-1;e?this.document.data("ui-dialog-overlays",e):this.document.unbind("focusin").removeData("ui-dialog-overlays"),this.overlay.remove(),this.overlay=null}}}),e.widget("ui.progressbar",{version:"1.11.0",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=e("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(e){return void 0===e?this.options.value:(this.options.value=this._constrainedValue(e),this._refreshValue(),void 0)},_constrainedValue:function(e){return void 0===e&&(e=this.options.value),this.indeterminate=e===!1,"number"!=typeof e&&(e=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,e))},_setOptions:function(e){var t=e.value;delete e.value,this._super(e),this.options.value=this._constrainedValue(t),this._refreshValue()},_setOption:function(e,t){"max"===e&&(t=Math.max(this.min,t)),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this._super(e,t)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var t=this.options.value,n=this._percentage();this.valueDiv.toggle(this.indeterminate||t>this.min).toggleClass("ui-corner-right",t===this.options.max).width(n.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=e("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":t}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==t&&(this.oldValue=t,this._trigger("change")),t===this.options.max&&this._trigger("complete")}}),e.widget("ui.selectmenu",{version:"1.11.0",defaultElement:"<select>",options:{appendTo:null,disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:null,change:null,close:null,focus:null,open:null,select:null},_create:function(){var e=this.element.uniqueId().attr("id");this.ids={element:e,button:e+"-button",menu:e+"-menu"},this._drawButton(),this._drawMenu(),this.options.disabled&&this.disable()},_drawButton:function(){var t=this,n=this.element.attr("tabindex");this.label=e("label[for='"+this.ids.element+"']").attr("for",this.ids.button),this._on(this.label,{click:function(e){this.button.focus(),e.preventDefault()}}),this.element.hide(),this.button=e("<span>",{"class":"ui-selectmenu-button ui-widget ui-state-default ui-corner-all",tabindex:n||this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true"}).insertAfter(this.element),e("<span>",{"class":"ui-icon "+this.options.icons.button}).prependTo(this.button),this.buttonText=e("<span>",{"class":"ui-selectmenu-text"}).appendTo(this.button),this._setText(this.buttonText,this.element.find("option:selected").text()),this._setOption("width",this.options.width),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){t.menuItems||t._refreshMenu()}),this._hoverable(this.button),this._focusable(this.button)},_drawMenu:function(){var t=this;this.menu=e("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=e("<div>",{"class":"ui-selectmenu-menu ui-front"}).append(this.menu).appendTo(this._appendTo()),this.menuInstance=this.menu.menu({role:"listbox",select:function(e,n){e.preventDefault(),t._select(n.item.data("ui-selectmenu-item"),e)},focus:function(e,n){var r=n.item.data("ui-selectmenu-item");null!=t.focusIndex&&r.index!==t.focusIndex&&(t._trigger("focus",e,{item:r}),t.isOpen||t._select(r,e)),t.focusIndex=r.index,t.button.attr("aria-activedescendant",t.menuItems.eq(r.index).attr("id"))}}).menu("instance"),this.menu.addClass("ui-corner-bottom").removeClass("ui-corner-all"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this._setText(this.buttonText,this._getSelectedItem().text()),this._setOption("width",this.options.width)},_refreshMenu:function(){this.menu.empty();var e,t=this.element.find("option");t.length&&(this._parseOptions(t),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup"),e=this._getSelectedItem(),this.menuInstance.focus(null,e),this._setAria(e.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(e){this.options.disabled||(this.menuItems?(this.menu.find(".ui-state-focus").removeClass("ui-state-focus"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",e))},_position:function(){this.menuWrap.position(e.extend({of:this.button},this.options.position))},close:function(e){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this._off(this.document),this._trigger("close",e))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderMenu:function(t,n){var r=this,i="";e.each(n,function(n,s){s.optgroup!==i&&(e("<li>",{"class":"ui-selectmenu-optgroup ui-menu-divider"+(s.element.parent("optgroup").prop("disabled")?" ui-state-disabled":""),text:s.optgroup}).appendTo(t),i=s.optgroup),r._renderItemData(t,s)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-selectmenu-item",t)},_renderItem:function(t,n){var r=e("<li>");return n.disabled&&r.addClass("ui-state-disabled"),this._setText(r,n.label),r.appendTo(t)},_setText:function(e,t){t?e.text(t):e.html("&#160;")},_move:function(e,t){var n,r,i=".ui-menu-item";this.isOpen?n=this.menuItems.eq(this.focusIndex):(n=this.menuItems.eq(this.element[0].selectedIndex),i+=":not(.ui-state-disabled)"),r="first"===e||"last"===e?n["first"===e?"prevAll":"nextAll"](i).eq(-1):n[e+"All"](i).eq(0),r.length&&this.menuInstance.focus(t,r)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex)},_toggle:function(e){this[this.isOpen?"close":"open"](e)},_documentClick:{mousedown:function(t){this.isOpen&&(e(t.target).closest(".ui-selectmenu-menu, #"+this.ids.button).length||this.close(t))}},_buttonEvents:{click:"_toggle",keydown:function(t){var n=!0;switch(t.keyCode){case e.ui.keyCode.TAB:case e.ui.keyCode.ESCAPE:this.close(t),n=!1;break;case e.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(t);break;case e.ui.keyCode.UP:t.altKey?this._toggle(t):this._move("prev",t);break;case e.ui.keyCode.DOWN:t.altKey?this._toggle(t):this._move("next",t);break;case e.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(t):this._toggle(t);break;case e.ui.keyCode.LEFT:this._move("prev",t);break;case e.ui.keyCode.RIGHT:this._move("next",t);break;case e.ui.keyCode.HOME:case e.ui.keyCode.PAGE_UP:this._move("first",t);break;case e.ui.keyCode.END:case e.ui.keyCode.PAGE_DOWN:this._move("last",t);break;default:this.menu.trigger(t),n=!1}n&&t.preventDefault()}},_selectFocusedItem:function(e){var t=this.menuItems.eq(this.focusIndex);t.hasClass("ui-state-disabled")||this._select(t.data("ui-selectmenu-item"),e)},_select:function(e,t){var n=this.element[0].selectedIndex;this.element[0].selectedIndex=e.index,this._setText(this.buttonText,e.label),this._setAria(e),this._trigger("select",t,{item:e}),e.index!==n&&this._trigger("change",t,{item:e}),this.close(t)},_setAria:function(e){var t=this.menuItems.eq(e.index).attr("id");this.button.attr({"aria-labelledby":t,"aria-activedescendant":t}),this.menu.attr("aria-activedescendant",t)},_setOption:function(e,t){"icons"===e&&this.button.find("span.ui-icon").removeClass(this.options.icons.button).addClass(t.button),this._super(e,t),"appendTo"===e&&this.menuWrap.appendTo(this._appendTo()),"disabled"===e&&(this.menuInstance.option("disabled",t),this.button.toggleClass("ui-state-disabled",t).attr("aria-disabled",t),this.element.prop("disabled",t),t?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)),"width"===e&&(t||(t=this.element.outerWidth()),this.button.outerWidth(t))},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t&&t[0]||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_toggleAttr:function(){this.button.toggleClass("ui-corner-top",this.isOpen).toggleClass("ui-corner-all",!this.isOpen).attr("aria-expanded",this.isOpen),this.menuWrap.toggleClass("ui-selectmenu-open",this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){return{disabled:this.element.prop("disabled")}},_parseOptions:function(t){var n=[];t.each(function(t,r){var i=e(r),s=i.parent("optgroup");n.push({element:i,index:t,value:i.attr("value"),label:i.text(),optgroup:s.attr("label")||"",disabled:s.prop("disabled")||i.prop("disabled")})}),this.items=n},_destroy:function(){this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.label.attr("for",this.ids.element)}}),e.widget("ui.slider",e.ui.mouse,{version:"1.11.0",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var t,n,r=this.options,i=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),s="<span class='ui-slider-handle ui-state-default ui-corner-all' tabindex='0'></span>",o=[];for(n=r.values&&r.values.length||1,i.length>n&&(i.slice(n).remove(),i=i.slice(0,n)),t=i.length;n>t;t++)o.push(s);this.handles=i.add(e(o.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(t){e(this).data("ui-slider-handle-index",t)})},_createRange:function(){var t=this.options,n="";t.range?(t.range===!0&&(t.values?t.values.length&&2!==t.values.length?t.values=[t.values[0],t.values[0]]:e.isArray(t.values)&&(t.values=t.values.slice(0)):t.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=e("<div></div>").appendTo(this.element),n="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(n+("min"===t.range||"max"===t.range?" ui-slider-range-"+t.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(t){var n,r,i,s,o,u,a,f,l=this,c=this.options;return c.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),n={x:t.pageX,y:t.pageY},r=this._normValueFromMouse(n),i=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var n=Math.abs(r-l.values(t));(i>n||i===n&&(t===l._lastChangedValue||l.values(t)===c.min))&&(i=n,s=e(this),o=t)}),u=this._start(t,o),u===!1?!1:(this._mouseSliding=!0,this._handleIndex=o,s.addClass("ui-state-active").focus(),a=s.offset(),f=!e(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=f?{left:0,top:0}:{left:t.pageX-a.left-s.width()/2,top:t.pageY-a.top-s.height()/2-(parseInt(s.css("borderTopWidth"),10)||0)-(parseInt(s.css("borderBottomWidth"),10)||0)+(parseInt(s.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,o,r),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},n=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,n),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,n,r,i,s;return"horizontal"===this.orientation?(t=this.elementSize.width,n=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,n=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),r=n/t,r>1&&(r=1),0>r&&(r=0),"vertical"===this.orientation&&(r=1-r),i=this._valueMax()-this._valueMin(),s=this._valueMin()+r*i,this._trimAlignValue(s)},_start:function(e,t){var n={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("start",e,n)},_slide:function(e,t,n){var r,i,s;this.options.values&&this.options.values.length?(r=this.values(t?0:1),2===this.options.values.length&&this.options.range===!0&&(0===t&&n>r||1===t&&r>n)&&(n=r),n!==this.values(t)&&(i=this.values(),i[t]=n,s=this._trigger("slide",e,{handle:this.handles[t],value:n,values:i}),r=this.values(t?0:1),s!==!1&&this.values(t,n))):n!==this.value()&&(s=this._trigger("slide",e,{handle:this.handles[t],value:n}),s!==!1&&this.value(n))},_stop:function(e,t){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("stop",e,n)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._lastChangedValue=t,this._trigger("change",e,n)}},value:function(e){return arguments.length?(this.options.value=this._trimAlignValue(e),this._refreshValue(),this._change(null,0),void 0):this._value()},values:function(t,n){var r,i,s;if(arguments.length>1)return this.options.values[t]=this._trimAlignValue(n),this._refreshValue(),this._change(null,t),void 0;if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();for(r=this.options.values,i=arguments[0],s=0;r.length>s;s+=1)r[s]=this._trimAlignValue(i[s]),this._change(null,s);this._refreshValue()},_setOption:function(t,n){var r,i=0;switch("range"===t&&this.options.range===!0&&("min"===n?(this.options.value=this._values(0),this.options.values=null):"max"===n&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),e.isArray(this.options.values)&&(i=this.options.values.length),"disabled"===t&&this.element.toggleClass("ui-state-disabled",!!n),this._super(t,n),t){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),r=0;i>r;r+=1)this._change(null,r);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e)},_values:function(e){var t,n,r;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t);if(this.options.values&&this.options.values.length){for(n=this.options.values.slice(),r=0;n.length>r;r+=1)n[r]=this._trimAlignValue(n[r]);return n}return[]},_trimAlignValue:function(e){if(this._valueMin()>=e)return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,n=(e-this._valueMin())%t,r=e-n;return 2*Math.abs(n)>=t&&(r+=n>0?t:-t),parseFloat(r.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var t,n,r,i,s,o=this.options.range,u=this.options,a=this,f=this._animateOff?!1:u.animate,l={};this.options.values&&this.options.values.length?this.handles.each(function(r){n=100*((a.values(r)-a._valueMin())/(a._valueMax()-a._valueMin())),l["horizontal"===a.orientation?"left":"bottom"]=n+"%",e(this).stop(1,1)[f?"animate":"css"](l,u.animate),a.options.range===!0&&("horizontal"===a.orientation?(0===r&&a.range.stop(1,1)[f?"animate":"css"]({left:n+"%"},u.animate),1===r&&a.range[f?"animate":"css"]({width:n-t+"%"},{queue:!1,duration:u.animate})):(0===r&&a.range.stop(1,1)[f?"animate":"css"]({bottom:n+"%"},u.animate),1===r&&a.range[f?"animate":"css"]({height:n-t+"%"},{queue:!1,duration:u.animate}))),t=n}):(r=this.value(),i=this._valueMin(),s=this._valueMax(),n=s!==i?100*((r-i)/(s-i)):0,l["horizontal"===this.orientation?"left":"bottom"]=n+"%",this.handle.stop(1,1)[f?"animate":"css"](l,u.animate),"min"===o&&"horizontal"===this.orientation&&this.range.stop(1,1)[f?"animate":"css"]({width:n+"%"},u.animate),"max"===o&&"horizontal"===this.orientation&&this.range[f?"animate":"css"]({width:100-n+"%"},{queue:!1,duration:u.animate}),"min"===o&&"vertical"===this.orientation&&this.range.stop(1,1)[f?"animate":"css"]({height:n+"%"},u.animate),"max"===o&&"vertical"===this.orientation&&this.range[f?"animate":"css"]({height:100-n+"%"},{queue:!1,duration:u.animate}))},_handleEvents:{keydown:function(t){var n,r,i,s,o=e(t.target).data("ui-slider-handle-index");switch(t.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(t.preventDefault(),!this._keySliding&&(this._keySliding=!0,e(t.target).addClass("ui-state-active"),n=this._start(t,o),n===!1))return}switch(s=this.options.step,r=i=this.options.values&&this.options.values.length?this.values(o):this.value(),t.keyCode){case e.ui.keyCode.HOME:i=this._valueMin();break;case e.ui.keyCode.END:i=this._valueMax();break;case e.ui.keyCode.PAGE_UP:i=this._trimAlignValue(r+(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.PAGE_DOWN:i=this._trimAlignValue(r-(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(r===this._valueMax())return;i=this._trimAlignValue(r+s);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(r===this._valueMin())return;i=this._trimAlignValue(r-s)}this._slide(t,o,i)},keyup:function(t){var n=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,n),this._change(t,n),e(t.target).removeClass("ui-state-active"))}}}),e.widget("ui.spinner",{version:"1.11.0",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var t={},n=this.element;return e.each(["min","max","step"],function(e,r){var i=n.attr(r);void 0!==i&&i.length&&(t[r]=i)}),t},_events:{keydown:function(e){this._start(e)&&this._keydown(e)&&e.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(e){return this.cancelBlur?(delete this.cancelBlur,void 0):(this._stop(),this._refresh(),this.previous!==this.element.val()&&this._trigger("change",e),void 0)},mousewheel:function(e,t){if(t){if(!this.spinning&&!this._start(e))return!1;this._spin((t>0?1:-1)*this.options.step,e),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(e)},100),e.preventDefault()}},"mousedown .ui-spinner-button":function(t){function n(){var e=this.element[0]===this.document[0].activeElement;e||(this.element.focus(),this.previous=r,this._delay(function(){this.previous=r}))}var r;r=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),t.preventDefault(),n.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,n.call(this)}),this._start(t)!==!1&&this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(t){return e(t.currentTarget).hasClass("ui-state-active")?this._start(t)===!1?!1:(this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t),void 0):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var e=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=e.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*e.height())&&e.height()>0&&e.height(e.height()),this.options.disabled&&this.disable()},_keydown:function(t){var n=this.options,r=e.ui.keyCode;switch(t.keyCode){case r.UP:return this._repeat(null,1,t),!0;case r.DOWN:return this._repeat(null,-1,t),!0;case r.PAGE_UP:return this._repeat(null,n.page,t),!0;case r.PAGE_DOWN:return this._repeat(null,-n.page,t),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span>"+"</a>"+"<a class='ui-spinner-button ui-spinner-down ui-corner-br'>"+"<span class='ui-icon "+this.options.icons.down+"'>&#9660;</span>"+"</a>"},_start:function(e){return this.spinning||this._trigger("start",e)!==!1?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(e,t,n){e=e||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,t,n)},e),this._spin(t*this.options.step,n)},_spin:function(e,t){var n=this.value()||0;this.counter||(this.counter=1),n=this._adjustValue(n+e*this._increment(this.counter)),this.spinning&&this._trigger("spin",t,{value:n})===!1||(this._value(n),this.counter++)},_increment:function(t){var n=this.options.incremental;return n?e.isFunction(n)?n(t):Math.floor(t*t*t/5e4-t*t/500+17*t/200+1):1},_precision:function(){var e=this._precisionOf(this.options.step);return null!==this.options.min&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=""+e,n=t.indexOf(".");return-1===n?0:t.length-n-1},_adjustValue:function(e){var t,n,r=this.options;return t=null!==r.min?r.min:0,n=e-t,n=Math.round(n/r.step)*r.step,e=t+n,e=parseFloat(e.toFixed(this._precision())),null!==r.max&&e>r.max?r.max:null!==r.min&&r.min>e?r.min:e},_stop:function(e){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",e))},_setOption:function(e,t){if("culture"===e||"numberFormat"===e){var n=this._parse(this.element.val());return this.options[e]=t,this.element.val(this._format(n)),void 0}("max"===e||"min"===e||"step"===e)&&"string"==typeof t&&(t=this._parse(t)),"icons"===e&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(t.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(t.down)),this._super(e,t),"disabled"===e&&(this.widget().toggleClass("ui-state-disabled",!!t),this.element.prop("disabled",!!t),this.buttons.button(t?"disable":"enable"))},_setOptions:u(function(e){this._super(e)}),_parse:function(e){return"string"==typeof e&&""!==e&&(e=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(e,10,this.options.culture):+e),""===e||isNaN(e)?null:e},_format:function(e){return""===e?"":window.Globalize&&this.options.numberFormat?Globalize.format(e,this.options.numberFormat,this.options.culture):e},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var e=this.value();return null===e?!1:e===this._adjustValue(e)},_value:function(e,t){var n;""!==e&&(n=this._parse(e),null!==n&&(t||(n=this._adjustValue(n)),e=this._format(n))),this.element.val(e),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:u(function(e){this._stepUp(e)}),_stepUp:function(e){this._start()&&(this._spin((e||1)*this.options.step),this._stop())},stepDown:u(function(e){this._stepDown(e)}),_stepDown:function(e){this._start()&&(this._spin((e||1)*-this.options.step),this._stop())},pageUp:u(function(e){this._stepUp((e||1)*this.options.page)}),pageDown:u(function(e){this._stepDown((e||1)*this.options.page)}),value:function(e){return arguments.length?(u(this._value).call(this,e),void 0):this._parse(this.element.val())},widget:function(){return this.uiSpinner}}),e.widget("ui.tabs",{version:"1.11.0",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:function(){var e=/#.*$/;return function(t){var n,r;t=t.cloneNode(!1),n=t.href.replace(e,""),r=location.href.replace(e,"");try{n=decodeURIComponent(n)}catch(i){}try{r=decodeURIComponent(r)}catch(i){}return t.hash.length>1&&n===r}}(),_create:function(){var t=this,n=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",n.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(t){e(this).is(".ui-state-disabled")&&t.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){e(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this._processTabs(),n.active=this._initialActive(),e.isArray(n.disabled)&&(n.disabled=e.unique(n.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"),function(e){return t.tabs.index(e)}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(n.active):e(),this._refresh(),this.active.length&&this.load(n.active)},_initialActive:function(){var t=this.options.active,n=this.options.collapsible,r=location.hash.substring(1);return null===t&&(r&&this.tabs.each(function(n,i){return e(i).attr("aria-controls")===r?(t=n,!1):void 0}),null===t&&(t=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===t||-1===t)&&(t=this.tabs.length?0:!1)),t!==!1&&(t=this.tabs.index(this.tabs.eq(t)),-1===t&&(t=n?!1:0)),!n&&t===!1&&this.anchors.length&&(t=0),t},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):e()}},_tabKeydown:function(t){var n=e(this.document[0].activeElement).closest("li"),r=this.tabs.index(n),i=!0;if(!this._handlePageNav(t)){switch(t.keyCode){case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:r++;break;case e.ui.keyCode.UP:case e.ui.keyCode.LEFT:i=!1,r--;break;case e.ui.keyCode.END:r=this.anchors.length-1;break;case e.ui.keyCode.HOME:r=0;break;case e.ui.keyCode.SPACE:return t.preventDefault(),clearTimeout(this.activating),this._activate(r),void 0;case e.ui.keyCode.ENTER:return t.preventDefault(),clearTimeout(this.activating),this._activate(r===this.options.active?!1:r),void 0;default:return}t.preventDefault(),clearTimeout(this.activating),r=this._focusNextTab(r,i),t.ctrlKey||(n.attr("aria-selected","false"),this.tabs.eq(r).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",r)},this.delay))}},_panelKeydown:function(t){this._handlePageNav(t)||t.ctrlKey&&t.keyCode===e.ui.keyCode.UP&&(t.preventDefault(),this.active.focus())},_handlePageNav:function(t){return t.altKey&&t.keyCode===e.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):t.altKey&&t.keyCode===e.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(t,n){function r(){return t>i&&(t=0),0>t&&(t=i),t}for(var i=this.tabs.length-1;-1!==e.inArray(r(),this.options.disabled);)t=n?t+1:t-1;return t},_focusNextTab:function(e,t){return e=this._findNextTab(e,t),this.tabs.eq(e).focus(),e},_setOption:function(e,t){return"active"===e?(this._activate(t),void 0):"disabled"===e?(this._setupDisabled(t),void 0):(this._super(e,t),"collapsible"===e&&(this.element.toggleClass("ui-tabs-collapsible",t),t||this.options.active!==!1||this._activate(0)),"event"===e&&this._setupEvents(t),"heightStyle"===e&&this._setupHeightStyle(t),void 0)},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var t=this.options,n=this.tablist.children(":has(a[href])");t.disabled=e.map(n.filter(".ui-state-disabled"),function(e){return n.index(e)}),this._processTabs(),t.active!==!1&&this.anchors.length?this.active.length&&!e.contains(this.tablist[0],this.active[0])?this.tabs.length===t.disabled.length?(t.active=!1,this.active=e()):this._activate(this._findNextTab(Math.max(0,t.active-1),!1)):t.active=this.tabs.index(this.active):(t.active=!1,this.active=e()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var t=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist"),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return e("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=e(),this.anchors.each(function(n,r){var i,s,o,u=e(r).uniqueId().attr("id"),a=e(r).closest("li"),f=a.attr("aria-controls");t._isLocal(r)?(i=r.hash,o=i.substring(1),s=t.element.find(t._sanitizeSelector(i))):(o=a.attr("aria-controls")||e({}).uniqueId()[0].id,i="#"+o,s=t.element.find(i),s.length||(s=t._createPanel(o),s.insertAfter(t.panels[n-1]||t.tablist)),s.attr("aria-live","polite")),s.length&&(t.panels=t.panels.add(s)),f&&a.data("ui-tabs-aria-controls",f),a.attr({"aria-controls":o,"aria-labelledby":u}),s.attr("aria-labelledby",u)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.tablist||this.element.find("ol,ul").eq(0)},_createPanel:function(t){return e("<div>").attr("id",t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(t){e.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1);for(var n,r=0;n=this.tabs[r];r++)t===!0||-1!==e.inArray(r,t)?e(n).addClass("ui-state-disabled").attr("aria-disabled","true"):e(n).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=t},_setupEvents:function(t){var n={};t&&e.each(t.split(" "),function(e,t){n[t]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(e){e.preventDefault()}}),this._on(this.anchors,n),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(t){var n,r=this.element.parent();"fill"===t?(n=r.height(),n-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var t=e(this),r=t.css("position");"absolute"!==r&&"fixed"!==r&&(n-=t.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){n-=e(this).outerHeight(!0)}),this.panels.each(function(){e(this).height(Math.max(0,n-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===t&&(n=0,this.panels.each(function(){n=Math.max(n,e(this).height("").height())}).height(n))},_eventHandler:function(t){var n=this.options,r=this.active,i=e(t.currentTarget),s=i.closest("li"),o=s[0]===r[0],u=o&&n.collapsible,a=u?e():this._getPanelForTab(s),f=r.length?this._getPanelForTab(r):e(),l={oldTab:r,oldPanel:f,newTab:u?e():s,newPanel:a};t.preventDefault(),s.hasClass("ui-state-disabled")||s.hasClass("ui-tabs-loading")||this.running||o&&!n.collapsible||this._trigger("beforeActivate",t,l)===!1||(n.active=u?!1:this.tabs.index(s),this.active=o?e():s,this.xhr&&this.xhr.abort(),f.length||a.length||e.error("jQuery UI Tabs: Mismatching fragment identifier."),a.length&&this.load(this.tabs.index(s),t),this._toggle(t,l))},_toggle:function(t,n){function r(){s.running=!1,s._trigger("activate",t,n)}function i(){n.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),o.length&&s.options.show?s._show(o,s.options.show,r):(o.show(),r())}var s=this,o=n.newPanel,u=n.oldPanel;this.running=!0,u.length&&this.options.hide?this._hide(u,this.options.hide,function(){n.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),i()}):(n.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),u.hide(),i()),u.attr("aria-hidden","true"),n.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),o.length&&u.length?n.oldTab.attr("tabIndex",-1):o.length&&this.tabs.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),o.attr("aria-hidden","false"),n.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(t){var n,r=this._findActive(t);r[0]!==this.active[0]&&(r.length||(r=this.active),n=r.find(".ui-tabs-anchor")[0],this._eventHandler({target:n,currentTarget:n,preventDefault:e.noop}))},_findActive:function(t){return t===!1?e():this.tabs.eq(t)},_getIndex:function(e){return"string"==typeof e&&(e=this.anchors.index(this.anchors.filter("[href$='"+e+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){e.data(this,"ui-tabs-destroy")?e(this).remove():e(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var t=e(this),n=t.data("ui-tabs-aria-controls");n?t.attr("aria-controls",n).removeData("ui-tabs-aria-controls"):t.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(t){var n=this.options.disabled;n!==!1&&(void 0===t?n=!1:(t=this._getIndex(t),n=e.isArray(n)?e.map(n,function(e){return e!==t?e:null}):e.map(this.tabs,function(e,n){return n!==t?n:null})),this._setupDisabled(n))},disable:function(t){var n=this.options.disabled;if(n!==!0){if(void 0===t)n=!0;else{if(t=this._getIndex(t),-1!==e.inArray(t,n))return;n=e.isArray(n)?e.merge([t],n).sort():[t]}this._setupDisabled(n)}},load:function(t,n){t=this._getIndex(t);var r=this,i=this.tabs.eq(t),s=i.find(".ui-tabs-anchor"),o=this._getPanelForTab(i),u={tab:i,panel:o};this._isLocal(s[0])||(this.xhr=e.ajax(this._ajaxSettings(s,n,u)),this.xhr&&"canceled"!==this.xhr.statusText&&(i.addClass("ui-tabs-loading"),o.attr("aria-busy","true"),this.xhr.success(function(e){setTimeout(function(){o.html(e),r._trigger("load",n,u)},1)}).complete(function(e,t){setTimeout(function(){"abort"===t&&r.panels.stop(!1,!0),i.removeClass("ui-tabs-loading"),o.removeAttr("aria-busy"),e===r.xhr&&delete r.xhr},1)})))},_ajaxSettings:function(t,n,r){var i=this;return{url:t.attr("href"),beforeSend:function(t,s){return i._trigger("beforeLoad",n,e.extend({jqXHR:t,ajaxSettings:s},r))}}},_getPanelForTab:function(t){var n=e(t).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+n))}}),e.widget("ui.tooltip",{version:"1.11.0",options:{content:function(){var t=e(this).attr("title")||"";return e("<a>").text(t).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_addDescribedBy:function(t,n){var r=(t.attr("aria-describedby")||"").split(/\s+/);r.push(n),t.data("ui-tooltip-id",n).attr("aria-describedby",e.trim(r.join(" ")))},_removeDescribedBy:function(t){var n=t.data("ui-tooltip-id"),r=(t.attr("aria-describedby")||"").split(/\s+/),i=e.inArray(n,r);-1!==i&&r.splice(i,1),t.removeData("ui-tooltip-id"),r=e.trim(r.join(" ")),r?t.attr("aria-describedby",r):t.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable(),this.liveRegion=e("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body)},_setOption:function(t,n){var r=this;return"disabled"===t?(this[n?"_disable":"_enable"](),this.options[t]=n,void 0):(this._super(t,n),"content"===t&&e.each(this.tooltips,function(e,t){r._updateContent(t)}),void 0)},_disable:function(){var t=this;e.each(this.tooltips,function(n,r){var i=e.Event("blur");i.target=i.currentTarget=r[0],t.close(i,!0)}),this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.is("[title]")&&t.data("ui-tooltip-title",t.attr("title")).removeAttr("title")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.data("ui-tooltip-title")&&t.attr("title",t.data("ui-tooltip-title"))})},open:function(t){var n=this,r=e(t?t.target:this.element).closest(this.options.items);r.length&&!r.data("ui-tooltip-id")&&(r.attr("title")&&r.data("ui-tooltip-title",r.attr("title")),r.data("ui-tooltip-open",!0),t&&"mouseover"===t.type&&r.parents().each(function(){var t,r=e(this);r.data("ui-tooltip-open")&&(t=e.Event("blur"),t.target=t.currentTarget=this,n.close(t,!0)),r.attr("title")&&(r.uniqueId(),n.parents[this.id]={element:this,title:r.attr("title")},r.attr("title",""))}),this._updateContent(r,t))},_updateContent:function(e,t){var n,r=this.options.content,i=this,s=t?t.type:null;return"string"==typeof r?this._open(t,e,r):(n=r.call(e[0],function(n){e.data("ui-tooltip-open")&&i._delay(function(){t&&(t.type=s),this._open(t,e,n)})}),n&&this._open(t,e,n),void 0)},_open:function(t,n,r){function i(e){f.of=e,s.is(":hidden")||s.position(f)}var s,o,u,a,f=e.extend({},this.options.position);if(r){if(s=this._find(n),s.length)return s.find(".ui-tooltip-content").html(r),void 0;n.is("[title]")&&(t&&"mouseover"===t.type?n.attr("title",""):n.removeAttr("title")),s=this._tooltip(n),this._addDescribedBy(n,s.attr("id")),s.find(".ui-tooltip-content").html(r),this.liveRegion.children().hide(),r.clone?(a=r.clone(),a.removeAttr("id").find("[id]").removeAttr("id")):a=r,e("<div>").html(a).appendTo(this.liveRegion),this.options.track&&t&&/^mouse/.test(t.type)?(this._on(this.document,{mousemove:i}),i(t)):s.position(e.extend({of:n},this.options.position)),s.hide(),this._show(s,this.options.show),this.options.show&&this.options.show.delay&&(u=this.delayedShow=setInterval(function(){s.is(":visible")&&(i(f.of),clearInterval(u))},e.fx.interval)),this._trigger("open",t,{tooltip:s}),o={keyup:function(t){if(t.keyCode===e.ui.keyCode.ESCAPE){var r=e.Event(t);r.currentTarget=n[0],this.close(r,!0)}}},n[0]!==this.element[0]&&(o.remove=function(){this._removeTooltip(s)}),t&&"mouseover"!==t.type||(o.mouseleave="close"),t&&"focusin"!==t.type||(o.focusout="close"),this._on(!0,n,o)}},close:function(t){var n=this,r=e(t?t.currentTarget:this.element),i=this._find(r);this.closing||(clearInterval(this.delayedShow),r.data("ui-tooltip-title")&&!r.attr("title")&&r.attr("title",r.data("ui-tooltip-title")),this._removeDescribedBy(r),i.stop(!0),this._hide(i,this.options.hide,function(){n._removeTooltip(e(this))}),r.removeData("ui-tooltip-open"),this._off(r,"mouseleave focusout keyup"),r[0]!==this.element[0]&&this._off(r,"remove"),this._off(this.document,"mousemove"),t&&"mouseleave"===t.type&&e.each(this.parents,function(t,r){e(r.element).attr("title",r.title),delete n.parents[t]}),this.closing=!0,this._trigger("close",t,{tooltip:i}),this.closing=!1)},_tooltip:function(t){var n=e("<div>").attr("role","tooltip").addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||"")),r=n.uniqueId().attr("id");return e("<div>").addClass("ui-tooltip-content").appendTo(n),n.appendTo(this.document[0].body),this.tooltips[r]=t,n},_find:function(t){var n=t.data("ui-tooltip-id");return n?e("#"+n):e()},_removeTooltip:function(e){e.remove(),delete this.tooltips[e.attr("id")]},_destroy:function(){var t=this;e.each(this.tooltips,function(n,r){var i=e.Event("blur");i.target=i.currentTarget=r[0],t.close(i,!0),e("#"+n).remove(),r.data("ui-tooltip-title")&&(r.attr("title")||r.attr("title",r.data("ui-tooltip-title")),r.removeData("ui-tooltip-title"))}),this.liveRegion.remove()}});var g="ui-effects-";e.effects={effect:{}},function(e,t){function n(e,t,n){var r=c[t.type]||{};return null==e?n||!t.def?null:t.def:(e=r.floor?~~e:parseFloat(e),isNaN(e)?t.def:r.mod?(e+r.mod)%r.mod:0>e?0:e>r.max?r.max:e)}function r(n){var r=f(),i=r._rgba=[];return n=n.toLowerCase(),d(a,function(e,s){var o,u=s.re.exec(n),a=u&&s.parse(u),f=s.space||"rgba";return a?(o=r[f](a),r[l[f].cache]=o[l[f].cache],i=r._rgba=o._rgba,!1):t}),i.length?("0,0,0,0"===i.join()&&e.extend(i,s.transparent),r):s[n]}function i(e,t,n){return n=(n+1)%1,1>6*n?e+6*(t-e)*n:1>2*n?t:2>3*n?e+6*(t-e)*(2/3-n):e}var s,o="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",u=/^([\-+])=\s*(\d+\.?\d*)/,a=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],f=e.Color=function(t,n,r,i){return new e.Color.fn.parse(t,n,r,i)},l={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},c={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},h=f.support={},p=e("<p>")[0],d=e.each;p.style.cssText="background-color:rgba(1,1,1,.5)",h.rgba=p.style.backgroundColor.indexOf("rgba")>-1,d(l,function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}}),f.fn=e.extend(f.prototype,{parse:function(i,o,u,a){if(i===t)return this._rgba=[null,null,null,null],this;(i.jquery||i.nodeType)&&(i=e(i).css(o),o=t);var c=this,h=e.type(i),p=this._rgba=[];return o!==t&&(i=[i,o,u,a],h="array"),"string"===h?this.parse(r(i)||s._default):"array"===h?(d(l.rgba.props,function(e,t){p[t.idx]=n(i[t.idx],t)}),this):"object"===h?(i instanceof f?d(l,function(e,t){i[t.cache]&&(c[t.cache]=i[t.cache].slice())}):d(l,function(t,r){var s=r.cache;d(r.props,function(e,t){if(!c[s]&&r.to){if("alpha"===e||null==i[e])return;c[s]=r.to(c._rgba)}c[s][t.idx]=n(i[e],t,!0)}),c[s]&&0>e.inArray(null,c[s].slice(0,3))&&(c[s][3]=1,r.from&&(c._rgba=r.from(c[s])))}),this):t},is:function(e){var n=f(e),r=!0,i=this;return d(l,function(e,s){var o,u=n[s.cache];return u&&(o=i[s.cache]||s.to&&s.to(i._rgba)||[],d(s.props,function(e,n){return null!=u[n.idx]?r=u[n.idx]===o[n.idx]:t})),r}),r},_space:function(){var e=[],t=this;return d(l,function(n,r){t[r.cache]&&e.push(n)}),e.pop()},transition:function(e,t){var r=f(e),i=r._space(),s=l[i],o=0===this.alpha()?f("transparent"):this,u=o[s.cache]||s.to(o._rgba),a=u.slice();return r=r[s.cache],d(s.props,function(e,i){var s=i.idx,o=u[s],f=r[s],l=c[i.type]||{};null!==f&&(null===o?a[s]=f:(l.mod&&(f-o>l.mod/2?o+=l.mod:o-f>l.mod/2&&(o-=l.mod)),a[s]=n((f-o)*t+o,i)))}),this[i](a)},blend:function(t){if(1===this._rgba[3])return this;var n=this._rgba.slice(),r=n.pop(),i=f(t)._rgba;return f(e.map(n,function(e,t){return(1-r)*i[t]+r*e}))},toRgbaString:function(){var t="rgba(",n=e.map(this._rgba,function(e,t){return null==e?t>2?1:0:e});return 1===n[3]&&(n.pop(),t="rgb("),t+n.join()+")"},toHslaString:function(){var t="hsla(",n=e.map(this.hsla(),function(e,t){return null==e&&(e=t>2?1:0),t&&3>t&&(e=Math.round(100*e)+"%"),e});return 1===n[3]&&(n.pop(),t="hsl("),t+n.join()+")"},toHexString:function(t){var n=this._rgba.slice(),r=n.pop();return t&&n.push(~~(255*r)),"#"+e.map(n,function(e){return e=(e||0).toString(16),1===e.length?"0"+e:e}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),f.fn.parse.prototype=f.fn,l.hsla.to=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t,n,r=e[0]/255,i=e[1]/255,s=e[2]/255,o=e[3],u=Math.max(r,i,s),a=Math.min(r,i,s),f=u-a,l=u+a,c=.5*l;return t=a===u?0:r===u?60*(i-s)/f+360:i===u?60*(s-r)/f+120:60*(r-i)/f+240,n=0===f?0:.5>=c?f/l:f/(2-l),[Math.round(t)%360,n,c,null==o?1:o]},l.hsla.from=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t=e[0]/360,n=e[1],r=e[2],s=e[3],o=.5>=r?r*(1+n):r+n-r*n,u=2*r-o;return[Math.round(255*i(u,o,t+1/3)),Math.round(255*i(u,o,t)),Math.round(255*i(u,o,t-1/3)),s]},d(l,function(r,i){var s=i.props,o=i.cache,a=i.to,l=i.from;f.fn[r]=function(r){if(a&&!this[o]&&(this[o]=a(this._rgba)),r===t)return this[o].slice();var i,u=e.type(r),c="array"===u||"object"===u?r:arguments,h=this[o].slice();return d(s,function(e,t){var r=c["object"===u?e:t.idx];null==r&&(r=h[t.idx]),h[t.idx]=n(r,t)}),l?(i=f(l(h)),i[o]=h,i):f(h)},d(s,function(t,n){f.fn[t]||(f.fn[t]=function(i){var s,o=e.type(i),a="alpha"===t?this._hsla?"hsla":"rgba":r,f=this[a](),l=f[n.idx];return"undefined"===o?l:("function"===o&&(i=i.call(this,l),o=e.type(i)),null==i&&n.empty?this:("string"===o&&(s=u.exec(i),s&&(i=l+parseFloat(s[2])*("+"===s[1]?1:-1))),f[n.idx]=i,this[a](f)))})})}),f.hook=function(t){var n=t.split(" ");d(n,function(t,n){e.cssHooks[n]={set:function(t,i){var s,o,u="";if("transparent"!==i&&("string"!==e.type(i)||(s=r(i)))){if(i=f(s||i),!h.rgba&&1!==i._rgba[3]){for(o="backgroundColor"===n?t.parentNode:t;(""===u||"transparent"===u)&&o&&o.style;)try{u=e.css(o,"backgroundColor"),o=o.parentNode}catch(a){}i=i.blend(u&&"transparent"!==u?u:"_default")}i=i.toRgbaString()}try{t.style[n]=i}catch(a){}}},e.fx.step[n]=function(t){t.colorInit||(t.start=f(t.elem,n),t.end=f(t.end),t.colorInit=!0),e.cssHooks[n].set(t.elem,t.start.transition(t.end,t.pos))}})},f.hook(o),e.cssHooks.borderColor={expand:function(e){var t={};return d(["Top","Right","Bottom","Left"],function(n,r){t["border"+r+"Color"]=e}),t}},s=e.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function t(t){var n,r,i=t.ownerDocument.defaultView?t.ownerDocument.defaultView.getComputedStyle(t,null):t.currentStyle,s={};if(i&&i.length&&i[0]&&i[i[0]])for(r=i.length;r--;)n=i[r],"string"==typeof i[n]&&(s[e.camelCase(n)]=i[n]);else for(n in i)"string"==typeof i[n]&&(s[n]=i[n]);return s}function n(t,n){var r,s,o={};for(r in n)s=n[r],t[r]!==s&&(i[r]||(e.fx.step[r]||!isNaN(parseFloat(s)))&&(o[r]=s));return o}var r=["add","remove","toggle"],i={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};e.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(t,n){e.fx.step[n]=function(e){("none"!==e.end&&!e.setAttr||1===e.pos&&!e.setAttr)&&(jQuery.style(e.elem,n,e.end),e.setAttr=!0)}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e.effects.animateClass=function(i,s,o,u){var a=e.speed(s,o,u);return this.queue(function(){var s,o=e(this),u=o.attr("class")||"",f=a.children?o.find("*").addBack():o;f=f.map(function(){var n=e(this);return{el:n,start:t(this)}}),s=function(){e.each(r,function(e,t){i[t]&&o[t+"Class"](i[t])})},s(),f=f.map(function(){return this.end=t(this.el[0]),this.diff=n(this.start,this.end),this}),o.attr("class",u),f=f.map(function(){var t=this,n=e.Deferred(),r=e.extend({},a,{queue:!1,complete:function(){n.resolve(t)}});return this.el.animate(this.diff,r),n.promise()}),e.when.apply(e,f.get()).done(function(){s(),e.each(arguments,function(){var t=this.el;e.each(this.diff,function(e){t.css(e,"")})}),a.complete.call(o[0])})})},e.fn.extend({addClass:function(t){return function(n,r,i,s){return r?e.effects.animateClass.call(this,{add:n},r,i,s):t.apply(this,arguments)}}(e.fn.addClass),removeClass:function(t){return function(n,r,i,s){return arguments.length>1?e.effects.animateClass.call(this,{remove:n},r,i,s):t.apply(this,arguments)}}(e.fn.removeClass),toggleClass:function(t){return function(n,r,i,s,o){return"boolean"==typeof r||void 0===r?i?e.effects.animateClass.call(this,r?{add:n}:{remove:n},i,s,o):t.apply(this,arguments):e.effects.animateClass.call(this,{toggle:n},r,i,s)}}(e.fn.toggleClass),switchClass:function(t,n,r,i,s){return e.effects.animateClass.call(this,{add:n,remove:t},r,i,s)}})}(),function(){function t(t,n,r,i){return e.isPlainObject(t)&&(n=t,t=t.effect),t={effect:t},null==n&&(n={}),e.isFunction(n)&&(i=n,r=null,n={}),("number"==typeof n||e.fx.speeds[n])&&(i=r,r=n,n={}),e.isFunction(r)&&(i=r,r=null),n&&e.extend(t,n),r=r||n.duration,t.duration=e.fx.off?0:"number"==typeof r?r:r in e.fx.speeds?e.fx.speeds[r]:e.fx.speeds._default,t.complete=i||n.complete,t}function n(t){return!t||"number"==typeof t||e.fx.speeds[t]?!0:"string"!=typeof t||e.effects.effect[t]?e.isFunction(t)?!0:"object"!=typeof t||t.effect?!1:!0:!0}e.extend(e.effects,{version:"1.11.0",save:function(e,t){for(var n=0;t.length>n;n++)null!==t[n]&&e.data(g+t[n],e[0].style[t[n]])},restore:function(e,t){var n,r;for(r=0;t.length>r;r++)null!==t[r]&&(n=e.data(g+t[r]),void 0===n&&(n=""),e.css(t[r],n))},setMode:function(e,t){return"toggle"===t&&(t=e.is(":hidden")?"show":"hide"),t},getBaseline:function(e,t){var n,r;switch(e[0]){case"top":n=0;break;case"middle":n=.5;break;case"bottom":n=1;break;default:n=e[0]/t.height}switch(e[1]){case"left":r=0;break;case"center":r=.5;break;case"right":r=1;break;default:r=e[1]/t.width}return{x:r,y:n}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var n={width:t.outerWidth(!0),height:t.outerHeight(!0),"float":t.css("float")},r=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),i={width:t.width(),height:t.height()},s=document.activeElement;try{s.id}catch(o){s=document.body}return t.wrap(r),(t[0]===s||e.contains(t[0],s))&&e(s).focus(),r=t.parent(),"static"===t.css("position")?(r.css({position:"relative"}),t.css({position:"relative"})):(e.extend(n,{position:t.css("position"),zIndex:t.css("z-index")}),e.each(["top","left","bottom","right"],function(e,r){n[r]=t.css(r),isNaN(parseInt(n[r],10))&&(n[r]="auto")}),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),t.css(i),r.css(n).show()},removeWrapper:function(t){var n=document.activeElement;return t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),(t[0]===n||e.contains(t[0],n))&&e(n).focus()),t},setTransition:function(t,n,r,i){return i=i||{},e.each(n,function(e,n){var s=t.cssUnit(n);s[0]>0&&(i[n]=s[0]*r+s[1])}),i}}),e.fn.extend({effect:function(){function n(t){function n(){e.isFunction(s)&&s.call(i[0]),e.isFunction(t)&&t()}var i=e(this),s=r.complete,u=r.mode;(i.is(":hidden")?"hide"===u:"show"===u)?(i[u](),n()):o.call(i[0],r,n)}var r=t.apply(this,arguments),i=r.mode,s=r.queue,o=e.effects.effect[r.effect];return e.fx.off||!o?i?this[i](r.duration,r.complete):this.each(function(){r.complete&&r.complete.call(this)}):s===!1?this.each(n):this.queue(s||"fx",n)},show:function(e){return function(r){if(n(r))return e.apply(this,arguments);var i=t.apply(this,arguments);return i.mode="show",this.effect.call(this,i)}}(e.fn.show),hide:function(e){return function(r){if(n(r))return e.apply(this,arguments);var i=t.apply(this,arguments);return i.mode="hide",this.effect.call(this,i)}}(e.fn.hide),toggle:function(e){return function(r){if(n(r)||"boolean"==typeof r)return e.apply(this,arguments);var i=t.apply(this,arguments);return i.mode="toggle",this.effect.call(this,i)}}(e.fn.toggle),cssUnit:function(t){var n=this.css(t),r=[];return e.each(["em","px","%","pt"],function(e,t){n.indexOf(t)>0&&(r=[parseFloat(n),t])}),r}})}(),function(){var t={};e.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,n){t[n]=function(t){return Math.pow(t,e+2)}}),e.extend(t,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return 0===e||1===e?e:-Math.pow(2,8*(e-1))*Math.sin((80*(e-1)-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){for(var t,n=4;((t=Math.pow(2,--n))-1)/11>e;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((3*t-2)/22-e,2)}}),e.each(t,function(t,n){e.easing["easeIn"+t]=n,e.easing["easeOut"+t]=function(e){return 1-n(1-e)},e.easing["easeInOut"+t]=function(e){return.5>e?n(2*e)/2:1-n(-2*e+2)/2}})}(),e.effects,e.effects.effect.blind=function(t,n){var r,i,s,o=e(this),u=/up|down|vertical/,a=/up|left|vertical|horizontal/,f=["position","top","bottom","left","right","height","width"],l=e.effects.setMode(o,t.mode||"hide"),c=t.direction||"up",h=u.test(c),p=h?"height":"width",d=h?"top":"left",v=a.test(c),m={},g="show"===l;o.parent().is(".ui-effects-wrapper")?e.effects.save(o.parent(),f):e.effects.save(o,f),o.show(),r=e.effects.createWrapper(o).css({overflow:"hidden"}),i=r[p](),s=parseFloat(r.css(d))||0,m[p]=g?i:0,v||(o.css(h?"bottom":"right",0).css(h?"top":"left","auto").css({position:"absolute"}),m[d]=g?s:i+s),g&&(r.css(p,0),v||r.css(d,s+i)),r.animate(m,{duration:t.duration,easing:t.easing,queue:!1,complete:function(){"hide"===l&&o.hide(),e.effects.restore(o,f),e.effects.removeWrapper(o),n()}})},e.effects.effect.bounce=function(t,n){var r,i,s,o=e(this),u=["position","top","bottom","left","right","height","width"],a=e.effects.setMode(o,t.mode||"effect"),f="hide"===a,l="show"===a,c=t.direction||"up",h=t.distance,p=t.times||5,d=2*p+(l||f?1:0),v=t.duration/d,m=t.easing,g="up"===c||"down"===c?"top":"left",y="up"===c||"left"===c,b=o.queue(),w=b.length;for((l||f)&&u.push("opacity"),e.effects.save(o,u),o.show(),e.effects.createWrapper(o),h||(h=o["top"===g?"outerHeight":"outerWidth"]()/3),l&&(s={opacity:1},s[g]=0,o.css("opacity",0).css(g,y?2*-h:2*h).animate(s,v,m)),f&&(h/=Math.pow(2,p-1)),s={},s[g]=0,r=0;p>r;r++)i={},i[g]=(y?"-=":"+=")+h,o.animate(i,v,m).animate(s,v,m),h=f?2*h:h/2;f&&(i={opacity:0},i[g]=(y?"-=":"+=")+h,o.animate(i,v,m)),o.queue(function(){f&&o.hide(),e.effects.restore(o,u),e.effects.removeWrapper(o),n()}),w>1&&b.splice.apply(b,[1,0].concat(b.splice(w,d+1))),o.dequeue()},e.effects.effect.clip=function(t,n){var r,i,s,o=e(this),u=["position","top","bottom","left","right","height","width"],a=e.effects.setMode(o,t.mode||"hide"),f="show"===a,l=t.direction||"vertical",c="vertical"===l,h=c?"height":"width",p=c?"top":"left",d={};e.effects.save(o,u),o.show(),r=e.effects.createWrapper(o).css({overflow:"hidden"}),i="IMG"===o[0].tagName?r:o,s=i[h](),f&&(i.css(h,0),i.css(p,s/2)),d[h]=f?s:0,d[p]=f?0:s/2,i.animate(d,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){f||o.hide(),e.effects.restore(o,u),e.effects.removeWrapper(o),n()}})},e.effects.effect.drop=function(t,n){var r,i=e(this),s=["position","top","bottom","left","right","opacity","height","width"],o=e.effects.setMode(i,t.mode||"hide"),u="show"===o,a=t.direction||"left",f="up"===a||"down"===a?"top":"left",l="up"===a||"left"===a?"pos":"neg",c={opacity:u?1:0};e.effects.save(i,s),i.show(),e.effects.createWrapper(i),r=t.distance||i["top"===f?"outerHeight":"outerWidth"](!0)/2,u&&i.css("opacity",0).css(f,"pos"===l?-r:r),c[f]=(u?"pos"===l?"+=":"-=":"pos"===l?"-=":"+=")+r,i.animate(c,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===o&&i.hide(),e.effects.restore(i,s),e.effects.removeWrapper(i),n()}})},e.effects.effect.explode=function(t,n){function r(){b.push(this),b.length===c*h&&i()}function i(){p.css({visibility:"visible"}),e(b).remove(),v||p.hide(),n()}var s,o,u,a,f,l,c=t.pieces?Math.round(Math.sqrt(t.pieces)):3,h=c,p=e(this),d=e.effects.setMode(p,t.mode||"hide"),v="show"===d,m=p.show().css("visibility","hidden").offset(),g=Math.ceil(p.outerWidth()/h),y=Math.ceil(p.outerHeight()/c),b=[];for(s=0;c>s;s++)for(a=m.top+s*y,l=s-(c-1)/2,o=0;h>o;o++)u=m.left+o*g,f=o-(h-1)/2,p.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-o*g,top:-s*y}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:g,height:y,left:u+(v?f*g:0),top:a+(v?l*y:0),opacity:v?0:1}).animate({left:u+(v?0:f*g),top:a+(v?0:l*y),opacity:v?1:0},t.duration||500,t.easing,r)},e.effects.effect.fade=function(t,n){var r=e(this),i=e.effects.setMode(r,t.mode||"toggle");r.animate({opacity:i},{queue:!1,duration:t.duration,easing:t.easing,complete:n})},e.effects.effect.fold=function(t,n){var r,i,s=e(this),o=["position","top","bottom","left","right","height","width"],u=e.effects.setMode(s,t.mode||"hide"),a="show"===u,f="hide"===u,l=t.size||15,c=/([0-9]+)%/.exec(l),h=!!t.horizFirst,p=a!==h,d=p?["width","height"]:["height","width"],v=t.duration/2,m={},g={};e.effects.save(s,o),s.show(),r=e.effects.createWrapper(s).css({overflow:"hidden"}),i=p?[r.width(),r.height()]:[r.height(),r.width()],c&&(l=parseInt(c[1],10)/100*i[f?0:1]),a&&r.css(h?{height:0,width:l}:{height:l,width:0}),m[d[0]]=a?i[0]:l,g[d[1]]=a?i[1]:0,r.animate(m,v,t.easing).animate(g,v,t.easing,function(){f&&s.hide(),e.effects.restore(s,o),e.effects.removeWrapper(s),n()})},e.effects.effect.highlight=function(t,n){var r=e(this),i=["backgroundImage","backgroundColor","opacity"],s=e.effects.setMode(r,t.mode||"show"),o={backgroundColor:r.css("backgroundColor")};"hide"===s&&(o.opacity=0),e.effects.save(r,i),r.show().css({backgroundImage:"none",backgroundColor:t.color||"#ffff99"}).animate(o,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===s&&r.hide(),e.effects.restore(r,i),n()}})},e.effects.effect.size=function(t,n){var r,i,s,o=e(this),u=["position","top","bottom","left","right","width","height","overflow","opacity"],a=["position","top","bottom","left","right","overflow","opacity"],f=["width","height","overflow"],l=["fontSize"],c=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],h=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],p=e.effects.setMode(o,t.mode||"effect"),d=t.restore||"effect"!==p,v=t.scale||"both",m=t.origin||["middle","center"],g=o.css("position"),y=d?u:a,b={height:0,width:0,outerHeight:0,outerWidth:0};"show"===p&&o.show(),r={height:o.height(),width:o.width(),outerHeight:o.outerHeight(),outerWidth:o.outerWidth()},"toggle"===t.mode&&"show"===p?(o.from=t.to||b,o.to=t.from||r):(o.from=t.from||("show"===p?b:r),o.to=t.to||("hide"===p?b:r)),s={from:{y:o.from.height/r.height,x:o.from.width/r.width},to:{y:o.to.height/r.height,x:o.to.width/r.width}},("box"===v||"both"===v)&&(s.from.y!==s.to.y&&(y=y.concat(c),o.from=e.effects.setTransition(o,c,s.from.y,o.from),o.to=e.effects.setTransition(o,c,s.to.y,o.to)),s.from.x!==s.to.x&&(y=y.concat(h),o.from=e.effects.setTransition(o,h,s.from.x,o.from),o.to=e.effects.setTransition(o,h,s.to.x,o.to))),("content"===v||"both"===v)&&s.from.y!==s.to.y&&(y=y.concat(l).concat(f),o.from=e.effects.setTransition(o,l,s.from.y,o.from),o.to=e.effects.setTransition(o,l,s.to.y,o.to)),e.effects.save(o,y),o.show(),e.effects.createWrapper(o),o.css("overflow","hidden").css(o.from),m&&(i=e.effects.getBaseline(m,r),o.from.top=(r.outerHeight-o.outerHeight())*i.y,o.from.left=(r.outerWidth-o.outerWidth())*i.x,o.to.top=(r.outerHeight-o.to.outerHeight)*i.y,o.to.left=(r.outerWidth-o.to.outerWidth)*i.x),o.css(o.from),("content"===v||"both"===v)&&(c=c.concat(["marginTop","marginBottom"]).concat(l),h=h.concat(["marginLeft","marginRight"]),f=u.concat(c).concat(h),o.find("*[width]").each(function(){var n=e(this),r={height:n.height(),width:n.width(),outerHeight:n.outerHeight(),outerWidth:n.outerWidth()};d&&e.effects.save(n,f),n.from={height:r.height*s.from.y,width:r.width*s.from.x,outerHeight:r.outerHeight*s.from.y,outerWidth:r.outerWidth*s.from.x},n.to={height:r.height*s.to.y,width:r.width*s.to.x,outerHeight:r.height*s.to.y,outerWidth:r.width*s.to.x},s.from.y!==s.to.y&&(n.from=e.effects.setTransition(n,c,s.from.y,n.from),n.to=e.effects.setTransition(n,c,s.to.y,n.to)),s.from.x!==s.to.x&&(n.from=e.effects.setTransition(n,h,s.from.x,n.from),n.to=e.effects.setTransition(n,h,s.to.x,n.to)),n.css(n.from),n.animate(n.to,t.duration,t.easing,function(){d&&e.effects.restore(n,f)})})),o.animate(o.to,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){0===o.to.opacity&&o.css("opacity",o.from.opacity),"hide"===p&&o.hide(),e.effects.restore(o,y),d||("static"===g?o.css({position:"relative",top:o.to.top,left:o.to.left}):e.each(["top","left"],function(e,t){o.css(t,function(t,n){var r=parseInt(n,10),i=e?o.to.left:o.to.top;return"auto"===n?i+"px":r+i+"px"})})),e.effects.removeWrapper(o),n()}})},e.effects.effect.scale=function(t,n){var r=e(this),i=e.extend(!0,{},t),s=e.effects.setMode(r,t.mode||"effect"),o=parseInt(t.percent,10)||(0===parseInt(t.percent,10)?0:"hide"===s?0:100),u=t.direction||"both",a=t.origin,f={height:r.height(),width:r.width(),outerHeight:r.outerHeight(),outerWidth:r.outerWidth()},l={y:"horizontal"!==u?o/100:1,x:"vertical"!==u?o/100:1};i.effect="size",i.queue=!1,i.complete=n,"effect"!==s&&(i.origin=a||["middle","center"],i.restore=!0),i.from=t.from||("show"===s?{height:0,width:0,outerHeight:0,outerWidth:0}:f),i.to={height:f.height*l.y,width:f.width*l.x,outerHeight:f.outerHeight*l.y,outerWidth:f.outerWidth*l.x},i.fade&&("show"===s&&(i.from.opacity=0,i.to.opacity=1),"hide"===s&&(i.from.opacity=1,i.to.opacity=0)),r.effect(i)},e.effects.effect.puff=function(t,n){var r=e(this),i=e.effects.setMode(r,t.mode||"hide"),s="hide"===i,o=parseInt(t.percent,10)||150,u=o/100,a={height:r.height(),width:r.width(),outerHeight:r.outerHeight(),outerWidth:r.outerWidth()};e.extend(t,{effect:"scale",queue:!1,fade:!0,mode:i,complete:n,percent:s?o:100,from:s?a:{height:a.height*u,width:a.width*u,outerHeight:a.outerHeight*u,outerWidth:a.outerWidth*u}}),r.effect(t)},e.effects.effect.pulsate=function(t,n){var r,i=e(this),s=e.effects.setMode(i,t.mode||"show"),o="show"===s,u="hide"===s,a=o||"hide"===s,f=2*(t.times||5)+(a?1:0),l=t.duration/f,c=0,h=i.queue(),p=h.length;for((o||!i.is(":visible"))&&(i.css("opacity",0).show(),c=1),r=1;f>r;r++)i.animate({opacity:c},l,t.easing),c=1-c;i.animate({opacity:c},l,t.easing),i.queue(function(){u&&i.hide(),n()}),p>1&&h.splice.apply(h,[1,0].concat(h.splice(p,f+1))),i.dequeue()},e.effects.effect.shake=function(t,n){var r,i=e(this),s=["position","top","bottom","left","right","height","width"],o=e.effects.setMode(i,t.mode||"effect"),u=t.direction||"left",a=t.distance||20,f=t.times||3,l=2*f+1,c=Math.round(t.duration/l),h="up"===u||"down"===u?"top":"left",p="up"===u||"left"===u,d={},v={},m={},g=i.queue(),y=g.length;for(e.effects.save(i,s),i.show(),e.effects.createWrapper(i),d[h]=(p?"-=":"+=")+a,v[h]=(p?"+=":"-=")+2*a,m[h]=(p?"-=":"+=")+2*a,i.animate(d,c,t.easing),r=1;f>r;r++)i.animate(v,c,t.easing).animate(m,c,t.easing);i.animate(v,c,t.easing).animate(d,c/2,t.easing).queue(function(){"hide"===o&&i.hide(),e.effects.restore(i,s),e.effects.removeWrapper(i),n()}),y>1&&g.splice.apply(g,[1,0].concat(g.splice(y,l+1))),i.dequeue()},e.effects.effect.slide=function(t,n){var r,i=e(this),s=["position","top","bottom","left","right","width","height"],o=e.effects.setMode(i,t.mode||"show"),u="show"===o,a=t.direction||"left",f="up"===a||"down"===a?"top":"left",l="up"===a||"left"===a,c={};e.effects.save(i,s),i.show(),r=t.distance||i["top"===f?"outerHeight":"outerWidth"](!0),e.effects.createWrapper(i).css({overflow:"hidden"}),u&&i.css(f,l?isNaN(r)?"-"+r:-r:r),c[f]=(u?l?"+=":"-=":l?"-=":"+=")+r,i.animate(c,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===o&&i.hide(),e.effects.restore(i,s),e.effects.removeWrapper(i),n()}})},e.effects.effect.transfer=function(t,n){var r=e(this),i=e(t.to),s="fixed"===i.css("position"),o=e("body"),u=s?o.scrollTop():0,a=s?o.scrollLeft():0,f=i.offset(),l={top:f.top-u,left:f.left-a,height:i.innerHeight(),width:i.innerWidth()},c=r.offset(),h=e("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(t.className).css({top:c.top-u,left:c.left-a,height:r.innerHeight(),width:r.innerWidth(),position:s?"fixed":"absolute"}).animate(l,t.duration,t.easing,function(){h.remove(),n()})}}),define("Samp",["jquery","underscore-min","gw/CoordinateSystem","gw/FeatureStyle","gw/VectorLayer","./Utils","./JsonProcessor","samp","jquery.ui"],function(e,t,n,r,i,s,o){function w(){var t='<div id="sampContent"><button id="registerSamp">Register</button>					<button id="unregisterSamp" disabled>Unregister</button>					<button id="sendVOTable">Send VO table</button>					<span><strong>Registered: </strong><span id="sampResult">No</span></span>					<br/>					<div style="display: none;" id="sampStatus"></div>					</div>',n=e(t).appendTo("body").dialog({title:"Samp",autoOpen:!1,show:{effect:"fade",duration:300},hide:{effect:"fade",duration:300},open:function(){e(this).find("button:first-child").blur()},resizable:!1,width:"auto",minHeight:"auto",close:function(t,n){e(this).dialog("close")}});n.find("#registerSamp").button().click(function(){v.register()}).end().find("#unregisterSamp").button().click(function(){v.unregister(),e("#registerSamp").removeAttr("disabled").button("refresh"),e(this).attr("disabled","disabled").button("refresh"),e("#sampInvoker").css("background-image","url(css/images/samp_off.png)")}).end().find("#sendVOTable").button().click(function(){var e=b+"/sia/search?order=3&healpix=293&coordSystem=EQUATORIAL&media=votable",t=new samp.Message("table.load.votable",{url:e});v.connection.notifyAll([t])}),e("#sampInvoker").on("click",function(){n.dialog("open")}).hover(function(){e(this).animate({left:"-10px"},100)},function(){e(this).animate({left:"-20px"},100)})}function E(){var t=new samp.ClientTracker,r=t.callHandler;return r["samp.app.ping"]=function(e,n,r){if(r)return{text:"ping to you, "+t.getName(e)}},r["table.load.votable"]=function(n,r,i){if(y){var s=r["samp.params"],u=s.url,a=t.connection.translateUrl(u),f=samp.XmlRpcClient.createXHR(),l;f.open("GET",a),f.onload=function(){var t=f.responseXML;if(t)try{e.ajax({type:"POST",url:y,data:{votable:f.responseText,coordSystem:"EQUATORIAL"},success:function(e){o.handleFeatureCollection(m,e),m.addFeatureCollection(e)},error:function(e){console.error(e)}})}catch(n){console.log("Error displaying table:\n"+n.toString())}else console.log("No XML response")},f.onerror=function(e){console.log("Error getting table "+u+"\n"+"("+e+")")},f.send(null)}else ErrorDialog.open("votable2geojson plugin base url isn't defined")},r["image.load.fits"]=function(e,t,n){var r=t["samp.params"],i={geometry:{gid:r.name,coordinates:[],type:"Polygon"},properties:{identifier:r.name},services:{download:{mimetype:"image/fits",url:r["image-id"]}},type:"Feature"},o={layer:m,feature:i,isFits:!0},a=b+"/proxy?external_url="+encodeURIComponent(r["image-id"]);u.publish("image:add",o),c.computeFits(o,a,function(e,t){var n=s.getPolygonCoordinatesFromFits(t);e.feature.geometry.coordinates=[n],m.addFeature(e.feature)})},r["coord.pointAt.sky"]=function(e,t,r){g=!0;var i=t["samp.params"],s=parseFloat(i.ra),o=parseFloat(i.dec),u=[s,o],l=[];n.fromGeoTo3D(u,l),f.center3d=l,f.computeViewMatrix(),a.renderContext.requestFrame()},r["samp.hub.event.unregister"]=function(t,n,r){e("#registerSamp").removeAttr("disabled").button("refresh"),e("#unregisterSamp").attr("disabled","disabled").button("refresh"),e("#sampInvoker").css("background-image","url(css/images/samp_off.png)")},t}function S(){var t=E(),n={receiveNotification:function(n,r){var i=t.receiveNotification(n,r);r["samp.mtype"]=="samp.hub.event.subscriptions"&&(e("#unregisterSamp").removeAttr("disabled").button("refresh"),e("#registerSamp").attr("disabled","disabled").button("refresh"),e("#sampInvoker").css("background-image","url(css/images/samp_on.png)"))},receiveCall:function(e,n,r){var i=t.receiveCall(e,n,r)},receiveResponse:function(e,n,r){var i=t.receiveResponse(e,n,r)},init:function(e){t.init(e)}},r={"samp.name":"Mizar","samp.description.text":"Module for Interactive visualiZation from Astronomical Repositories","mizar.version":"v0.1","author.affiliation":"CNES/TPZ","home.page":"http://github.com/TPZF/RTWeb3D"},i=t.calculateSubscriptions();v=new samp.Connector("Mizar",r,n,i),v.regTextNodes.push(e("#sampResult")[0])}function x(e,t,r,i){u=e,a=u.sky,f=u.navigation,layerManager=t,c=r,i.votable2geojson&&(b=i.sitoolsBaseUrl,y=i.votable2geojson.baseUrl),w(),S(),f.subscribe("modified",function(){if(v.connection)if(!g){var e=n.from3DToGeo(f.center3d),t=new samp.Message("coord.pointAt.sky",{ra:e[0].toString(),dec:e[1].toString()});v.connection.notifyAll([t])}else g=!1});var s={type:"Vector",name:"SAMP",pickable:!0,dataType:"line"};m=layerManager.addLayer(s),window.onbeforeunload=function(){v.unregister()}}var u,a,f,l,c,h={},p=new r({strokeColor:[1,1,1,1],fillColor:[1,1,1,1]}),d,v,m,g=!1,y,b;return{init:x,sendImage:function(e){if(this.isConnected()){var t=new samp.Message("image.load.fits",{url:e});return v.connection.notifyAll([t]),"Image has been sent"}return"Connect to SAMP Hub first"},sendVOTable:function(e,t){if(this.isConnected()){var n=new samp.Message("table.load.votable",{url:t+"&media=votable"});return v.connection.notifyAll([n]),"VOTable has been sent"}return"Connect to SAMP Hub first"},highlightFeature:function(e,t){this.isConnected()},isConnected:function(){return v.connection}}}),define("AnimatedButton",["jquery","jquery.ui"],function(e){var t=function(t,n){this.$element=e(t).button(),this.stopped=!0,n&&this.$element.on("click",e.proxy(n.onclick,this))};return t.prototype.startAnimation=function(){this.stopped=!1,this.iterateAnimation()},t.prototype.stopAnimation=function(){this.stopped=!0},t.prototype.iterateAnimation=function(){var t=this;this.$element.children("span").animate({backgroundColor:"rgb(255, 165, 0);"},300,function(){e(this).animate({backgroundColor:"transparent"},300,function(){t.stopped||t.iterateAnimation()})})},t}),define("ErrorDialog",["jquery","jquery.ui"],function(e){var t='<div id="errorDiv" style="text-align: justify" title="Error"></div>',n=e(t).appendTo("body").dialog({autoOpen:!1,resizable:!1,draggable:!1,width:"300px",minHeight:"auto",dialogClass:"errorBox"});return{open:function(e){n.html(e).dialog("open")}}}),define("text!../templates/cutOut.html",[],function(){return'<div class="cutOutService">\n	<div style="text-align: center;">\n		<button id="selectionTool">Select area</button>\n		<button id="clearSelection">Clear area</button>\n		<br/>\n		<button id="runJob">Cut</button>\n		<div style="display: none;" class="jobStatus"></div>\n	</div>\n	<hr />\n	<em>Results</em>\n	<div class="cutoutResults">\n		<ul style="list-style-type: none;">\n		</ul>\n	</div>\n</div>'}),define("text!../templates/cutResultItem.html",[],function(){return'<li data-jobid="<%= result.jobId %>" class="cutResult" style="display: none;"><%= result.name %>:\n	<img data-url="<%= result.url %>" title="Export image by SAMP" class="sampExport" src="css/images/exportSamp.png" />\n	<a href="<%= result.url %>" download="<% (result.downloadName) ? print(result.downloadName) : print(result.name) %>"><img style="vertical-align: middle; width: 20px; height: 20px;" title="Download" src="css/images/download1.png"></a>\n	<img title="Delete result" class="deleteResult" src="css/images/delete.png" />\n</li>'}),define("CutOutView",["jquery","./SelectionTool","./UWSManager","./Samp","gw/CoordinateSystem","./AnimatedButton","./ErrorDialog","underscore-min","text!../templates/cutOut.html","text!../templates/cutResultItem.html","jquery.ui"],function(e,t,n,r,i,s,o,u,a,f){var l=u.template(a),c=u.template(f),h=function(t,i,u){this.url,this.pickingManager=u,this.selectionTool=i;var a=l(),f=this;e("#"+t).html(""),this.$content=e(a).appendTo("#"+t).find("#selectionTool").button().click(function(){f.$content.slideUp(),f.pickingManager.deactivate(),f.selectionTool.toggle()}).end().find("#clearSelection").button().click(function(){f.selectionTool.clear()}).end(),this.runButton=new s(e("#"+t).find("#runJob")[0],{onclick:e.proxy(this.runJob,this)}),this.$content.on("click",".sampExport",function(t){r.isConnected()?r.sendImage(e(this).data("url")):o.open("You must be connected to SAMP Hub")}),this.$content.on("click",".deleteResult",function(t){var r=e(this).parent(),i=r.data("jobid");n.delete("cutout",i,{successCallback:function(){r.parent().find("li[data-jobid="+r.data("jobid")+"]").each(function(){e(this).fadeOut(function(){e(this).remove()})})},failCallback:function(t){console.error(t),r.parent().find("li[data-jobid="+r.data("jobid")+"]").each(function(){e(this).fadeOut(function(){e(this).remove()})})}})})};return h.prototype.runJob=function(){if(this.selectionTool.selectionFeature){this.runButton.startAnimation();var t={PHASE:"RUN",uri:this.url,ra:this.selectionTool.geoPickPoint[0],dec:this.selectionTool.geoPickPoint[1],radius:this.selectionTool.geoRadius},r=this;n.post("cutout",t,{successCallback:function(t,n){r.showMessage("Completed");for(var i=0;i<t.results.result.length;i++){var s=t.results.result[i],o=s["@id"],u=s["@xlink:href"];if(u.search("[?]")>0){var a=u.lastIndexOf("/")+1;u=u.substr(0,a)+encodeURIComponent(o)}var f=o.search("file_id="),l;f>=0?l=o.substr(f+8):l=o,r.runButton.stopAnimation(),s={name:l,url:u,jobId:n};var h=c({result:s});e(h).appendTo(r.$content.find(".cutoutResults").find("ul")).fadeIn(400)}},failCallback:function(e){r.runButton.stopAnimation(),r.showMessage(e)}})}else this.showMessage("Please, select area to cut")},h.prototype.showMessage=function(e){this.$content.find(".jobStatus").html(e).stop().slideDown(300).delay(2e3).slideUp()},h.prototype.setUrl=function(e){this.url=e},h}),define("CutOutViewFactory",["jquery","SelectionTool","CutOutView"],function(e,t,n){var r,i,s=[];return{init:function(n,o,u){i=u,r=new t({globe:n,navigation:o,onselect:function(){e(".cutOutService").slideDown(),i.activate(),r.toggle()}}),s=[]},addView:function(e){var t=new n(e,r,i);return s.push(t),t},removeView:function(e){var t=s.indexOf(e);s.splice(t,1)}}}),define("Histogram",[],function(){function u(e,t){var n=e.getBoundingClientRect();return{x:t.clientX-n.left,y:t.clientY-n.top}}function f(e,t,n,r){var i=[],s=[],o=[],u=[],a=[];return vec3.cross(vec3.subtract(r,n,i),vec3.subtract(e,n,s),u),vec3.cross(i,vec3.subtract(t,n,o),a),vec3.dot(u,a)>=0?!0:!1}function l(e,t,n,r){return f(e,t,n,r)&&f(e,n,t,r)&&f(e,r,t,n)?!0:!1}var e,t=[],n,r=5,i,s,o=15,a=function(e,t,n){this.initA=e.slice(0),this.initB=t.slice(0),this.initC=n.slice(0),this.a=e,this.b=t,this.c=n,this.dragging=!1,this.hover=!1,this.halfWidth=Math.abs((n[0]-t[0])/2)};a.prototype.reset=function(){this.a=this.initA.slice(0),this.b=this.initB.slice(0),this.c=this.initC.slice(0)},a.prototype.contains=function(e){return l(e,this.a,this.b,this.c)},a.prototype.draw=function(e){this.dragging?e.fillStyle="#FF0":e.fillStyle="#F00",e.beginPath(),e.moveTo(this.a[0],this.a[1]),e.lineTo(this.b[0],this.b[1]),e.lineTo(this.c[0],this.c[1]),e.closePath(),e.fill(),!this.dragging&&this.hover&&(e.strokeStyle="#FF0",e.stroke())},a.prototype.modifyPosition=function(e){this.a[0]=e[0],this.b[0]=e[0]-this.halfWidth,this.c[0]=e[0]+this.halfWidth};var c=function(t){e=t.nbBins||256,this.image=t.image,this.onUpdate=t.onUpdate,this.accuracy=t.accuracy||6;var n=document.getElementById(t.canvas);this.ctx=n.getContext("2d"),i=n.height-o,s=e+r>n.width?n.width:e+r;var f=5;this.minThreshold=new a([r,i+1,0],[r-f,i+o-1,0],[r+f,i+o-1,0]),this.maxThreshold=new a([s,i+1,0],[s-f,i+o-1,0],[s+f,i+o-1,0]);var l=this;n.addEventListener("mousemove",function(t){var s=u(n,t);l.ctx.clearRect(0,i,n.width,o),l.minThreshold.contains([s.x,s.y,0])?l.minThreshold.hover=!0:l.minThreshold.hover=!1,l.maxThreshold.contains([s.x,s.y,0])?l.maxThreshold.hover=!0:l.maxThreshold.hover=!1,l.minThreshold.dragging&&s.x>=l.minThreshold.initA[0]&&s.x<l.maxThreshold.a[0]&&l.minThreshold.modifyPosition([s.x,l.minThreshold.a[1]]),l.maxThreshold.dragging&&s.x<=l.maxThreshold.initA[0]&&s.x>l.minThreshold.a[0]&&l.maxThreshold.modifyPosition([s.x,l.maxThreshold.a[1]]),l.drawThresholdControls();if(s.y>n.height||s.y<0||s.x>r+e||s.x<r)return;l.ctx.font="8pt Calibri",l.ctx.fillStyle="yellow";var a=l.getHistValue([s.x,s.y]);l.ctx.fillText(a,n.width/2-15,i+o),l.ctx.fillRect(s.x,i,1,2)}),n.addEventListener("mousedown",function(e){var t=u(n,e);l.minThreshold.contains([t.x,t.y,0])&&(l.minThreshold.dragging=!0,l.minThreshold.draw(l.ctx)),l.maxThreshold.contains([t.x,t.y,0])&&(l.maxThreshold.dragging=!0,l.maxThreshold.draw(l.ctx))}),n.addEventListener("mouseup",function(e){l.minThreshold.dragging=!1,l.maxThreshold.dragging=!1;if(l.onUpdate){var t=l.getHistValue(l.minThreshold.a),n=l.getHistValue(l.maxThreshold.a);l.minThreshold.reset(),l.maxThreshold.reset(),l.onUpdate(t,n)}})};return c.prototype.getHistValue=function(e){return Math.floor(((e[0]-r)/256*(this.image.tmax-this.image.tmin)+this.image.tmin)*Math.pow(10,this.accuracy))/Math.pow(10,this.accuracy)},c.prototype.drawThresholdControls=function(){this.minThreshold.draw(this.ctx),this.maxThreshold.draw(this.ctx)},c.prototype.drawHistogram=function(){this.ctx.fillStyle="blue";for(var e=0;e<t.length;e++){var s=t[e]/n*i;this.ctx.fillRect(r+e,i,1,-s)}},c.prototype.drawAxes=function(){var e,t;e=0,t=r+s,this.ctx.beginPath(),this.ctx.moveTo(r,e),this.ctx.lineTo(r,i),this.ctx.moveTo(r,i),this.ctx.lineTo(t,i),this.ctx.closePath(),this.ctx.strokeStyle="#fff",this.ctx.stroke()},c.prototype.drawTransferFunction=function(){this.ctx.fillStyle="red";for(var t=0;t<e;t++){var n=t,s=r+n,o;switch(this.image.transferFn){case"linear":o=n/e*i;break;case"log":o=Math.log(n/10+1)/Math.log(e/10+1)*i;break;case"sqrt":o=Math.sqrt(n/10)/Math.sqrt(e/10)*i;break;case"sqr":o=Math.pow(n,2)/Math.pow(e,2)*i;break;case"asin":o=Math.log(n+Math.sqrt(Math.pow(n,2)+1))/Math.log(e+Math.sqrt(Math.pow(e,2)+1))*i;break;default:}this.image.inverse||(o=i-o),this.ctx.fillRect(s,o,1,1)}},c.prototype.draw=function(){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.drawHistogram(),this.drawTransferFunction(),this.drawAxes(),this.drawThresholdControls()},c.prototype.compute=function(){var r=this.image;t=new Array(e);for(var i=0;i<t.length;i++)t[i]=0;n=Number.MIN_VALUE;for(var i=0;i<r.pixels.length;i++){var s=r.pixels[i];if(isNaN(s))continue;if(s<r.tmin)continue;if(s>=r.tmax)continue;var o=Math.floor(e*(s-r.tmin)/(r.tmax-r.tmin));t[o]++,t[o]>n&&(n=t[o])}for(var i=0;i<t.length;i++)t[i]=Math.log(1+t[i]);n=Math.log(1+n)},c.prototype.setImage=function(e){this.image=e},c}),define("text!../templates/dynamicImageView.html",[],function(){return'<div id="imageProcessing">\n	<div>\n		<span class="processOption">Contrast : </span>\n		<div class="contrast" style="display: inline-block;">\n			<input name="fitsScale_<%= id %>" type="radio" value="raw" id="raw_<%= id %>" checked="checked" /><label for="raw_<%= id %>">Raw</label>\n			<input name="fitsScale_<%= id %>" type="radio" value="linear" id="linear_<%= id %>" /><label for="linear_<%= id %>">Linear</label>\n		  	<input name="fitsScale_<%= id %>" type="radio" value="log" id="log_<%= id %>" /><label for="log_<%= id %>">Log</label>\n		  	<input name="fitsScale_<%= id %>" type="radio" value="sqrt" id="sqrt_<%= id %>" /><label for="sqrt_<%= id %>">Sqrt</label>\n		  	<input name="fitsScale_<%= id %>" type="radio" value="sqr" id="sqr_<%= id %>" /><label for="sqr_<%= id %>">Pow2</label>\n		  	<input name="fitsScale_<%= id %>" type="radio" value="asin" id="asin_<%= id %>" /><label for="asin_<%= id %>">AsinH</label>\n		</div>\n	</div>\n\n	<div>\n		<span class="processOption">Colormap : </span>\n		<select class="colormap" style="width:100px;" disabled>\n			<option value="grey">Grey</option>\n			<option value="rainbow">Rainbow</option>\n			<option value="stern">Stern</option>\n			<option value="fire">Fire</option>\n			<option value="eosb">EOSB</option>\n		</select>\n	</div>\n\n	<div>\n  		<span class="processOption"> Threshold : </span>\n		<div class="thresholdSlider"></div>\n	</div>\n\n	<div>\n	  	<span class="thresholdInputs">\n	  		<label for="min">Min : </label><input type="text" id="min" disabled />\n	  		<label for="max">Max : </label><input type="text" id="max" disabled />\n	  	</span>\n	</div>\n\n	<div>\n		<button disabled class="zScale">ZScale</button>\n	</div>\n\n	<div>\n		<span style="width: auto" class="processOption"> Inverse : </span>\n		<input id="inverse_<%= id %>" class="inverse" type="checkbox" disabled /><label for="inverse_<%= id %>"></label>\n	</div>\n\n	<div>\n		<div class="processOption" >Histogram : </div>\n		<canvas class="noSelect" id="histogram_<%= id %>" width="275" height="160"></canvas>\n	</div>\n</div>'}),define("DynamicImageView",["jquery","underscore-min","gw/FeatureStyle","./Histogram","./UWSManager","./AnimatedButton","./ErrorDialog","text!../templates/dynamicImageView.html","jquery.ui"],function(e,t,n,r,i,s,o,u){var a=function(n,a){this.id=a.id,this.changeShaderCallback=a.changeShaderCallback;var f="grey",l="raw",c=!1,h=this,p=t.template(u,{id:this.id});this.$element=e("#"+n),this.$element.html(p),this.$element.find(".contrast").buttonset().find("input").each(function(t){e(this).click(function(){l=e(this).val();switch(l){case"linear":case"log":case"sqrt":case"sqr":case"asin":h.enableUI();break;case"raw":h.disableUI();break;default:}h.image.updateColormap(l,f,c),h.changeShaderCallback&&h.changeShaderCallback(l),h.render()})});var d=this.$element.find(".thresholdSlider").slider({range:!0,slide:function(e,t){h.$element.find("#min").val(t.values[0]),h.$element.find("#max").val(t.values[1])},stop:function(e,t){h.updateThreshold(t.values[0],t.values[1])}}).slider("disable");this.$element.find(".thresholdInputs").change(function(){var t=parseFloat(e(this).children("#min").val());if(isNaN(t)||t<h.image.min)e(this).children("#min").val(h.image.min),t=h.image.min;var n=parseFloat(e(this).children("#max").val());if(isNaN(n)||n>h.image.max)e(this).children("#max").val(h.image.max),n=h.image.max;h.updateThreshold(t,n)});var v=this.$element.find(".colormap").selectmenu({select:function(t){f=e(this).children("option:selected").val(),h.image.colormap=f,h.image.updateColormap(l,f,c),h.image.renderContext.requestFrame()}});this.$element.find(".inverse").button({text:!1,icons:{primary:""}}),this.$element.find(".inverse").click(function(){e(this).button("option",{icons:{primary:e(this)[0].checked?"ui-icon-check":""}}),c=e(this).is(":checked"),h.image.updateColormap(l,f,c),h.render()});var m=new s(this.$element.find(".zScale")[0],{onclick:function(){var t={PHASE:"RUN",uri:h.image.url};h.image.url||o.open("ZScale can't find image url"),m.startAnimation(),i.post("zscale",t,{successCallback:function(t){m.stopAnimation();var n=parseFloat(t.results.result[0]["@xlink:href"]),r=parseFloat(t.results.result[1]["@xlink:href"]);h.$element.find("#min").val(n).animate({color:"#6BCAFF","border-color":"#6BCAFF"},300,function(){e(this).animate({color:"#F8A102","border-color":"transparent"})}),h.$element.find("#max").val(r).animate({color:"#6BCAFF","border-color":"#6BCAFF"},300,function(){e(this).animate({color:"#F8A102","border-color":"transparent"})}),h.updateThreshold(n,r)},failCallback:function(){m.stopAnimation(),o.open("ZScale internal server error<br/>")}})}});this.histogram=new r({canvas:"histogram_"+this.id,nbBeans:256,onUpdate:e.proxy(this.updateThreshold,this)}),a.image&&(a.image.colormap="grey",this.setImage(a.image))};return a.prototype.enableUI=function(){this.$element.find(".colormap").selectmenu("enable"),this.$element.find(".thresholdSlider").slider("enable"),this.$element.find(".inverse").removeAttr("disabled").button("refresh"),this.$element.find(".zScale").removeAttr("disabled").button("refresh"),this.$element.find(".thresholdInputs input").each(function(t){e(this).removeAttr("disabled")})},a.prototype.disableUI=function(){this.$element.find(".colormap").selectmenu("disable"),this.$element.find(".thresholdSlider").slider("disable"),this.$element.find(".inverse").attr("disabled","disabled").button("refresh"),this.$element.find(".zScale").attr("disabled","disabled").button("refresh"),this.$element.find(".thresholdInputs input").each(function(t){e(this).attr("disabled","disabled")})},a.prototype.updateThreshold=function(e,t){this.image.tmin=e,this.image.tmax=t,this.$element.find("#min").val(e),this.$element.find("#max").val(t),this.$element.find(".thresholdSlider").slider({values:[e,t]}),this.histogram.compute(),this.render()},a.prototype.setImage=function(e){var t=(e.max-e.min)/1e3,n=this;this.$element.find(".thresholdSlider").slider("option",{values:[e.min,e.max],min:e.min,max:e.max,step:t}),this.histogram.setImage(e),this.$element.find("#min").attr("placeholder",e.min).end().find("#max").attr("placeholder",e.max),this.$element.find(".inverse").attr("checked",e.inverse?"checked":!1).button("refresh").end().find(".contrast").find("input[value="+e.transferFn+"]").attr("checked","checked").end().buttonset("refresh").end().find(".colormap").val(e.colormap).selectmenu(),e.transferFn=="raw"?this.disableUI():this.enableUI(),this.image=e,this.updateThreshold(e.tmin,e.tmax),this.render()},a.prototype.remove=function(){this.image.dispose()},a.prototype.render=function(){this.histogram.draw(),this.image.renderContext.requestFrame()},a}),define("ImageProcessing",["jquery","./SelectionTool","./CutOutViewFactory","./DynamicImageView","gw/FeatureStyle","jquery.ui"],function(e,t,n,r,i){function h(){f.dialog("isOpen")?f.dialog("close"):f.dialog("open")}function p(){a&&a(),u&&u(),l&&l.remove(),n.removeView(c),f.remove()}function d(t){s&&s.properties.identifier==t.feature.properties.identifier?this.toggle():f.dialog("isOpen")||this.toggle(),s=t.feature,o=t.layer,t.feature.services&&c.setUrl(t.feature.services.download.url);var n=t.feature.properties.style.uniformValues;n?this.setImage(n):f.find(".histogramContent").children("div").fadeOut(function(){e(this).siblings("p").fadeIn()})}var s,o,u,a,f,l,c;return{init:function(t){t&&(s=t.feature||null,o=t.layer||null,u=t.disable||null,a=t.unselect||null);var h='<div>				<div class="imageProcessing" id="imageProcessing" title="Image processing">					<h3>Histogram</h3>					<div class="histogramContent">						<p> Fits isn\'t loaded, thus histogram information isn\'t available</p>						<div style="display: none;" id="histogramView"></div>					</div>					<h3>Cutout</h3>					<div id="cutOutView"></div>				</div>			</div>';f=e(h).appendTo("body").dialog({title:"Image processing",autoOpen:!1,show:{effect:"fade",duration:300},hide:{effect:"fade",duration:300},width:500,resizable:!1,minHeight:"auto",close:function(t,n){a&&a(),e(this).dialog("close")}}).find(".imageProcessing").accordion({autoHeight:!1,active:0,collapsible:!0,heightStyle:"content"}).end(),l=new r("histogramView",{id:"featureImageProcessing",changeShaderCallback:function(e){if(e=="raw"){var t=new i(s.properties.style);t.fillShader={fragmentCode:null,updateUniforms:null},o.modifyFeatureStyle(s,t)}else{var t=new i(s.properties.style);t.fillShader={fragmentCode:this.image.fragmentCode,updateUniforms:this.image.updateUniforms},o.modifyFeatureStyle(s,t)}}}),c=n.addView("cutOutView")},setData:d,setImage:function(t){l.setImage(t),t.url&&c.setUrl(t.url),f.find(".histogramContent").children("p").fadeOut(function(){e(this).siblings("div").fadeIn()})},toggle:h,isOpened:function(){return f.dialog("isOpen")},removeData:function(t){s&&t.feature.properties.identifier==s.properties.identifier&&(this.isOpened()&&this.toggle(),f.find(".histogramContent").children("div").fadeOut(function(){e(this).siblings("p").fadeIn()}),s=null,o=null)}}}),define("text!../templates/featureList.html",[],function(){return'<div id="overlappedObjects">\n	<% if ( selection.length > 1 ) {%>\n		<u>Overlapped observations:</u><br/>\n	<% } else { %>\n		<u>Object:</u><br/>\n	<% } %>\n	<div id="scroll-arrow-up" style="display: none" class="scroll-arrow-up"></div>\n	<div id="featureListDiv">\n		<div id="featureList">\n			<%\n			var title = "";\n			for ( var i=0; i<selection.length; i++ )\n			{ \n				var properties = selection[i].feature.properties;\n				title = ( properties.title ) ? properties.title : properties.identifier;\n			%>\n				<div title=<%= title %> class="featureTitle"> <%= title %> <br/></div>\n			<%\n			}\n			%>\n		</div>\n	</div>\n	<div id="scroll-arrow-down" style="display: none" class="scroll-arrow-down clickable"></div>\n</div>'}),define("text!../templates/featureDescription.html",[],function(){return'<div class="detailedInfo">\n	<% if ( properties.thumbnail ) \n	{ %>\n		<div class="thumbnail"><img src="<%= properties.thumbnail %>" /></div>\n	<% } %>\n	<div class="featureProperties">\n		<table class="propertiesTable" rules="rows">\n			<tbody>\n				<% print(descriptionTableTemplate( { properties: properties, descriptionTableTemplate: descriptionTableTemplate, dictionary: dictionary }) ); %>\n			</tbody>\n		</table>\n	</div>\n	\n	<% if ( services ) {\n	%>\n		<div id="services">\n			<%\n			if ( properties.quicklook ) { %>\n				<span class="featureService" title="Quicklook" id=\'quicklook\' class=<%= (properties.style.fillTextureUrl && properties.style.fill ? \'selected\' : \'\' ) %> ></span>\n			<% } %>\n\n			<% if ( services )\n			{\n				if ( services.download )\n				{\n					if ( services.download.mimetype == "image/fits" )\n					{\n						if ( !isMobile ) \n						{\n							var fitsQuicklookOn = properties.style.fill && !properties.style.fillTextureUrl;\n							%>\n							<span class="featureService" title="Fits quicklook" id=\'quicklookFits\' class=<%= (fitsQuicklookOn ? \'selected\' : \'\' ) %> ></span>\n						<% } %>\n						<span style="display: inline-block; position: relative;">\n							<span class="featureService" title="Solar object service" id="solarObjects" class=<%= (services.solarObjects && services.solarObjects.layer.visible() ? \'selected\' : \'\' ) %>></span>\n							<div style="display: none" id="solarObjectsSpinner"></div>\n						</span>\n						<span title="Image processing" id="dynamicImageView" class=\'dynamicAvailable\' />\n						<span class="featureService" title="Export image by SAMP" id="sendImage"></span>\n					<%\n					}\n				 	%>\n					<a href="<%= services ? services.download.url : "" %>" target="_self" download><span class="featureService" id="downloadImage" title="Download"></span></a>\n					<%\n				}\n				if ( services.healpix ) { %>\n					<span class="featureService" title="Healpix service" id=\'healpix\' class=<%= (services.healpix.layer.visible() ? \'selected\' : \'\' ) %> ></span>\n				<% }\n			} %>\n			<div style="display: none;" id="serviceStatus"></div>\n		</div>\n	<% } %>\n\n</div>'}),define("text!../templates/descriptionTable.html",[],function(){return'<% for ( var key in properties )\n{ \n	if ( key != \'style\' && key != \'title\' && key != \'quicklook\' && key != \'thumbnail\' )\n	{	\n		var stringKey = key.toString(); %>\n	<tr height="30%">\n		<% // Test if section\n		var title = dictionary[stringKey];\n		if (typeof (properties[key]) === "object" )\n		{	\n			if ( key == \'crs\' )\n			{%>\n				<td id="<%=stringKey%>" title="<%= title%>" class="selectProperty"><em><%= stringKey %>:</em></td>\n				<td title="<%= properties[key].properties.name %>" class="selectValue"><%= properties[key].properties.name %></td>\n			<% } else { %>\n				<td  id="<%=stringKey%>" title="<%= title%>" class="selectProperty" colspan="2">\n					<div id="arrow" class="arrow-right"></div><div class="section"><b><%= stringKey %></b></div>\n					<table class="propertiesTable" style="display: none; margin-left: 10px" rules="rows">\n						<tbody>\n							<% print( descriptionTableTemplate( { dictionary: dictionary, properties: properties[key], descriptionTableTemplate: descriptionTableTemplate }) );\n							 %>\n						</tbody>\n					</table>\n				</td>\n		<%	}\n		}\n		else\n		{%>\n			<td  id="<%=stringKey%>" title="<%= title%>" class="selectProperty"><em><%= stringKey %>:</em></td>\n			<% \n			var isUrl = ( typeof (properties[key]) === "string" && properties[key].substr(0,4) == \'http\' ) ? true : false;\n			if (isUrl) {%>\n				<td class="selectValue"><a href="<%= properties[key] %>"><%= properties[key] %></a></td>\n			<% } else { %>\n				<td class="selectValue" title="<%= properties[key] %>"><%= properties[key] %></td>\n			<% }\n		} %>\n	</tr>\n	<% }\n} %>'}),function(e){"function"==typeof define&&define.amd?define("jquery.nicescroll.min",["jquery"],e):e(jQuery)}(function(e){var t=!1,n=!1,r=5e3,i=2e3,s=0,o=["ms","moz","webkit","o"],u=window.requestAnimationFrame||!1,a=window.cancelAnimationFrame||!1;if(!u)for(var f in o){var l=o[f];u||(u=window[l+"RequestAnimationFrame"]),a||(a=window[l+"CancelAnimationFrame"]||window[l+"CancelRequestAnimationFrame"])}var c=window.MutationObserver||window.WebKitMutationObserver||!1,h={zindex:"auto",cursoropacitymin:0,cursoropacitymax:1,cursorcolor:"#424242",cursorwidth:"5px",cursorborder:"1px solid #fff",cursorborderradius:"5px",scrollspeed:60,mousescrollstep:24,touchbehavior:!1,hwacceleration:!0,usetransition:!0,boxzoom:!1,dblclickzoom:!0,gesturezoom:!0,grabcursorenabled:!0,autohidemode:!0,background:"",iframeautoresize:!0,cursorminheight:32,preservenativescrolling:!0,railoffset:!1,bouncescroll:!0,spacebarenabled:!0,railpadding:{top:0,right:0,left:0,bottom:0},disableoutline:!0,horizrailenabled:!0,railalign:"right",railvalign:"bottom",enabletranslate3d:!0,enablemousewheel:!0,enablekeyboard:!0,smoothscroll:!0,sensitiverail:!0,enablemouselockapi:!0,cursorfixedheight:!1,directionlockdeadzone:6,hidecursordelay:400,nativeparentscrolling:!0,enablescrollonselection:!0,overflowx:!0,overflowy:!0,cursordragspeed:.3,rtlmode:"auto",cursordragontouch:!1,oneaxismousemode:"auto",scriptpath:function(){var e=document.getElementsByTagName("script"),e=e[e.length-1].src.split("?")[0];return 0<e.split("/").length?e.split("/").slice(0,-1).join("/")+"/":""}()},p=!1,d=function(){if(p)return p;var e=document.createElement("DIV"),t={haspointerlock:"pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document};t.isopera="opera"in window,t.isopera12=t.isopera&&"getUserMedia"in navigator,t.isoperamini="[object OperaMini]"===Object.prototype.toString.call(window.operamini),t.isie="all"in document&&"attachEvent"in e&&!t.isopera,t.isieold=t.isie&&!("msInterpolationMode"in e.style),t.isie7=t.isie&&!t.isieold&&(!("documentMode"in document)||7==document.documentMode),t.isie8=t.isie&&"documentMode"in document&&8==document.documentMode,t.isie9=t.isie&&"performance"in window&&9<=document.documentMode,t.isie10=t.isie&&"performance"in window&&10<=document.documentMode,t.isie9mobile=/iemobile.9/i.test(navigator.userAgent),t.isie9mobile&&(t.isie9=!1),t.isie7mobile=!t.isie9mobile&&t.isie7&&/iemobile/i.test(navigator.userAgent),t.ismozilla="MozAppearance"in e.style,t.iswebkit="WebkitAppearance"in e.style,t.ischrome="chrome"in window,t.ischrome22=t.ischrome&&t.haspointerlock,t.ischrome26=t.ischrome&&"transition"in e.style,t.cantouch="ontouchstart"in document.documentElement||"ontouchstart"in window,t.hasmstouch=window.navigator.msPointerEnabled||!1,t.ismac=/^mac$/i.test(navigator.platform),t.isios=t.cantouch&&/iphone|ipad|ipod/i.test(navigator.platform),t.isios4=t.isios&&!("seal"in Object),t.isandroid=/android/i.test(navigator.userAgent),t.trstyle=!1,t.hastransform=!1,t.hastranslate3d=!1,t.transitionstyle=!1,t.hastransition=!1,t.transitionend=!1;for(var n=["transform","msTransform","webkitTransform","MozTransform","OTransform"],r=0;r<n.length;r++)if("undefined"!=typeof e.style[n[r]]){t.trstyle=n[r];break}t.hastransform=0!=t.trstyle,t.hastransform&&(e.style[t.trstyle]="translate3d(1px,2px,3px)",t.hastranslate3d=/translate3d/.test(e.style[t.trstyle])),t.transitionstyle=!1,t.prefixstyle="",t.transitionend=!1;for(var n="transition webkitTransition MozTransition OTransition OTransition msTransition KhtmlTransition".split(" "),i=" -webkit- -moz- -o- -o -ms- -khtml-".split(" "),s="transitionend webkitTransitionEnd transitionend otransitionend oTransitionEnd msTransitionEnd KhtmlTransitionEnd".split(" "),r=0;r<n.length;r++)if(n[r]in e.style){t.transitionstyle=n[r],t.prefixstyle=i[r],t.transitionend=s[r];break}t.ischrome26&&(t.prefixstyle=i[1]),t.hastransition=t.transitionstyle;e:{n=["-moz-grab","-webkit-grab","grab"];if(t.ischrome&&!t.ischrome22||t.isie)n=[];for(r=0;r<n.length;r++)if(i=n[r],e.style.cursor=i,e.style.cursor==i){n=i;break e}n="url(http://www.google.com/intl/en_ALL/mapfiles/openhand.cur),n-resize"}return t.cursorgrabvalue=n,t.hasmousecapture="setCapture"in e,t.hasMutationObserver=!1!==c,p=t},v=function(o,f){function l(){var e=y.win;if("zIndex"in e)return e.zIndex();for(;0<e.length&&9!=e[0].nodeType;){var t=e.css("zIndex");if(!isNaN(t)&&0!=t)return parseInt(t);e=e.parent()}return!1}function p(e,t,n){return t=e.css(t),e=parseFloat(t),isNaN(e)?(e=T[t]||0,n=3==e?n?y.win.outerHeight()-y.win.innerHeight():y.win.outerWidth()-y.win.innerWidth():1,y.isie8&&e&&(e+=1),n?e:0):e}function v(e,t,n,r){y._bind(e,t,function(r){r=r?r:window.event;var i={original:r,target:r.target||r.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"==r.type?0:1,deltaX:0,deltaZ:0,preventDefault:function(){return r.preventDefault?r.preventDefault():r.returnValue=!1,!1},stopImmediatePropagation:function(){r.stopImmediatePropagation?r.stopImmediatePropagation():r.cancelBubble=!0}};return"mousewheel"==t?(i.deltaY=-0.025*r.wheelDelta,r.wheelDeltaX&&(i.deltaX=-0.025*r.wheelDeltaX)):i.deltaY=r.detail,n.call(e,i)},r)}function g(e,t,n){var r,i;0==e.deltaMode?(r=-Math.floor(e.deltaX*(y.opt.mousescrollstep/54)),i=-Math.floor(e.deltaY*(y.opt.mousescrollstep/54))):1==e.deltaMode&&(r=-Math.floor(e.deltaX*y.opt.mousescrollstep),i=-Math.floor(e.deltaY*y.opt.mousescrollstep)),t&&y.opt.oneaxismousemode&&0==r&&i&&(r=i,i=0),r&&(y.scrollmom&&y.scrollmom.stop(),y.lastdeltax+=r,y.debounced("mousewheelx",function(){var e=y.lastdeltax;y.lastdeltax=0,y.rail.drag||y.doScrollLeftBy(e)},15));if(i){if(y.opt.nativeparentscrolling&&n&&!y.ispage&&!y.zoomactive)if(0>i){if(y.getScrollTop()>=y.page.maxh)return!0}else if(0>=y.getScrollTop())return!0;y.scrollmom&&y.scrollmom.stop(),y.lastdeltay+=i,y.debounced("mousewheely",function(){var e=y.lastdeltay;y.lastdeltay=0,y.rail.drag||y.doScrollBy(e)},15)}return e.stopImmediatePropagation(),e.preventDefault()}var y=this;this.version="3.5.4",this.name="nicescroll",this.me=f,this.opt={doc:e("body"),win:!1},e.extend(this.opt,h),this.opt.snapbackspeed=80;if(o)for(var b in y.opt)"undefined"!=typeof o[b]&&(y.opt[b]=o[b]);this.iddoc=(this.doc=y.opt.doc)&&this.doc[0]?this.doc[0].id||"":"",this.ispage=/^BODY|HTML/.test(y.opt.win?y.opt.win[0].nodeName:this.doc[0].nodeName),this.haswrapper=!1!==y.opt.win,this.win=y.opt.win||(this.ispage?e(window):this.doc),this.docscroll=this.ispage&&!this.haswrapper?e(window):this.win,this.body=e("body"),this.iframe=this.isfixed=this.viewport=!1,this.isiframe="IFRAME"==this.doc[0].nodeName&&"IFRAME"==this.win[0].nodeName,this.istextarea="TEXTAREA"==this.win[0].nodeName,this.forcescreen=!1,this.canshowonmouseevent="scroll"!=y.opt.autohidemode,this.page=this.view=this.onzoomout=this.onzoomin=this.onscrollcancel=this.onscrollend=this.onscrollstart=this.onclick=this.ongesturezoom=this.onkeypress=this.onmousewheel=this.onmousemove=this.onmouseup=this.onmousedown=!1,this.scroll={x:0,y:0},this.scrollratio={x:0,y:0},this.cursorheight=20,this.scrollvaluemax=0,this.observerremover=this.observer=this.scrollmom=this.scrollrunning=this.isrtlmode=!1;do this.id="ascrail"+i++;while(document.getElementById(this.id));this.hasmousefocus=this.hasfocus=this.zoomactive=this.zoom=this.selectiondrag=this.cursorfreezed=this.cursor=this.rail=!1,this.visibility=!0,this.hidden=this.locked=!1,this.cursoractive=!0,this.wheelprevented=!1,this.overflowx=y.opt.overflowx,this.overflowy=y.opt.overflowy,this.nativescrollingarea=!1,this.checkarea=0,this.events=[],this.saved={},this.delaylist={},this.synclist={},this.lastdeltay=this.lastdeltax=0,this.detected=d();var w=e.extend({},this.detected);this.ishwscroll=(this.canhwscroll=w.hastransform&&y.opt.hwacceleration)&&y.haswrapper,this.istouchcapable=!1,w.cantouch&&w.ischrome&&!w.isios&&!w.isandroid&&(this.istouchcapable=!0,w.cantouch=!1),w.cantouch&&w.ismozilla&&!w.isios&&!w.isandroid&&(this.istouchcapable=!0,w.cantouch=!1),y.opt.enablemouselockapi||(w.hasmousecapture=!1,w.haspointerlock=!1),this.delayed=function(e,t,n,r){var i=y.delaylist[e],s=(new Date).getTime();if(!r&&i&&i.tt)return!1;i&&i.tt&&clearTimeout(i.tt);if(i&&i.last+n>s&&!i.tt)y.delaylist[e]={last:s+n,tt:setTimeout(function(){y&&(y.delaylist[e].tt=0,t.call())},n)};else if(!i||!i.tt)y.delaylist[e]={last:s,tt:0},setTimeout(function(){t.call()},0)},this.debounced=function(e,t,n){var r=y.delaylist[e];(new Date).getTime(),y.delaylist[e]=t,r||setTimeout(function(){var t=y.delaylist[e];y.delaylist[e]=!1,t.call()},n)};var E=!1;this.synched=function(e,t){return y.synclist[e]=t,function(){E||(u(function(){E=!1;for(e in y.synclist){var t=y.synclist[e];t&&t.call(y),y.synclist[e]=!1}}),E=!0)}(),e},this.unsynched=function(e){y.synclist[e]&&(y.synclist[e]=!1)},this.css=function(e,t){for(var n in t)y.saved.css.push([e,n,e.css(n)]),e.css(n,t[n])},this.scrollTop=function(e){return"undefined"==typeof e?y.getScrollTop():y.setScrollTop(e)},this.scrollLeft=function(e){return"undefined"==typeof e?y.getScrollLeft():y.setScrollLeft(e)},BezierClass=function(e,t,n,r,i,s,o){this.st=e,this.ed=t,this.spd=n,this.p1=r||0,this.p2=i||1,this.p3=s||0,this.p4=o||1,this.ts=(new Date).getTime(),this.df=this.ed-this.st},BezierClass.prototype={B2:function(e){return 3*e*e*(1-e)},B3:function(e){return 3*e*(1-e)*(1-e)},B4:function(e){return(1-e)*(1-e)*(1-e)},getNow:function(){var e=1-((new Date).getTime()-this.ts)/this.spd,t=this.B2(e)+this.B3(e)+this.B4(e);return 0>e?this.ed:this.st+Math.round(this.df*t)},update:function(e,t){return this.st=this.getNow(),this.ed=e,this.spd=t,this.ts=(new Date).getTime(),this.df=this.ed-this.st,this}};if(this.ishwscroll){this.doc.translate={x:0,y:0,tx:"0px",ty:"0px"},w.hastranslate3d&&w.isios&&this.doc.css("-webkit-backface-visibility","hidden");var S=function(){var e=y.doc.css(w.trstyle);return e&&"matrix"==e.substr(0,6)?e.replace(/^.*\((.*)\)$/g,"$1").replace(/px/g,"").split(/, +/):!1};this.getScrollTop=function(e){if(!e){if(e=S())return 16==e.length?-e[13]:-e[5];if(y.timerscroll&&y.timerscroll.bz)return y.timerscroll.bz.getNow()}return y.doc.translate.y},this.getScrollLeft=function(e){if(!e){if(e=S())return 16==e.length?-e[12]:-e[4];if(y.timerscroll&&y.timerscroll.bh)return y.timerscroll.bh.getNow()}return y.doc.translate.x},this.notifyScrollEvent=document.createEvent?function(e){var t=document.createEvent("UIEvents");t.initUIEvent("scroll",!1,!0,window,1),e.dispatchEvent(t)}:document.fireEvent?function(e){var t=document.createEventObject();e.fireEvent("onscroll"),t.cancelBubble=!0}:function(e,t){},w.hastranslate3d&&y.opt.enabletranslate3d?(this.setScrollTop=function(e,t){y.doc.translate.y=e,y.doc.translate.ty=-1*e+"px",y.doc.css(w.trstyle,"translate3d("+y.doc.translate.tx+","+y.doc.translate.ty+",0px)"),t||y.notifyScrollEvent(y.win[0])},this.setScrollLeft=function(e,t){y.doc.translate.x=e,y.doc.translate.tx=-1*e+"px",y.doc.css(w.trstyle,"translate3d("+y.doc.translate.tx+","+y.doc.translate.ty+",0px)"),t||y.notifyScrollEvent(y.win[0])}):(this.setScrollTop=function(e,t){y.doc.translate.y=e,y.doc.translate.ty=-1*e+"px",y.doc.css(w.trstyle,"translate("+y.doc.translate.tx+","+y.doc.translate.ty+")"),t||y.notifyScrollEvent(y.win[0])},this.setScrollLeft=function(e,t){y.doc.translate.x=e,y.doc.translate.tx=-1*e+"px",y.doc.css(w.trstyle,"translate("+y.doc.translate.tx+","+y.doc.translate.ty+")"),t||y.notifyScrollEvent(y.win[0])})}else this.getScrollTop=function(){return y.docscroll.scrollTop()},this.setScrollTop=function(e){return y.docscroll.scrollTop(e)},this.getScrollLeft=function(){return y.docscroll.scrollLeft()},this.setScrollLeft=function(e){return y.docscroll.scrollLeft(e)};this.getTarget=function(e){return e?e.target?e.target:e.srcElement?e.srcElement:!1:!1},this.hasParent=function(e,t){if(!e)return!1;for(var n=e.target||e.srcElement||e||!1;n&&n.id!=t;)n=n.parentNode||!1;return!1!==n};var T={thin:1,medium:3,thick:5};this.getOffset=function(){if(y.isfixed)return{top:parseFloat(y.win.css("top")),left:parseFloat(y.win.css("left"))};if(!y.viewport)return y.win.offset();var e=y.win.offset(),t=y.viewport.offset();return{top:e.top-t.top+y.viewport.scrollTop(),left:e.left-t.left+y.viewport.scrollLeft()}},this.updateScrollBar=function(e){if(y.ishwscroll)y.rail.css({height:y.win.innerHeight()}),y.railh&&y.railh.css({width:y.win.innerWidth()});else{var t=y.getOffset(),n=t.top,r=t.left,n=n+p(y.win,"border-top-width",!0);y.win.outerWidth(),y.win.innerWidth();var r=r+(y.rail.align?y.win.outerWidth()-p(y.win,"border-right-width")-y.rail.width:p(y.win,"border-left-width")),i=y.opt.railoffset;i&&(i.top&&(n+=i.top),y.rail.align&&i.left&&(r+=i.left)),y.locked||y.rail.css({top:n,left:r,height:e?e.h:y.win.innerHeight()}),y.zoom&&y.zoom.css({top:n+1,left:1==y.rail.align?r-20:r+y.rail.width+4}),y.railh&&!y.locked&&(n=t.top,r=t.left,e=y.railh.align?n+p(y.win,"border-top-width",!0)+y.win.innerHeight()-y.railh.height:n+p(y.win,"border-top-width",!0),r+=p(y.win,"border-left-width"),y.railh.css({top:e,left:r,width:y.railh.width}))}},this.doRailClick=function(e,t,n){var r;y.locked||(y.cancelEvent(e),t?(t=n?y.doScrollLeft:y.doScrollTop,r=n?(e.pageX-y.railh.offset().left-y.cursorwidth/2)*y.scrollratio.x:(e.pageY-y.rail.offset().top-y.cursorheight/2)*y.scrollratio.y,t(r)):(t=n?y.doScrollLeftBy:y.doScrollBy,r=n?y.scroll.x:y.scroll.y,e=n?e.pageX-y.railh.offset().left:e.pageY-y.rail.offset().top,n=n?y.view.w:y.view.h,r>=e?t(n):t(-n)))},y.hasanimationframe=u,y.hascancelanimationframe=a,y.hasanimationframe?y.hascancelanimationframe||(a=function(){y.cancelAnimationFrame=!0}):(u=function(e){return setTimeout(e,15-Math.floor(+(new Date)/1e3)%16)},a=clearInterval),this.init=function(){y.saved.css=[];if(w.isie7mobile||w.isoperamini)return!0;w.hasmstouch&&y.css(y.ispage?e("html"):y.win,{"-ms-touch-action":"none"}),y.zindex="auto",y.zindex=!y.ispage&&"auto"==y.opt.zindex?l()||"auto":y.opt.zindex,!y.ispage&&"auto"!=y.zindex&&y.zindex>s&&(s=y.zindex),y.isie&&0==y.zindex&&"auto"==y.opt.zindex&&(y.zindex="auto");if(!y.ispage||!w.cantouch&&!w.isieold&&!w.isie9mobile){var i=y.docscroll;y.ispage&&(i=y.haswrapper?y.win:y.doc),w.isie9mobile||y.css(i,{"overflow-y":"hidden"}),y.ispage&&w.isie7&&("BODY"==y.doc[0].nodeName?y.css(e("html"),{"overflow-y":"hidden"}):"HTML"==y.doc[0].nodeName&&y.css(e("body"),{"overflow-y":"hidden"})),w.isios&&!y.ispage&&!y.haswrapper&&y.css(e("body"),{"-webkit-overflow-scrolling":"touch"});var o=e(document.createElement("div"));o.css({position:"relative",top:0,"float":"right",width:y.opt.cursorwidth,height:"0px","background-color":y.opt.cursorcolor,border:y.opt.cursorborder,"background-clip":"padding-box","-webkit-border-radius":y.opt.cursorborderradius,"-moz-border-radius":y.opt.cursorborderradius,"border-radius":y.opt.cursorborderradius}),o.hborder=parseFloat(o.outerHeight()-o.innerHeight()),y.cursor=o;var u=e(document.createElement("div"));u.attr("id",y.id),u.addClass("nicescroll-rails");var a,f,h=["left","right"],p;for(p in h)f=h[p],(a=y.opt.railpadding[f])?u.css("padding-"+f,a+"px"):y.opt.railpadding[f]=0;u.append(o),u.width=Math.max(parseFloat(y.opt.cursorwidth),o.outerWidth())+y.opt.railpadding.left+y.opt.railpadding.right,u.css({width:u.width+"px",zIndex:y.zindex,background:y.opt.background,cursor:"default"}),u.visibility=!0,u.scrollable=!0,u.align="left"==y.opt.railalign?0:1,y.rail=u,o=y.rail.drag=!1,y.opt.boxzoom&&!y.ispage&&!w.isieold&&(o=document.createElement("div"),y.bind(o,"click",y.doZoom),y.zoom=e(o),y.zoom.css({cursor:"pointer","z-index":y.zindex,backgroundImage:"url("+y.opt.scriptpath+"zoomico.png)",height:18,width:18,backgroundPosition:"0px 0px"}),y.opt.dblclickzoom&&y.bind(y.win,"dblclick",y.doZoom),w.cantouch&&y.opt.gesturezoom&&(y.ongesturezoom=function(e){return 1.5<e.scale&&y.doZoomIn(e),.8>e.scale&&y.doZoomOut(e),y.cancelEvent(e)},y.bind(y.win,"gestureend",y.ongesturezoom))),y.railh=!1;if(y.opt.horizrailenabled){y.css(i,{"overflow-x":"hidden"}),o=e(document.createElement("div")),o.css({position:"relative",top:0,height:y.opt.cursorwidth,width:"0px","background-color":y.opt.cursorcolor,border:y.opt.cursorborder,"background-clip":"padding-box","-webkit-border-radius":y.opt.cursorborderradius,"-moz-border-radius":y.opt.cursorborderradius,"border-radius":y.opt.cursorborderradius}),o.wborder=parseFloat(o.outerWidth()-o.innerWidth()),y.cursorh=o;var d=e(document.createElement("div"));d.attr("id",y.id+"-hr"),d.addClass("nicescroll-rails"),d.height=Math.max(parseFloat(y.opt.cursorwidth),o.outerHeight()),d.css({height:d.height+"px",zIndex:y.zindex,background:y.opt.background}),d.append(o),d.visibility=!0,d.scrollable=!0,d.align="top"==y.opt.railvalign?0:1,y.railh=d,y.railh.drag=!1}y.ispage?(u.css({position:"fixed",top:"0px",height:"100%"}),u.align?u.css({right:"0px"}):u.css({left:"0px"}),y.body.append(u),y.railh&&(d.css({position:"fixed",left:"0px",width:"100%"}),d.align?d.css({bottom:"0px"}):d.css({top:"0px"}),y.body.append(d))):(y.ishwscroll?("static"==y.win.css("position")&&y.css(y.win,{position:"relative"}),i="HTML"==y.win[0].nodeName?y.body:y.win,y.zoom&&(y.zoom.css({position:"absolute",top:1,right:0,"margin-right":u.width+4}),i.append(y.zoom)),u.css({position:"absolute",top:0}),u.align?u.css({right:0}):u.css({left:0}),i.append(u),d&&(d.css({position:"absolute",left:0,bottom:0}),d.align?d.css({bottom:0}):d.css({top:0}),i.append(d))):(y.isfixed="fixed"==y.win.css("position"),i=y.isfixed?"fixed":"absolute",y.isfixed||(y.viewport=y.getViewport(y.win[0])),y.viewport&&(y.body=y.viewport,0==/fixed|relative|absolute/.test(y.viewport.css("position"))&&y.css(y.viewport,{position:"relative"})),u.css({position:i}),y.zoom&&y.zoom.css({position:i}),y.updateScrollBar(),y.body.append(u),y.zoom&&y.body.append(y.zoom),y.railh&&(d.css({position:i}),y.body.append(d))),w.isios&&y.css(y.win,{"-webkit-tap-highlight-color":"rgba(0,0,0,0)","-webkit-touch-callout":"none"}),w.isie&&y.opt.disableoutline&&y.win.attr("hideFocus","true"),w.iswebkit&&y.opt.disableoutline&&y.win.css({outline:"none"})),!1===y.opt.autohidemode?(y.autohidedom=!1,y.rail.css({opacity:y.opt.cursoropacitymax}),y.railh&&y.railh.css({opacity:y.opt.cursoropacitymax})):!0===y.opt.autohidemode||"leave"===y.opt.autohidemode?(y.autohidedom=e().add(y.rail),w.isie8&&(y.autohidedom=y.autohidedom.add(y.cursor)),y.railh&&(y.autohidedom=y.autohidedom.add(y.railh)),y.railh&&w.isie8&&(y.autohidedom=y.autohidedom.add(y.cursorh))):"scroll"==y.opt.autohidemode?(y.autohidedom=e().add(y.rail),y.railh&&(y.autohidedom=y.autohidedom.add(y.railh))):"cursor"==y.opt.autohidemode?(y.autohidedom=e().add(y.cursor),y.railh&&(y.autohidedom=y.autohidedom.add(y.cursorh))):"hidden"==y.opt.autohidemode&&(y.autohidedom=!1,y.hide(),y.locked=!1);if(w.isie9mobile)y.scrollmom=new m(y),y.onmangotouch=function(e){e=y.getScrollTop();var t=y.getScrollLeft();if(e==y.scrollmom.lastscrolly&&t==y.scrollmom.lastscrollx)return!0;var n=e-y.mangotouch.sy,r=t-y.mangotouch.sx;if(0!=Math.round(Math.sqrt(Math.pow(r,2)+Math.pow(n,2)))){var i=0>n?-1:1,s=0>r?-1:1,o=+(new Date);y.mangotouch.lazy&&clearTimeout(y.mangotouch.lazy),80<o-y.mangotouch.tm||y.mangotouch.dry!=i||y.mangotouch.drx!=s?(y.scrollmom.stop(),y.scrollmom.reset(t,e),y.mangotouch.sy=e,y.mangotouch.ly=e,y.mangotouch.sx=t,y.mangotouch.lx=t,y.mangotouch.dry=i,y.mangotouch.drx=s,y.mangotouch.tm=o):(y.scrollmom.stop(),y.scrollmom.update(y.mangotouch.sx-r,y.mangotouch.sy-n),y.mangotouch.tm=o,n=Math.max(Math.abs(y.mangotouch.ly-e),Math.abs(y.mangotouch.lx-t)),y.mangotouch.ly=e,y.mangotouch.lx=t,2<n&&(y.mangotouch.lazy=setTimeout(function(){y.mangotouch.lazy=!1,y.mangotouch.dry=0,y.mangotouch.drx=0,y.mangotouch.tm=0,y.scrollmom.doMomentum(30)},100)))}},u=y.getScrollTop(),d=y.getScrollLeft(),y.mangotouch={sy:u,ly:u,dry:0,sx:d,lx:d,drx:0,lazy:!1,tm:0},y.bind(y.docscroll,"scroll",y.onmangotouch);else{if(w.cantouch||y.istouchcapable||y.opt.touchbehavior||w.hasmstouch){y.scrollmom=new m(y),y.ontouchstart=function(t){if(t.pointerType&&2!=t.pointerType)return!1;y.hasmoving=!1;if(!y.locked){if(w.hasmstouch)for(var n=t.target?t.target:!1;n;){var r=e(n).getNiceScroll();if(0<r.length&&r[0].me==y.me)break;if(0<r.length)return!1;if("DIV"==n.nodeName&&n.id==y.id)break;n=n.parentNode?n.parentNode:!1}y.cancelScroll();if((n=y.getTarget(t))&&/INPUT/i.test(n.nodeName)&&/range/i.test(n.type))return y.stopPropagation(t);!("clientX"in t)&&"changedTouches"in t&&(t.clientX=t.changedTouches[0].clientX,t.clientY=t.changedTouches[0].clientY),y.forcescreen&&(r=t,t={original:t.original?t.original:t},t.clientX=r.screenX,t.clientY=r.screenY),y.rail.drag={x:t.clientX,y:t.clientY,sx:y.scroll.x,sy:y.scroll.y,st:y.getScrollTop(),sl:y.getScrollLeft(),pt:2,dl:!1};if(y.ispage||!y.opt.directionlockdeadzone)y.rail.drag.dl="f";else{var r=e(window).width(),i=e(window).height(),s=Math.max(document.body.scrollWidth,document.documentElement.scrollWidth),o=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight),i=Math.max(0,o-i),r=Math.max(0,s-r);y.rail.drag.ck=!y.rail.scrollable&&y.railh.scrollable?0<i?"v":!1:y.rail.scrollable&&!y.railh.scrollable?0<r?"h":!1:!1,y.rail.drag.ck||(y.rail.drag.dl="f")}y.opt.touchbehavior&&y.isiframe&&w.isie&&(r=y.win.position(),y.rail.drag.x+=r.left,y.rail.drag.y+=r.top),y.hasmoving=!1,y.lastmouseup=!1,y.scrollmom.reset(t.clientX,t.clientY);if(!w.cantouch&&!this.istouchcapable&&!w.hasmstouch){if(!n||!/INPUT|SELECT|TEXTAREA/i.test(n.nodeName))return!y.ispage&&w.hasmousecapture&&n.setCapture(),y.opt.touchbehavior?(n.onclick&&!n._onclick&&(n._onclick=n.onclick,n.onclick=function(e){if(y.hasmoving)return!1;n._onclick.call(this,e)}),y.cancelEvent(t)):y.stopPropagation(t);/SUBMIT|CANCEL|BUTTON/i.test(e(n).attr("type"))&&(pc={tg:n,click:!1},y.preventclick=pc)}}},y.ontouchend=function(e){if(e.pointerType&&2!=e.pointerType)return!1;if(y.rail.drag&&2==y.rail.drag.pt&&(y.scrollmom.doMomentum(),y.rail.drag=!1,y.hasmoving&&(y.lastmouseup=!0,y.hideCursor(),w.hasmousecapture&&document.releaseCapture(),!w.cantouch)))return y.cancelEvent(e)};var v=y.opt.touchbehavior&&y.isiframe&&!w.hasmousecapture;y.ontouchmove=function(t,n){if(t.pointerType&&2!=t.pointerType)return!1;if(y.rail.drag&&2==y.rail.drag.pt){if(w.cantouch&&"undefined"==typeof t.original)return!0;y.hasmoving=!0,y.preventclick&&!y.preventclick.click&&(y.preventclick.click=y.preventclick.tg.onclick||!1,y.preventclick.tg.onclick=y.onpreventclick),t=e.extend({original:t},t),"changedTouches"in t&&(t.clientX=t.changedTouches[0].clientX,t.clientY=t.changedTouches[0].clientY);if(y.forcescreen){var r=t;t={original:t.original?t.original:t},t.clientX=r.screenX,t.clientY=r.screenY}r=ofy=0;if(v&&!n){var i=y.win.position(),r=-i.left;ofy=-i.top}var s=t.clientY+ofy,i=s-y.rail.drag.y,o=t.clientX+r,u=o-y.rail.drag.x,a=y.rail.drag.st-i;y.ishwscroll&&y.opt.bouncescroll?0>a?a=Math.round(a/2):a>y.page.maxh&&(a=y.page.maxh+Math.round((a-y.page.maxh)/2)):(0>a&&(s=a=0),a>y.page.maxh&&(a=y.page.maxh,s=0));if(y.railh&&y.railh.scrollable){var f=y.rail.drag.sl-u;y.ishwscroll&&y.opt.bouncescroll?0>f?f=Math.round(f/2):f>y.page.maxw&&(f=y.page.maxw+Math.round((f-y.page.maxw)/2)):(0>f&&(o=f=0),f>y.page.maxw&&(f=y.page.maxw,o=0))}r=!1;if(y.rail.drag.dl)r=!0,"v"==y.rail.drag.dl?f=y.rail.drag.sl:"h"==y.rail.drag.dl&&(a=y.rail.drag.st);else{var i=Math.abs(i),u=Math.abs(u),l=y.opt.directionlockdeadzone;if("v"==y.rail.drag.ck){if(i>l&&u<=.3*i)return y.rail.drag=!1,!0;u>l&&(y.rail.drag.dl="f",e("body").scrollTop(e("body").scrollTop()))}else if("h"==y.rail.drag.ck){if(u>l&&i<=.3*u)return y.rail.drag=!1,!0;i>l&&(y.rail.drag.dl="f",e("body").scrollLeft(e("body").scrollLeft()))}}y.synched("touchmove",function(){y.rail.drag&&2==y.rail.drag.pt&&(y.prepareTransition&&y.prepareTransition(0),y.rail.scrollable&&y.setScrollTop(a),y.scrollmom.update(o,s),y.railh&&y.railh.scrollable?(y.setScrollLeft(f),y.showCursor(a,f)):y.showCursor(a),w.isie10&&document.selection.clear())}),w.ischrome&&y.istouchcapable&&(r=!1);if(r)return y.cancelEvent(t)}}}y.onmousedown=function(e,t){if(!y.rail.drag||1==y.rail.drag.pt){if(y.locked)return y.cancelEvent(e);y.cancelScroll(),y.rail.drag={x:e.clientX,y:e.clientY,sx:y.scroll.x,sy:y.scroll.y,pt:1,hr:!!t};var n=y.getTarget(e);return!y.ispage&&w.hasmousecapture&&n.setCapture(),y.isiframe&&!w.hasmousecapture&&(y.saved.csspointerevents=y.doc.css("pointer-events"),y.css(y.doc,{"pointer-events":"none"})),y.hasmoving=!1,y.cancelEvent(e)}},y.onmouseup=function(e){if(y.rail.drag&&(w.hasmousecapture&&document.releaseCapture(),y.isiframe&&!w.hasmousecapture&&y.doc.css("pointer-events",y.saved.csspointerevents),1==y.rail.drag.pt))return y.rail.drag=!1,y.hasmoving&&y.triggerScrollEnd(),y.cancelEvent(e)},y.onmousemove=function(e){if(y.rail.drag&&1==y.rail.drag.pt){if(w.ischrome&&0==e.which)return y.onmouseup(e);y.cursorfreezed=!0,y.hasmoving=!0;if(y.rail.drag.hr){y.scroll.x=y.rail.drag.sx+(e.clientX-y.rail.drag.x),0>y.scroll.x&&(y.scroll.x=0);var t=y.scrollvaluemaxw;y.scroll.x>t&&(y.scroll.x=t)}else y.scroll.y=y.rail.drag.sy+(e.clientY-y.rail.drag.y),0>y.scroll.y&&(y.scroll.y=0),t=y.scrollvaluemax,y.scroll.y>t&&(y.scroll.y=t);return y.synched("mousemove",function(){y.rail.drag&&1==y.rail.drag.pt&&(y.showCursor(),y.rail.drag.hr?y.doScrollLeft(Math.round(y.scroll.x*y.scrollratio.x),y.opt.cursordragspeed):y.doScrollTop(Math.round(y.scroll.y*y.scrollratio.y),y.opt.cursordragspeed))}),y.cancelEvent(e)}};if(w.cantouch||y.opt.touchbehavior)y.onpreventclick=function(e){if(y.preventclick)return y.preventclick.tg.onclick=y.preventclick.click,y.preventclick=!1,y.cancelEvent(e)},y.bind(y.win,"mousedown",y.ontouchstart),y.onclick=w.isios?!1:function(e){return y.lastmouseup?(y.lastmouseup=!1,y.cancelEvent(e)):!0},y.opt.grabcursorenabled&&w.cursorgrabvalue&&(y.css(y.ispage?y.doc:y.win,{cursor:w.cursorgrabvalue}),y.css(y.rail,{cursor:w.cursorgrabvalue}));else{var g=function(e){if(y.selectiondrag){if(e){var t=y.win.outerHeight();e=e.pageY-y.selectiondrag.top,0<e&&e<t&&(e=0),e>=t&&(e-=t),y.selectiondrag.df=e}0!=y.selectiondrag.df&&(y.doScrollBy(2*-Math.floor(y.selectiondrag.df/6)),y.debounced("doselectionscroll",function(){g()},50))}};y.hasTextSelected="getSelection"in document?function(){return 0<document.getSelection().rangeCount}:"selection"in document?function(){return"None"!=document.selection.type}:function(){return!1},y.onselectionstart=function(e){y.ispage||(y.selectiondrag=y.win.offset())},y.onselectionend=function(e){y.selectiondrag=!1},y.onselectiondrag=function(e){y.selectiondrag&&y.hasTextSelected()&&y.debounced("selectionscroll",function(){g(e)},250)}}w.hasmstouch&&(y.css(y.rail,{"-ms-touch-action":"none"}),y.css(y.cursor,{"-ms-touch-action":"none"}),y.bind(y.win,"MSPointerDown",y.ontouchstart),y.bind(document,"MSPointerUp",y.ontouchend),y.bind(document,"MSPointerMove",y.ontouchmove),y.bind(y.cursor,"MSGestureHold",function(e){e.preventDefault()}),y.bind(y.cursor,"contextmenu",function(e){e.preventDefault()})),this.istouchcapable&&(y.bind(y.win,"touchstart",y.ontouchstart),y.bind(document,"touchend",y.ontouchend),y.bind(document,"touchcancel",y.ontouchend),y.bind(document,"touchmove",y.ontouchmove)),y.bind(y.cursor,"mousedown",y.onmousedown),y.bind(y.cursor,"mouseup",y.onmouseup),y.railh&&(y.bind(y.cursorh,"mousedown",function(e){y.onmousedown(e,!0)}),y.bind(y.cursorh,"mouseup",y.onmouseup));if(y.opt.cursordragontouch||!w.cantouch&&!y.opt.touchbehavior)y.rail.css({cursor:"default"}),y.railh&&y.railh.css({cursor:"default"}),y.jqbind(y.rail,"mouseenter",function(){if(!y.win.is(":visible"))return!1;y.canshowonmouseevent&&y.showCursor(),y.rail.active=!0}),y.jqbind(y.rail,"mouseleave",function(){y.rail.active=!1,y.rail.drag||y.hideCursor()}),y.opt.sensitiverail&&(y.bind(y.rail,"click",function(e){y.doRailClick(e,!1,!1)}),y.bind(y.rail,"dblclick",function(e){y.doRailClick(e,!0,!1)}),y.bind(y.cursor,"click",function(e){y.cancelEvent(e)}),y.bind(y.cursor,"dblclick",function(e){y.cancelEvent(e)})),y.railh&&(y.jqbind(y.railh,"mouseenter",function(){if(!y.win.is(":visible"))return!1;y.canshowonmouseevent&&y.showCursor(),y.rail.active=!0}),y.jqbind(y.railh,"mouseleave",function(){y.rail.active=!1,y.rail.drag||y.hideCursor()}),y.opt.sensitiverail&&(y.bind(y.railh,"click",function(e){y.doRailClick(e,!1,!0)}),y.bind(y.railh,"dblclick",function(e){y.doRailClick(e,!0,!0)}),y.bind(y.cursorh,"click",function(e){y.cancelEvent(e)}),y.bind(y.cursorh,"dblclick",function(e){y.cancelEvent(e)})));!w.cantouch&&!y.opt.touchbehavior?(y.bind(w.hasmousecapture?y.win:document,"mouseup",y.onmouseup),y.bind(document,"mousemove",y.onmousemove),y.onclick&&y.bind(document,"click",y.onclick),!y.ispage&&y.opt.enablescrollonselection&&(y.bind(y.win[0],"mousedown",y.onselectionstart),y.bind(document,"mouseup",y.onselectionend),y.bind(y.cursor,"mouseup",y.onselectionend),y.cursorh&&y.bind(y.cursorh,"mouseup",y.onselectionend),y.bind(document,"mousemove",y.onselectiondrag)),y.zoom&&(y.jqbind(y.zoom,"mouseenter",function(){y.canshowonmouseevent&&y.showCursor(),y.rail.active=!0}),y.jqbind(y.zoom,"mouseleave",function(){y.rail.active=!1,y.rail.drag||y.hideCursor()}))):(y.bind(w.hasmousecapture?y.win:document,"mouseup",y.ontouchend),y.bind(document,"mousemove",y.ontouchmove),y.onclick&&y.bind(document,"click",y.onclick),y.opt.cursordragontouch&&(y.bind(y.cursor,"mousedown",y.onmousedown),y.bind(y.cursor,"mousemove",y.onmousemove),y.cursorh&&y.bind(y.cursorh,"mousedown",function(e){y.onmousedown(e,!0)}),y.cursorh&&y.bind(y.cursorh,"mousemove",y.onmousemove))),y.opt.enablemousewheel&&(y.isiframe||y.bind(w.isie&&y.ispage?document:y.win,"mousewheel",y.onmousewheel),y.bind(y.rail,"mousewheel",y.onmousewheel),y.railh&&y.bind(y.railh,"mousewheel",y.onmousewheelhr)),!y.ispage&&!w.cantouch&&!/HTML|^BODY/.test(y.win[0].nodeName)&&(y.win.attr("tabindex")||y.win.attr({tabindex:r++}),y.jqbind(y.win,"focus",function(e){t=y.getTarget(e).id||!0,y.hasfocus=!0,y.canshowonmouseevent&&y.noticeCursor()}),y.jqbind(y.win,"blur",function(e){t=!1,y.hasfocus=!1}),y.jqbind(y.win,"mouseenter",function(e){n=y.getTarget(e).id||!0,y.hasmousefocus=!0,y.canshowonmouseevent&&y.noticeCursor()}),y.jqbind(y.win,"mouseleave",function(){n=!1,y.hasmousefocus=!1,y.rail.drag||y.hideCursor()}))}y.onkeypress=function(r){if(y.locked&&0==y.page.maxh)return!0;r=r?r:window.e;var i=y.getTarget(r);if(i&&/INPUT|TEXTAREA|SELECT|OPTION/.test(i.nodeName)&&(!i.getAttribute("type")&&!i.type||!/submit|button|cancel/i.tp)||e(i).attr("contenteditable"))return!0;if(y.hasfocus||y.hasmousefocus&&!t||y.ispage&&!t&&!n){i=r.keyCode;if(y.locked&&27!=i)return y.cancelEvent(r);var s=r.ctrlKey||!1,o=r.shiftKey||!1,u=!1;switch(i){case 38:case 63233:y.doScrollBy(72),u=!0;break;case 40:case 63235:y.doScrollBy(-72),u=!0;break;case 37:case 63232:y.railh&&(s?y.doScrollLeft(0):y.doScrollLeftBy(72),u=!0);break;case 39:case 63234:y.railh&&(s?y.doScrollLeft(y.page.maxw):y.doScrollLeftBy(-72),u=!0);break;case 33:case 63276:y.doScrollBy(y.view.h),u=!0;break;case 34:case 63277:y.doScrollBy(-y.view.h),u=!0;break;case 36:case 63273:y.railh&&s?y.doScrollPos(0,0):y.doScrollTo(0),u=!0;break;case 35:case 63275:y.railh&&s?y.doScrollPos(y.page.maxw,y.page.maxh):y.doScrollTo(y.page.maxh),u=!0;break;case 32:y.opt.spacebarenabled&&(o?y.doScrollBy(y.view.h):y.doScrollBy(-y.view.h),u=!0);break;case 27:y.zoomactive&&(y.doZoom(),u=!0)}if(u)return y.cancelEvent(r)}},y.opt.enablekeyboard&&y.bind(document,w.isopera&&!w.isopera12?"keypress":"keydown",y.onkeypress),y.bind(document,"keydown",function(e){e.ctrlKey&&(y.wheelprevented=!0)}),y.bind(document,"keyup",function(e){e.ctrlKey||(y.wheelprevented=!1)}),y.bind(window,"resize",y.lazyResize),y.bind(window,"orientationchange",y.lazyResize),y.bind(window,"load",y.lazyResize);if(w.ischrome&&!y.ispage&&!y.haswrapper){var b=y.win.attr("style"),u=parseFloat(y.win.css("width"))+1;y.win.css("width",u),y.synched("chromefix",function(){y.win.attr("style",b)})}y.onAttributeChange=function(e){y.lazyResize(250)},!y.ispage&&!y.haswrapper&&(!1!==c?(y.observer=new c(function(e){e.forEach(y.onAttributeChange)}),y.observer.observe(y.win[0],{childList:!0,characterData:!1,attributes:!0,subtree:!1}),y.observerremover=new c(function(e){e.forEach(function(e){if(0<e.removedNodes.length)for(var t in e.removedNodes)if(e.removedNodes[t]==y.win[0])return y.remove()})}),y.observerremover.observe(y.win[0].parentNode,{childList:!0,characterData:!1,attributes:!1,subtree:!1})):(y.bind(y.win,w.isie&&!w.isie9?"propertychange":"DOMAttrModified",y.onAttributeChange),w.isie9&&y.win[0].attachEvent("onpropertychange",y.onAttributeChange),y.bind(y.win,"DOMNodeRemoved",function(e){e.target==y.win[0]&&y.remove()}))),!y.ispage&&y.opt.boxzoom&&y.bind(window,"resize",y.resizeZoom),y.istextarea&&y.bind(y.win,"mouseup",y.lazyResize),y.lazyResize(30)}if("IFRAME"==this.doc[0].nodeName){var E=function(t){y.iframexd=!1;try{var n="contentDocument"in this?this.contentDocument:this.contentWindow.document}catch(r){y.iframexd=!0,n=!1}if(y.iframexd)return"console"in window&&console.log("NiceScroll error: policy restriced iframe"),!0;y.forcescreen=!0,y.isiframe&&(y.iframe={doc:e(n),html:y.doc.contents().find("html")[0],body:y.doc.contents().find("body")[0]},y.getContentSize=function(){return{w:Math.max(y.iframe.html.scrollWidth,y.iframe.body.scrollWidth),h:Math.max(y.iframe.html.scrollHeight,y.iframe.body.scrollHeight)}},y.docscroll=e(y.iframe.body)),!w.isios&&y.opt.iframeautoresize&&!y.isiframe&&(y.win.scrollTop(0),y.doc.height(""),t=Math.max(n.getElementsByTagName("html")[0].scrollHeight,n.body.scrollHeight),y.doc.height(t)),y.lazyResize(30),w.isie7&&y.css(e(y.iframe.html),{"overflow-y":"hidden"}),y.css(e(y.iframe.body),{"overflow-y":"hidden"}),w.isios&&y.haswrapper&&y.css(e(n.body),{"-webkit-transform":"translate3d(0,0,0)"}),"contentWindow"in this?y.bind(this.contentWindow,"scroll",y.onscroll):y.bind(n,"scroll",y.onscroll),y.opt.enablemousewheel&&y.bind(n,"mousewheel",y.onmousewheel),y.opt.enablekeyboard&&y.bind(n,w.isopera?"keypress":"keydown",y.onkeypress);if(w.cantouch||y.opt.touchbehavior)y.bind(n,"mousedown",y.ontouchstart),y.bind(n,"mousemove",function(e){y.ontouchmove(e,!0)}),y.opt.grabcursorenabled&&w.cursorgrabvalue&&y.css(e(n.body),{cursor:w.cursorgrabvalue});y.bind(n,"mouseup",y.ontouchend),y.zoom&&(y.opt.dblclickzoom&&y.bind(n,"dblclick",y.doZoom),y.ongesturezoom&&y.bind(n,"gestureend",y.ongesturezoom))};this.doc[0].readyState&&"complete"==this.doc[0].readyState&&setTimeout(function(){E.call(y.doc[0],!1)},500),y.bind(this.doc,"load",E)}},this.showCursor=function(e,t){y.cursortimeout&&(clearTimeout(y.cursortimeout),y.cursortimeout=0);if(y.rail){y.autohidedom&&(y.autohidedom.stop().css({opacity:y.opt.cursoropacitymax}),y.cursoractive=!0);if(!y.rail.drag||1!=y.rail.drag.pt)"undefined"!=typeof e&&!1!==e&&(y.scroll.y=Math.round(1*e/y.scrollratio.y)),"undefined"!=typeof t&&(y.scroll.x=Math.round(1*t/y.scrollratio.x));y.cursor.css({height:y.cursorheight,top:y.scroll.y}),y.cursorh&&(!y.rail.align&&y.rail.visibility?y.cursorh.css({width:y.cursorwidth,left:y.scroll.x+y.rail.width}):y.cursorh.css({width:y.cursorwidth,left:y.scroll.x}),y.cursoractive=!0),y.zoom&&y.zoom.stop().css({opacity:y.opt.cursoropacitymax})}},this.hideCursor=function(e){!y.cursortimeout&&y.rail&&y.autohidedom&&(!y.hasmousefocus||"leave"!=y.opt.autohidemode)&&(y.cursortimeout=setTimeout(function(){if(!y.rail.active||!y.showonmouseevent)y.autohidedom.stop().animate({opacity:y.opt.cursoropacitymin}),y.zoom&&y.zoom.stop().animate({opacity:y.opt.cursoropacitymin}),y.cursoractive=!1;y.cursortimeout=0},e||y.opt.hidecursordelay))},this.noticeCursor=function(e,t,n){y.showCursor(t,n),y.rail.active||y.hideCursor(e)},this.getContentSize=y.ispage?function(){return{w:Math.max(document.body.scrollWidth,document.documentElement.scrollWidth),h:Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)}}:y.haswrapper?function(){return{w:y.doc.outerWidth()+parseInt(y.win.css("paddingLeft"))+parseInt(y.win.css("paddingRight")),h:y.doc.outerHeight()+parseInt(y.win.css("paddingTop"))+parseInt(y.win.css("paddingBottom"))}}:function(){return{w:y.docscroll[0].scrollWidth,h:y.docscroll[0].scrollHeight}},this.onResize=function(e,t){if(!y||!y.win)return!1;if(!y.haswrapper&&!y.ispage){if("none"==y.win.css("display"))return y.visibility&&y.hideRail().hideRailHr(),!1;!y.hidden&&!y.visibility&&y.showRail().showRailHr()}var n=y.page.maxh,r=y.page.maxw,i=y.view.w;y.view={w:y.ispage?y.win.width():parseInt(y.win[0].clientWidth),h:y.ispage?y.win.height():parseInt(y.win[0].clientHeight)},y.page=t?t:y.getContentSize(),y.page.maxh=Math.max(0,y.page.h-y.view.h),y.page.maxw=Math.max(0,y.page.w-y.view.w);if(y.page.maxh==n&&y.page.maxw==r&&y.view.w==i){if(y.ispage)return y;n=y.win.offset();if(y.lastposition&&(r=y.lastposition,r.top==n.top&&r.left==n.left))return y;y.lastposition=n}return 0==y.page.maxh?(y.hideRail(),y.scrollvaluemax=0,y.scroll.y=0,y.scrollratio.y=0,y.cursorheight=0,y.setScrollTop(0),y.rail.scrollable=!1):y.rail.scrollable=!0,0==y.page.maxw?(y.hideRailHr(),y.scrollvaluemaxw=0,y.scroll.x=0,y.scrollratio.x=0,y.cursorwidth=0,y.setScrollLeft(0),y.railh.scrollable=!1):y.railh.scrollable=!0,y.locked=0==y.page.maxh&&0==y.page.maxw,y.locked?(y.ispage||y.updateScrollBar(y.view),!1):(!y.hidden&&!y.visibility?y.showRail().showRailHr():!y.hidden&&!y.railh.visibility&&y.showRailHr(),y.istextarea&&y.win.css("resize")&&"none"!=y.win.css("resize")&&(y.view.h-=20),y.cursorheight=Math.min(y.view.h,Math.round(y.view.h*(y.view.h/y.page.h))),y.cursorheight=y.opt.cursorfixedheight?y.opt.cursorfixedheight:Math.max(y.opt.cursorminheight,y.cursorheight),y.cursorwidth=Math.min(y.view.w,Math.round(y.view.w*(y.view.w/y.page.w))),y.cursorwidth=y.opt.cursorfixedheight?y.opt.cursorfixedheight:Math.max(y.opt.cursorminheight,y.cursorwidth),y.scrollvaluemax=y.view.h-y.cursorheight-y.cursor.hborder,y.railh&&(y.railh.width=0<y.page.maxh?y.view.w-y.rail.width:y.view.w,y.scrollvaluemaxw=y.railh.width-y.cursorwidth-y.cursorh.wborder),y.ispage||y.updateScrollBar(y.view),y.scrollratio={x:y.page.maxw/y.scrollvaluemaxw,y:y.page.maxh/y.scrollvaluemax},y.getScrollTop()>y.page.maxh?y.doScrollTop(y.page.maxh):(y.scroll.y=Math.round(y.getScrollTop()*(1/y.scrollratio.y)),y.scroll.x=Math.round(y.getScrollLeft()*(1/y.scrollratio.x)),y.cursoractive&&y.noticeCursor()),y.scroll.y&&0==y.getScrollTop()&&y.doScrollTo(Math.floor(y.scroll.y*y.scrollratio.y)),y)},this.resize=y.onResize,this.lazyResize=function(e){return e=isNaN(e)?30:e,y.delayed("resize",y.resize,e),y},this._bind=function(e,t,n,r){y.events.push({e:e,n:t,f:n,b:r,q:!1}),e.addEventListener?e.addEventListener(t,n,r||!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n},this.jqbind=function(t,n,r){y.events.push({e:t,n:n,f:r,q:!0}),e(t).bind(n,r)},this.bind=function(e,t,n,r){var i="jquery"in e?e[0]:e;"mousewheel"==t?"onwheel"in y.win?y._bind(i,"wheel",n,r||!1):(e="undefined"!=typeof document.onmousewheel?"mousewheel":"DOMMouseScroll",v(i,e,n,r||!1),"DOMMouseScroll"==e&&v(i,"MozMousePixelScroll",n,r||!1)):i.addEventListener?(w.cantouch&&/mouseup|mousedown|mousemove/.test(t)&&y._bind(i,"mousedown"==t?"touchstart":"mouseup"==t?"touchend":"touchmove",function(e){if(e.touches){if(2>e.touches.length){var t=e.touches.length?e.touches[0]:e;t.original=e,n.call(this,t)}}else e.changedTouches&&(t=e.changedTouches[0],t.original=e,n.call(this,t))},r||!1),y._bind(i,t,n,r||!1),w.cantouch&&"mouseup"==t&&y._bind(i,"touchcancel",n,r||!1)):y._bind(i,t,function(e){return(e=e||window.event||!1)&&e.srcElement&&(e.target=e.srcElement),"pageY"in e||(e.pageX=e.clientX+document.documentElement.scrollLeft,e.pageY=e.clientY+document.documentElement.scrollTop),!1===n.call(i,e)||!1===r?y.cancelEvent(e):!0})},this._unbind=function(e,t,n,r){e.removeEventListener?e.removeEventListener(t,n,r):e.detachEvent?e.detachEvent("on"+t,n):e["on"+t]=!1},this.unbindAll=function(){for(var e=0;e<y.events.length;e++){var t=y.events[e];t.q?t.e.unbind(t.n,t.f):y._unbind(t.e,t.n,t.f,t.b)}},this.cancelEvent=function(e){return e=e.original?e.original:e?e:window.event||!1,e?(e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.preventManipulation&&e.preventManipulation(),e.cancelBubble=!0,e.cancel=!0,e.returnValue=!1):!1},this.stopPropagation=function(e){return e=e.original?e.original:e?e:window.event||!1,e?e.stopPropagation?e.stopPropagation():(e.cancelBubble&&(e.cancelBubble=!0),!1):!1},this.showRail=function(){return 0!=y.page.maxh&&(y.ispage||"none"!=y.win.css("display"))&&(y.visibility=!0,y.rail.visibility=!0,y.rail.css("display","block")),y},this.showRailHr=function(){return y.railh?(0!=y.page.maxw&&(y.ispage||"none"!=y.win.css("display"))&&(y.railh.visibility=!0,y.railh.css("display","block")),y):y},this.hideRail=function(){return y.visibility=!1,y.rail.visibility=!1,y.rail.css("display","none"),y},this.hideRailHr=function(){return y.railh?(y.railh.visibility=!1,y.railh.css("display","none"),y):y},this.show=function(){return y.hidden=!1,y.locked=!1,y.showRail().showRailHr()},this.hide=function(){return y.hidden=!0,y.locked=!0,y.hideRail().hideRailHr()},this.toggle=function(){return y.hidden?y.show():y.hide()},this.remove=function(){y.stop(),y.cursortimeout&&clearTimeout(y.cursortimeout),y.doZoomOut(),y.unbindAll(),w.isie9&&y.win[0].detachEvent("onpropertychange",y.onAttributeChange),!1!==y.observer&&y.observer.disconnect(),!1!==y.observerremover&&y.observerremover.disconnect(),y.events=null,y.cursor&&y.cursor.remove(),y.cursorh&&y.cursorh.remove(),y.rail&&y.rail.remove(),y.railh&&y.railh.remove(),y.zoom&&y.zoom.remove();for(var t=0;t<y.saved.css.length;t++){var n=y.saved.css[t];n[0].css(n[1],"undefined"==typeof n[2]?"":n[2])}y.saved=!1,y.me.data("__nicescroll","");var r=e.nicescroll;r.each(function(e){if(this&&this.id===y.id){delete r[e];for(var t=++e;t<r.length;t++,e++)r[e]=r[t];r.length--,r.length&&delete r[r.length]}});for(var i in y)y[i]=null,delete y[i];y=null},this.scrollstart=function(e){return this.onscrollstart=e,y},this.scrollend=function(e){return this.onscrollend=e,y},this.scrollcancel=function(e){return this.onscrollcancel=e,y},this.zoomin=function(e){return this.onzoomin=e,y},this.zoomout=function(e){return this.onzoomout=e,y},this.isScrollable=function(t){t=t.target?t.target:t;if("OPTION"==t.nodeName)return!0;for(;t&&1==t.nodeType&&!/^BODY|HTML/.test(t.nodeName);){var n=e(t),n=n.css("overflowY")||n.css("overflowX")||n.css("overflow")||"";if(/scroll|auto/.test(n))return t.clientHeight!=t.scrollHeight;t=t.parentNode?t.parentNode:!1}return!1},this.getViewport=function(t){for(t=t&&t.parentNode?t.parentNode:!1;t&&1==t.nodeType&&!/^BODY|HTML/.test(t.nodeName);){var n=e(t);if(/fixed|absolute/.test(n.css("position")))return n;var r=n.css("overflowY")||n.css("overflowX")||n.css("overflow")||"";if(/scroll|auto/.test(r)&&t.clientHeight!=t.scrollHeight||0<n.getNiceScroll().length)return n;t=t.parentNode?t.parentNode:!1}return t?e(t):!1},this.triggerScrollEnd=function(){if(y.onscrollend){var e=y.getScrollLeft(),t=y.getScrollTop();y.onscrollend.call(y,{type:"scrollend",current:{x:e,y:t},end:{x:e,y:t}})}},this.onmousewheel=function(e){if(!y.wheelprevented){if(y.locked)return y.debounced("checkunlock",y.resize,250),!0;if(y.rail.drag)return y.cancelEvent(e);"auto"==y.opt.oneaxismousemode&&0!=e.deltaX&&(y.opt.oneaxismousemode=!1);if(y.opt.oneaxismousemode&&0==e.deltaX&&!y.rail.scrollable)return y.railh&&y.railh.scrollable?y.onmousewheelhr(e):!0;var t=+(new Date),n=!1;y.opt.preservenativescrolling&&y.checkarea+600<t&&(y.nativescrollingarea=y.isScrollable(e),n=!0),y.checkarea=t;if(y.nativescrollingarea)return!0;if(e=g(e,!1,n))y.checkarea=0;return e}},this.onmousewheelhr=function(e){if(!y.wheelprevented){if(y.locked||!y.railh.scrollable)return!0;if(y.rail.drag)return y.cancelEvent(e);var t=+(new Date),n=!1;return y.opt.preservenativescrolling&&y.checkarea+600<t&&(y.nativescrollingarea=y.isScrollable(e),n=!0),y.checkarea=t,y.nativescrollingarea?!0:y.locked?y.cancelEvent(e):g(e,!0,n)}},this.stop=function(){return y.cancelScroll(),y.scrollmon&&y.scrollmon.stop(),y.cursorfreezed=!1,y.scroll.y=Math.round(y.getScrollTop()*(1/y.scrollratio.y)),y.noticeCursor(),y},this.getTransitionSpeed=function(e){var t=Math.round(10*y.opt.scrollspeed);return e=Math.min(t,Math.round(e/20*y.opt.scrollspeed)),20<e?e:0},y.opt.smoothscroll?y.ishwscroll&&w.hastransition&&y.opt.usetransition?(this.prepareTransition=function(e,t){var n=t?20<e?e:0:y.getTransitionSpeed(e),r=n?w.prefixstyle+"transform "+n+"ms ease-out":"";if(!y.lasttransitionstyle||y.lasttransitionstyle!=r)y.lasttransitionstyle=r,y.doc.css(w.transitionstyle,r);return n},this.doScrollLeft=function(e,t){var n=y.scrollrunning?y.newscrolly:y.getScrollTop();y.doScrollPos(e,n,t)},this.doScrollTop=function(e,t){var n=y.scrollrunning?y.newscrollx:y.getScrollLeft();y.doScrollPos(n,e,t)},this.doScrollPos=function(e,t,n){var r=y.getScrollTop(),i=y.getScrollLeft();(0>(y.newscrolly-r)*(t-r)||0>(y.newscrollx-i)*(e-i))&&y.cancelScroll(),0==y.opt.bouncescroll&&(0>t?t=0:t>y.page.maxh&&(t=y.page.maxh),0>e?e=0:e>y.page.maxw&&(e=y.page.maxw));if(y.scrollrunning&&e==y.newscrollx&&t==y.newscrolly)return!1;y.newscrolly=t,y.newscrollx=e,y.newscrollspeed=n||!1;if(y.timer)return!1;y.timer=setTimeout(function(){var n=y.getScrollTop(),r=y.getScrollLeft(),i,s;i=e-r,s=t-n,i=Math.round(Math.sqrt(Math.pow(i,2)+Math.pow(s,2))),i=y.newscrollspeed&&1<y.newscrollspeed?y.newscrollspeed:y.getTransitionSpeed(i),y.newscrollspeed&&1>=y.newscrollspeed&&(i*=y.newscrollspeed),y.prepareTransition(i,!0),y.timerscroll&&y.timerscroll.tm&&clearInterval(y.timerscroll.tm),0<i&&(!y.scrollrunning&&y.onscrollstart&&y.onscrollstart.call(y,{type:"scrollstart",current:{x:r,y:n},request:{x:e,y:t},end:{x:y.newscrollx,y:y.newscrolly},speed:i}),w.transitionend?y.scrollendtrapped||(y.scrollendtrapped=!0,y.bind(y.doc,w.transitionend,y.onScrollTransitionEnd,!1)):(y.scrollendtrapped&&clearTimeout(y.scrollendtrapped),y.scrollendtrapped=setTimeout(y.onScrollTransitionEnd,i)),y.timerscroll={bz:new BezierClass(n,y.newscrolly,i,0,0,.58,1),bh:new BezierClass(r,y.newscrollx,i,0,0,.58,1)},y.cursorfreezed||(y.timerscroll.tm=setInterval(function(){y.showCursor(y.getScrollTop(),y.getScrollLeft())},60))),y.synched("doScroll-set",function(){y.timer=0,y.scrollendtrapped&&(y.scrollrunning=!0),y.setScrollTop(y.newscrolly),y.setScrollLeft(y.newscrollx),y.scrollendtrapped||y.onScrollTransitionEnd()})},50)},this.cancelScroll=function(){if(!y.scrollendtrapped)return!0;var e=y.getScrollTop(),t=y.getScrollLeft();return y.scrollrunning=!1,w.transitionend||clearTimeout(w.transitionend),y.scrollendtrapped=!1,y._unbind(y.doc,w.transitionend,y.onScrollTransitionEnd),y.prepareTransition(0),y.setScrollTop(e),y.railh&&y.setScrollLeft(t),y.timerscroll&&y.timerscroll.tm&&clearInterval(y.timerscroll.tm),y.timerscroll=!1,y.cursorfreezed=!1,y.showCursor(e,t),y},this.onScrollTransitionEnd=function(){y.scrollendtrapped&&y._unbind(y.doc,w.transitionend,y.onScrollTransitionEnd),y.scrollendtrapped=!1,y.prepareTransition(0),y.timerscroll&&y.timerscroll.tm&&clearInterval(y.timerscroll.tm),y.timerscroll=!1;var e=y.getScrollTop(),t=y.getScrollLeft();y.setScrollTop(e),y.railh&&y.setScrollLeft(t),y.noticeCursor(!1,e,t),y.cursorfreezed=!1,0>e?e=0:e>y.page.maxh&&(e=y.page.maxh),0>t?t=0:t>y.page.maxw&&(t=y.page.maxw);if(e!=y.newscrolly||t!=y.newscrollx)return y.doScrollPos(t,e,y.opt.snapbackspeed);y.onscrollend&&y.scrollrunning&&y.triggerScrollEnd(),y.scrollrunning=!1}):(this.doScrollLeft=function(e,t){var n=y.scrollrunning?y.newscrolly:y.getScrollTop();y.doScrollPos(e,n,t)},this.doScrollTop=function(e,t){var n=y.scrollrunning?y.newscrollx:y.getScrollLeft();y.doScrollPos(n,e,t)},this.doScrollPos=function(e,t,n){function r(){if(y.cancelAnimationFrame)return!0;y.scrollrunning=!0;if(c=1-c)return y.timer=u(r)||1;var e=0,t=sy=y.getScrollTop();if(y.dst.ay){var t=y.bzscroll?y.dst.py+y.bzscroll.getNow()*y.dst.ay:y.newscrolly,n=t-sy;if(0>n&&t<y.newscrolly||0<n&&t>y.newscrolly)t=y.newscrolly;y.setScrollTop(t),t==y.newscrolly&&(e=1)}else e=1;var i=sx=y.getScrollLeft();if(y.dst.ax){i=y.bzscroll?y.dst.px+y.bzscroll.getNow()*y.dst.ax:y.newscrollx,n=i-sx;if(0>n&&i<y.newscrollx||0<n&&i>y.newscrollx)i=y.newscrollx;y.setScrollLeft(i),i==y.newscrollx&&(e+=1)}else e+=1;2==e?(y.timer=0,y.cursorfreezed=!1,y.bzscroll=!1,y.scrollrunning=!1,0>t?t=0:t>y.page.maxh&&(t=y.page.maxh),0>i?i=0:i>y.page.maxw&&(i=y.page.maxw),i!=y.newscrollx||t!=y.newscrolly?y.doScrollPos(i,t):y.onscrollend&&y.triggerScrollEnd()):y.timer=u(r)||1}t="undefined"==typeof t||!1===t?y.getScrollTop(!0):t;if(y.timer&&y.newscrolly==t&&y.newscrollx==e)return!0;y.timer&&a(y.timer),y.timer=0;var i=y.getScrollTop(),s=y.getScrollLeft();(0>(y.newscrolly-i)*(t-i)||0>(y.newscrollx-s)*(e-s))&&y.cancelScroll(),y.newscrolly=t,y.newscrollx=e;if(!y.bouncescroll||!y.rail.visibility)0>y.newscrolly?y.newscrolly=0:y.newscrolly>y.page.maxh&&(y.newscrolly=y.page.maxh);if(!y.bouncescroll||!y.railh.visibility)0>y.newscrollx?y.newscrollx=0:y.newscrollx>y.page.maxw&&(y.newscrollx=y.page.maxw);y.dst={},y.dst.x=e-s,y.dst.y=t-i,y.dst.px=s,y.dst.py=i;var o=Math.round(Math.sqrt(Math.pow(y.dst.x,2)+Math.pow(y.dst.y,2)));y.dst.ax=y.dst.x/o,y.dst.ay=y.dst.y/o;var f=0,l=o;0==y.dst.x?(f=i,l=t,y.dst.ay=1,y.dst.py=0):0==y.dst.y&&(f=s,l=e,y.dst.ax=1,y.dst.px=0),o=y.getTransitionSpeed(o),n&&1>=n&&(o*=n),y.bzscroll=0<o?y.bzscroll?y.bzscroll.update(l,o):new BezierClass(f,l,o,0,1,0,1):!1;if(!y.timer){(i==y.page.maxh&&t>=y.page.maxh||s==y.page.maxw&&e>=y.page.maxw)&&y.checkContentSize();var c=1;y.cancelAnimationFrame=!1,y.timer=1,y.onscrollstart&&!y.scrollrunning&&y.onscrollstart.call(y,{type:"scrollstart",current:{x:s,y:i},request:{x:e,y:t},end:{x:y.newscrollx,y:y.newscrolly},speed:o}),r(),(i==y.page.maxh&&t>=i||s==y.page.maxw&&e>=s)&&y.checkContentSize(),y.noticeCursor()}},this.cancelScroll=function(){return y.timer&&a(y.timer),y.timer=0,y.bzscroll=!1,y.scrollrunning=!1,y}):(this.doScrollLeft=function(e,t){var n=y.getScrollTop();y.doScrollPos(e,n,t)},this.doScrollTop=function(e,t){var n=y.getScrollLeft();y.doScrollPos(n,e,t)},this.doScrollPos=function(e,t,n){var r=e>y.page.maxw?y.page.maxw:e;0>r&&(r=0);var i=t>y.page.maxh?y.page.maxh:t;0>i&&(i=0),y.synched("scroll",function(){y.setScrollTop(i),y.setScrollLeft(r)})},this.cancelScroll=function(){}),this.doScrollBy=function(e,t){var n=0,n=t?Math.floor((y.scroll.y-e)*y.scrollratio.y):(y.timer?y.newscrolly:y.getScrollTop(!0))-e;if(y.bouncescroll){var r=Math.round(y.view.h/2);n<-r?n=-r:n>y.page.maxh+r&&(n=y.page.maxh+r)}y.cursorfreezed=!1,py=y.getScrollTop(!0);if(0>n&&0>=py)return y.noticeCursor();if(n>y.page.maxh&&py>=y.page.maxh)return y.checkContentSize(),y.noticeCursor();y.doScrollTop(n)},this.doScrollLeftBy=function(e,t){var n=0,n=t?Math.floor((y.scroll.x-e)*y.scrollratio.x):(y.timer?y.newscrollx:y.getScrollLeft(!0))-e;if(y.bouncescroll){var r=Math.round(y.view.w/2);n<-r?n=-r:n>y.page.maxw+r&&(n=y.page.maxw+r)}y.cursorfreezed=!1,px=y.getScrollLeft(!0);if(0>n&&0>=px||n>y.page.maxw&&px>=y.page.maxw)return y.noticeCursor();y.doScrollLeft(n)},this.doScrollTo=function(e,t){t&&Math.round(e*y.scrollratio.y),y.cursorfreezed=!1,y.doScrollTop(e)},this.checkContentSize=function(){var e=y.getContentSize();(e.h!=y.page.h||e.w!=y.page.w)&&y.resize(!1,e)},y.onscroll=function(e){y.rail.drag||y.cursorfreezed||y.synched("scroll",function(){y.scroll.y=Math.round(y.getScrollTop()*(1/y.scrollratio.y)),y.railh&&(y.scroll.x=Math.round(y.getScrollLeft()*(1/y.scrollratio.x))),y.noticeCursor()})},y.bind(y.docscroll,"scroll",y.onscroll),this.doZoomIn=function(t){if(!y.zoomactive){y.zoomactive=!0,y.zoomrestore={style:{}};var n="position top left zIndex backgroundColor marginTop marginBottom marginLeft marginRight".split(" "),r=y.win[0].style,i;for(i in n){var o=n[i];y.zoomrestore.style[o]="undefined"!=typeof r[o]?r[o]:""}return y.zoomrestore.style.width=y.win.css("width"),y.zoomrestore.style.height=y.win.css("height"),y.zoomrestore.padding={w:y.win.outerWidth()-y.win.width(),h:y.win.outerHeight()-y.win.height()},w.isios4&&(y.zoomrestore.scrollTop=e(window).scrollTop(),e(window).scrollTop(0)),y.win.css({position:w.isios4?"absolute":"fixed",top:0,left:0,"z-index":s+100,margin:"0px"}),n=y.win.css("backgroundColor"),(""==n||/transparent|rgba\(0, 0, 0, 0\)|rgba\(0,0,0,0\)/.test(n))&&y.win.css("backgroundColor","#fff"),y.rail.css({"z-index":s+101}),y.zoom.css({"z-index":s+102}),y.zoom.css("backgroundPosition","0px -18px"),y.resizeZoom(),y.onzoomin&&y.onzoomin.call(y),y.cancelEvent(t)}},this.doZoomOut=function(t){if(y.zoomactive)return y.zoomactive=!1,y.win.css("margin",""),y.win.css(y.zoomrestore.style),w.isios4&&e(window).scrollTop(y.zoomrestore.scrollTop),y.rail.css({"z-index":y.zindex}),y.zoom.css({"z-index":y.zindex}),y.zoomrestore=!1,y.zoom.css("backgroundPosition","0px 0px"),y.onResize(),y.onzoomout&&y.onzoomout.call(y),y.cancelEvent(t)},this.doZoom=function(e){return y.zoomactive?y.doZoomOut(e):y.doZoomIn(e)},this.resizeZoom=function(){if(y.zoomactive){var t=y.getScrollTop();y.win.css({width:e(window).width()-y.zoomrestore.padding.w+"px",height:e(window).height()-y.zoomrestore.padding.h+"px"}),y.onResize(),y.setScrollTop(Math.min(y.page.maxh,t))}},this.init(),e.nicescroll.push(this)},m=function(e){var t=this;this.nc=e,this.steptime=this.lasttime=this.speedy=this.speedx=this.lasty=this.lastx=0,this.snapy=this.snapx=!1,this.demuly=this.demulx=0,this.lastscrolly=this.lastscrollx=-1,this.timer=this.chky=this.chkx=0,this.time=function(){return+(new Date)},this.reset=function(e,n){t.stop();var r=t.time();t.steptime=0,t.lasttime=r,t.speedx=0,t.speedy=0,t.lastx=e,t.lasty=n,t.lastscrollx=-1,t.lastscrolly=-1},this.update=function(e,n){var r=t.time();t.steptime=r-t.lasttime,t.lasttime=r;var r=n-t.lasty,i=e-t.lastx,s=t.nc.getScrollTop(),o=t.nc.getScrollLeft(),s=s+r,o=o+i;t.snapx=0>o||o>t.nc.page.maxw,t.snapy=0>s||s>t.nc.page.maxh,t.speedx=i,t.speedy=r,t.lastx=e,t.lasty=n},this.stop=function(){t.nc.unsynched("domomentum2d"),t.timer&&clearTimeout(t.timer),t.timer=0,t.lastscrollx=-1,t.lastscrolly=-1},this.doSnapy=function(e,n){var r=!1;0>n?(n=0,r=!0):n>t.nc.page.maxh&&(n=t.nc.page.maxh,r=!0),0>e?(e=0,r=!0):e>t.nc.page.maxw&&(e=t.nc.page.maxw,r=!0),r?t.nc.doScrollPos(e,n,t.nc.opt.snapbackspeed):t.nc.triggerScrollEnd()},this.doMomentum=function(e){var n=t.time(),r=e?n+e:t.lasttime;e=t.nc.getScrollLeft();var i=t.nc.getScrollTop(),s=t.nc.page.maxh,o=t.nc.page.maxw;t.speedx=0<o?Math.min(60,t.speedx):0,t.speedy=0<s?Math.min(60,t.speedy):0,r=r&&60>=n-r;if(0>i||i>s||0>e||e>o)r=!1;e=t.speedx&&r?t.speedx:!1;if(t.speedy&&r&&t.speedy||e){var u=Math.max(16,t.steptime);50<u&&(e=u/50,t.speedx*=e,t.speedy*=e,u=50),t.demulxy=0,t.lastscrollx=t.nc.getScrollLeft(),t.chkx=t.lastscrollx,t.lastscrolly=t.nc.getScrollTop(),t.chky=t.lastscrolly;var a=t.lastscrollx,f=t.lastscrolly,l=function(){var e=600<t.time()-n?.04:.02;t.speedx&&(a=Math.floor(t.lastscrollx-t.speedx*(1-t.demulxy)),t.lastscrollx=a,0>a||a>o)&&(e=.1),t.speedy&&(f=Math.floor(t.lastscrolly-t.speedy*(1-t.demulxy)),t.lastscrolly=f,0>f||f>s)&&(e=.1),t.demulxy=Math.min(1,t.demulxy+e),t.nc.synched("domomentum2d",function(){t.speedx&&(t.nc.getScrollLeft()!=t.chkx&&t.stop(),t.chkx=a,t.nc.setScrollLeft(a)),t.speedy&&(t.nc.getScrollTop()!=t.chky&&t.stop(),t.chky=f,t.nc.setScrollTop(f)),t.timer||(t.nc.hideCursor(),t.doSnapy(a,f))}),1>t.demulxy?t.timer=setTimeout(l,u):(t.stop(),t.nc.hideCursor(),t.doSnapy(a,f))};l()}else t.doSnapy(t.nc.getScrollLeft(),t.nc.getScrollTop())}},g=e.fn.scrollTop;e.cssHooks.pageYOffset={get:function(t,n,r){return(n=e.data(t,"__nicescroll")||!1)&&n.ishwscroll?n.getScrollTop():g.call(t)},set:function(t,n){var r=e.data(t,"__nicescroll")||!1;return r&&r.ishwscroll?r.setScrollTop(parseInt(n)):g.call(t,n),this}},e.fn.scrollTop=function(t){if("undefined"==typeof t){var n=this[0]?e.data(this[0],"__nicescroll")||!1:!1;return n&&n.ishwscroll?n.getScrollTop():g.call(this)}return this.each(function(){var n=e.data(this,"__nicescroll")||!1;n&&n.ishwscroll?n.setScrollTop(parseInt(t)):g.call(e(this),t)})};var y=e.fn.scrollLeft;e.cssHooks.pageXOffset={get:function(t,n,r){return(n=e.data(t,"__nicescroll")||!1)&&n.ishwscroll?n.getScrollLeft():y.call(t)},set:function(t,n){var r=e.data(t,"__nicescroll")||!1;return r&&r.ishwscroll?r.setScrollLeft(parseInt(n)):y.call(t,n),this}},e.fn.scrollLeft=function(t){if("undefined"==typeof t){var n=this[0]?e.data(this[0],"__nicescroll")||!1:!1;return n&&n.ishwscroll?n.getScrollLeft():y.call(this)}return this.each(function(){var n=e.data(this,"__nicescroll")||!1;n&&n.ishwscroll?n.setScrollLeft(parseInt(t)):y.call(e(this),t)})};var b=function(t){var n=this;this.length=0,this.name="nicescrollarray",this.each=function(e){for(var t=0,r=0;t<n.length;t++)e.call(n[t],r++);return n},this.push=function(e){n[n.length]=e,n.length++},this.eq=function(e){return n[e]};if(t)for(var r=0;r<t.length;r++){var i=e.data(t[r],"__nicescroll")||!1;i&&(this[this.length]=i,this.length++)}return this};(function(e,t,n){for(var r=0;r<t.length;r++)n(e,t[r])})(b.prototype,"show hide toggle onResize resize remove stop doScrollPos".split(" "),function(e,t){e[t]=function(){var e=arguments;return this.each(function(){this[t].apply(this,e)})}}),e.fn.getNiceScroll=function(t){return"undefined"==typeof t?new b(this):this[t]&&e.data(this[t],"__nicescroll")||!1},e.extend(e.expr[":"],{nicescroll:function(t){return e.data(t,"__nicescroll")?!0:!1}}),e.fn.niceScroll=function(t,n){"undefined"==typeof n&&"object"==typeof t&&!("jquery"in t)&&(n=t,t=!1);var r=new b;"undefined"==typeof n&&(n={}),t&&(n.doc=e(t),n.win=e(this));var i=!("doc"in n);return!i&&!("win"in n)&&(n.win=e(this)),this.each(function(){var t=e(this).data("__nicescroll")||!1;t||(n.doc=i?e(this):n.doc,t=new v(n,e(this)),e(this).data("__nicescroll",t)),r.push(t)}),1==r.length?r[0]:r},window.NiceScroll={getjQuery:function(){return e}},e.nicescroll||(e.nicescroll=new b,e.nicescroll.options=h)}),define("FeaturePopup",["jquery","./IFrame","./JsonProcessor","./Utils","./ImageProcessing","gw/FeatureStyle","gw/VectorLayer","./Samp","underscore-min","text!../templates/featureList.html","text!../templates/featureDescription.html","text!../templates/descriptionTable.html","jquery.nicescroll.min","jquery.ui"],function(e,t,n,r,i,s,o,u,a,f,l,c){function C(t,n){var r=t,i=n;r+=20,i-=100,e("#selectedFeatureDiv").css({position:"absolute",left:r+"px",top:i+"px"})}function k(){return 2*e("#"+v.renderContext.canvas.id).height()/5}function L(e,t){if(t){handledProperties={},handledProperties.identifier=e.identifier,handledProperties.title=e.title?e.title:"",handledProperties.style=e.style;for(var n=0;n<t.length;n++){var r=t[n];e[r]&&(handledProperties[r]=e[r])}handledProperties.others={};for(var r in e)handledProperties[r]||(handledProperties.others[r]=e[r]);return handledProperties}return e}function A(t,n,r){e.ajax({type:"GET",url:t+n,dataType:"text",success:function(t){r[n]=t,e("#"+n).attr("title",t)},error:function(e,t,n){}})}function O(t,n){t.dictionary={},e.ajax({type:"GET",url:t.serviceUrl,dataType:"xml",success:function(r){var i=e(r).find('Url[rel="dicodesc"]'),s=e(i).attr("template");if(s){var o=s.indexOf("{");o!=-1&&(s=s.substring(0,o));for(var u in n)A(s,u,t.dictionary)}},error:function(e){}})}function M(e,t){e.hasOwnProperty("dictionary")||O(e,t.properties);var n=x({dictionary:e.dictionary,services:t.services,properties:L(t.properties,e.displayProperties),descriptionTableTemplate:T,isMobile:g});E.html(n),E.find(".featureProperties").css("max-height",k()),b.find(".featureProperties").niceScroll({autohidemode:!1}).hide()}var h="",p=null,d=null,v=null,m,g,y='<div id="selectedFeatureDiv" class="contentBox ui-widget-content" style="display: none">				<div id="leftDiv"></div>				<div id="rightDiv"></div>				<div class="closeBtn">					<span class="defaultImg"></span>					<span style="opacity: 0" class="hoverImg"></span>				</div>				<div class="arrow-left"></div>			</div>',b,w,E,S=a.template(f),x=a.template(l),T=a.template(c),N='<div id="pileStashHelp"> Some observations are overlapped. <br/> Click on the observation to see detailed informations about each observation. <br/> </div>';return{init:function(r,a,f,l){p=r,d=a,v=f,m=l,g=l.isMobile,b=e(y).appendTo("body"),w=e("#leftDiv"),E=e("#rightDiv"),i.init({disable:function(){e("#dynamicImageView").removeClass("dynamicAvailable").addClass("dynamicNotAvailable")},unselect:function(){e("#dynamicImageView").removeClass("selected")}}),b.on("click","#quicklook",function(e){var t=p.getSelectedData(),n=t.feature.properties.style.fill&&!t.feature.properties.style.fillTextureUrl;n&&d.removeImage(t),t.isFits=!1,t.feature.properties.style.fill==1?d.removeImage(t):d.addImage(t)}),b.on("click","#quicklookFits",function(e){var t=p.getSelectedData(),n=t.feature.properties.style.fill&&t.feature.properties.style.fillTextureUrl;n&&d.removeImage(t),t.isFits=!0,t.feature.properties.style.fill==1?d.removeImage(t):d.addImage(t)}),b.on("click","#dynamicImageView",function(t){e(this).toggleClass("selected");var n=p.getSelectedData();i.setData(n)}),b.on("click","#sendImage",function(t){var n=p.getSelectedData(),r=u.sendImage(n.feature.services.download.url);e("#serviceStatus").html(r).slideDown().delay(1500).slideUp()}),b.on("click","#healpix",function(t){var n=p.getSelectedData(),r=n.feature.services.healpix.layer;e("#healpix").is(".selected")?(e("#healpix").removeClass("selected"),r.visible(!1)):(e("#healpix").addClass("selected"),r.visible(!0))}),b.on("click","#solarObjects",function(t){var r=p.getSelectedData(),i=p.getSelection(),u,a=r.layer;if(r.feature.services.solarObjects)u=r.feature.services.solarObjects.layer;else{var f=new s({iconUrl:m.mizarBaseUrl+"css/images/star.png",zIndex:2}),l={name:"SolarObjectsSublayer",style:f};u=new o(l),v.addLayer(u),p.addPickableLayer(u);var c=m.solarObjects.baseUrl;v.tileManager.imageryProvider.tiling.coordSystem=="EQ"?c+="EQUATORIAL":c+="GALACTIC",e("#solarObjectsSpinner").show(),e.ajax({type:"GET",url:c,data:{order:i.selectedTile.order,healpix:i.selectedTile.pixelIndex,EPOCH:r.feature.properties["date-obs"]},success:function(t){n.handleFeatureCollection(u,t),e("#serviceStatus").html(t.totalResults+" objects found").slideDown().delay(400).slideUp(),u.addFeatureCollection(t)},complete:function(t){e("#solarObjectsSpinner").hide()},error:function(t){e("#serviceStatus").html("No data found").slideDown().delay(400).slideUp()}}),a.subLayers||(a.subLayers=[]),r.feature.services.solarObjects={layer:u},a.subLayers.push(u)}e("#solarObjects").is(".selected")?(e("#solarObjects").removeClass("selected"),u.visible(!1)):(e("#solarObjects").addClass("selected"),u.visible(!0))}),b.on("mousedown","#scroll-arrow-down.clickable",function(t){e("#selectedFeatureDiv #scroll-arrow-up").css("border-bottom-color","orange").addClass("clickable");var n=e("#featureList"),r=parseInt(e("#featureListDiv").css("max-height"))/2,i=parseInt(n.css("top"),10)-r,s=n.height(),o=parseInt(e("#featureListDiv").css("max-height"));i<=-(s-o)&&(i=-(s-o),e(this).css("border-top-color","gray").removeClass("clickable")),n.stop().animate({top:i+"px"},300)}).disableSelection(),b.on("mousedown","#scroll-arrow-up.clickable",function(t){e("#selectedFeatureDiv #scroll-arrow-down").css("border-top-color","orange").addClass("clickable");var n=e("#featureList"),r=parseInt(e("#featureListDiv").css("max-height"))/2,i=parseInt(n.css("top"),10)+r;i>=0&&(i=0,e(this).css("border-bottom-color","gray").removeClass("clickable")),n.stop().animate({top:i+"px"},300)}).disableSelection(),b.on("click",".section",function(t){b.find(".featureProperties").getNiceScroll().hide(),e(this).siblings("table").fadeToggle("slow","linear",function(){b.find(".featureProperties").getNiceScroll().show(),b.find(".featureProperties").getNiceScroll().resize()}),e(this).siblings("#arrow").is(".arrow-right")?e(this).siblings("#arrow").removeClass("arrow-right").addClass("arrow-bottom"):e(this).siblings("#arrow").removeClass("arrow-bottom").addClass("arrow-right")});var c=this;b.on("click",".featureTitle",function(){p.blurSelectedFeature(),e("#featureList div.selected").removeClass("selected");var t=e(this).index();p.focusFeatureByIndex(t);var n=p.getSelectedData();e("#featureList div:eq("+t+")").addClass("selected"),c.showFeatureInformation(n.layer,n.feature),v.renderContext.requestFrame()}),b.on("click",".propertiesTable a",function(e){e.preventDefault(),t.show(e.target.innerHTML)}),E.css("max-width",e("#"+v.renderContext.canvas.id).width()/4),e(window).on("resize",function(){E.find(".featureProperties").css("max-height",k()),E.css("max-width",e("#"+v.renderContext.canvas.id).width()/4)})},hide:function(e){b.css("display")!="none"?(b.find(".featureProperties").getNiceScroll().hide(),b.fadeOut(300,function(){b.find(".featureProperties").getNiceScroll().remove(),e&&e()})):e&&e()},show:function(t,n,r){C(t,n),b.fadeIn(500,function(){b.find(".featureProperties").getNiceScroll().resize(),r&&r()});var i=k(),s=i-60;e("#featureListDiv").css("max-height",s),w.find("#featureList").height()>s&&w.find(".scroll-arrow-up, .scroll-arrow-down").css("display","block")},createFeatureList:function(e){h=S({selection:e}),w.html(h)},createHelp:function(){E.html(N)},showFeatureInformation:function(t,n){E.find(".featureProperties").getNiceScroll().hide(),E.fadeOut(300,function(){E.find(".featureProperties").getNiceScroll().remove(),M(t,n),e(this).fadeIn(300,function(){b.find(".featureProperties").getNiceScroll().resize(),b.find(".featureProperties").getNiceScroll().show()})})},generateFeatureMetadata:function(e,t){return x({dictionary:e.hasOwnProperty("dictionary")?e.dictionary:O(e,t.properties),services:!1,properties:L(t.properties,e.displayProperties),descriptionTableTemplate:T})}}}),define("ImageManager",["jquery","gw/FeatureStyle","gw/DynamicImage","./FitsLoader","./Utils","./ImageProcessing","fits"],function(e,t,n,r,i,s){function a(e,t,n){var i=r.loadFits(t,function(t){delete e.xhr;var r=t.getHDU().data;n&&n(e,t),f(r,e)});e.xhr=i,this.mizar.publish("image:download",e)}function f(e,r){var i=new Float32Array(e.view.buffer,e.begin,e.length/4),u=o.renderContext.gl,a=new n(o.renderContext,i,u.LUMINANCE,u.FLOAT,e.width,e.height),f=r.feature,l=r.layer,c;f.properties.style?c=new t(f.properties.style):c=new t(l.style),c.fillTexture=a.texture,c.uniformValues=a,c.fill=!0,l.modifyFeatureStyle(f,c),f.services&&(a.url=f.services.download.url),s.setImage(a)}function l(e){e.xhr&&(e.xhr.abort(),delete e.xhr);var n=o.renderContext.gl;e.feature.properties.style.uniformValues&&e.feature.properties.style.uniformValues.dispose();var r=e.feature.properties.style.fillTexture;r&&n.deleteTexture(r);var i=new t(e.feature.properties.style);i.fillTexture=null,i.fill=!1,i.fillShader={fragmentCode:null,updateUniforms:null},delete i.uniformValues,e.layer.modifyFeatureStyle(e.feature,i)}var o=null,u;return{init:function(e,t,n){this.mizar=e,o=e.sky,u=n.sitoolsBaseUrl;var r=o.renderContext.gl.getExtension("OES_texture_float")},hideImage:function(e){var n=new t(e.feature.properties.style);n.fill=!1,e.layer.modifyFeatureStyle(e.feature,n)},showImage:function(e){var n=new t(e.feature.properties.style);n.fill=!0,e.layer.modifyFeatureStyle(e.feature,n)},removeImage:function(t){this.mizar.publish("image:remove",t);if(t.isFits)l(t),e("#quicklookFits").removeClass("selected");else{var n=t.feature.properties.style;n.fill=!1,n.fillTextureUrl=null,t.layer.modifyFeatureStyle(t.feature,n),e("#quicklook").removeClass("selected")}},addImage:function(n){var r=n.feature,i=new t(r.properties.style);i.fill=!0,this.mizar.publish("image:add",n);if(n.isFits){var s=u+"/proxy?external_url="+encodeURIComponent(r.services.download.url);this.computeFits(n,s),e("#quicklookFits").addClass("selected")}else i.fillTextureUrl=u+"/proxy?external_url="+r.properties.quicklook+"&rewrite_redirection=true",e("#quicklook").addClass("selected");n.layer.modifyFeatureStyle(r,i)},computeFits:a,handleFits:f}}),define("PickingManager",["jquery","gw/FeatureStyle","gw/CoordinateSystem","gw/OpenSearchLayer","./FeaturePopup","./ImageManager","./CutOutViewFactory","./Utils"],function(e,t,n,r,i,s,o,u){function w(e){b&&e.type.search("touch")>=0&&(e.layerX=e.changedTouches[0].clientX,e.layerY=e.changedTouches[0].clientY),y=new Date,m=e.layerX,g=e.layerY,C()}function E(t){var n=new Date,r=5,s=n-y;b&&t.type.search("touch")>=0&&(t.layerX=t.changedTouches[0].clientX,t.layerY=t.changedTouches[0].clientY);if(s<500&&Math.abs(m-t.layerX)<r&&Math.abs(g-t.layerY)<r){var o=a.getLonLatFromPixel(t.layerX,t.layerY);C();var u=L(o);u.length>0?i.hide(function(){f.inertia&&f.inertia.stop(),f.moveTo(o,800,function(){c=u,N(c),c.selectedTile=v,i.createFeatureList(c),c.length>1?(i.createHelp(),h=-1):(l.focusFeatureByIndex(0),e("#featureList div:eq(0)").addClass("selected"),i.showFeatureInformation(c[h].layer,c[h].feature));var t=e(a.renderContext.canvas).offset();i.show(t.left+a.renderContext.canvas.width/2,t.top+a.renderContext.canvas.height/2)})}):i.hide()}}function S(){a.renderContext.canvas.addEventListener("mousedown",w),a.renderContext.canvas.addEventListener("mouseup",E),b&&(a.renderContext.canvas.addEventListener("touchstart",w),a.renderContext.canvas.addEventListener("touchend",E)),f.subscribe("modified",function(){C(),i.hide()})}function x(){a.renderContext.canvas.removeEventListener("mousedown",w),a.renderContext.canvas.removeEventListener("mouseup",E),b&&(a.renderContext.canvas.removeEventListener("touchstart",w),a.renderContext.canvas.removeEventListener("touchend",E)),f.unsubscribe("modified",function(){C(),i.hide()})}function T(){for(var e=0;e<c.length;e++){var n=c[e],r=new t(n.feature.properties.style);switch(n.feature.geometry.type){case"Polygon":case"MultiPolygon":r.strokeColor=n.layer.style.strokeColor;break;case"Point":r.fillColor=n.layer.style.fillColor;break;default:}r.zIndex=n.layer.style.zIndex,n.layer.globe&&n.layer.modifyFeatureStyle(n.feature,r)}}function N(e){var n;for(var r=0;r<e.length;r++){var i=e[r];i.feature.properties.style?n=new t(i.feature.properties.style):n=new t(i.layer.style);switch(i.feature.geometry.type){case"Polygon":case"MultiPolygon":n.strokeColor=p.strokeColor;break;case"Point":n.fillColor=p.fillColor;break;default:}n.zIndex=p.zIndex,i.layer.modifyFeatureStyle(i.feature,n)}}function C(){T(),c=[]}function k(e,t){var n=!1,r=t[0][0];for(var i=1;i<t.length&&!n;i++){var s=Math.abs(t[i][0]-r);s>180&&(n=!0)}if(n){var o=[];if(e[0]<0)for(var u=0;u<t.length;u++)t[u][0]>0?o[u]=[t[u][0]-360,t[u][1]]:o[u]=[t[u][0],t[u][1]];else for(var u=0;u<t.length;u++)t[u][0]<0?o[u]=[t[u][0]+360,t[u][1]]:o[u]=[t[u][0],t[u][1]];return o}return t}function L(e){v=a.tileManager.getVisibleTile(e[0],e[1]);var t=[];for(var n=0;n<d.length;n++){var i=d[n];if(i.visible())if(i instanceof r){var s=v,o=s.extension[i.extId];if(!o||o.state!=r.TileState.LOADED)while(s.parent&&(!o||o.state!=r.TileState.LOADED))s=s.parent,o=s.extension[i.extId];if(o)for(var f=0;f<o.featureIds.length;f++){var l=i.features[i.featuresSet[o.featureIds[f]].index];switch(l.geometry.type){case"Polygon":var c=k(e,l.geometry.coordinates[0]);u.pointInRing(e,c)&&t.push({feature:l,layer:i});break;case"MultiPolygon":for(var h=0;h<l.geometry.coordinates.length;h++){var c=k(e,l.geometry.coordinates[h][0]);u.pointInRing(e,c)&&t.push({feature:l,layer:i})}break;case"Point":var p=l.geometry.coordinates;l.cluster?u.pointInSphere(e,p,l.geometry._bucket.textureHeight)&&t.push({feature:l,layer:i}):u.pointInSphere(e,p,l.geometry._bucket.textureHeight)&&t.push({feature:l,layer:i});break;default:}}}else for(var f=0;f<i.features.length;f++){var l=i.features[f];switch(l.geometry.type){case"Polygon":var c=k(e,l.geometry.coordinates[0]);u.pointInRing(e,c)&&t.push({feature:l,layer:i});break;case"MultiPolygon":for(var h=0;h<l.geometry.coordinates.length;h++){var c=k(e,l.geometry.coordinates[h][0]);u.pointInRing(e,c)&&t.push({feature:l,layer:i})}break;case"Point":u.pointInSphere(e,l.geometry.coordinates,l.geometry._bucket.textureHeight)&&t.push({feature:l,layer:i});break;default:}}}return t}var a,f,l,c=[],h=-1,p=new t({strokeColor:[1,1,0,1],fillColor:[1,1,0,1],zIndex:1}),d=[],v=null,m,g,y,b;return{init:function(e,t){a=e.sky,f=e.navigation,l=this,b=t.isMobile,S(),s.init(e,this,t),t.cutOut&&o.init(a,f,this),i.init(this,s,a,t)},addPickableLayer:function(e){d.push(e)},removePickableLayer:function(e){for(var t=0;t<d.length;t++)e.id==d[t].id&&d.splice(t,1)},blurSelectedFeature:function(){var e=c[h];if(e){var n=new t(e.feature.properties.style);switch(e.feature.geometry.type){case"Polygon":case"MultiPolygon":n.strokeColor=e.layer.style.strokeColor;break;case"Point":n.fillColor=e.layer.style.fillColor;break;default:}n.zIndex=e.layer.style.zIndex,e.layer.modifyFeatureStyle(e.feature,n)}},focusFeatureByIndex:function(e){T();var n=c[e];if(n){h=e;var r=new t(n.feature.properties.style);switch(n.feature.geometry.type){case"Polygon":case"MultiPolygon":r.strokeColor=p.strokeColor;break;case"Point":r.fillColor=p.fillColor;break;default:}r.zIndex=p.zIndex,n.layer.modifyFeatureStyle(n.feature,r)}},focusFeature:function(e){C(),c=[e],this.focusFeatureByIndex(0)},getSelectedData:function(){return c[h]},getSelection:function(){return c},computePickSelection:L,activate:S,deactivate:x}}),define("LayerManager",["jquery","underscore-min","gw/FeatureStyle","gw/HEALPixLayer","gw/VectorLayer","gw/CoordinateGridLayer","gw/TileWireframeLayer","gw/OpenSearchLayer","./ClusterOpenSearchLayer","./MocLayer","./HEALPixFITSLayer","./PickingManager","./Utils","./JsonProcessor","jquery.ui"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){function b(e){var t=h.generateColor(),r=t.concat([1]),s={name:e,style:new n({iconUrl:m.mizarBaseUrl+"css/images/star.png",fillColor:r,strokeColor:r,visible:!0})},o=new i(s);return o.type="GeoJSON",o.deletable=!0,o.pickable=!0,o}function w(e){var t;e.attribution&&e.attribution.search("<a")>=0&&e.attribution.search("target=")<0&&(e.attribution=e.attribution.replace(" "," target=_blank "));var c={name:e.name,attribution:e.attribution,visible:e.visible,icon:e.icon,description:e.description,onready:e.onready};if(e.color)var p=n.fromStringToColor(e.color);else var d=h.generateColor(),p=d.concat([1]);var v=new n({rendererHint:"Basic",opacity:e.opacity/100,iconUrl:e.icon?e.icon:m.mizarBaseUrl+"css/images/star.png",fillColor:p,strokeColor:p});switch(e.type){case"healpix":c.baseUrl=e.baseUrl,c.coordSystem=e.coordSystem||"EQ",c.dataType=e.dataType||"jpg",c.numberOfLevels=e.numberOfLevels,e.fitsSupported?t=new l(c):t=new r(c),e.availableServices&&(t.availableServices=e.availableServices,t.healpixCutFileName=e.healpixCutFileName);break;case"coordinateGrid":t=new s({name:e.name,visible:e.visible,longFormat:e.longFormat,latFormat:e.latFormat,coordSystem:e.coordSystem,color:p});break;case"healpixGrid":t=new o({name:e.name,visible:e.visible,outline:e.outline}),t.style=v;break;case"GeoJSON":c.style=v,t=new i(c);if(g[e.data.type])var y=g[e.data.type],w=y(t,e.data);t.dataType=e.dataType||"line",t.pickable=e.hasOwnProperty("pickable")?e.pickable:!0;break;case"DynamicOpenSearch":c.serviceUrl=e.serviceUrl,c.minOrder=e.minOrder,e.hasOwnProperty("invertY")&&(c.invertY=e.invertY),c.style=v,e.hasOwnProperty("coordSystemRequired")&&(c.coordSystemRequired=e.coordSystemRequired),e.useCluster?(e.maxClusterOrder&&(c.maxClusterOrder=e.maxClusterOrder),e.treshold&&(c.treshold=e.treshold),e.accuracyOrder&&c.accuracyOrder,t=new a(c)):t=new u(c),e.displayProperties&&(t.displayProperties=e.displayProperties),t.dataType=e.dataType,t.pickable=e.hasOwnProperty("pickable")?e.pickable:!0,t.availableServices=e.availableServices;break;case"Moc":c.style=v,c.serviceUrl=e.serviceUrl,c.style.fill=!0,c.style.fillColor[3]=.3,t=new f(c),t.dataType="line";break;case"Vector":t=b(c.name),t.dataType=e.dataType,t.pickable=e.hasOwnProperty("pickable")?e.pickable:!0,t.deletable=!1;break;default:return console.error(e.type+" isn't not implemented"),null}return t.type=e.type,t}function E(e){for(var t=0;t<e.length;t++){var n=e[t];this.addLayer(n)}}var d,v=[],m,g={},y;return{init:function(e,t){this.mizar=e,m=t,d=e.sky},registerDataProvider:function(e,t){g[e.toString()]=t},getLayers:function(){return v},addLayer:function(e){var n=t.findWhere(v,{name:e.name});return n||(e.opacity||(e.opacity=100),e.visible||(e.visible=!1),n=w(e),n&&(e.background?(n.visible()&&(d.tileManager.imageryProvider&&d.tileManager.imageryProvider.visible(!1),d.setBaseImagery(n),n.visible(!0)),v.push(n),this.mizar.publish("backgroundLayer:add",n),n.category="background"):(d.addLayer(n),v.push(n),n.category=e.category,this.mizar.publish("additionalLayer:add",n)))),n.pickable&&c.addPickableLayer(n),n},removeLayer:function(e){var t=v.indexOf(e);v.splice(t,1),e.pickable&&c.removePickableLayer(e),this.mizar.publish("layer:remove",e),d.removeLayer(e)},setBackgroundSurvey:function(e){var n=t.findWhere(v,{name:e});if(n){if(n!=d.baseImagery){d.baseImagery.visible(!1),d.setBaseImagery(n),n.visible(!0),c.getSelection().length=0;for(var r=0;r<v.length;r++){var i=v[r];if(i.subLayers){var s=i.subLayers.length;for(var o=0;o<s;o++){var u=i.subLayers[o];u.name=="SolarObjectsSublayer"&&(c.removePickableLayer(u),d.removeLayer(u),i.subLayers.splice(o,1))}}}}this.mizar.publish("backgroundLayer:change",n)}else this.mizar.publish("backgroundSurveyError","Survey "+e+" hasn't been found")},createLayerFromFits:function(e,t){var n=b(e);n.dataType="line";var r=h.getPolygonCoordinatesFromFits(t),i={geometry:{gid:e,coordinates:[r],type:"Polygon"},properties:{identifier:e},type:"Feature"};return n.addFeature(i),d.addLayer(n),v.push(n),n},createLayerFromGeoJson:function(e,t){var n=b(e);return p.handleFeatureCollection(n,t),n.addFeatureCollection(t),d.addLayer(n),v.push(n),n},createSimpleLayer:b}}),define("text!../templates/openSearchService.html",[],function(){return'<div id="openSearchTabs">\n	<ul>\n		<% for ( var i=0; i<layers.length; i++ )\n		{\n		%>\n			<li><a href="#osForm_<%=layers[i].id%>"><%= layers[i].name %></a></li>\n		<%\n		}\n		%>\n	</ul>\n\n<% for ( var i=0; i<layers.length; i++)\n{\n%>\n	<div id="osForm_<%= layers[i].id %>"> <%= layers[i].openSearchForm %> </div>\n<%\n}\n%>\n</div>'}),define("text!../templates/openSearchForm.html",[],function(){return'<form class="openSearchForm" id="openSearchForm_<%= layer.id %>">\n	<%\n	for(var i=0; i<properties.length; i++)\n	{\n		var property = properties[i];\n		%>\n		<label for="<%= property.id %>"><%= property.title %></label>\n		<%\n		if(property.type == "text" || property.type == "number")\n		{\n		%>\n			<input type="text" id="<%= property.id %>" name="<%= property.id %>"><br/>\n		<%\n		}\n		if(property.type == "date")\n		{\n		%>\n			<input type="text" id="<%= property.id %>" name="<%= property.id %>" class="datepicker" /><br/>\n		<%\n		}\n		if(property.type == "enumeration")\n		{\n		%>\n			<select name="<%= property.id %>">\n				<option value="">None</option>\n				<%\n				for(var j=0; j<property.son.length; j++)\n				{\n				%>\n					<option value="<%= property.son[j].id  %>"><%= property.son[j].title %>(<%= property.son[j].population %>)</option>\n				<% \n				}\n				%>\n			</select><br/>\n		<%\n		}\n	}\n	%>\n	<input class="submit" type="submit" value="Save parameters" />\n</form>'}),function(e){typeof define=="function"&&define.amd?define("jquery.ui.timepicker",["jquery","jquery.ui"],e):e(jQuery)}(function($){$.ui.timepicker=$.ui.timepicker||{};if($.ui.timepicker.version)return;$.extend($.ui,{timepicker:{version:"1.2"}});var Timepicker=function(){this.regional=[],this.regional[""]={currentText:"Now",closeText:"Done",amNames:["AM","A"],pmNames:["PM","P"],timeFormat:"HH:mm",timeSuffix:"",timeOnlyTitle:"Choose Time",timeText:"Time",hourText:"Hour",minuteText:"Minute",secondText:"Second",millisecText:"Millisecond",timezoneText:"Time Zone",isRTL:!1},this._defaults={showButtonPanel:!0,timeOnly:!1,showHour:!0,showMinute:!0,showSecond:!1,showMillisec:!1,showTimezone:!1,showTime:!0,stepHour:1,stepMinute:1,stepSecond:1,stepMillisec:1,hour:0,minute:0,second:0,millisec:0,timezone:null,useLocalTimezone:!1,defaultTimezone:"+0000",hourMin:0,minuteMin:0,secondMin:0,millisecMin:0,hourMax:23,minuteMax:59,secondMax:59,millisecMax:999,minDateTime:null,maxDateTime:null,onSelect:null,hourGrid:0,minuteGrid:0,secondGrid:0,millisecGrid:0,alwaysSetTime:!0,separator:" ",altFieldTimeOnly:!0,altTimeFormat:null,altSeparator:null,altTimeSuffix:null,pickerTimeFormat:null,pickerTimeSuffix:null,showTimepicker:!0,timezoneIso8601:!1,timezoneList:null,addSliderAccess:!1,sliderAccessArgs:null,controlType:"slider",defaultValue:null,parse:"strict"},$.extend(this._defaults,this.regional[""])};$.extend(Timepicker.prototype,{$input:null,$altInput:null,$timeObj:null,inst:null,hour_slider:null,minute_slider:null,second_slider:null,millisec_slider:null,timezone_select:null,hour:0,minute:0,second:0,millisec:0,timezone:null,defaultTimezone:"+0000",hourMinOriginal:null,minuteMinOriginal:null,secondMinOriginal:null,millisecMinOriginal:null,hourMaxOriginal:null,minuteMaxOriginal:null,secondMaxOriginal:null,millisecMaxOriginal:null,ampm:"",formattedDate:"",formattedTime:"",formattedDateTime:"",timezoneList:null,units:["hour","minute","second","millisec"],control:null,setDefaults:function(e){return extendRemove(this._defaults,e||{}),this},_newInst:function($input,o){var tp_inst=new Timepicker,inlineSettings={},fns={},overrides,i;for(var attrName in this._defaults)if(this._defaults.hasOwnProperty(attrName)){var attrValue=$input.attr("time:"+attrName);if(attrValue)try{inlineSettings[attrName]=eval(attrValue)}catch(err){inlineSettings[attrName]=attrValue}}overrides={beforeShow:function(e,t){if($.isFunction(tp_inst._defaults.evnts.beforeShow))return tp_inst._defaults.evnts.beforeShow.call($input[0],e,t,tp_inst)},onChangeMonthYear:function(e,t,n){tp_inst._updateDateTime(n),$.isFunction(tp_inst._defaults.evnts.onChangeMonthYear)&&tp_inst._defaults.evnts.onChangeMonthYear.call($input[0],e,t,n,tp_inst)},onClose:function(e,t){tp_inst.timeDefined===!0&&$input.val()!==""&&tp_inst._updateDateTime(t),$.isFunction(tp_inst._defaults.evnts.onClose)&&tp_inst._defaults.evnts.onClose.call($input[0],e,t,tp_inst)}};for(i in overrides)overrides.hasOwnProperty(i)&&(fns[i]=o[i]||null);tp_inst._defaults=$.extend({},this._defaults,inlineSettings,o,overrides,{evnts:fns,timepicker:tp_inst}),tp_inst.amNames=$.map(tp_inst._defaults.amNames,function(e){return e.toUpperCase()}),tp_inst.pmNames=$.map(tp_inst._defaults.pmNames,function(e){return e.toUpperCase()}),typeof tp_inst._defaults.controlType=="string"?($.fn[tp_inst._defaults.controlType]===undefined&&(tp_inst._defaults.controlType="select"),tp_inst.control=tp_inst._controls[tp_inst._defaults.controlType]):tp_inst.control=tp_inst._defaults.controlType;if(tp_inst._defaults.timezoneList===null){var timezoneList=["-1200","-1100","-1000","-0930","-0900","-0800","-0700","-0600","-0500","-0430","-0400","-0330","-0300","-0200","-0100","+0000","+0100","+0200","+0300","+0330","+0400","+0430","+0500","+0530","+0545","+0600","+0630","+0700","+0800","+0845","+0900","+0930","+1000","+1030","+1100","+1130","+1200","+1245","+1300","+1400"];tp_inst._defaults.timezoneIso8601&&(timezoneList=$.map(timezoneList,function(e){return e=="+0000"?"Z":e.substring(0,3)+":"+e.substring(3)})),tp_inst._defaults.timezoneList=timezoneList}tp_inst.timezone=tp_inst._defaults.timezone,tp_inst.hour=tp_inst._defaults.hour<tp_inst._defaults.hourMin?tp_inst._defaults.hourMin:tp_inst._defaults.hour>tp_inst._defaults.hourMax?tp_inst._defaults.hourMax:tp_inst._defaults.hour,tp_inst.minute=tp_inst._defaults.minute<tp_inst._defaults.minuteMin?tp_inst._defaults.minuteMin:tp_inst._defaults.minute>tp_inst._defaults.minuteMax?tp_inst._defaults.minuteMax:tp_inst._defaults.minute,tp_inst.second=tp_inst._defaults.second<tp_inst._defaults.secondMin?tp_inst._defaults.secondMin:tp_inst._defaults.second>tp_inst._defaults.secondMax?tp_inst._defaults.secondMax:tp_inst._defaults.second,tp_inst.millisec=tp_inst._defaults.millisec<tp_inst._defaults.millisecMin?tp_inst._defaults.millisecMin:tp_inst._defaults.millisec>tp_inst._defaults.millisecMax?tp_inst._defaults.millisecMax:tp_inst._defaults.millisec,tp_inst.ampm="",tp_inst.$input=$input,o.altField&&(tp_inst.$altInput=$(o.altField).css({cursor:"pointer"}).focus(function(){$input.trigger("focus")}));if(tp_inst._defaults.minDate===0||tp_inst._defaults.minDateTime===0)tp_inst._defaults.minDate=new Date;if(tp_inst._defaults.maxDate===0||tp_inst._defaults.maxDateTime===0)tp_inst._defaults.maxDate=new Date;return tp_inst._defaults.minDate!==undefined&&tp_inst._defaults.minDate instanceof Date&&(tp_inst._defaults.minDateTime=new Date(tp_inst._defaults.minDate.getTime())),tp_inst._defaults.minDateTime!==undefined&&tp_inst._defaults.minDateTime instanceof Date&&(tp_inst._defaults.minDate=new Date(tp_inst._defaults.minDateTime.getTime())),tp_inst._defaults.maxDate!==undefined&&tp_inst._defaults.maxDate instanceof Date&&(tp_inst._defaults.maxDateTime=new Date(tp_inst._defaults.maxDate.getTime())),tp_inst._defaults.maxDateTime!==undefined&&tp_inst._defaults.maxDateTime instanceof Date&&(tp_inst._defaults.maxDate=new Date(tp_inst._defaults.maxDateTime.getTime())),tp_inst.$input.bind("focus",function(){tp_inst._onFocus()}),tp_inst},_addTimePicker:function(e){var t=this.$altInput&&this._defaults.altFieldTimeOnly?this.$input.val()+" "+this.$altInput.val():this.$input.val();this.timeDefined=this._parseTime(t),this._limitMinMaxDateTime(e,!1),this._injectTimePicker()},_parseTime:function(e,t){this.inst||(this.inst=$.datepicker._getInst(this.$input[0]));if(t||!this._defaults.timeOnly){var n=$.datepicker._get(this.inst,"dateFormat");try{var r=parseDateTimeInternal(n,this._defaults.timeFormat,e,$.datepicker._getFormatConfig(this.inst),this._defaults);if(!r.timeObj)return!1;$.extend(this,r.timeObj)}catch(i){return $.timepicker.log("Error parsing the date/time string: "+i+"\ndate/time string = "+e+"\ntimeFormat = "+this._defaults.timeFormat+"\ndateFormat = "+n),!1}return!0}var s=$.datepicker.parseTime(this._defaults.timeFormat,e,this._defaults);return s?($.extend(this,s),!0):!1},_injectTimePicker:function(){var e=this.inst.dpDiv,t=this.inst.settings,n=this,r="",i="",s={},o={},u=null;if(e.find("div.ui-timepicker-div").length===0&&t.showTimepicker){var a=' style="display:none;"',f='<div class="ui-timepicker-div'+(t.isRTL?" ui-timepicker-rtl":"")+'"><dl>'+'<dt class="ui_tpicker_time_label"'+(t.showTime?"":a)+">"+t.timeText+"</dt>"+'<dd class="ui_tpicker_time"'+(t.showTime?"":a)+"></dd>";for(var l=0,c=this.units.length;l<c;l++){r=this.units[l],i=r.substr(0,1).toUpperCase()+r.substr(1),s[r]=parseInt(t[r+"Max"]-(t[r+"Max"]-t[r+"Min"])%t["step"+i],10),o[r]=0,f+='<dt class="ui_tpicker_'+r+'_label"'+(t["show"+i]?"":a)+">"+t[r+"Text"]+"</dt>"+'<dd class="ui_tpicker_'+r+'"><div class="ui_tpicker_'+r+'_slider"'+(t["show"+i]?"":a)+"></div>";if(t["show"+i]&&t[r+"Grid"]>0){f+='<div style="padding-left: 1px"><table class="ui-tpicker-grid-label"><tr>';if(r=="hour")for(var h=t[r+"Min"];h<=s[r];h+=parseInt(t[r+"Grid"],10)){o[r]++;var p=$.datepicker.formatTime(useAmpm(t.pickerTimeFormat||t.timeFormat)?"hht":"HH",{hour:h},t);f+='<td data-for="'+r+'">'+p+"</td>"}else for(var d=t[r+"Min"];d<=s[r];d+=parseInt(t[r+"Grid"],10))o[r]++,f+='<td data-for="'+r+'">'+(d<10?"0":"")+d+"</td>";f+="</tr></table></div>"}f+="</dd>"}f+='<dt class="ui_tpicker_timezone_label"'+(t.showTimezone?"":a)+">"+t.timezoneText+"</dt>",f+='<dd class="ui_tpicker_timezone" '+(t.showTimezone?"":a)+"></dd>",f+="</dl></div>";var v=$(f);t.timeOnly===!0&&(v.prepend('<div class="ui-widget-header ui-helper-clearfix ui-corner-all"><div class="ui-datepicker-title">'+t.timeOnlyTitle+"</div>"+"</div>"),e.find(".ui-datepicker-header, .ui-datepicker-calendar").hide());for(var l=0,c=n.units.length;l<c;l++)r=n.units[l],i=r.substr(0,1).toUpperCase()+r.substr(1),n[r+"_slider"]=n.control.create(n,v.find(".ui_tpicker_"+r+"_slider"),r,n[r],t[r+"Min"],s[r],t["step"+i]),t["show"+i]&&t[r+"Grid"]>0&&(u=100*o[r]*t[r+"Grid"]/(s[r]-t[r+"Min"]),v.find(".ui_tpicker_"+r+" table").css({width:u+"%",marginLeft:t.isRTL?"0":u/(-2*o[r])+"%",marginRight:t.isRTL?u/(-2*o[r])+"%":"0",borderCollapse:"collapse"}).find("td").click(function(e){var t=$(this),i=t.html(),s=parseInt(i.replace(/[^0-9]/g),10),o=i.replace(/[^apm]/ig),u=t.data("for");u=="hour"&&(o.indexOf("p")!==-1&&s<12?s+=12:o.indexOf("a")!==-1&&s===12&&(s=0)),n.control.value(n,n[u+"_slider"],r,s),n._onTimeChange(),n._onSelectHandler()}).css({cursor:"pointer",width:100/o[r]+"%",textAlign:"center",overflow:"hidden"}));this.timezone_select=v.find(".ui_tpicker_timezone").append("<select></select>").find("select"),$.fn.append.apply(this.timezone_select,$.map(t.timezoneList,function(e,t){return $("<option />").val(typeof e=="object"?e.value:e).text(typeof e=="object"?e.label:e)}));if(typeof this.timezone!="undefined"&&this.timezone!==null&&this.timezone!==""){var m=new Date(this.inst.selectedYear,this.inst.selectedMonth,this.inst.selectedDay,12),g=$.timepicker.timeZoneOffsetString(m);g==this.timezone?selectLocalTimeZone(n):this.timezone_select.val(this.timezone)}else typeof this.hour!="undefined"&&this.hour!==null&&this.hour!==""?this.timezone_select.val(t.defaultTimezone):selectLocalTimeZone(n);this.timezone_select.change(function(){n._defaults.useLocalTimezone=!1,n._onTimeChange(),n._onSelectHandler()});var y=e.find(".ui-datepicker-buttonpane");y.length?y.before(v):e.append(v),this.$timeObj=v.find(".ui_tpicker_time");if(this.inst!==null){var b=this.timeDefined;this._onTimeChange(),this.timeDefined=b}if(this._defaults.addSliderAccess){var w=this._defaults.sliderAccessArgs,E=this._defaults.isRTL;w.isRTL=E,setTimeout(function(){if(v.find(".ui-slider-access").length===0){v.find(".ui-slider:visible").sliderAccess(w);var e=v.find(".ui-slider-access:eq(0)").outerWidth(!0);e&&v.find("table:visible").each(function(){var t=$(this),n=t.outerWidth(),r=t.css(E?"marginRight":"marginLeft").toString().replace("%",""),i=n-e,s=r*i/n+"%",o={width:i,marginRight:0,marginLeft:0};o[E?"marginRight":"marginLeft"]=s,t.css(o)})}},10)}}},_limitMinMaxDateTime:function(e,t){var n=this._defaults,r=new Date(e.selectedYear,e.selectedMonth,e.selectedDay);if(!this._defaults.showTimepicker)return;if($.datepicker._get(e,"minDateTime")!==null&&$.datepicker._get(e,"minDateTime")!==undefined&&r){var i=$.datepicker._get(e,"minDateTime"),s=new Date(i.getFullYear(),i.getMonth(),i.getDate(),0,0,0,0);if(this.hourMinOriginal===null||this.minuteMinOriginal===null||this.secondMinOriginal===null||this.millisecMinOriginal===null)this.hourMinOriginal=n.hourMin,this.minuteMinOriginal=n.minuteMin,this.secondMinOriginal=n.secondMin,this.millisecMinOriginal=n.millisecMin;e.settings.timeOnly||s.getTime()==r.getTime()?(this._defaults.hourMin=i.getHours(),this.hour<=this._defaults.hourMin?(this.hour=this._defaults.hourMin,this._defaults.minuteMin=i.getMinutes(),this.minute<=this._defaults.minuteMin?(this.minute=this._defaults.minuteMin,this._defaults.secondMin=i.getSeconds(),this.second<=this._defaults.secondMin?(this.second=this._defaults.secondMin,this._defaults.millisecMin=i.getMilliseconds()):(this.millisec<this._defaults.millisecMin&&(this.millisec=this._defaults.millisecMin),this._defaults.millisecMin=this.millisecMinOriginal)):(this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal)):(this._defaults.minuteMin=this.minuteMinOriginal,this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal)):(this._defaults.hourMin=this.hourMinOriginal,this._defaults.minuteMin=this.minuteMinOriginal,this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal)}if($.datepicker._get(e,"maxDateTime")!==null&&$.datepicker._get(e,"maxDateTime")!==undefined&&r){var o=$.datepicker._get(e,"maxDateTime"),u=new Date(o.getFullYear(),o.getMonth(),o.getDate(),0,0,0,0);if(this.hourMaxOriginal===null||this.minuteMaxOriginal===null||this.secondMaxOriginal===null)this.hourMaxOriginal=n.hourMax,this.minuteMaxOriginal=n.minuteMax,this.secondMaxOriginal=n.secondMax,this.millisecMaxOriginal=n.millisecMax;e.settings.timeOnly||u.getTime()==r.getTime()?(this._defaults.hourMax=o.getHours(),this.hour>=this._defaults.hourMax?(this.hour=this._defaults.hourMax,this._defaults.minuteMax=o.getMinutes(),this.minute>=this._defaults.minuteMax?(this.minute=this._defaults.minuteMax,this._defaults.secondMax=o.getSeconds(),this.second>=this._defaults.secondMax?(this.second=this._defaults.secondMax,this._defaults.millisecMax=o.getMilliseconds()):(this.millisec>this._defaults.millisecMax&&(this.millisec=this._defaults.millisecMax),this._defaults.millisecMax=this.millisecMaxOriginal)):(this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal)):(this._defaults.minuteMax=this.minuteMaxOriginal,this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal)):(this._defaults.hourMax=this.hourMaxOriginal,this._defaults.minuteMax=this.minuteMaxOriginal,this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal)}if(t!==undefined&&t===!0){var a=parseInt(this._defaults.hourMax-(this._defaults.hourMax-this._defaults.hourMin)%this._defaults.stepHour,10),f=parseInt(this._defaults.minuteMax-(this._defaults.minuteMax-this._defaults.minuteMin)%this._defaults.stepMinute,10),l=parseInt(this._defaults.secondMax-(this._defaults.secondMax-this._defaults.secondMin)%this._defaults.stepSecond,10),c=parseInt(this._defaults.millisecMax-(this._defaults.millisecMax-this._defaults.millisecMin)%this._defaults.stepMillisec,10);this.hour_slider&&(this.control.options(this,this.hour_slider,"hour",{min:this._defaults.hourMin,max:a}),this.control.value(this,this.hour_slider,"hour",this.hour-this.hour%this._defaults.stepHour)),this.minute_slider&&(this.control.options(this,this.minute_slider,"minute",{min:this._defaults.minuteMin,max:f}),this.control.value(this,this.minute_slider,"minute",this.minute-this.minute%this._defaults.stepMinute)),this.second_slider&&(this.control.options(this,this.second_slider,"second",{min:this._defaults.secondMin,max:l}),this.control.value(this,this.second_slider,"second",this.second-this.second%this._defaults.stepSecond)),this.millisec_slider&&(this.control.options(this,this.millisec_slider,"millisec",{min:this._defaults.millisecMin,max:c}),this.control.value(this,this.millisec_slider,"millisec",this.millisec-this.millisec%this._defaults.stepMillisec))}},_onTimeChange:function(){var e=this.hour_slider?this.control.value(this,this.hour_slider,"hour"):!1,t=this.minute_slider?this.control.value(this,this.minute_slider,"minute"):!1,n=this.second_slider?this.control.value(this,this.second_slider,"second"):!1,r=this.millisec_slider?this.control.value(this,this.millisec_slider,"millisec"):!1,i=this.timezone_select?this.timezone_select.val():!1,s=this._defaults,o=s.pickerTimeFormat||s.timeFormat,u=s.pickerTimeSuffix||s.timeSuffix;typeof e=="object"&&(e=!1),typeof t=="object"&&(t=!1),typeof n=="object"&&(n=!1),typeof r=="object"&&(r=!1),typeof i=="object"&&(i=!1),e!==!1&&(e=parseInt(e,10)),t!==!1&&(t=parseInt(t,10)),n!==!1&&(n=parseInt(n,10)),r!==!1&&(r=parseInt(r,10));var a=s[e<12?"amNames":"pmNames"][0],f=e!=this.hour||t!=this.minute||n!=this.second||r!=this.millisec||this.ampm.length>0&&e<12!=($.inArray(this.ampm.toUpperCase(),this.amNames)!==-1)||this.timezone===null&&i!=this.defaultTimezone||this.timezone!==null&&i!=this.timezone;f&&(e!==!1&&(this.hour=e),t!==!1&&(this.minute=t),n!==!1&&(this.second=n),r!==!1&&(this.millisec=r),i!==!1&&(this.timezone=i),this.inst||(this.inst=$.datepicker._getInst(this.$input[0])),this._limitMinMaxDateTime(this.inst,!0)),useAmpm(s.timeFormat)&&(this.ampm=a),this.formattedTime=$.datepicker.formatTime(s.timeFormat,this,s),this.$timeObj&&(o===s.timeFormat?this.$timeObj.text(this.formattedTime+u):this.$timeObj.text($.datepicker.formatTime(o,this,s)+u)),this.timeDefined=!0,f&&this._updateDateTime()},_onSelectHandler:function(){var e=this._defaults.onSelect||this.inst.settings.onSelect,t=this.$input?this.$input[0]:null;e&&t&&e.apply(t,[this.formattedDateTime,this])},_updateDateTime:function(e){e=this.inst||e;var t=$.datepicker._daylightSavingAdjust(new Date(e.selectedYear,e.selectedMonth,e.selectedDay)),n=$.datepicker._get(e,"dateFormat"),r=$.datepicker._getFormatConfig(e),i=t!==null&&this.timeDefined;this.formattedDate=$.datepicker.formatDate(n,t===null?new Date:t,r);var s=this.formattedDate;e.lastVal==""&&(e.currentYear=e.selectedYear,e.currentMonth=e.selectedMonth,e.currentDay=e.selectedDay),this._defaults.timeOnly===!0?s=this.formattedTime:this._defaults.timeOnly!==!0&&(this._defaults.alwaysSetTime||i)&&(s+=this._defaults.separator+this.formattedTime+this._defaults.timeSuffix),this.formattedDateTime=s;if(!this._defaults.showTimepicker)this.$input.val(this.formattedDate);else if(this.$altInput&&this._defaults.altFieldTimeOnly===!0)this.$altInput.val(this.formattedTime),this.$input.val(this.formattedDate);else if(this.$altInput){this.$input.val(s);var o="",u=this._defaults.altSeparator?this._defaults.altSeparator:this._defaults.separator,a=this._defaults.altTimeSuffix?this._defaults.altTimeSuffix:this._defaults.timeSuffix;this._defaults.altFormat?o=$.datepicker.formatDate(this._defaults.altFormat,t===null?new Date:t,r):o=this.formattedDate,o&&(o+=u),this._defaults.altTimeFormat?o+=$.datepicker.formatTime(this._defaults.altTimeFormat,this,this._defaults)+a:o+=this.formattedTime+a,this.$altInput.val(o)}else this.$input.val(s);this.$input.trigger("change")},_onFocus:function(){if(!this.$input.val()&&this._defaults.defaultValue){this.$input.val(this._defaults.defaultValue);var e=$.datepicker._getInst(this.$input.get(0)),t=$.datepicker._get(e,"timepicker");if(t&&t._defaults.timeOnly&&e.input.val()!=e.lastVal)try{$.datepicker._updateDatepicker(e)}catch(n){$.timepicker.log(n)}}},_controls:{slider:{create:function(e,t,n,r,i,s,o){var u=e._defaults.isRTL;return t.prop("slide",null).slider({orientation:"horizontal",value:u?r*-1:r,min:u?s*-1:i,max:u?i*-1:s,step:o,slide:function(t,r){e.control.value(e,$(this),n,u?r.value*-1:r.value),e._onTimeChange()},stop:function(t,n){e._onSelectHandler()}})},options:function(e,t,n,r,i){if(e._defaults.isRTL){if(typeof r=="string")return r=="min"||r=="max"?i!==undefined?t.slider(r,i*-1):Math.abs(t.slider(r)):t.slider(r);var s=r.min,o=r.max;return r.min=r.max=null,s!==undefined&&(r.max=s*-1),o!==undefined&&(r.min=o*-1),t.slider(r)}return typeof r=="string"&&i!==undefined?t.slider(r,i):t.slider(r)},value:function(e,t,n,r){return e._defaults.isRTL?r!==undefined?t.slider("value",r*-1):Math.abs(t.slider("value")):r!==undefined?t.slider("value",r):t.slider("value")}},select:{create:function(e,t,n,r,i,s,o){var u='<select class="ui-timepicker-select" data-unit="'+n+'" data-min="'+i+'" data-max="'+s+'" data-step="'+o+'">',a=e._defaults.timeFormat.indexOf("t")!==-1?"toLowerCase":"toUpperCase",f=0;for(var l=i;l<=s;l+=o)u+='<option value="'+l+'"'+(l==r?" selected":"")+">",n=="hour"&&useAmpm(e._defaults.pickerTimeFormat||e._defaults.timeFormat)?u+=$.datepicker.formatTime("hh TT",{hour:l},e._defaults):n=="millisec"||l>=10?u+=l:u+="0"+l.toString(),u+="</option>";return u+="</select>",t.children("select").remove(),$(u).appendTo(t).change(function(t){e._onTimeChange(),e._onSelectHandler()}),t},options:function(e,t,n,r,i){var s={},o=t.children("select");if(typeof r=="string"){if(i===undefined)return o.data(r);s[r]=i}else s=r;return e.control.create(e,t,o.data("unit"),o.val(),s.min||o.data("min"),s.max||o.data("max"),s.step||o.data("step"))},value:function(e,t,n,r){var i=t.children("select");return r!==undefined?i.val(r):i.val()}}}}),$.fn.extend({timepicker:function(e){e=e||{};var t=Array.prototype.slice.call(arguments);return typeof e=="object"&&(t[0]=$.extend(e,{timeOnly:!0})),$(this).each(function(){$.fn.datetimepicker.apply($(this),t)})},datetimepicker:function(e){e=e||{};var t=arguments;return typeof e=="string"?e=="getDate"?$.fn.datepicker.apply($(this[0]),t):this.each(function(){var e=$(this);e.datepicker.apply(e,t)}):this.each(function(){var t=$(this);t.datepicker($.timepicker._newInst(t,e)._defaults)})}}),$.datepicker.parseDateTime=function(e,t,n,r,i){var s=parseDateTimeInternal(e,t,n,r,i);if(s.timeObj){var o=s.timeObj;s.date.setHours(o.hour,o.minute,o.second,o.millisec)}return s.date},$.datepicker.parseTime=function(e,t,n){var r=extendRemove(extendRemove({},$.timepicker._defaults),n||{}),i=function(e,t,n){var r=function(e,t){var n=[];return e&&$.merge(n,e),t&&$.merge(n,t),n=$.map(n,function(e){return e.replace(/[.*+?|()\[\]{}\\]/g,"\\$&")}),"("+n.join("|")+")?"},i=function(e){var t=e.toLowerCase().match(/(h{1,2}|m{1,2}|s{1,2}|l{1}|t{1,2}|z|'.*?')/g),n={h:-1,m:-1,s:-1,l:-1,t:-1,z:-1};if(t)for(var r=0;r<t.length;r++)n[t[r].toString().charAt(0)]==-1&&(n[t[r].toString().charAt(0)]=r+1);return n},s="^"+e.toString().replace(/([hH]{1,2}|mm?|ss?|[tT]{1,2}|[lz]|'.*?')/g,function(e){var t=e.length;switch(e.charAt(0).toLowerCase()){case"h":return t===1?"(\\d?\\d)":"(\\d{"+t+"})";case"m":return t===1?"(\\d?\\d)":"(\\d{"+t+"})";case"s":return t===1?"(\\d?\\d)":"(\\d{"+t+"})";case"l":return"(\\d?\\d?\\d)";case"z":return"(z|[-+]\\d\\d:?\\d\\d|\\S+)?";case"t":return r(n.amNames,n.pmNames);default:return"("+e.replace(/\'/g,"").replace(/(\.|\$|\^|\\|\/|\(|\)|\[|\]|\?|\+|\*)/g,function(e){return"\\"+e})+")?"}}).replace(/\s/g,"\\s?")+n.timeSuffix+"$",o=i(e),u="",a;a=t.match(new RegExp(s,"i"));var f={hour:0,minute:0,second:0,millisec:0};if(a){o.t!==-1&&(a[o.t]===undefined||a[o.t].length===0?(u="",f.ampm=""):(u=$.inArray(a[o.t].toUpperCase(),n.amNames)!==-1?"AM":"PM",f.ampm=n[u=="AM"?"amNames":"pmNames"][0])),o.h!==-1&&(u=="AM"&&a[o.h]=="12"?f.hour=0:u=="PM"&&a[o.h]!="12"?f.hour=parseInt(a[o.h],10)+12:f.hour=Number(a[o.h])),o.m!==-1&&(f.minute=Number(a[o.m])),o.s!==-1&&(f.second=Number(a[o.s])),o.l!==-1&&(f.millisec=Number(a[o.l]));if(o.z!==-1&&a[o.z]!==undefined){var l=a[o.z].toUpperCase();switch(l.length){case 1:l=n.timezoneIso8601?"Z":"+0000";break;case 5:n.timezoneIso8601&&(l=l.substring(1)=="0000"?"Z":l.substring(0,3)+":"+l.substring(3));break;case 6:n.timezoneIso8601?l.substring(1)=="00:00"&&(l="Z"):l=l=="Z"||l.substring(1)=="00:00"?"+0000":l.replace(/:/,"")}f.timezone=l}return f}return!1},s=function(e,t,n){try{var r=new Date("2012-01-01 "+t);if(isNaN(r.getTime())){r=new Date("2012-01-01T"+t);if(isNaN(r.getTime())){r=new Date("01/01/2012 "+t);if(isNaN(r.getTime()))throw"Unable to parse time with native Date: "+t}}return{hour:r.getHours(),minute:r.getMinutes(),second:r.getSeconds(),millisec:r.getMilliseconds(),timezone:$.timepicker.timeZoneOffsetString(r)}}catch(s){try{return i(e,t,n)}catch(o){$.timepicker.log("Unable to parse \ntimeString: "+t+"\ntimeFormat: "+e)}}return!1};return typeof r.parse=="function"?r.parse(e,t,r):r.parse==="loose"?s(e,t,r):i(e,t,r)},$.datepicker.formatTime=function(e,t,n){n=n||{},n=$.extend({},$.timepicker._defaults,n),t=$.extend({hour:0,minute:0,second:0,millisec:0,timezone:"+0000"},t);var r=e,i=n.amNames[0],s=parseInt(t.hour,10);return s>11&&(i=n.pmNames[0]),r=r.replace(/(?:HH?|hh?|mm?|ss?|[tT]{1,2}|[lz]|('.*?'|".*?"))/g,function(e){switch(e){case"HH":return("0"+s).slice(-2);case"H":return s;case"hh":return("0"+convert24to12(s)).slice(-2);case"h":return convert24to12(s);case"mm":return("0"+t.minute).slice(-2);case"m":return t.minute;case"ss":return("0"+t.second).slice(-2);case"s":return t.second;case"l":return("00"+t.millisec).slice(-3);case"z":return t.timezone===null?n.defaultTimezone:t.timezone;case"T":return i.charAt(0).toUpperCase();case"TT":return i.toUpperCase();case"t":return i.charAt(0).toLowerCase();case"tt":return i.toLowerCase();default:return e.replace(/\'/g,"")||"'"}}),r=$.trim(r),r},$.datepicker._base_selectDate=$.datepicker._selectDate,$.datepicker._selectDate=function(e,t){var n=this._getInst($(e)[0]),r=this._get(n,"timepicker");r?(r._limitMinMaxDateTime(n,!0),n.inline=n.stay_open=!0,this._base_selectDate(e,t),n.inline=n.stay_open=!1,this._notifyChange(n),this._updateDatepicker(n)):this._base_selectDate(e,t)},$.datepicker._base_updateDatepicker=$.datepicker._updateDatepicker,$.datepicker._updateDatepicker=function(e){var t=e.input[0];if($.datepicker._curInst&&$.datepicker._curInst!=e&&$.datepicker._datepickerShowing&&$.datepicker._lastInput!=t)return;if(typeof e.stay_open!="boolean"||e.stay_open===!1){this._base_updateDatepicker(e);var n=this._get(e,"timepicker");n&&n._addTimePicker(e)}},$.datepicker._base_doKeyPress=$.datepicker._doKeyPress,$.datepicker._doKeyPress=function(e){var t=$.datepicker._getInst(e.target),n=$.datepicker._get(t,"timepicker");if(n&&$.datepicker._get(t,"constrainInput")){var r=useAmpm(n._defaults.timeFormat),i=$.datepicker._possibleChars($.datepicker._get(t,"dateFormat")),s=n._defaults.timeFormat.toString().replace(/[hms]/g,"").replace(/TT/g,r?"APM":"").replace(/Tt/g,r?"AaPpMm":"").replace(/tT/g,r?"AaPpMm":"").replace(/T/g,r?"AP":"").replace(/tt/g,r?"apm":"").replace(/t/g,r?"ap":"")+" "+n._defaults.separator+n._defaults.timeSuffix+(n._defaults.showTimezone?n._defaults.timezoneList.join(""):"")+n._defaults.amNames.join("")+n._defaults.pmNames.join("")+i,o=String.fromCharCode(e.charCode===undefined?e.keyCode:e.charCode);return e.ctrlKey||o<" "||!i||s.indexOf(o)>-1}return $.datepicker._base_doKeyPress(e)},$.datepicker._base_updateAlternate=$.datepicker._updateAlternate,$.datepicker._updateAlternate=function(e){var t=this._get(e,"timepicker");if(t){var n=t._defaults.altField;if(n){var r=t._defaults.altFormat||t._defaults.dateFormat,i=this._getDate(e),s=$.datepicker._getFormatConfig(e),o="",u=t._defaults.altSeparator?t._defaults.altSeparator:t._defaults.separator,a=t._defaults.altTimeSuffix?t._defaults.altTimeSuffix:t._defaults.timeSuffix,f=t._defaults.altTimeFormat!==null?t._defaults.altTimeFormat:t._defaults.timeFormat;o+=$.datepicker.formatTime(f,t,t._defaults)+a,!t._defaults.timeOnly&&!t._defaults.altFieldTimeOnly&&i!==null&&(t._defaults.altFormat?o=$.datepicker.formatDate(t._defaults.altFormat,i,s)+u+o:o=t.formattedDate+u+o),$(n).val(o)}}else $.datepicker._base_updateAlternate(e)},$.datepicker._base_doKeyUp=$.datepicker._doKeyUp,$.datepicker._doKeyUp=function(e){var t=$.datepicker._getInst(e.target),n=$.datepicker._get(t,"timepicker");if(n&&n._defaults.timeOnly&&t.input.val()!=t.lastVal)try{$.datepicker._updateDatepicker(t)}catch(r){$.timepicker.log(r)}return $.datepicker._base_doKeyUp(e)},$.datepicker._base_gotoToday=$.datepicker._gotoToday,$.datepicker._gotoToday=function(e){var t=this._getInst($(e)[0]),n=t.dpDiv;this._base_gotoToday(e);var r=this._get(t,"timepicker");selectLocalTimeZone(r);var i=new Date;this._setTime(t,i),$(".ui-datepicker-today",n).click()},$.datepicker._disableTimepickerDatepicker=function(e){var t=this._getInst(e);if(!t)return;var n=this._get(t,"timepicker");$(e).datepicker("getDate"),n&&(n._defaults.showTimepicker=!1,n._updateDateTime(t))},$.datepicker._enableTimepickerDatepicker=function(e){var t=this._getInst(e);if(!t)return;var n=this._get(t,"timepicker");$(e).datepicker("getDate"),n&&(n._defaults.showTimepicker=!0,n._addTimePicker(t),n._updateDateTime(t))},$.datepicker._setTime=function(e,t){var n=this._get(e,"timepicker");if(n){var r=n._defaults;n.hour=t?t.getHours():r.hour,n.minute=t?t.getMinutes():r.minute,n.second=t?t.getSeconds():r.second,n.millisec=t?t.getMilliseconds():r.millisec,n._limitMinMaxDateTime(e,!0),n._onTimeChange(),n._updateDateTime(e)}},$.datepicker._setTimeDatepicker=function(e,t,n){var r=this._getInst(e);if(!r)return;var i=this._get(r,"timepicker");if(i){this._setDateFromField(r);var s;t&&(typeof t=="string"?(i._parseTime(t,n),s=new Date,s.setHours(i.hour,i.minute,i.second,i.millisec)):s=new Date(t.getTime()),s.toString()=="Invalid Date"&&(s=undefined),this._setTime(r,s))}},$.datepicker._base_setDateDatepicker=$.datepicker._setDateDatepicker,$.datepicker._setDateDatepicker=function(e,t){var n=this._getInst(e);if(!n)return;var r=t instanceof Date?new Date(t.getTime()):t;this._updateDatepicker(n),this._base_setDateDatepicker.apply(this,arguments),this._setTimeDatepicker(e,r,!0)},$.datepicker._base_getDateDatepicker=$.datepicker._getDateDatepicker,$.datepicker._getDateDatepicker=function(e,t){var n=this._getInst(e);if(!n)return;var r=this._get(n,"timepicker");if(r){n.lastVal===undefined&&this._setDateFromField(n,t);var i=this._getDate(n);return i&&r._parseTime($(e).val(),r.timeOnly)&&i.setHours(r.hour,r.minute,r.second,r.millisec),i}return this._base_getDateDatepicker(e,t)},$.datepicker._base_parseDate=$.datepicker.parseDate,$.datepicker.parseDate=function(e,t,n){var r;try{r=this._base_parseDate(e,t,n)}catch(i){r=this._base_parseDate(e,t.substring(0,t.length-(i.length-i.indexOf(":")-2)),n),$.timepicker.log("Error parsing the date string: "+i+"\ndate string = "+t+"\ndate format = "+e)}return r},$.datepicker._base_formatDate=$.datepicker._formatDate,$.datepicker._formatDate=function(e,t,n,r){var i=this._get(e,"timepicker");return i?(i._updateDateTime(e),i.$input.val()):this._base_formatDate(e)},$.datepicker._base_optionDatepicker=$.datepicker._optionDatepicker,$.datepicker._optionDatepicker=function(e,t,n){var r=this._getInst(e),i;if(!r)return null;var s=this._get(r,"timepicker");if(s){var o=null,u=null,a=null,f=s._defaults.evnts,l={},c;if(typeof t=="string"){if(t==="minDate"||t==="minDateTime")o=n;else if(t==="maxDate"||t==="maxDateTime")u=n;else if(t==="onSelect")a=n;else if(f.hasOwnProperty(t)){if(typeof n=="undefined")return f[t];l[t]=n,i={}}}else if(typeof t=="object"){t.minDate?o=t.minDate:t.minDateTime?o=t.minDateTime:t.maxDate?u=t.maxDate:t.maxDateTime&&(u=t.maxDateTime);for(c in f)f.hasOwnProperty(c)&&t[c]&&(l[c]=t[c])}for(c in l)l.hasOwnProperty(c)&&(f[c]=l[c],i||(i=$.extend({},t)),delete i[c]);if(i&&isEmptyObject(i))return;o?(o===0?o=new Date:o=new Date(o),s._defaults.minDate=o,s._defaults.minDateTime=o):u?(u===0?u=new Date:u=new Date(u),s._defaults.maxDate=u,s._defaults.maxDateTime=u):a&&(s._defaults.onSelect=a)}return n===undefined?this._base_optionDatepicker.call($.datepicker,e,t):this._base_optionDatepicker.call($.datepicker,e,i||t,n)};var isEmptyObject=function(e){var t;for(t in e)if(e.hasOwnProperty(e))return!1;return!0},extendRemove=function(e,t){$.extend(e,t);for(var n in t)if(t[n]===null||t[n]===undefined)e[n]=t[n];return e},useAmpm=function(e){return e.indexOf("t")!==-1&&e.indexOf("h")!==-1},convert24to12=function(e){return e>12&&(e-=12),e==0&&(e=12),String(e)},splitDateTime=function(e,t,n,r){try{var i=r&&r.separator?r.separator:$.timepicker._defaults.separator,s=r&&r.timeFormat?r.timeFormat:$.timepicker._defaults.timeFormat,o=s.split(i),u=o.length,a=t.split(i),f=a.length;if(f>1)return[a.splice(0,f-u).join(i),a.splice(0,u).join(i)]}catch(l){$.timepicker.log("Could not split the date from the time. Please check the following datetimepicker options\nthrown error: "+l+"\ndateTimeString"+t+"\ndateFormat = "+e+"\nseparator = "+r.separator+"\ntimeFormat = "+r.timeFormat);if(l.indexOf(":")>=0){var c=t.length-(l.length-l.indexOf(":")-2),h=t.substring(c);return[$.trim(t.substring(0,c)),$.trim(t.substring(c))]}throw l}return[t,""]},parseDateTimeInternal=function(e,t,n,r,i){var s,o=splitDateTime(e,n,r,i);s=$.datepicker._base_parseDate(e,o[0],r);if(o[1]!==""){var u=o[1],a=$.datepicker.parseTime(t,u,i);if(a===null)throw"Wrong time format";return{date:s,timeObj:a}}return{date:s}},selectLocalTimeZone=function(e,t){if(e&&e.timezone_select){e._defaults.useLocalTimezone=!0;var n=typeof t!="undefined"?t:new Date,r=$.timepicker.timeZoneOffsetString(n);e._defaults.timezoneIso8601&&(r=r.substring(0,3)+":"+r.substring(3)),e.timezone_select.val(r)}};$.timepicker=new Timepicker,$.timepicker.timeZoneOffsetString=function(e){var t=e.getTimezoneOffset()*-1,n=t%60,r=(t-n)/60;return(t>=0?"+":"-")+("0"+(r*101).toString()).slice(-2)+("0"+(n*101).toString()).slice(-2)},$.timepicker.timeRange=function(e,t,n){return $.timepicker.handleRange("timepicker",e,t,n)},$.timepicker.dateTimeRange=function(e,t,n){$.timepicker.dateRange(e,t,n,"datetimepicker")},$.timepicker.dateRange=function(e,t,n,r){r=r||"datepicker",$.timepicker.handleRange(r,e,t,n)},$.timepicker.handleRange=function(e,t,n,r){function i(e,r,i){r.val()&&new Date(t.val())>new Date(n.val())&&r.val(i)}function s(t,n,r){if(!$(t).val())return;var i=$(t)[e].call($(t),"getDate");i.getTime&&$(n)[e].call($(n),"option",r,i)}return $.fn[e].call(t,$.extend({onClose:function(e,t){i(this,n,e)},onSelect:function(e){s(this,n,"minDate")}},r,r.start)),$.fn[e].call(n,$.extend({onClose:function(e,n){i(this,t,e)},onSelect:function(e){s(this,t,"maxDate")}},r,r.end)),e!="timepicker"&&r.reformat&&$([t,n]).each(function(){var t=$(this)[e].call($(this),"option","dateFormat"),n=new Date($(this).val());$(this).val()&&n&&$(this).val($.datepicker.formatDate(t,n))}),i(t,n,t.val()),s(t,n,"minDate"),s(n,t,"maxDate"),$([t.get(0),n.get(0)])},$.timepicker.log=function(e){window.console&&console.log(e)},$.timepicker.version="1.2"}),define("OpenSearchService",["jquery","underscore-min","text!../templates/openSearchService.html","text!../templates/openSearchForm.html","jquery.ui","jquery.ui.timepicker"],function(e,t,n,r){function u(t){t.preventDefault();var n=e(this).data("layer"),r=e(this).find(':input[value!=""]').serializeArray(),i={};for(var s=0;s<r.length;s++)i[r[s].name.toString()]=r[s].value.toString();var o;e(this).find("select").each(function(t){e(this).val()&&(i[e(this).attr("name")]=e(this).val())}),n.setRequestProperties(i)}function a(t){e("#osForm_"+t.id).html(t.openSearchForm?t.openSearchForm:"Loading...").find(".openSearchForm").data("layer",t).submit(u).end().find(".datepicker").datetimepicker({showSecond:!0,separator:"T",timeSuffix:"Z",timeFormat:"HH:mm:ss"}),e("#openSearchTabs").tabs("refresh")}function f(t){e.ajax({type:"GET",url:t.serviceUrl,dataType:"xml",success:function(n){var r=e(n).find('Url[rel="mspdesc"]'),i=e(r).attr("template");e.ajax({type:"GET",url:i,dataType:"json",success:function(e){var n=e.filters;t.openSearchForm=s({layer:t,properties:n}),a(t)},error:function(){t.openSearchForm="OpenSearch parameter isn't available",e("#osForm_"+t.id).html(t.openSearchForm)}})},error:function(n){e("#osForm_"+t.id).html("("+n.status+") "+n.statusText+"<br/>For more details, contact administrator.")}})}var i=t.template(n),s=t.template(r),o=[];return{addLayer:function(t){o.push(t),t.openSearchForm||f(t),e("#openSearchTabs").children(".ui-tabs-nav").append('<li><a href="#osForm_'+t.id+'">'+t.name+"</a></li>"),e("#openSearchTabs").append('<div id="osForm_'+t.id+'">'+t.openSearchForm+"</div>"),a(t)},removeLayer:function(t){for(var n=0;n<o.length;n++)o[n].id==t.id&&o.splice(n,1);var r=e("#openSearchTabs").find('.ui-tabs-nav li[aria-controls="osForm_'+t.id+'"]').index();e("#openSearchTabs").tabs("remove",r),e("#openSearchTabs").tabs("refresh")},addService:function(t){e('<li style="display: none;"><a href="#OpenSearchService">OpenSearch</a></li>').appendTo(t.children(".ui-tabs-nav")).fadeIn(300),t.append('<div id="OpenSearchService"></div>');var n=i({layers:o});e(n).appendTo("#OpenSearchService").tabs({collapsible:!0,hide:{effect:"fadeOut",duration:300},show:{effect:"fadeIn",duration:300}}).find(".openSearchForm").submit(u).end().find(".datepicker").datetimepicker({showSecond:!0,separator:"T",timeSuffix:"Z",timeFormat:"HH:mm:ss"})},removeService:function(t){var n=e(this).index();t.tabs("remove",n)}}}),define("MocBase",["jquery","./MocLayer","./Utils"],function(e,t,n){function r(t,n,r){e.ajax({type:"GET",url:t.serviceUrl,dataType:"xml",success:function(i){var s=e(i).find('Url[rel="mocdesc"]'),o=e(s).attr("template");if(o){var u=o.indexOf("?q=");u!=-1&&(o=o.substring(0,u)),t.describeUrl=o,n(t)}else t.describeUrl="Not available",t.coverage="Not available",r&&r(t)},error:function(e){t.describeUrl="Not available",t.coverage="Not available",r&&r(t)}})}function i(e,t,n){e.coverage!="Not available"?e.describeUrl?o(e,e.describeUrl+"?media=txt",t):r(e,function(e){o(e,e.describeUrl+"?media=txt",t)},n):n(e)}function s(e,t,n){e.describeUrl!="Not available"?e.describeUrl?(u(e,e.describeUrl),o(e,e.describeUrl+"?media=txt",t)):r(e,function(e){u(e,e.describeUrl),o(e,e.describeUrl+"?media=txt",t)},n):n(e)}function o(t,r,i){t.coverage?i(t):e.ajax({type:"GET",url:r,success:function(e){t.coverage=n.roundNumber(parseFloat(e),5)+"%",i&&i(t)}})}function u(e,n){var r=e.style,i=new t({serviceUrl:n,style:e.style,visible:!1});i.style.fill=!0,i.style.fillColor[3]=.3,e.globe&&e.visible()&&e.globe.addLayer(i),e.subLayers||(e.subLayers=[]),e.subLayers.push(i)}function a(e){if(e.subLayers)for(var n=0;n<e.subLayers.length;n++)if(e.subLayers[n]instanceof t)return e.subLayers[n];return null}return{createMocSublayer:s,findMocSublayer:a,getSkyCoverage:i,requestSkyCoverage:o}}),define("text!../templates/mocServiceItem.html",[],function(){return'<div class="mocLayer" id ="mocLayer_<%=layer.id%>">\n	<% if( display )\n	{\n	%>\n		<input class="display" id="display_<%=layer.id%>" type="checkbox" /><label for="display_<%=layer.id%>">Display</label>\n	<%\n	}\n	else\n	{\n	%>\n		<input id="mocCheck_<%=layer.id%>" type="checkbox" /><label for="mocCheck_<%=layer.id%>">Check</label>\n	<%\n	}\n	%>\n	<span class="mocName"><%=layer.name%></span>\n	<span class="mocStatus"><% if ( layer.coverage == "Not available" ) print("(Not found)"); %> </span>\n	<span class="mocCoverage">Sky coverage: <%= layer.coverage %></span>\n	<br/>\n</div>\n'}),define("MocService",["jquery","./MocLayer","./MocBase","underscore-min","text!../templates/mocServiceItem.html"],function(e,t,n,r,i){function a(){var r=e(this).parent().data("layer"),i;r instanceof t?i=r:i=n.findMocSublayer(r),i&&(this.checked?i.visible(!0):i.visible(!1))}function f(t){var r=s({layer:t,display:!0}),i=n.findMocSublayer(t);e(r).appendTo("#MocService .mocLayers").data("layer",t).find('input[type="checkbox"]').attr("checked",i&&i.visible()?!0:!1).attr("disabled",i?!1:!0).button().click(a)}var s=r.template(i),o=null,u=[];return{init:function(e){o=e},addLayer:function(t){u.push(t),t.subLayers||(t.subLayers=[]);var r=n.findMocSublayer(t);r||n.createMocSublayer(t,function(t){e("#MocService #mocLayer_"+t.id).find('input[type="checkbox"]').removeAttr("disabled").button("refresh"),e("#MocService #mocLayer_"+t.id).find(".mocCoverage").html("Sky coverage: "+t.coverage)},function(t){e("#MocService #mocLayer_"+t.id).find(".mocCoverage").html("Sky coverage: Not available").end().find(".mocStatus").html("(Not found)")}),f(t)},removeLayer:function(t){for(var n=0;n<u.length;n++)u[n].id==t.id&&u.splice(n,1);e("#MocService #mocLayer_"+t.id).remove()},addService:function(t){e('<li style="display: none;"><a href="#MocService">Moc</a></li>').appendTo(t.children(".ui-tabs-nav")).fadeIn(300),t.append('<div id="MocService">						<div class="mocLayers"></div>					</div>');for(var n=0;n<u.length;n++){var r=u[n];f(r)}},removeService:function(t){e('li[aria-controls="MocService"]').remove(),e("#MocService").remove(),t.tabs("refresh")}}}),define("XMatchService",["jquery","./LayerManager","gw/FeatureStyle","./MocLayer","./MocBase","gw/OpenSearchLayer","./ErrorDialog","underscore-min","text!../templates/mocServiceItem.html","jquery.ui"],function(e,t,n,r,i,s,o,u,a){function p(){var t=e(this).parent().data("layer"),n;t instanceof r?n=t:n=i.findMocSublayer(t),n&&(this.checked?n.visible(!0):n.visible(!1))}function d(t){var n=f({layer:t,display:!1});e(n).appendTo("#xMatchService .mocLayers").data("layer",t).find('input[type="checkbox"]').attr("disabled",t.coverage&&t.coverage!="Not available"?!1:!0).button({text:!1,icons:{primary:"ui-icon-empty"}}).click(function(){e(this).button("option",{icons:{primary:e(this).is(":checked")?"ui-icon-check":"ui-icon-empty"}})})}function v(){var t=f({layer:c,display:!0});e(t).appendTo("#intersectResult").data("layer",c).find(".display").button().click(p),e("#intersectResult").slideDown(),e("#intersectMocBtn").removeAttr("disabled").button("refresh")}function m(t){if(l){var s=l,u="";for(var a=0;a<t.length;a++){var f=t[a];u+=f.name,s+=f.describeUrl,a!=t.length-1&&(s+=";",u+=" x ")}c&&h.removeLayer(c),c=new r({name:"Intersection( "+u+" )",serviceUrl:s+"&media=json",style:new n({rendererHint:"Basic",fill:!0,fillColor:[1,0,0,.3]}),visible:!1}),h.addLayer(c),i.requestSkyCoverage(c,s+"&media=txt",function(t){e("#xMatchService #mocLayer_"+t.id).find(".mocCoverage").html("Sky coverage: "+t.coverage)}),v()}else o.open("Coverage service URL isn't defined in configuration file"),e("#intersectMocBtn").removeAttr("disabled").button("refresh")}var f=u.template(a),l,c,h;return{init:function(e,t){h=e,t.coverageService&&(l=t.coverageService.baseUrl)},addLayer:function(t){t.coverage!="Not available"&&e("#xMatchService #mocCheck_"+t.id).attr("checked","checked").button("option",{icons:{primary:"ui-icon-check"}}).button("refresh"),e("#xMatchService #mocLayer_"+t.id).append("<br/>").prependTo("#xMatchService .mocLayers")},removeLayer:function(t){e("#xMatchService #mocCheck_"+t.id).removeAttr("checked")},addService:function(n){e('<li style="display: none;"><a href="#xMatchService">xMatch</a></li>').appendTo(n.children(".ui-tabs-nav")).fadeIn(300),n.append('<div id="xMatchService">				<div class="mocLayers"></div>					<button id="intersectMocBtn">Intersect</button>				<div id="intersectResult"></div>			</div>');var r=t.getLayers(),o=u.filter(r,function(e){return e instanceof s});for(var a=0;a<o.length;a++){var f=o[a],l=i.findMocSublayer(f);l||i.getSkyCoverage(f,function(t){e("#xMatchService #mocLayer_"+t.id).find(".mocCoverage").html("Sky coverage: "+t.coverage),e("#xMatchService #mocLayer_"+t.id).find('input[type="checkbox"]').removeAttr("disabled").button("refresh")},function(t){e("#xMatchService #mocLayer_"+t.id).find(".mocCoverage").html("Sky coverage: Not available").end().find(".mocStatus").html("(Not found)"),e("#xMatchService #mocLayer_"+t.id).find('input[type="checkbox"]').removeAttr("checked").button("option",{icons:{primary:"ui-icon-empty"}}).button("refresh")}),d(f)}e("#intersectMocBtn").button().click(function(){e(this).attr("disabled","disabled").button("refresh"),e("#intersectResult").clearQueue().stop().slideUp(function(){var t=e(this).parent().find(".mocLayers .mocLayer input:checked");if(t.length<2)e("#intersectResult").html("Check at least two layers").slideDown().delay(700).slideUp(function(){e("#intersectMocBtn").removeAttr("disabled").button("refresh")});else{e("#intersectResult").html("");var n=[];t.each(function(r){n.push(e.data(t[r].parentElement,"layer"))}),m(n)}})})},removeService:function(n){n.find('.ui-tabs-nav li[aria-controls="xMatchService"]').remove(),e("#xMatchService").remove(),n.tabs("refresh");var r=t.getLayers(),i=u.filter(r,function(e){return e instanceof s});for(var o=0;o<i.length;o++){var a=i[o];e("#xMatchService #mocLayer_"+a.id).remove()}c&&(h.removeLayer(c),c=null)}}}),define("text!../templates/healpixCutService.html",[],function(){return'<div id="HEALPixCut">\n	Arcsec per pixel of result:\n	<div style="margin-left: 20px; margin-bottom: 10px;" class="imageProperties">\n		<label for="cdelt1">X axis: </label><input type="text" id="cdelt1" /><br/>\n		<label for="cdelt2">Y axis: </label><input type="text" id="cdelt2" />\n	</div>\n	<button style="margin-left: auto; margin-right: auto; display: block;" id="HEALPixCutBtn">Cut viewport</button>\n	<div style="display: inline-block; width: auto; height: 1em;" class="status"></div>\n	<div style="margin-top: 15px;">\n		<em style="font-size: 14px;">Results</em>\n		<div class="HEALPixCutResults">\n			<ul style="list-style-type: none;">\n				<% \n				for ( var i=0; i<results.length; i++ )\n				{\n					print( itemTemplate( { result: results[i] } ) );\n				}\n				%>\n			</ul>\n		</div>\n	</div>\n</div>'}),define("HEALPixCutService",["jquery","gw/CoordinateSystem","gw/Numeric","./UWSManager","./Samp","./ErrorDialog","./Utils","underscore-min","text!../templates/healpixCutService.html","text!../templates/cutResultItem.html","jquery.ui"],function(e,t,n,r,i,s,o,u,a,f){var l,c,h=[],p=u.template(a),d=u.template(f);return{init:function(e,t){l=e,c=t},addService:function(n,u){e('<li style="display: none;"><a href="#HEALPixCut">HEALPixCut</a></li>').appendTo(n.children(".ui-tabs-nav")).fadeIn(300);var a=p({itemTemplate:d,results:h});n.append(a).find("li").fadeIn(),n.find("input").on("focus",function(){e(this).removeClass("inputError")}),e("#HEALPixCut").on("click",".sampExport",function(t){i.isConnected()?i.sendImage(e(this).data("url")):s.open("You must be connected to SAMP Hub")}),e("#HEALPixCut").on("click",".deleteResult",function(t){var n=e(this).parent(),i=n.data("jobid");r.delete("healpixcut",i,{successCallback:function(){n.fadeOut(function(){e(this).remove()})},failCallback:function(t){console.error(t),n.fadeOut(function(){e(this).remove()})}})}),e("#HEALPixCutBtn").button().click(function(n){var i=[[0,0],[l.renderContext.canvas.width,0],[l.renderContext.canvas.width,l.renderContext.canvas.height],[0,l.renderContext.canvas.height]];for(var a=0;a<i.length;a++){var f=l.getLonLatFromPixel(i[a][0],i[a][1]);f[0]<0&&(f[0]+=360),i[a]=f}var p=[];t.from3DToGeo(c.center3d,p);var v=[];t.getLHVTransform(p,v);var m=o.formatCoordinates([p[0],p[1]]),g=[v[4],v[5],v[6]],y=vec3.dot(c.up,g),b=Math.acos(y);if(isNaN(b)){console.error("North is NaN'ed...");return}var w=b*180/Math.PI;l.renderContext.viewMatrix[8]<0&&(w*=-1);var E=parseFloat(e("#cdelt1").val()),S=parseFloat(e("#cdelt2").val()),x=l.tileManager.imageryProvider;u.fileName||s.open("FITS fileName isn't defined for HealpixCut service<br/>");if(isNaN(E)||isNaN(S)){e("#HEALPixCut").find("input").each(function(){e(this).val()||e(this).addClass("inputError")});return}var T={long1:i[0][0],lat1:i[0][1],long2:i[1][0],lat2:i[1][1],long3:i[2][0],lat3:i[2][1],long4:i[3][0],lat4:i[3][1],rotation:w,coordSystem:"EQUATORIAL",cdelt1:E,cdelt2:S,filename:u.fileName,PHASE:"RUN"};e("#HEALPixCut").find(".status").html("Healpix cut is in progress, be patient, it may take some time.").fadeIn().css("display: inline-block"),r.post("healpixcut",T,{successCallback:function(t,n){var r="Viewport ( "+m[0]+" x "+m[1]+" )",i={name:r,url:t.results.result[0]["@xlink:href"],downloadName:r.replace('"',"&quot;")+".fits",jobId:n};h.push(i),e("#HEALPixCut").find(".status").hide();var s=d({result:i});e(s).appendTo(e("#HEALPixCut").find(".HEALPixCutResults ul")).fadeIn()},failCallback:function(t){e("#HEALPixCut").find(".status").hide(),s.open(t)},onloadCallback:function(){e("#HEALPixCut").find(".status").animate({opacity:0},400,function(){e(this).animate({opacity:1},400)})}})})},removeService:function(t){t.find('.ui-tabs-nav li[aria-controls="HEALPixCut"]').css("opacity",0);var n=e(this).index();t.tabs("remove",n)}}}),define("LayerServiceView",["jquery","./OpenSearchService","./MocService","./XMatchService","./HEALPixCutService","jquery.ui"],function(e,t,n,r,i){function c(e){return typeof e=="string"?f[e]:e.name?f[e.name]:(console.error("Service must have name property in configuration"),null)}var s='<div id="layerServiceView" title="Available services">							<div id="layerServices">								<ul>								</ul>							</div>						</div>',o,u,a=[t,n,r],f={OpenSearch:t,Moc:n,XMatch:r,HEALPixCut:i},l;return{init:function(t,a){o=e(s).appendTo("body").dialog({autoOpen:!1,resizable:!1,width:"600px",show:{effect:"fade",duration:300},hide:{effect:"fade",duration:300},minHeight:"auto",position:["middle",20],open:function(){e(this).find("li:first-child").blur()}}),u=o.find("#layerServices").tabs({collapsible:!0,hide:{effect:"slideUp",duration:300},show:{effect:"slideDown",duration:300}}),n.init(t.sky,a),r.init(t.sky,a),i.init(t.sky,t.navigation)},remove:function(){o.find("#layerServices").tabs("destroy"),o.dialog("destroy").remove()},show:function(e){var t;if(l)for(var n=0;n<l.availableServices.length;n++)t=c(l.availableServices[n]),t.removeLayer&&t.removeLayer(l),t.removeService(u,l.availableServices[n]);for(var n=0;n<e.availableServices.length;n++)t=c(e.availableServices[n]),t?(t.addService(u,e.availableServices[n]),t.addLayer&&t.addLayer(e)):(console.error("Mapping doesn't exist, service must be = { OpenSearch, Moc, XMatch or HEALPixCut }"),e.availableServices.splice(n,1));l=e,u.tabs("refresh"),u.tabs("option","active",0),o.dialog("open")}}}),define("BackgroundLayersView",["jquery","underscore-min","./LayerManager","./DynamicImageView","./PickingManager","./HEALPixFITSLayer","./LayerServiceView","./Samp","./ErrorDialog","jquery.ui"],function(e,t,n,r,i,s,o,u,a){function d(t){t instanceof s?(e("#fitsType").removeAttr("disabled").removeAttr("checked").button("refresh"),t.dataType=="jpeg"&&e("#fitsView").button("disable")):(e("#fitsType").attr("disabled","disabled").button("refresh"),e("#fitsView").button("disable"));var n=e("#backgroundLayers").find(".layerServices");t.availableServices?n.removeAttr("disabled").button("refresh"):n.attr("disabled","disabled").button("refresh")}function v(t){var n=e("<option "+(t.visible()?"selected":"")+">"+t.name+"</option>").appendTo("#backgroundLayersSelect").data("layer",t);t.icon?n.addClass("backgroundLayer_"+f).attr("data-style","background-image: url("+t.icon+")"):n.addClass("backgroundLayer_"+f).attr("data-class","unknown"),t.visible()&&(d(t),p=t),e("#backgroundLayersSelect").iconselectmenu("refresh"),f++}function m(t){e("#backgroundSpinner").fadeIn("fast")}function g(t){e("#backgroundSpinner").fadeOut("fast")}var f=0,l,c,h,p;return{init:function(e){this.mizar=e.mizar,l=this.mizar.sky,this.updateUI(),l.subscribe("startBackgroundLoad",m),l.subscribe("endBackgroundLoad",g),this.mizar.subscribe("backgroundLayer:change",this.selectLayer)},remove:function(){l.unsubscribe("startBackgroundLoad",m),l.unsubscribe("endBackgroundLoad",g),this.mizar.unsubscribe("backgroundLayer:change",this.selectLayer),e("#backgroundDiv").dialog("destroy").remove()},addView:v,selectLayer:function(n){e("#backgroundLayersSelect").children().removeAttr("selected");var r=t.find(e("#backgroundLayersSelect").children(),function(e){return e.text==n.name});e(r).attr("selected","selected"),p=n,e("#loading").show(300),h.changeShaderCallback=function(e){e=="raw"?n.customShader.fragmentCode=n.rawFragShader:n.customShader.fragmentCode=n.colormapFragShader},d(n),e("#backgroundLayersSelect").iconselectmenu("refresh")},updateUI:function(){e.widget("custom.iconselectmenu",e.ui.selectmenu,{_renderItem:function(t,n){var r=e("<li>",{text:n.label});return n.disabled&&r.addClass("ui-state-disabled"),e("<span>",{style:n.element.attr("data-style"),"class":"ui-icon "+n.element.attr("data-class")}).appendTo(r),r.appendTo(t)}}),e("#backgroundLayers").find(".layerServices").button({text:!1,icons:{primary:"ui-icon-wrench"}}).click(function(e){o.show(p)}),e("#backgroundLayers").find(".exportLayer").button({text:!1,icons:{primary:"ui-icon-extlink"}}).click(function(e){if(u.isConnected()){var t=l.tileManager.imageryProvider;for(var n=0;n<l.tileManager.tilesToRender.length;n++){var r=l.tileManager.tilesToRender[n],i=window.location.origin+t.getUrl(r);u.sendImage(i)}}else a.open("You must be connected to SAMP Hub")});var t="backgroundDiv",i=e('<div id="'+t+'"></div>').appendTo("body").dialog({title:"Image processing",autoOpen:!1,show:{effect:"fade",duration:300},hide:{effect:"fade",duration:300},width:400,resizable:!1,minHeight:"auto",close:function(t,n){e("#fitsView").removeAttr("checked").button("refresh"),e(this).dialog("close")}});e("#fitsView").button({text:!1,icons:{primary:"ui-icon-image"}}).click(function(e){i.dialog("isOpen")?i.dialog("close"):i.dialog("open")}),h=new r(t,{id:"backgroundFitsView"}),e("#fitsType").button().click(function(){isFits=e(this).is(":checked"),p.dataType=isFits?"fits":"jpg",isFits||e("#fitsView").button("disable"),l.setBaseImagery(null),l.setBaseImagery(p),e("#loading").show()});var s=this;e("#backgroundLayersSelect").iconselectmenu({select:function(t,r){var i=r.item.index,s=e(this).children().eq(i).data("layer");s!=l.baseImagery&&n.setBackgroundSurvey(s.name)}}).iconselectmenu("menuWidget").addClass("ui-menu-icons customicons")},getDiv:function(){return h}}}),define("text!../templates/additionalLayer.html",[],function(){return'<div class="ui-widget addLayer" id="addLayer_<%= shortName %>" >\n\n	<span id="visible_<%= shortName %>" class="<% if (layer.visible()) print(\'ui-state-active\'); else print(\'ui-state-default\'); %> ui-corner-all ui-button">\n		<span class="ui-icon <% if (layer.visible()) print(\'ui-icon-check\'); else print(\'ui-icon-empty\'); %>"></span>\n	</span>\n\n	<canvas width="20" height="10" class="legend"></canvas>\n\n	<label title="<%= layer.description %>" for="addLayerInput_<%= shortName %>"><%= layer.name %></label>\n\n	<span style="display: none;" class="spinner"></span>\n\n	<div style="display: none;" class="layerTools" class="ui-widget-header ui-corner-all">\n		\n		<%\n		if( layer.deletable )\n		{\n		%>\n			\n			<button class="deleteLayer">Delete</button>\n		<%\n		}\n		%>\n\n\n		<% if ( layer.type == "GeoJSON" )\n		{\n		%>\n			\n			<button class="zoomTo">zoomTo</button>\n		<%\n		}\n\n		if ( layer.availableServices )\n		{\n		%>\n			<button class="layerServices">Available services</button>\n		<%\n		}\n		if ( layer instanceof OpenSearchLayer )\n		{\n		%>\n			<button class="exportLayer">Export visible tiles by SAMP</button>\n			<a href="" download=""><button class="downloadAsVO">Download visible tiles as VOTable</button></a>\n		<%\n		}\n		%>\n\n		<% if ( layer instanceof HEALPixFITSLayer && !isMobile )\n		{\n		%>\n			<input type="checkbox" class="isFits" id="isFits_<%= shortName %>" /><label for="isFits_<%= shortName %>">Fits</label>\n			<input type="checkbox" class="addFitsView" id="addFitsView_<%= shortName %>" disabled="disabled" /><label for="addFitsView_<%= shortName %>"></label>\n		<%\n		}\n		%>\n\n		<div id="opacity_<%= shortName %>">\n			<div>\n				<label for="percentInput_<%= shortName %>">Opacity: </label>\n				<input class="percentInput" type="text" id="percentInput_<%= shortName %>" />\n			</div>\n			<div class="slider" id="slider_<%= shortName %>"></div>\n		</div>\n	</div>\n\n</div>'}),define("AdditionalLayersView",["jquery","gw/CoordinateSystem","gw/FeatureStyle","gw/OpenSearchLayer","./LayerManager","./HEALPixFITSLayer","./MocLayer","gw/VectorLayer","./PickingManager","./DynamicImageView","./LayerServiceView","./Samp","./ErrorDialog","./Utils","underscore-min","text!../templates/additionalLayer.html","jquery.nicescroll.min","jquery.ui"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){function E(e,t,n){var r=t.getContext("2d"),i=new Image;i.crossOrigin="",i.onload=function(){r.drawImage(i,5,0,10,10);var n=r.getImageData(0,0,t.width,t.height);for(var s=0,o=n.data.length;s<o;s+=4)n.data[s]=e.style.fillColor[0]*255,n.data[s+1]=e.style.fillColor[1]*255,n.data[s+2]=e.style.fillColor[2]*255;r.putImageData(n,0,0)},i.src=n}function S(e,t){var r=t.getContext("2d"),i=2;r.beginPath(),r.moveTo(i,t.height-i),r.lineTo(t.width/2-i,i),r.lineTo(t.width/2+i,t.height-i),r.lineTo(t.width-i,i),r.lineWidth=1,r.strokeStyle=n.fromColorToString(e.style.fillColor),r.stroke()}function x(t){e("#"+t).niceScroll({autohidemode:!1}),e("#accordion").on("accordionbeforeactivate",function(n,r){e("#"+t).niceScroll().hide()}),e("#accordion").on("accordionactivate",function(n,r){e("#"+t).niceScroll().show(),T(t)})}function T(t){e("#accordion").find("#"+t).getNiceScroll().resize()}function N(e,t){var n=e.find(".legend"),i=n[0];t instanceof r||t instanceof o||t instanceof u?t.dataType=="point"?E(t,i,t.style.iconUrl):t.dataType=="line"?S(t,i):n.css("display","none"):n.css("display","none")}function C(t,n){var r=p.formatId(n.name);t.find("#slider_"+r).slider({value:n.opacity()*100,min:20,max:100,step:20,slide:function(t,i){e("#percentInput_"+r).val(i.value+"%"),n.opacity(i.value/100);if(n.subLayers)for(var s=0;s<n.subLayers.length;s++)n.subLayers[s].opacity(i.value/100)}}).slider("option","disabled",!n.visible()),e("#percentInput_"+r).val(e("#slider_"+r).slider("value")+"%")}function k(e){e.find(".deleteLayer").button({text:!1,icons:{primary:"ui-icon-trash"}}).end().find(".zoomTo").button({text:!1,icons:{primary:"ui-icon-zoomin"}}).end().find(".exportLayer").button({text:!1,icons:{primary:"ui-icon-extlink"}}).end().find(".downloadAsVO").button({text:!1,icons:{primary:"ui-icon-arrowthickstop-1-s"}}).end().find(".isFits").button().end().find(".addFitsView").button({text:!1,icons:{primary:"ui-icon-image"}}).end().find(".layerServices").button({text:!1,icons:{primary:"ui-icon-wrench"}})}function L(t){var n=p.formatId(t.name),r="addFitsViewDialog_"+n,i=e('<div id="'+r+'"></div>').appendTo("body").dialog({title:"Image processing",autoOpen:!1,show:{effect:"fade",duration:300},hide:{effect:"fade",duration:300},resizable:!1,width:"auto",minHeight:"auto",close:function(t,r){e("#addFitsView_"+n).removeAttr("checked").button("refresh"),e(this).dialog("close")}});e("#addFitsView_"+n).click(function(){i.dialog("isOpen")?i.dialog("close"):i.dialog("open")}),t.div=new f(r,{id:n,changeShaderCallback:function(e){e=="raw"?t.customShader.fragmentCode=t.rawFragShader:t.customShader.fragmentCode=t.colormapFragShader}})}function A(t,n,r){var i=p.formatId(n.name),s=t.find(".layerTools");t.children("label").click(function(){s.slideToggle(T.bind(this,r))}),n.visible()&&s.slideDown(),t.find("#visible_"+i).click(function(){var r=!e(this).hasClass("ui-state-active");n.visible(r),n.subLayers&&O(n,r),t.find(".slider").slider(r?"enable":"disable"),r?(e(".layerTools").slideUp(),s.slideDown()):s.slideUp(),e("#visible_"+i).toggleClass("ui-state-active").toggleClass("ui-state-default").find("span").toggleClass("ui-icon-check").toggleClass("ui-icon-empty");var o=e("#layerVisibility_"+n.id);o.button("option","icons").primary=="ui-icon-check"!=r&&o.trigger("click")})}function O(e,t){if(t)for(var n=0;n<e.subLayers.length;n++)m.addLayer(e.subLayers[n]);else for(var n=0;n<e.subLayers.length;n++)m.removeLayer(e.subLayers[n])}function M(t,n){var i=t.id,o=p.formatId(t.name),u=w({layer:t,OpenSearchLayer:r,HEALPixFITSLayer:s,shortName:o,isMobile:b}),a=e(u).appendTo("#"+n).data("layer",t);N(a,t),C(a,t),A(a,t,n),k(a),t instanceof s&&!b&&L(t)}function _(t){var n=t.category;n||(n="Other");var r;y[n]?r=y[n]:(r=p.formatId(n),e('<div class="category"><h3>'+n+'</h3>			<div id="'+r+'"></div></div>').insertBefore(e("#otherLayers").parent()),y[n]=r,e("#accordion").accordion("refresh"),x(r)),M(t,r)}function D(t){var n=p.formatId(t.name),r=e("#accordion").find("#addLayer_"+n);r.parent().children().length==1?r.closest(".category").remove():r.remove(),t.div&&(e("#addFitsView_"+t.div.id).dialog("destroy").remove(),t.div=null)}function P(e){var t=3,n="";for(var r=0;r<m.tileManager.visibleTiles.length;r++){var i=m.tileManager.visibleTiles[r];t<i.order&&(t=i.order),n+=i.pixelIndex,r<m.tileManager.visibleTiles.length-1&&(n+=",")}return e.serviceUrl+"/search?order="+t+"&healpix="+n+"&coordSystem=EQUATORIAL"}function H(){e(this).parent().parent().fadeOut(300,function(){e(this).remove()});var t=e(this).closest(".addLayer").data("layer");i.removeLayer(t),T("otherLayers")}function B(){var t=e(this).closest(".addLayer").data("layer");l.show(t)}function j(){if(c.isConnected())var t=e(this).closest(".addLayer").data("layer"),n=P(t),r=c.sendVOTable(t,n);else h.open("You must be connected to SAMP Hub")}function F(){var n=e(this).closest(".addLayer").data("layer"),r=P(n);r+="&media=votable";var i=t.from3DToGeo(g.center3d),s=p.formatCoordinates(i);e(this).parent().attr("href",r).attr("download",n.name+"_"+s[0]+"_"+s[1])}function I(){var t=e(this).closest(".addLayer").data("layer"),n=0,r=0,i=0;for(var s=0;s<t.features.length;s++){var o=p.computeGeometryBarycenter(t.features[s].geometry);n+=o[0],r+=o[1],i++}g.zoomTo([n/i,r/i],2,2e3)}function q(){var t=e(this).is(":checked"),n=e(this).closest(".addLayer").data("layer");n.dataType=t?"fits":"jpg",t||e(this).nextAll(".addFitsView").button("disable");var r=n.id;m.removeLayer(n),m.addLayer(n),e("#addLayer_"+r).attr("id","addLayer_"+n.id)}function R(){m.subscribe("startLoad",U),m.subscribe("endLoad",z),e("#accordion").on("click",".category .deleteLayer",H).on("click",".category .layerServices",B).on("click",".category .exportLayer",j).on("click",".category .downloadAsVO",F).on("click",".category .zoomTo",I).on("click",".category .isFits",q)}function U(t){var n=p.formatId(t.name);e("#addLayer_"+n).find(".spinner").stop(!0,!0).fadeIn("fast")}function z(t){var n=p.formatId(t.name);e("#addLayer_"+n).find(".spinner").fadeOut(500)}var m,g,y={Other:"otherLayers","Coordinate systems":"coordinateSystems"},b=!1,w=d.template(v);return{init:function(t){m=t.mizar.sky,g=t.mizar.navigation,b=t.configuration.isMobile,e("#defaultCoordSystem").selectmenu({select:function(n){var r=e(this).children("option:selected").val();t.mizar.setCoordinateSystem(r)},width:100}),R()},remove:function(){m.unsubscribe("startLoad",U),m.unsubscribe("endLoad",z),e("#accordion").off("click",".category .deleteLayer",H).off("click",".category .layerServices",B).off("click",".category .exportLayer",j).off("click",".category .downloadAsVO",F).off("click",".category .zoomTo",I).off("click",".category .isFits",q);var t=i.getLayers();for(var n=0;n<t.length;n++){var r=t[n];r.div&&e("#addFitsViewDialog_"+r.div.id).dialog("destroy").remove()}y={Other:"otherLayers","Coordinate systems":"coordinateSystems"}},addView:_,removeView:D,hideView:function(t){e("#addLayer_"+t.id).hide()},showView:function(t){e("#addLayer_"+t.id).show()}}}),define("text!../templates/layerManagerContent.html",[],function(){return'<div id="accordion" style="display: none;">\n	<div>\n		<h3>Background layer</h3>\n		<div id="backgroundLayers">\n			<fieldset>\n				<select style="display: none;" id="backgroundLayersSelect">\n				</select>\n			</fieldset>\n\n			<div style="display: none" id="backgroundSpinner"></div>\n			<br/>\n			<div id="backgroundOptions">\n				<input type="checkbox" id="fitsType" /><label for="fitsType">Fits</label>\n				<input type="checkbox" id="fitsView" /><label for="fitsView">Image processing</label>\n				<button class="layerServices">Available services</button>\n				<button class="exportLayer">Send viewport by SAMP</button>\n			</div>\n		</div>\n	</div>\n\n	<div class="category">\n		<h3>Other</h3>\n		<div id="otherLayers"></div>\n	</div>\n\n	<div class="category">\n		<h3>Coordinate systems</h3>\n		<div id="coordinateSystems">\n			<em>Default coordinate system:</em>\n			<select id="defaultCoordSystem">\n				<option value="EQ">Equatorial</option>\n				<option value="GAL">Galactic</option>\n			</select>\n			<div id="coordinateGrids">\n			</div>\n		</div>\n	</div>\n</div>'}),define("LayerManagerView",["jquery","underscore-min","LayerManager","./ErrorDialog","./LayerServiceView","./BackgroundLayersView","./AdditionalLayersView","./FitsLoader","./ImageManager","text!../templates/layerManagerContent.html","jquery.ui"],function(e,t,n,r,i,s,o,u,a,f){function v(t){t.stopPropagation(),t.preventDefault();var i=t.dataTransfer.files;e.each(i,function(t,i){var s=i.name,f=new FileReader;e("#loading").show(),i.type=="image/fits"?(f.onloadend=function(t){var r=this.result,i=u.parseFits(r),f=n.createLayerFromFits(s,i);o.addView(f);var c={layer:f,feature:f.features[0],isFits:!0},h=i.getHDU().data;l.publish("image:add",c),a.handleFits(h,c),e("#loading").hide()},f.readAsArrayBuffer(i)):(f.onloadend=function(t){if(this.result.search("<?xml")>0)e.ajax({type:"GET",url:p,data:{url:proxyUrl,coordSystem:"EQUATORIAL"},success:function(t){var r=n.createLayerFromGeoJson(s,t);o.addView(r),e("#loading").hide()},error:function(e){console.error(e)}});else{try{var i=e.parseJSON(this.result)}catch(t){return r.open("JSON parsing error : "+t.type+"<br/> For more details see http://jsonlint.com/."),e("#loading").hide(),!1}var u=n.createLayerFromGeoJson(s,i);o.addView(u),e("#loading").hide()}},f.readAsText(i))})}function m(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}function g(){var t=n.getLayers();e("#accordion").accordion({header:"> div > h3",autoHeight:!1,active:0,collapsible:!0,heightStyle:"content"}).show().accordion("refresh");for(var r=0;r<t.length;r++){var i=t[r];i.category=="background"?s.addView(i):o.addView(i)}}var l,c=null,h={},p,d;return{init:function(t,n){d=n.element,e(f).appendTo(d),c=t.sky,o.init({mizar:t,configuration:n}),s.init({mizar:t}),t.subscribe("backgroundLayer:add",s.addView),t.subscribe("additionalLayer:add",o.addView),e.event.props.push("dataTransfer"),g(),i.init(t,n),e("canvas").on("dragover",m),e("canvas").on("drop",v),n.votable2geojson&&(p=n.votable2geojson.baseUrl)},remove:function(){o.remove(),s.remove(),i.remove(),e(d).empty(),l.unsubscribe("backgroundLayer:add",s.addView),l.unsubscribe("additionalLayer:add",o.addView),e("canvas").off("dragover",m),e("canvas").off("drop",v)},isInitialized:function(){return c!=null}}}),define("NameResolver",["jquery","gw/FeatureStyle","gw/VectorLayer","gw/HEALPixBase","gw/CoordinateSystem","./Utils","jquery.ui"],function(e,t,n,r,i,s){function h(e,t){c={geometry:{coordinates:[e,t],type:"Point"},type:"Feature"},l.addFeature(c)}function p(t,n,s,o){t=t.replace(/\s{2,}/g," ");var u=new RegExp("\\d{1,2}[h|:]\\d{1,2}[m|:]\\d{1,2}([\\.]\\d+)?s?\\s[-+]?[\\d]+[¬∞|:]\\d{1,2}['|:]\\d{1,2}([\\.]\\d+)?\"?","g"),a=/^healpix\((\d)+,(\d+)\)/,l=/^(\d+(\.\d+)?),?\s(-?\d+(\.\d+)?)/,c=a.exec(t),h=l.exec(t);if(c){var p=parseInt(c[1]),v=parseInt(c[2]),m=Math.pow(2,p),g=v&m*m-1,y=r.compress_bits(g),b=r.compress_bits(g>>>1),w=v>>>2*p,E=.5,S=.5,x=r.fxyf((y+E)/m,(b+S)/m,w),T=[];i.from3DToGeo(x,T),d(T[0],T[1])}else if(t.match(u)){var N=t.split(" ");N[0]=N[0].replace(/h|m|:/g," "),N[0]=N[0].replace("s",""),N[1]=N[1].replace(/¬∞|'|:/g," "),N[1]=N[1].replace('"',"");var T=[];i.fromEquatorialToGeo([N[0],N[1]],T),i.type!="EQ"&&(T=i.convert(T,i.type,"EQ")),d(T[0],T[1])}else if(h){var C=parseFloat(h[1]),k=parseFloat(h[3]),L=[C,k];i.type!="EQ"&&(L=i.convert(L,i.type,"EQ")),d(L[0],L[1])}else{var A=f.baseUrl+"/"+t+"/EQUATORIAL";e.ajax({type:"GET",url:A,success:function(e){if(e.type=="FeatureCollection"){var t=e.features[0];d(t.geometry.coordinates[0],t.geometry.coordinates[1]),n&&n(e)}else s()},error:function(e,t,n){s&&s(),console.error(e.responseText)},complete:function(e){o&&o(e)}})}}function d(e,t){a.zoomTo([e,t],f.zoomFov,3e3,function(){h(e,t),o.publish("goTo:finished")})}function v(){c&&(l.removeFeature(c),c=null)}var o,u,a,f={nameResolver:{zoomFov:15}},l,c;return{init:function(r,i){o=r;if(!u){f=i;var s=new t({iconUrl:f.mizarBaseUrl+"css/images/target.png",fillColor:[1,1,1,1]});l=new n({style:s}),u=o.sky,a=o.navigation,f=e.extend(i.nameResolver,f.nameResolver),u.addLayer(l),a.subscribe("modified",v)}else console.error("Name resolver is already initialized")},remove:function(){u&&(u.removeLayer(l),a.unsubscribe("modified",v),u=null)},goTo:p,zoomTo:d}}),define("text!../templates/nameResolverResult.html",[],function(){return'<div class="nameResolverResult">\n	<% if (properties.type)\n	{ %>\n		<em>Type:</em> <%= properties.type %><br/>\n	<% } %>\n	<em><% (type == "EQ") ? print("RA: ") : print("Longitude: ") %></em><%= lon %><br/>\n	<em><% (type == "EQ") ? print("Dec: ") : print("Latitude: ") %></em><%= lat %><br/>\n	Found in <%= properties.credits %> database</br>\n</div>'}),define("NameResolverView",["jquery","gw/CoordinateSystem","./Utils","./NameResolver","underscore-min","text!../templates/nameResolverResult.html","jquery.ui"],function(e,t,n,r,i,s){function d(e,t){targetFeature={geometry:{coordinates:[e,t],type:"Point"},type:"Feature"},targetLayer.addFeature(targetFeature)}function v(){var t=f.attr("value");f.val()===t&&f.val(""),e(this).animate({color:"#000"},p).parent().animate({backgroundColor:"#fff"},p,function(){f.val()!==""&&f.val()!==t&&l.fadeIn(p)}).addClass("focus")}function m(t){var n=f.attr("value");e(this).animate({color:"#b4bdc4"},p,function(){f.val()===""&&f.val(n)}).parent().animate({backgroundColor:"#e8edf1"},p).removeClass("focus")}function g(){f.val()===""?l.fadeOut(p):l.fadeIn(p)}function y(e){h=e;var r="";for(var i=0;i<h.features.length;i++){var s=n.formatCoordinates([h.features[i].geometry.coordinates[0],h.features[i].geometry.coordinates[1]]),o=u({properties:h.features[i].properties,lon:s[0],lat:s[1],type:t.type});r+=o}c.html(r).fadeIn(p),c.find("div:first-child").addClass("selected"),a.find("#searchSpinner").fadeOut(p),l.fadeIn(p)}function b(){c.html("Bad input or object not found").fadeIn(p),a.find("#searchSpinner").fadeOut(p).end(),l.fadeIn(p)}function w(e){e.preventDefault(),f.blur();var t=f.val();t!=f.attr("value")&&t!=""?(a.find("#searchSpinner").fadeIn(p).end().find("#searchClear").fadeOut(p),c.fadeOut(p),r.goTo(t,y,b)):c.html("Enter object name").fadeIn(p)}function E(t){e("#resolverSearchResult").find(".selected").removeClass("selected"),e(this).addClass("selected");var n=e(this).index(),i=h.features[n];r.zoomTo(i.geometry.coordinates[0],i.geometry.coordinates[1])}function S(){e("#resolverSearchResult").fadeOut(p)}function x(){var t=f.attr("value");f.val()!==t&&f.val(t),l.fadeOut(p),e("#searchInput").animate({color:"#b4bdc4"},p).parent().animate({backgroundColor:"#e8edf1"},p).removeClass("focus")}function T(){f.on("focus",v).on("blur",m).keyup(g),e("#searchDiv").find("#searchForm").submit(w),e("canvas").on("click",S),e("#searchDiv").find("#resolverSearchResult").on("click",".nameResolverResult",E),a.find("#searchClear").on("click",x)}function N(){targetFeature&&(targetLayer.removeFeature(targetFeature),targetFeature=null)}var o='<form id="searchForm">				<fieldset>					<div class="searchInputDiv">						<input title="Enter an object name (e.g. m31) or coordinate (e.g 23h45m30.5s -45&#186;30\'30&rdquo;)" type="text" name="searchInput" id="searchInput" value="Object name or coordinates" />					</div>					<input type="submit" id="searchSubmit" value="" />					<div style="display: none" id="searchSpinner"></div>					<input type="button" id="searchClear" value="" style="display: none;"/>				</fieldset>			</form>			<div style="display: none" id="resolverSearchResult"></div>',u=i.template(s),a,f,l,c,h,p=300;return{init:function(){a?console.error("Name resolver view is already initialized"):(a=e(o).appendTo("#searchDiv"),f=a.find("#searchInput"),l=a.find("#searchClear"),c=a.siblings("#resolverSearchResult"),T())},remove:function(){a&&(f.off("focus",v).off("blur",m).unbind("keyup",g),e("canvas").off("click",S),e("#searchDiv").find("#resolverSearchResult").off("click",".nameResolverResult",E),a.find("#searchClear").off("click",x),a.remove(),a=null)}}}),define("ReverseNameResolver",["jquery","gw/CoordinateSystem","gw/Numeric","./IFrame","./Utils","./ErrorDialog","underscore-min","text!../templates/featureDescription.html","text!../templates/descriptionTable.html","jquery.ui"],function(e,t,n,r,i,s,o,u,a){function E(e){w.fadeOut(),m=new Date,e.type.search("touch")>=0&&(e.clientX=e.changedTouches[0].clientX,e.clientY=e.changedTouches[0].clientY),g=e.clientX,y=e.clientY}function S(n){var r=5,s=new Date,o=s-m,u=15;n.type.search("touch")>=0&&(n.clientX=n.changedTouches[0].clientX,n.clientY=n.changedTouches[0].clientY);var a=window.innerHeight-n.clientY-u*2;e("#reverseSearchField").css("max-height",a),e("#reverseSearchResult").css("max-height",a);if(o>500&&Math.abs(g-n.clientX)<r&&Math.abs(y-n.clientY)<r){e("#reverseSearchResult").css("display","none");var h=[];c=f.getLonLatFromPixel(n.clientX,n.clientY);var p=i.formatCoordinates([c[0],c[1]]);t.type=="EQ"?e("#coordinatesInfo").html("<em>Right ascension:</em><br/>&nbsp;&nbsp;&nbsp;&nbsp;"+p[0]+"<br/><em>Declination :</em><br/>&nbsp;&nbsp;&nbsp;&nbsp;"+p[1]):t.type=="GAL"&&e("#coordinatesInfo").html("<em>Longitude:</em><br/>&nbsp;&nbsp;&nbsp;&nbsp;"+p[0]+"<br/><em>Latitude:</em><br/>&nbsp;&nbsp;&nbsp;&nbsp;"+p[1]);var d=f.tileManager.getVisibleTile(c[0],c[1]);l.debug&&e("#reverseSearchField #healpixInfo").html("<em>Healpix index/order: </em>&nbsp;&nbsp;&nbsp;&nbsp;"+d.pixelIndex+"/"+d.order),e("#reverseSearchField").css("display","block"),w.css({position:"absolute",left:n.clientX+"px",top:n.clientY+"px"}).fadeIn(100)}}function x(){f.renderContext.canvas.addEventListener("mousedown",E),f.renderContext.canvas.addEventListener("mouseup",S),p&&(f.renderContext.canvas.addEventListener("touchstart",E),f.renderContext.canvas.addEventListener("touchend",S)),w.on("click",".propertiesTable a",N),h.subscribe("modified",C)}function T(t){var n=d({dictionary:{},services:t.services,properties:t.properties,descriptionTableTemplate:v}),r=t.properties.title?t.properties.title:t.properties.identifier;n='<div class="title">'+r+'</div><div class="credit">Found in CDS database</div>'+n,e("#reverseSearchResult").html(n).find("#sendViewport").button(),e("#reverseSearchField").fadeOut(300,function(){e("#reverseSearchResult").fadeIn(300)})}function N(e){e.preventDefault(),r.show(e.target.innerHTML)}function C(e){w.css("display")!="none"&&w.fadeOut(300)}var f,l={},c=[],h=null,p=!1,d=o.template(u),v=o.template(a),m,g,y,b='<div id="reverseNameResolver" class="contentBox ui-widget-content" style="display: none;">		<div id="reverseSearchField">			<input type="submit" value="Find Object Name" />			<div id="coordinatesInfo"></div>			<div id="healpixInfo"></div>		</div>		<div id="reverseSearchResult"></div>		<div class="closeBtn">			<span class="defaultImg"></span>			<span style="opacity: 0" class="hoverImg"></span>		</div>	</div>',w;return{init:function(n,r){if(!w){f=n.sky,h=n.navigation,w=e(b).appendTo("body"),e("#reverseNameResolver input[type=submit]").button().click(function(n){n.preventDefault(),e('#reverseSearchField input[type="submit"]').attr("disabled","disabled");var r=[];t.fromGeoToEquatorial(c,r),r[0]=r[0].replace("h ",":"),r[0]=r[0].replace("m ",":"),r[0]=r[0].replace("s",""),r[1]=r[1].replace("ÔøΩ ",":"),r[1]=r[1].replace("' ",":"),r[1]=r[1].replace('"',"");var i=3;f.tileManager.visitTiles(function(e){i<e.order&&(i=e.order)});var o=l.baseUrl+"/EQUATORIAL/"+r[0]+" "+r[1]+";"+i;e.ajax({type:"GET",url:o,success:function(e){T(e.features[0])},error:function(e,t,n){switch(e.status){case 503:s.open("Please wait at least 6 seconds between each request to reverse name resolver");break;case 500:s.open("Internal server error");break;case 404:s.open("Object not found");break;case 400:s.open("Bad input");default:}},complete:function(t){e('#reverseSearchField input[type="submit"]').removeAttr("disabled")}})});for(var i in r.reverseNameResolver)l[i]=r.reverseNameResolver[i];l.debug=r.debug,p=n.isMobile,x()}else console.error("Reverse name resolver is already initialized")},remove:function(){w&&(f.renderContext.canvas.removeEventListener("mousedown",E),f.renderContext.canvas.removeEventListener("mouseup",S),p&&(f.renderContext.canvas.removeEventListener("touchstart",E),f.renderContext.canvas.removeEventListener("touchend",S)),w.off("click",".propertiesTable a",N),h.unsubscribe("modified",C),w.remove(),w=null)}}}),define("Compass",["jquery","gw/CoordinateSystem","gw/glMatrix"],function(e,t){var n=null,r=null,i,s=function(){var e=[];t.from3DToGeo(r.center3d,e),t.type!="EQ"&&(e=t.convert(e,"EQ","GAL"));var n=[];t.getLHVTransform(e,n);var s=[],o=[n[4],n[5],n[6]],u=[n[8],n[9],n[10]];t.type!="EQ"&&(o=t.transformVec([n[4],n[5],n[6]]),t.from3DToGeo(o,s),s=t.convert(s,"EQ","GAL"),t.fromGeoTo3D(s,o),u=t.transformVec([n[8],n[9],n[10]]),t.from3DToGeo(u,s),s=t.convert(s,"EQ","GAL"),t.fromGeoTo3D(s,u));var a=vec3.dot(r.up,o),f=Math.acos(a);if(isNaN(f))return;var l=f*180/Math.PI,c;vec3.cross(r.up,o,s),c=vec3.dot(s,[u[0],u[1],u[2]]),c<0&&(l*=-1);var h=i.getElementById("NorthText");h.setAttribute("transform","rotate("+l+" 40 40)")},o=function(o){n=o.element;var u=o.globe;r=o.navigation,document.getElementById(n).innerHTML='<div id="objectCompass"></div>',e.get(o.mizarBaseUrl+"css/images/compass.svg",function(t){i=document.importNode(t.documentElement,!0),i.height.baseVal.value=100,i.width.baseVal.value=100,e("#objectCompass").append(i),a(),r.publish("modified"),e("#"+n).css("display","block")},"xml");var a=function(){var e=document.getElementById("objectCompass"),n=i.getElementById("East"),u=i.getElementById("West"),a=i.getElementById("South"),f=i.getElementById("North"),l=i.getElementById("NorthText"),c=i.getElementById("OuterCircle"),h=o.rotationFactor?o.rotationFactor:8,p=o.panFactor?o.panFactor:30,d=-1,v=-1,m=0,g=0,y=!1,b=c.ownerSVGElement.clientWidth/2,w=function(e){e.preventDefault(),e.type.search("touch")>=0&&(e.layerX=e.changedTouches[0].clientX,e.layerY=e.changedTouches[0].clientY),y=!0,d=e.layerX-b,v=e.layerY-b,m=0,g=0};i.addEventListener("mousedown",w);var E=function(e){e.preventDefault(),e.type.search("touch")>=0&&(e.layerX=e.changedTouches[0].clientX,e.layerY=e.changedTouches[0].clientY);if(!y)return;var t=d*(e.layerY-b)-v*(e.layerX-b);r.rotate(t,0),d=e.layerX-b,v=e.layerY-b,s()};i.addEventListener("mousemove",E);var S=function(e){e.preventDefault(),y=!1};i.addEventListener("mouseup",S),n.addEventListener("click",function(){r.pan(p,0),s()}),u.addEventListener("click",function(){r.pan(-p,0),s()}),f.addEventListener("click",function(){r.pan(0,p),s()}),a.addEventListener("click",function(){r.pan(0,-p),s()});var x=function(e){var n=[0,0,1];if(t.type!="EQ"){var i=[];t.from3DToGeo(n,i),i=t.convert(i,"GAL","EQ"),t.fromGeoTo3D(i,n)}r.moveUpTo(n)};l.addEventListener("click",x),o.isMobile&&(i.addEventListener("touchstart",w),i.addEventListener("touchup",S),i.addEventListener("touchmove",E),l.addEventListener("touchstart",x)),r.subscribe("modified",s)}};return o.prototype.remove=function(){r.unsubscribe("modified",s),document.getElementById(n).innerHTML=""},o}),define("MollweideViewer",["jquery","gw/CoordinateSystem","./Utils","gw/glMatrix"],function(e,t,n){function i(e){if(e==Math.PI||e==-Math.PI)return e;var t=.001,n=e,r;do{var i=2*n;n=r,r=i/2-(i+Math.sin(i)-Math.PI*Math.sin(e))/(2+2*Math.cos(i))}while(Math.abs(r-n)>=t);return r}var r,s=function(e){this.x=0,this.y=0,this.color="rgb(255,0,0)",this.size=2;for(x in e)this[x]=e[x]},o=function(o){function b(e){var n=t.from3DToGeo(e);t.type!="EQ"&&(n=t.convert(n,"EQ",t.type),n[0]>180&&(n[0]-=360));var r=n[0]*Math.PI/180,s=n[1]*Math.PI/180,o=i(s),u=2*Math.sqrt(2)/Math.PI*r*Math.cos(o),a=Math.sqrt(2)*Math.sin(o),p=-u*h/2.8+h+f,d=-a*c/1.38+c+l;return[p,d]}function w(e){v.x=-(e[0]-h-f)*2.8/h,v.y=-(e[1]-c-l)*1.38/c;var n=Math.asin(v.y/Math.sqrt(2)),r=Math.asin((2*n+Math.sin(2*n))/Math.PI),i=Math.PI*v.x/(2*Math.sqrt(2)*Math.cos(n)),s=[i*180/Math.PI,r*180/Math.PI];t.type!="EQ"&&(s=t.convert(s,t.type,"EQ")),t.fromGeoTo3D(s,a.center3d),a.computeViewMatrix()}function E(){g.clearRect(0,0,g.canvas.width,g.canvas.height),g.drawImage(y.imageObj,0,0),g.fillStyle="rgb(255,0,0)";var r=u.renderContext.canvas.clientWidth/(d-1),i=u.renderContext.canvas.clientHeight/(d-1);for(var s=0;s<d;s++)for(var o=0;o<d;o++){var f=u.renderContext.get3DFromPixel(s*r,o*i),l=b(f);g.fillRect(l[0],l[1],2,2)}g.fillStyle=v.color,l=b(a.center3d),v.x=l[0]-v.size/2,v.y=l[1]-v.size/2,g.fillRect(l[0]-v.size/2,l[1]-v.size/2,v.size,v.size);var c=a.getFov(),h=n.roundNumber(c[0],2);h=t.fromDegreesToDMS(h);var p=n.roundNumber(c[1],2);p=t.fromDegreesToDMS(p),e("#fov").html("Fov : "+h+" x "+p)}function S(e){var t=e.offsetX?e.offsetX:e.layerX-e.target.offsetLeft,n=e.offsetY?e.offsetY:e.layerY-e.target.offsetTop;return[t,n]}r=o.mizarBaseUrl;var u=o.globe,a=o.navigation,f=16,l=8,c=50,h=100,p=!1,d=9,v=new s({size:5,color:"rgb(255,255,0)"}),m=document.getElementById("mollweideCanvas"),g=m.getContext("2d");this.imageObj=new Image;var y=this;this.imageObj.onload=function(){g.drawImage(y.imageObj,0,0),E()},this.setCoordSystem(t.type),m.addEventListener("mousedown",function(e){var t=S(e);return w(t),p=!0,!0}),m.addEventListener("mousemove",function(e){if(!p)return;var t=S(e);w(t)}),m.addEventListener("mouseup",function(){p=!1}),e("#slideArrow").click(function(){parseFloat(e(this).parent().css("left"))<0?(e("#mollweideContent").css({boxShadow:"0px 0px 8px 1px rgba(255, 158, 82, 0.92)"}),e(this).css("background-position","0px 0px"),e(this).parent().animate({left:"0px"},300),a.subscribe("modified",E),E()):(e("#mollweideContent").css({boxShadow:"none"}),e(this).css("background-position","0px -20px"),e(this).parent().animate({left:"-266px"},300),a.unsubscribe("modified",E))}),m.addEventListener("dragstart",function(e){return e.preventDefault(),!1})};return o.prototype.setCoordSystem=function(t){e(this.imageObj).attr("src",r+"css/images/MollweideSky_"+t+".png")},o}),define("AboutDialog",["jquery","jquery.ui"],function(e){var t='<div id="about" title="About">		<p>MIZAR has been developed and is maintained by the CENTRE NATIONAL d\'ETUDES SPATIALES (CNES).</p>		<p>Copyright CNES - MIZAR is a module of <a target="_blank" href="http://sitools2.sourceforge.net">SITools2</a>, distributed under GPLV3</p>		<p>MIZAR is based on <a target="_blank" href="https://github.com/TPZF/GlobWeb">GlobWeb</a> for rendering, developed by TPZF SSA.</p>		<p>Portions of the code related to Healpix and coordinates system transformation have been traduced in JavaScript from Healpix library <a target="_blank" href="http://sourceforge.net/projects/healpix/">Healpix library</a>.</p>		<p>The <a target="_blanc" href="http://astrojs.github.io/fitsjs/">FITS library</a> has been used to load FITS file.</p>		<p>The <a target="_blanc" href="http://astrojs.github.io/sampjs/">SAMP library</a> has been used for using the SAMP Web Profile from within web pages.</p>		<p>The <a target="_blanc" href="http://astrojs.github.io/wcsjs/">WCS library</a> has been used to localize recieved fits files on sky.</p>		<p>The <a target="_blanc" href="https://github.com/beatgammit/gzip-js">GZip library</a> has been used to decompress, g-zipped fits files.</p>		<p>ColorMap have been traduced in JavaScript from <a target="_blanc" href="http://aladin.u-strasbg.fr/aladin.gml">Aladin Sky Atlas</a>.</p>		<div>			<input id="showAbout" type="checkbox" />\n			<label style="font-size: 0.8em;top: -3px;position: relative;" for="showAbout">Don\'t show this message again</label>		</div>		<span style="font-size: 0.8em;bottom: 5px;right: 5px;position: absolute;">v1.0 - 26.11.2013 - nightly build</span>	</div>',n=null;return{show:function(){n||(n=e(t).appendTo("body").dialog({autoOpen:!1,resizable:!1,show:{effect:"fade",duration:1e3},hide:{effect:"fade",duration:1e3},width:"500px",minHeight:"auto",draggable:!1,open:function(){e(this).find("a:first-child").blur()},close:function(){e("#showAbout").is(":checked")&&(localStorage.showAbout=!1),e(this).remove()}})),n.dialog("open")}}}),define("Share",["jquery","gw/CoordinateSystem","./LayerManager","./ErrorDialog"],function(e,t,n,r){function o(){var o=window.document.documentURI,u=o.search(/[&|?]sharedParameters=/);u!=-1&&(o=o.substr(0,u));var a=o.indexOf("?conf=");a!=-1?o!="undefined"&&o!=""?o+="&":(o=o.substr(0,a),o+="?"):o+="?";var f=[];t.from3DToGeo(i.center3d,f);var l=n.getLayers(),c={};for(var h=0;h<l.length;h++)c[l[h].name]=l[h].visible();var p={initTarget:f,fov:i.renderContext.fov,visibility:c,up:i.up};return s?e.ajax({type:"POST",url:s,async:!1,data:{context:JSON.stringify(p)},success:function(e){o+="sharedParameters="+e},error:function(e){r.open("Shortener service: "+e.statusText),console.error(e)}}):o+="sharedParameters="+JSON.stringify(p),o}function u(t){i=t.navigation,t.configuration.hasOwnProperty("shortener")&&(s=t.configuration.shortener.baseUrl),e("#share").on("click",function(){var t=o();e("#shareInput").val(t),e(this).fadeOut(300,function(){e(this).next().fadeIn(),e("#shareInput").select()})}),e("#shareClear").on("click",function(){e(this).parent().fadeOut(300,function(){e("#share").fadeIn()})}),e("#share").hover(function(){e(this).animate({left:"-10px"},100)},function(){e(this).animate({left:"-20px"},100)})}var i,s;return{init:u}}),define("SimpleProgressBar",["jquery"],function(e){var t=function(t){var n=t.id;this.percentOutput=t.hasOwnProperty("percentOutput")?t.percentOutput:!1,this.$element=e('<div style="display: none;" class="progress"><div></div></div>').appendTo("#"+n).fadeIn()};return t.prototype.onprogress=function(e){if(e.lengthComputable){var t=Math.floor(e.loaded/e.total*100),n=t*this.$element.width()/100;this.$element.find("div").css("width",n),this.percentOut&&this.$element.find("div").html(t+"%&nbsp;"),t>=99&&this.$element.delay(1e3).fadeOut("slow")}else this.$element.fadeOut()},t}),define("text!../templates/imageViewer.html",[],function(){return'<div id="imageViewerContent">\n	<span id="imageViewInvoker"></span>\n	<div id="loadedImages">\n		<h3>Images</h3>\n		<div>\n			<p style="color: white; text-align: center;">No image was loaded</p>\n			<div class="imageLayers">\n			</div>\n		</div>\n	</div>\n</div>'}),define("text!../templates/imageViewerLayerItem.html",[],function(){return'<div class="layer" id="imageLayer_<%= id %>" style="display: none;">\n	<input class="layerVisibility" id="layerVisibility_<%= id %>" type="checkbox" checked />\n	<label for="layerVisibility_<%= id %>"></label>\n	<label class="layerName" title=<%= name %>><%= name %></label>\n	<ul>\n	</ul>\n</div>'}),define("text!../templates/imageViewerImageItem.html",[],function(){return'<li class="image" id="imageView_<%= id %>" style="display: none;">\n	<input type="checkbox" name="imageView" id="<%= id %>" checked />\n	<label style="width: 15px; height: 15px;" for="<%= id %>"></label>\n	<label class="imageName" title="<%= name %>"><%= name %></label>\n	<div style="display: none;" class="options">\n		<button class="zoomTo">Zoom to..</button>\n		<button class="<% if (!isFits) print(\'fitsUnavailable\') %> imageProcessing" id="imageProcessing_<%= id %>">Image processing</button>\n		<button class="sampExport">Send image by SAMP</button>\n		<button class="metadata">Show metadata</button>\n		<button class="delete">Delete</button>\n	</div>\n</li>'}),define("ImageViewer",["require","jquery","gw/FeatureStyle","./PickingManager","./ImageManager","./ImageProcessing","./SimpleProgressBar","./Utils","./Samp","./ErrorDialog","underscore-min","text!../templates/imageViewer.html","text!../templates/imageViewerLayerItem.html","text!../templates/imageViewerImageItem.html","jquery.ui"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){function S(e){g.find('.imageLayers div[id="imageLayer_'+e.id+'"] ul').find("button, input").each(function(){t(this).attr("disabled","disabled").button("refresh")})}function x(e){g.find('.imageLayers div[id="imageLayer_'+e.id+'"] ul').find("button, input").each(function(){t(this).hasClass("fitsUnavailable")||t(this).removeAttr("disabled").button("refresh")})}function T(e){var n=w({id:e.id,name:e.name});$layer=t(n).appendTo(g.find(".imageLayers")),$layer.find("label.layerName").click(function(){t("#imageLayer_"+e.id+" > ul").slideToggle()});var r=$layer.find("#layerVisibility_"+e.id);return r.button({text:!1,icons:{primary:"ui-icon-check"}}).click(function(){var n=r.button("option","icons").primary!="ui-icon-check",i=u.formatId(e.name);r.button("option",{icons:{primary:n?"ui-icon-check":""}}).button("refresh"),n?x(e):S(e);var s=t("#visible_"+i);s.hasClass("ui-state-active")!=n&&s.trigger("click")}),y.length==0?g.find("#loadedImages p").fadeOut(function(){$layer.fadeIn()}):$layer.fadeIn(),y.push(e),$layer}function N(){g.find("#loadedImages").css({boxShadow:"0px 0px 8px 1px rgba(255, 158, 82, 0.92)"}),g.find("#imageViewInvoker").css("background-position","0px -20px").parent().animate({right:"0px"},300)}function C(){g.find("#loadedImages").css({boxShadow:"none"}),g.find("#imageViewInvoker").css("background-position","0px 0px").parent().animate({right:"-254px"},300)}var d,v,m,g,y=[],b=[],w=l.template(h),E=l.template(p);return{init:function(e){d=e;var n=this;d.subscribe("image:add",this.addView),d.subscribe("image:remove",this.removeView),d.subscribe("image:download",this.addProgressBar),d.subscribe("layer:remove",this.removeLayer),m=d.sky,v=d.navigation,g=t(c).appendTo("#imageViewerDiv"),g.find("#imageViewInvoker").click(function(){parseFloat(t(this).parent().css("right"))<0?N():C()}),g.find("#loadedImages").accordion({heightStyle:"content",active:0,collapsible:!0}).show()},remove:function(){d.unsubscribe("image:add",this.addView),d.unsubscribe("image:remove",this.removeView),d.unsubscribe("image:download",this.addProgressBar),d.unsubscribe("layer:remove",this.removeLayer),g.remove(),m=null,v=null},addProgressBar:function(e){var t="imageView_"+u.formatId(e.feature.properties.identifier)+"_fits",n=new o({id:t});e.xhr.onprogress=n.onprogress.bind(n)},addView:function(n){N();var o,l=n.layer;y.indexOf(n.layer)<0?o=T(n.layer):o=g.find('.imageLayers div[id="imageLayer_'+l.id+'"]');var c=n.feature,h=u.formatId(n.feature.properties.identifier);n.isFits&&(h+="_fits");var p=n.feature.properties.identifier,d,w;if(o.find('ul li[id="'+h+'"]').length==0){var S=E({id:h,name:p,isFits:n.isFits});return d=t(S).appendTo(o.find("ul")).find(".zoomTo").button({text:!1,icons:{primary:"ui-icon-zoomin"}}).click(function(){var e=u.computeGeometryBarycenter(c.geometry);v.zoomTo([e[0],e[1]],.1,2e3,function(){r.focusFeature(n)})}).end().find("input").button({text:!1,icons:{primary:"ui-icon-check"}}).click(function(){t(this).button("option",{icons:{primary:t(this)[0].checked?"ui-icon-check":""}}),t(this).is(":checked")?i.showImage(n):i.hideImage(n),m.renderContext.requestFrame()}).end().find(".delete").button({text:!1,icons:{primary:"ui-icon-trash"}}).click(function(){i.removeImage(n,n.isFits),n.isFits&&s.removeData(n),m.renderContext.requestFrame()}).end().find(".imageProcessing").button({text:!1,icons:{primary:"ui-icon-image"}}).click(function(){s.setData(n)}).end().find(".metadata").button({text:!1,icons:{primary:"ui-icon-info"}}).click(function(){if(!w){var r=e("FeaturePopup"),i=r.generateFeatureMetadata(n.layer,n.feature);w=t("<div>"+i+"</div>").dialog({autoOpen:!0,show:{effect:"fade",duration:300},hide:{effect:"fade",duration:300},title:"Metadata",width:350,resizable:!1,zIndex:12,stack:!1,close:function(){t(this).find(".featureProperties").getNiceScroll().remove(),t(this).dialog("destroy").remove(),w=null},drag:function(){t(this).find(".featureProperties").getNiceScroll().resize()}}),w.find(".featureProperties").niceScroll({autohidemode:!1})}else w.dialog("isOpen")&&w.dialog("close")}).end().find(".sampExport").button({text:!1,icons:{primary:"ui-icon-extlink"}}).click(function(){a.isConnected()?a.sendImage(c.services.download.url):f.open("You must be connected to SAMP Hub")}).end().fadeIn(),d.find("label.imageName").click(function(){t(this).siblings(".options").slideToggle()}),n.isFits||d.find(".imageProcessing").button("disable"),b.push(n),d}},removeView:function(e){var n="imageView_"+u.formatId(e.feature.properties.identifier);e.isFits&&(n+="_fits"),g.find("#loadedImages").find('li.image[id="'+n+'"]').fadeOut(function(){if(t(this).siblings().length==0){g.find('.imageLayers div[id="imageLayer_'+e.layer.id+'"]').fadeOut(300,function(){t(this).remove(),y.length==0&&g.find("#loadedImages p").fadeIn()});var n=y.indexOf(e.layer);y.splice(n,1)}t(this).remove()});var r=b.indexOf(e);b.splice(r,1)},removeLayer:function(e){var n=g.find('.imageLayers div[id="imageLayer_'+e.id+'"]');n.find("ul li").each(function(){t(this).find(".delete").trigger("click")})},getFeatures:function(){return b}}}),define("PositionTracker",["gw/CoordinateSystem","./Utils"],function(e,t){function s(e){e.type.search("touch")>=0&&(e.clientX=e.changedTouches[0].clientX,e.clientY=e.changedTouches[0].clientY);var r=n.getLonLatFromPixel(e.clientX,e.clientY),s=t.formatCoordinates([r[0],r[1]]);document.getElementById(i).innerHTML=s[0]+" x "+s[1]}var n,r,i;return{init:function(e){n=e.globe,r=e.navigation,i=e.element,n.renderContext.canvas.addEventListener("mousemove",s),e.isMobile&&n.renderContext.canvas.addEventListener("touchmove",s)}}}),define("MeasureTool",["jquery","gw/VectorLayer","gw/Numeric","gw/CoordinateSystem","gw/FeatureStyle","gw/glMatrix","jquery.ui"],function(e,t,n,r,i){function o(e,t){t=t*Math.PI/180;var n=Math.cos(t),r=Math.sin(t);return[e[0]*n-e[1]*r,e[0]*r+e[1]*n]}function u(e,t){t||(t=e);var n=Math.sqrt(e[0]*e[0]+e[1]*e[1]);return t[0]=e[0]/n,t[1]=e[1]/n,t}var s=function(i){var s=i.globe,o=i.navigation,u=i.onselect;this.activated=!1,this.renderContext=s.renderContext,this.measureLayer=new t,s.addLayer(this.measureLayer),this.measureFeature=null,this.distance,this.pickPoint,this.secondPickPoint,this.geoDistance,this.geoPickPoint,this.secondGeoPickPoint,this.measureLabel;var a=this,f=!1,l=function(e){e.preventDefault();if(!a.activated)return;a.distance=0,o.stop(),f=!0,e.type.search("touch")>=0?a.pickPoint=[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:a.pickPoint=[e.clientX,e.clientY],a.geoPickPoint=s.getLonLatFromPixel(a.pickPoint[0],a.pickPoint[1])},c=function(e){e.preventDefault();if(!a.activated)return;var t;if(e.type.search("touch")>=0)t=s.getLonLatFromPixel(e.changedTouches[0].clientX,e.changedTouches[0].clientY);else var t=s.getLonLatFromPixel(e.clientX,e.clientY);var i=vec3.dot(r.fromGeoTo3D(t),r.fromGeoTo3D(a.geoPickPoint)),l=Math.acos(i);a.geoDistance=n.toDegree(l),u&&u(),o.start(),f=!1},h=function(e){e.preventDefault();if(!a.activated||!f)return;e.type.search("touch")>=0?a.secondPickPoint=[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:a.secondPickPoint=[e.clientX,e.clientY],a.secondGeoPickPoint=s.getLonLatFromPixel(a.secondPickPoint[0],a.secondPickPoint[1]),a.distance=Math.sqrt(Math.pow(a.secondPickPoint[0]-a.pickPoint[0],2)+Math.pow(a.secondPickPoint[1]-a.pickPoint[1],2));var t=vec3.dot(r.fromGeoTo3D(a.secondGeoPickPoint),r.fromGeoTo3D(a.geoPickPoint)),i=Math.acos(t);a.geoDistance=n.toDegree(i),a.updateMeasure()};this.renderContext.canvas.addEventListener("mousedown",e.proxy(l,this)),this.renderContext.canvas.addEventListener("mousemove",e.proxy(h,this)),this.renderContext.canvas.addEventListener("mouseup",e.proxy(c,this)),i.isMobile&&(this.renderContext.canvas.addEventListener("touchend",e.proxy(c,this)),this.renderContext.canvas.addEventListener("touchmove",e.proxy(h,this)),this.renderContext.canvas.addEventListener("touchstart",e.proxy(l,this))),e("#measureInvoker").on("click",function(){a.toggle()}).hover(function(){e(this).animate({left:"-10px"},100)},function(){e(this).animate({left:"-20px"},100)})};return s.prototype.computeIntersection=function(e){var t=this.renderContext,i=mat4.create();mat4.inverse(t.viewMatrix,i);var s=[i[12],i[13],i[14]];mat4.multiply(t.projectionMatrix,t.viewMatrix,i),mat4.inverse(i);var o=vec3.create(),u=[0,0,0];for(var a=0;a<e.length;a++){mat4.multiplyVec4(i,e[a]),vec3.scale(e[a],1/e[a][3]),vec3.subtract(e[a],s,e[a]),vec3.normalize(e[a]);var f=n.raySphereIntersection(s,e[a],u,r.radius);if(f<0)return null;e[a]=r.from3DToGeo(n.pointOnRay(s,e[a],f,o))}return e},s.prototype.computeMeasure=function(){var e=this.renderContext,t=2/e.canvas.width,n=2/e.canvas.height,r=[this.secondPickPoint[0]-this.pickPoint[0],this.secondPickPoint[1]-this.pickPoint[1]];u(r);var i=o(r,30),s=o(r,-30);i=[this.pickPoint[0]+10*i[0],this.pickPoint[1]+10*i[1]],s=[this.pickPoint[0]+10*s[0],this.pickPoint[1]+10*s[1]];var a=[-r[0],-r[1]],f=o(a,30),l=o(a,-30);f=[this.secondPickPoint[0]+10*f[0],this.secondPickPoint[1]+10*f[1]],l=[this.secondPickPoint[0]+10*l[0],this.secondPickPoint[1]+10*l[1]];var c=[[this.pickPoint[0]*t-1,(e.canvas.height-this.pickPoint[1])*n-1,1,1],[i[0]*t-1,(e.canvas.height-i[1])*n-1,1,1],[this.pickPoint[0]*t-1,(e.canvas.height-this.pickPoint[1])*n-1,1,1],[s[0]*t-1,(e.canvas.height-s[1])*n-1,1,1],[this.pickPoint[0]*t-1,(e.canvas.height-this.pickPoint[1])*n-1,1,1],[this.secondPickPoint[0]*t-1,(e.canvas.height-this.secondPickPoint[1])*n-1,1,1],[f[0]*t-1,(e.canvas.height-f[1])*n-1,1,1],[this.secondPickPoint[0]*t-1,(e.canvas.height-this.secondPickPoint[1])*n-1,1,1],[l[0]*t-1,(e.canvas.height-l[1])*n-1,1,1],[this.secondPickPoint[0]*t-1,(e.canvas.height-this.secondPickPoint[1])*n-1,1,1]];return this.computeIntersection(c),c},s.prototype.updateMeasure=function(){this.measureFeature&&this.measureLayer.removeFeature(this.measureFeature),this.measureLabel&&this.measureLayer.removeFeature(this.measureLabel);var e=this.computeMeasure();e.push(e[0]),this.measureFeature={geometry:{gid:"measureShape",coordinates:[e],type:"Polygon"},properties:{style:new i({zIndex:2,fillColor:[1,0,0,1]})},type:"Feature"};var t=[(this.secondPickPoint[0]+this.pickPoint[0])/2,(this.secondPickPoint[1]+this.pickPoint[1])/2],n=this.renderContext.get3DFromPixel(t[0],t[1]),s=r.from3DToGeo(n);this.measureLabel={geometry:{type:"Point",gid:"measureShape",coordinates:s},properties:{style:new i({label:r.fromDegreesToDMS(this.geoDistance),fillColor:[1,1,1,1],zIndex:2})}},this.measureLayer.addFeature(this.measureFeature),this.measureLayer.addFeature(this.measureLabel)},s.prototype.toggle=function(){this.activated=!this.activated,this.activated?(e("#measureInvoker").css("background-image","url(css/images/measure_on.png)"),e(this.renderContext.canvas).css("cursor","url(css/images/selectionCursor.png)")):(e("#measureInvoker").css("background-image","url(css/images/measure_off.png)"),e(this.renderContext.canvas).css("cursor","default"))},s.prototype.clear=function(){this.measureFeature&&this.measureLayer.removeFeature(this.measureFeature),this.pickPoint=null,this.geoPickPoint=null},s}),define("StarProvider",["jquery","gw/CoordinateSystem","gw/FeatureStyle","./LayerManager"],function(e,t,n,r){function o(t,n){if(!n.nameUrl||!n.catalogueUrl)return console.error("Not valid options"),null;var r={type:"GET",url:n.nameUrl,success:function(e){i=e},error:function(e,t,n){console.error(e.responseText)}},o={type:"GET",url:n.catalogueUrl,success:function(e){s=e},error:function(e,t,n){console.error(e.responseText)}},f=this;e.when(e.ajax(r),e.ajax(o)).then(function(){u(t)},a)}function u(e){var r=i.slice(i.indexOf("897;Acamar"),i.indexOf("1231;Zaurak")+11),o=r.split("\n");r=s.slice(s.indexOf("001."),s.indexOf("4.98;K3Ibv")+10);var u=r.split("\n"),a=[];for(var f=0;f<o.length;f++){var l=o[f].split(";"),c=parseInt(l[0]),h=l[1];for(var p=0;p<u.length;p++){l=u[p].split(";");if(parseInt(l[2])==c){var d=l[6],v=l[7],m=[];t.fromEquatorialToGeo([d,v],m);var g={geometry:{type:"Point",gid:"star_"+h,coordinates:[m[0],m[1]]},properties:{name:h,style:new n({label:h,fillColor:[1,1,1,1]})}};a.push(g)}}}var y={type:"FeatureCollection",features:a};e.addFeatureCollection(y)}function a(){console.error("Failed to load files")}var i,s;r.registerDataProvider("star",o)}),define("ConstellationProvider",["jquery","./LayerManager","gw/CoordinateSystem","gw/FeatureStyle"],function(e,t,n,r){function u(t,n){if(!n.nameUrl||!n.catalogueUrl)return console.error("Not valid options"),!1;var r={type:"GET",url:n.nameUrl,success:function(e){i=e},error:function(e,t,n){console.error(e.responseText)}},o={type:"GET",url:n.catalogueUrl,success:function(e){s=e},error:function(e,t,n){console.error(e.responseText)}},u=this;e.when(e.ajax(r),e.ajax(o)).then(function(){a(),f(t)},l)}function a(){var e=i.split("\n"),t=s.split("\n");for(var r=0;r<t.length;r++){var u=t[r].replace("  "," ");u=u.split(" ");var a=parseFloat(u[0]),f=parseFloat(u[1]),l=u[2],c=u[3];a*=15;if(!o[l])for(j=0;j<e.length;j++){var u=e[j].split(";"),h=u[0];if(h==l){var p=u[1];o[l]={coord:[],name:p,x:0,y:0,z:0,nbStars:0};break}}var d=[a,f],v=[];n.fromGeoTo3D(d,v),o[l].x+=v[0],o[l].y+=v[1],o[l].z+=v[2],o[l].nbStars++,o[l].coord.push(d)}}function f(e){var t=[],i=[];for(var s in o){var u=o[s];u.coord.push(u.coord[0]);var a={geometry:{type:"Polygon",gid:"constellationShape_"+u.name,coordinates:[u.coord]},properties:{name:u.name}};i.push(a);var f=[];n.from3DToGeo([u.x/u.nbStars,u.y/u.nbStars,u.z/u.nbStars],f);var l={geometry:{type:"Point",gid:"constellationName_"+u.name,coordinates:[f[0],f[1]]},properties:{name:u.name,style:new r({textColor:"#083BA8",fillColor:[1,1,1,1],label:u.name})}};t.push(l)}var c={type:"FeatureCollection",features:i},h={type:"FeatureCollection",features:t};e.addFeatureCollection(c),e.addFeatureCollection(h)}function l(){console.error("Failed to load files")}var i,s,o={};t.registerDataProvider("constellation",u)}),define("JsonProvider",["jquery","./LayerManager","./JsonProcessor"],function(e,t,n){function r(t,r){e.ajax({type:"GET",url:r.url,success:function(e){n.handleFeatureCollection(t,e),t.addFeatureCollection(e)},error:function(e,t,n){console.error(e.responseText)}})}t.registerDataProvider("JSON",r)}),define("OpenSearchProvider",["jquery","./LayerManager","./JsonProcessor"],function(e,t,n){function r(t,i,s){e.ajax({type:"GET",url:i.url+"startIndex="+s+"&count=500",success:function(e){n.handleFeatureCollection(t,e),t.addFeatureCollection(e),s+e.features.length<e.totalResults&&r(t,i.url,s+e.features.length)},error:function(e,t,n){console.error(e.responseText)}})}t.registerDataProvider("OpenSearch",function(e,t){r(e,t,1)})}),define("PlanetProvider",["jquery","gw/FeatureStyle","./LayerManager"],function(e,t,n){var r,i=function(e){return e||(e=new Date),(e.getTime()+e.getTimezoneOffset()*6e4)/864e5+2440587.5},s={planets:[["Mercury","rgb(170,150,170)",[2456474.5,113.62579,18.471,3.23,2456475,113.4281,18.37483,3.37,2456475.5,113.21445,18.28334,3.51,2456476,112.98555,18.19668,3.67,2456476.5,112.74219,18.11498,3.82,2456477,112.48519,18.03835,3.98,2456477.5,112.21546,17.96692,4.14,2456478,111.93396,17.90078,4.31,2456478.5,111.6417,17.84003,4.47,2456479,111.33977,17.78476,4.64,2456479.5,111.02929,17.73503,4.8,2456480,110.71144,17.6909,4.96,2456480.5,110.38744,17.65243,5.11,2456481,110.05858,17.61965,5.25,2456481.5,109.72614,17.59258,5.37,2456482,109.39146,17.57125,5.46,2456482.5,109.05591,17.55563,5.52,2456483,108.72085,17.54573,5.54,2456483.5,108.38768,17.54151,5.52,2456484,108.05779,17.54293,5.47,2456484.5,107.73256,17.54994,5.37,2456485,107.41338,17.56248,5.25,2456485.5,107.10161,17.58045,5.11,2456486,106.79859,17.60377,4.95,2456486.5,106.50564,17.63234,4.77,2456487,106.22404,17.66603,4.6,2456487.5,105.95502,17.70471,4.41,2456488,105.6998,17.74824,4.23,2456488.5,105.45951,17.79647,4.04,2456489,105.23525,17.84924,3.86,2456489.5,105.02808,17.90636,3.68,2456490,104.83898,17.96764,3.5,2456490.5,104.66889,18.0329,3.32,2456491,104.51866,18.10192,3.15,2456491.5,104.38913,18.17448,2.98,2456492,104.28104,18.25036,2.81,2456492.5,104.19509,18.32933,2.66,2456493,104.13191,18.41114,2.5,2456493.5,104.09208,18.49553,2.35,2456494,104.07613,18.58224,2.2,2456494.5,104.08453,18.67102,2.06,2456495,104.1177,18.76157,1.92,2456495.5,104.17601,18.85361,1.79,2456496,104.25977,18.94686,1.66,2456496.5,104.36927,19.04101,1.53,2456497,104.50474,19.13575,1.41,2456497.5,104.66637,19.23078,1.29,2456498,104.85433,19.32577,1.18,2456498.5,105.06872,19.4204,1.07,2456499,105.30964,19.51434,.96,2456499.5,105.57713,19.60724,.86,2456500,105.87122,19.69877,.76,2456500.5,106.19189,19.78857,.66,2456501,106.5391,19.87629,.57,2456501.5,106.91279,19.96156,.48,2456502,107.31286,20.04402,.39,2456502.5,107.73918,20.1233,.31,2456503,108.19161,20.19902,.23,2456503.5,108.66996,20.2708,.15,2456504,109.17404,20.33826,.07,2456504.5,109.7036,20.401,.07,2456505,110.25838,20.45865,-0.07,2456505.5,110.83809,20.51081,-0.14,2456506,111.4424,20.55708,-0.21,2456506.5,112.07095,20.59709,-0.27,2456507,112.72336,20.63043,-0.33,2456507.5,113.39919,20.65673,-0.39,2456508,114.09797,20.67561,-0.45,2456508.5,114.81922,20.68668,-0.5,2456509,115.56237,20.6896,-0.56,2456509.5,116.32686,20.68399,-0.61,2456510,117.11205,20.66953,-0.66,2456510.5,117.91728,20.64589,-0.7,2456511,118.74185,20.61275,-0.75,2456511.5,119.585,20.56982,-0.79,2456512,120.44595,20.51685,-0.83,2456512.5,121.32388,20.45357,-0.88,2456513,122.21791,20.37978,-0.91,2456513.5,123.12714,20.29528,-0.95,2456514,124.05065,20.19991,-0.99,2456514.5,124.98748,20.09355,-1.03,2456515,125.93665,19.97608,-1.06,2456515.5,126.89715,19.84746,-1.09,2456516,127.86797,19.70765,-1.13,2456516.5,128.84809,19.55666,-1.16,2456517,129.83648,19.39453,-1.19,2456517.5,130.83211,19.22133,-1.23,2456518,131.83397,19.03716,-1.26,2456518.5,132.84106,18.84218,-1.29,2456519,133.85239,18.63655,-1.33,2456519.5,134.86701,18.42046,-1.36,2456520,135.88398,18.19416,-1.39,2456520.5,136.90242,17.95787,-1.43,2456521,137.92147,17.71189,-1.46,2456521.5,138.94031,17.45649,-1.5,2456522,139.95817,17.19199,-1.53,2456522.5,140.97432,16.9187,-1.57,2456523,141.98809,16.63697,-1.6,2456523.5,142.99884,16.34713,-1.64,2456524,144.00599,16.04954,-1.68,2456524.5,145.00901,15.74454,-1.72,2456525,146.00741,15.43249,-1.75,2456525.5,147.00077,15.11374,-1.79,2456526,147.98868,14.78865,-1.83,2456526.5,148.9708,14.45757,-1.87,2456527,149.94682,14.12083,-1.9,2456527.5,150.91648,13.77879,-1.93,2456528,151.87956,13.43176,-1.96,2456528.5,152.83586,13.08008,-1.97,2456529,153.78523,12.72405,-1.98,2456529.5,154.72753,12.36398,-1.96,2456530,155.66267,12.00017,-1.93,2456530.5,156.59057,11.6329,-1.88,2456531,157.51118,11.26245,-1.83,2456531.5,158.42447,10.8891,-1.77,2456532,159.33045,10.51308,-1.71,2456532.5,160.22913,10.13465,-1.64,2456533,161.12052,9.75405,-1.58,2456533.5,162.00467,9.37149,-1.52,2456534,162.88164,8.98719,-1.46,2456534.5,163.75149,8.60137,-1.4,2456535,164.6143,8.21421,-1.35,2456535.5,165.47016,7.82591,-1.29,2456536,166.31915,7.43664,-1.24,2456536.5,167.16138,7.04657,-1.19,2456537,167.99694,6.65588,-1.14,2456537.5,168.82596,6.26471,-1.09,2456538,169.64854,5.87321,-1.05,2456538.5,170.46479,5.48153,-1,2456539,171.27485,5.0898,-0.96,2456539.5,172.07881,4.69815,-0.92,2456540,172.87681,4.30671,-0.88,2456540.5,173.66897,3.91559,-0.84,2456541,174.45541,3.52491,-0.81,2456541.5,175.23625,3.13477,-0.77,2456542,176.01161,2.74528,-0.74,2456542.5,176.78161,2.35654,-0.71,2456543,177.54636,1.96863,-0.68,2456543.5,178.30599,1.58166,-0.65,2456544,179.06061,1.19571,-0.62,2456544.5,179.81033,.81086,-0.59,2456545,180.55527,.4272,-0.56,2456545.5,181.29551,.0448,-0.54,2456546,182.03118,-0.33626,-0.51,2456546.5,182.76238,-0.71592,-0.49,2456547,183.4892,-1.09409,-0.46,2456547.5,184.21173,-1.47071,-0.44,2456548,184.93007,-1.84571,-0.42,2456548.5,185.64431,-2.21903,-0.4,2456549,186.35454,-2.59061,-0.38,2456549.5,187.06082,-2.96039,-0.36,2456550,187.76325,-3.3283,-0.34,2456550.5,188.4619,-3.69428,-0.33,2456551,189.15683,-4.05828,-0.31,2456551.5,189.84812,-4.42024,-0.3,2456552,190.53583,-4.78011,-0.28,2456552.5,191.22002,-5.13784,-0.27,2456553,191.90075,-5.49335,-0.25,2456553.5,192.57806,-5.84662,-0.24,2456554,193.25201,-6.19757,-0.23,2456554.5,193.92263,-6.54616,-0.22,2456555,194.58998,-6.89234,-0.2,2456555.5,195.25407,-7.23605,-0.19,2456556,195.91495,-7.57724,-0.18,2456556.5,196.57263,-7.91586,-0.17,2456557,197.22713,-8.25186,-0.16,2456557.5,197.87847,-8.58518,-0.16,2456558,198.52664,-8.91576,-0.15,2456558.5,199.17166,-9.24356,-0.14,2456559,199.8135,-9.56851,-0.13,2456559.5,200.45217,-9.89057,-0.13,2456560,201.08763,-10.20967,-0.12,2456560.5,201.71986,-10.52575,-0.12,2456561,202.34883,-10.83876,-0.11,2456561.5,202.97449,-11.14863,-0.11,2456562,203.59679,-11.45531,-0.1,2456562.5,204.21567,-11.75872,-0.1,2456563,204.83107,-12.0588,-0.09,2456563.5,205.4429,-12.35549,-0.09,2456564,206.05108,-12.64871,-0.09,2456564.5,206.65551,-12.9384,-0.09,2456565,207.25609,-13.22447,-0.08,2456565.5,207.85269,-13.50686,-0.08,2456566,208.44519,-13.78548,-0.08,2456566.5,209.03344,-14.06026,-0.08,2456567,209.61728,-14.3311,-0.08,2456567.5,210.19656,-14.59793,-0.08,2456568,210.77108,-14.86064,-0.08,2456568.5,211.34064,-15.11916,-0.08,2456569,211.90504,-15.37337,-0.07,2456569.5,212.46404,-15.62318,-0.07,2456570,213.0174,-15.86848,-0.07,2456570.5,213.56485,-16.10916,-0.07,2456571,214.10609,-16.3451,-0.07,2456571.5,214.64084,-16.57619,-0.07,2456572,215.16875,-16.80229,-0.07,2456572.5,215.68948,-17.02328,-0.07,2456573,216.20266,-17.23901,-0.07,2456573.5,216.70787,-17.44934,-0.07,2456574,217.20471,-17.65411,-0.07,2456574.5,217.69272,-17.85317,-0.07,2456575,218.17141,-18.04635,-0.07,2456575.5,218.64027,-18.23346,-0.06,2456576,219.09877,-18.41432,-0.06,2456576.5,219.54633,-18.58873,-0.06,2456577,219.98234,-18.75649,-0.05,2456577.5,220.40616,-18.91737,-0.04,2456578,220.81711,-19.07114,-0.04,2456578.5,221.21449,-19.21756,-0.03,2456579,221.59754,-19.35636,-0.02,2456579.5,221.96547,-19.48728,-0.01,2456580,222.31746,-19.61003,-0.01,2456580.5,222.65264,-19.7243,.02,2456581,222.97012,-19.82978,.04,2456581.5,223.26894,-19.92612,.06,2456582,223.54814,-20.01296,.08,2456582.5,223.80669,-20.08995,.1,2456583,224.04356,-20.15667,.13,2456583.5,224.25766,-20.21271,.16,2456584,224.4479,-20.25765,.2,2456584.5,224.61314,-20.29103,.24,2456585,224.75227,-20.31237,.29,2456585.5,224.86412,-20.32118,.34,2456586,224.94757,-20.31697,.4,2456586.5,225.00149,-20.2992,.46,2456587,225.02479,-20.26736,.54,2456587.5,225.01642,-20.2209,.62,2456588,224.97539,-20.15928,.71,2456588.5,224.90081,-20.08199,.81,2456589,224.79188,-19.9885,.92,2456589.5,224.64794,-19.87833,1.04,2456590,224.46848,-19.75102,1.18,2456590.5,224.25319,-19.60617,1.33,2456591,224.00197,-19.44344,1.5,2456591.5,223.71498,-19.2626,1.69,2456592,223.39266,-19.06348,1.89,2456592.5,223.03575,-18.84607,2.11,2456593,222.64534,-18.6105,2.36,2456593.5,222.22287,-18.35704,2.63,2456594,221.77019,-18.08618,2.92,2456594.5,221.28951,-17.79861,3.24,2456595,220.78346,-17.49523,3.59,2456595.5,220.25505,-17.17719,3.97,2456596,219.70765,-16.84586,4.38,2456596.5,219.145,-16.50288,4.82,2456597,218.57113,-16.15009,4.82,2456597.5,217.99033,-15.78957,4.82,2456598,217.40708,-15.42358,4.82,2456598.5,216.82599,-15.05455,4.82,2456599,216.25172,-14.68502,4.82,2456599.5,215.68889,-14.31761,4.82,2456600,215.14204,-13.95496,4.98,2456600.5,214.61552,-13.5997,4.48,2456601,214.11344,-13.25438,4.01,2456601.5,213.6396,-12.92141,3.57,2456602,213.19743,-12.60306,3.16,2456602.5,212.78998,-12.30139,2.78,2456603,212.41988,-12.01823,2.42,2456603.5,212.08932,-11.75514,2.1,2456604,211.80002,-11.51345,1.8,2456604.5,211.55331,-11.29421,1.52,2456605,211.35007,-11.09818,1.27,2456605.5,211.1908,-10.9259,1.04,2456606,211.07562,-10.77763,.84,2456606.5,211.00433,-10.65344,.65,2456607,210.97645,-10.55317,.48,2456607.5,210.9912,-10.47649,.33,2456608,211.04762,-10.4229,.2,2456608.5,211.14456,-10.39178,.08,2456609,211.2807,-10.3824,-0.03,2456609.5,211.45464,-10.39392,-0.12,2456610,211.66485,-10.42544,-0.21,2456610.5,211.90979,-10.47602,-0.28,2456611,212.18786,-10.54466,-0.34,2456611.5,212.49744,-10.63037,-0.4,2456612,212.83693,-10.73211,-0.45,2456612.5,213.20475,-10.84889,-0.49,2456613,213.59934,-10.97969,-0.52,2456613.5,214.01918,-11.12353,-0.55,2456614,214.46282,-11.27946,-0.58,2456614.5,214.92885,-11.44653,-0.6,2456615,215.41592,-11.62384,-0.62,2456615.5,215.92275,-11.81055,-0.63,2456616,216.44812,-12.00581,-0.64,2456616.5,216.99088,-12.20884,-0.65,2456617,217.54993,-12.41889,-0.66,2456617.5,218.12426,-12.63524,-0.66,2456618,218.7129,-12.85723,-0.67,2456618.5,219.31495,-13.0842,-0.67,2456619,219.92957,-13.31557,-0.67,2456619.5,220.55597,-13.55076,-0.67,2456620,221.19343,-13.78924,-0.67,2456620.5,221.84126,-14.03051,-0.67,2456621,222.49882,-14.27409,-0.67,2456621.5,223.16554,-14.51955,-0.67,2456622,223.84087,-14.76647,-0.66,2456622.5,224.52431,-15.01446,-0.66,2456623,225.21538,-15.26315,-0.66,2456623.5,225.91366,-15.5122,-0.66,2456624,226.61876,-15.7613,-0.65,2456624.5,227.3303,-16.01014,-0.65,2456625,228.04795,-16.25844,-0.65,2456625.5,228.77139,-16.50593,-0.65,2456626,229.50033,-16.75237,-0.65,2456626.5,230.23452,-16.99753,-0.64,2456627,230.9737,-17.24118,-0.64,2456627.5,231.71765,-17.48312,-0.64,2456628,232.46616,-17.72316,-0.64,2456628.5,233.21904,-17.96111,-0.64,2456629,233.97611,-18.19681,-0.64,2456629.5,234.73722,-18.43009,-0.64,2456630,235.5022,-18.66081,-0.64,2456630.5,236.27092,-18.8888,-0.65,2456631,237.04325,-19.11395,-0.65,2456631.5,237.81907,-19.33612,-0.65,2456632,238.59827,-19.55519,-0.65,2456632.5,239.38076,-19.77103,-0.66,2456633,240.16644,-19.98355,-0.66,2456633.5,240.95522,-20.19263,-0.67,2456634,241.74703,-20.39818,-0.67,2456634.5,242.54179,-20.60009,-0.68,2456635,243.33944,-20.79828,-0.68,2456635.5,244.13992,-20.99265,-0.69,2456636,244.94317,-21.18313,-0.7,2456636.5,245.74914,-21.36964,-0.7,2456637,246.55777,-21.55209,-0.71,2456637.5,247.36903,-21.73041,-0.72,2456638,248.18286,-21.90453,-0.73,2456638.5,248.99923,-22.07438,-0.74,2456639,249.8181,-22.2399,-0.75,2456639.5,250.63943,-22.40101,-0.76,2456640,251.46317,-22.55765,-0.77,2456640.5,252.28931,-22.70976,-0.78,2456641,253.1178,-22.85728,-0.79,2456641.5,253.9486,-23.00016,-0.81,2456642,254.7817,-23.13833,-0.82,2456642.5,255.61704,-23.27174,-0.84,2456643,256.45461,-23.40033,-0.85,2456643.5,257.29436,-23.52405,-0.87,2456644,258.13626,-23.64285,-0.88,2456644.5,258.98029,-23.75668,-0.9,2456645,259.82641,-23.86548,-0.91,2456645.5,260.67458,-23.9692,-0.93,2456646,261.52478,-24.0678,-0.95,2456646.5,262.37696,-24.16122,-0.97,2456647,263.23109,-24.24942,-0.99,2456647.5,264.08713,-24.33236,-1.01,2456648,264.94506,-24.40998,-1.03,2456648.5,265.80482,-24.48223,-1.05,2456649,266.66639,-24.54908,-1.07,2456649.5,267.52972,-24.61048,-1.09,2456650,268.39478,-24.66639,-1.11,2456650.5,269.26151,-24.71675,-1.14,2456651,270.12988,-24.76153,-1.16,2456651.5,270.99984,-24.80069,-1.18,2456652,271.87135,-24.83419,-1.2,2456652.5,272.74435,-24.86198,-1.23,2456653,273.61881,-24.88402,-1.25,2456653.5,274.49467,-24.90027,-1.27,2456654,275.37187,-24.9107,-1.29,2456654.5,276.25037,-24.91526,-1.3,2456655,277.13011,-24.91392,-1.31,2456655.5,278.01103,-24.90664,-1.32,2456656,278.89307,-24.89338,-1.32,2456656.5,279.77617,-24.87411,-1.32,2456657,280.66025,-24.8488,-1.32,2456657.5,281.54526,-24.8174,-1.31,2456658,282.43113,-24.77989,-1.3,2456658.5,283.31777,-24.73623,-1.29,2456659,284.20512,-24.6864,-1.27,2456659.5,285.09311,-24.63036,-1.26,2456660,285.98164,-24.56808,-1.25,2456660.5,286.87064,-24.49953,-1.23,2456661,287.76002,-24.4247,-1.22,2456661.5,288.6497,-24.34354,-1.2,2456662,289.53959,-24.25603,-1.19,2456662.5,290.42959,-24.16216,-1.18,2456663,291.31961,-24.06189,-1.16,2456663.5,292.20955,-23.95522,-1.15,2456664,293.09931,-23.84211,-1.13,2456664.5,293.98879,-23.72255,-1.12,2456665,294.87786,-23.59654,-1.11,2456665.5,295.76642,-23.46405,-1.1,2456666,296.65434,-23.32507,-1.09,2456666.5,297.5415,-23.17961,-1.08,2456667,298.42776,-23.02765,-1.06,2456667.5,299.31299,-22.8692,-1.05,2456668,300.19703,-22.70425,-1.04,2456668.5,301.07974,-22.53282,-1.03,2456669,301.96094,-22.35491,-1.03,2456669.5,302.84048,-22.17054,-1.02,2456670,303.71816,-21.97973,-1.01,2456670.5,304.59379,-21.7825,-1,2456671,305.46717,-21.57888,-0.99,2456671.5,306.33809,-21.36891,-0.99,2456672,307.20631,-21.15263,-0.98,2456672.5,308.0716,-20.9301,-0.97,2456673,308.93369,-20.70137,-0.97,2456673.5,309.7923,-20.4665,-0.96,2456674,310.64716,-20.22558,-0.96,2456674.5,311.49793,-19.97869,-0.95,2456675,312.34429,-19.72592,-0.95,2456675.5,313.18589,-19.46739,-0.95,2456676,314.02233,-19.20322,-0.94,2456676.5,314.85323,-18.93355,-0.94,2456677,315.67814,-18.65851,-0.94,2456677.5,316.4966,-18.37829,-0.93,2456678,317.30812,-18.09307,-0.93,2456678.5,318.11217,-17.80305,-0.93,2456679,318.90819,-17.50845,-0.93,2456679.5,319.69558,-17.20952,-0.92,2456680,320.47369,-16.90653,-0.92,2456680.5,321.24185,-16.59977,-0.92,2456681,321.99933,-16.28956,-0.92,2456681.5,322.74537,-15.97624,-0.91,2456682,323.47913,-15.66019,-0.91,2456682.5,324.19977,-15.34182,-0.9,2456683,324.90635,-15.02155,-0.9,2456683.5,325.59792,-14.69988,-0.89,2456684,326.27345,-14.37729,-0.88,2456684.5,326.93188,-14.05432,-0.87,2456685,327.57207,-13.73156,-0.86,2456685.5,328.19287,-13.40962,-0.84,2456686,328.79304,-13.08914,-0.82,2456686.5,329.37133,-12.77081,-0.8,2456687,329.92643,-12.45535,-0.78,2456687.5,330.45698,-12.14352,-0.75,2456688,330.96163,-11.8361,-0.72,2456688.5,331.43896,-11.53393,-0.68,2456689,331.88756,-11.23784,-0.64,2456689.5,332.30602,-10.94872,-0.59,2456690,332.69291,-10.66746,-0.54,2456690.5,333.04684,-10.39499,-0.48,2456691,333.36645,-10.13221,-0.41,2456691.5,333.6504,-9.88007,-0.33,2456692,333.89745,-9.63951,-0.24,2456692.5,334.10642,-9.41144,-0.15,2456693,334.27622,-9.19678,-0.04,2456693.5,334.4059,-8.99641,.08,2456694,334.49463,-8.81119,.21,2456694.5,334.54177,-8.64192,.35,2456695,334.54683,-8.48935,.5,2456695.5,334.50953,-8.35418,.67,2456696,334.42983,-8.23702,.86,2456696.5,334.30791,-8.1384,1.06,2456697,334.14423,-8.05875,1.27,2456697.5,333.93949,-7.9984,1.5,2456698,333.69472,-7.95756,1.74,2456698.5,333.4112,-7.93632,2.01,2456699,333.09054,-7.93463,2.28,2456699.5,332.73462,-7.95231,2.58,2456700,332.34563,-7.98904,2.88,2456700.5,331.92602,-8.04437,3.2,2456701,331.47852,-8.1177,3.53,2456701.5,331.00608,-8.20829,3.87,2456702,330.51185,-8.31529,4.2,2456702.5,329.99917,-8.43772,4.53,2456703,329.4715,-8.57451,4.82,2456703.5,328.93242,-8.72449,5.06,2456704,328.38553,-8.8864,5.21,2456704.5,327.83446,-9.05896,5.25,2456705,327.28278,-9.24082,5.17,2456705.5,326.734,-9.43063,4.99,2456706,326.1915,-9.62702,4.76,2456706.5,325.65852,-9.82865,4.49,2456707,325.13809,-10.03421,4.21,2456707.5,324.63306,-10.24241,3.93,2456708,324.14603,-10.45206,3.66,2456708.5,323.67934,-10.662,3.4,2456709,323.23511,-10.87115,3.15,2456709.5,322.81518,-11.07853,2.91,2456710,322.42112,-11.28323,2.69,2456710.5,322.05428,-11.4844,2.49,2456711,321.71573,-11.68132,2.3,2456711.5,321.40633,-11.8733,2.12,2456712,321.12673,-12.05977,1.95,2456712.5,320.87734,-12.24022,1.8,2456713,320.65843,-12.4142,1.65,2456713.5,320.47007,-12.58133,1.52,2456714,320.31219,-12.74129,1.4,2456714.5,320.18459,-12.89383,1.29,2456715,320.08695,-13.03872,1.18,2456715.5,320.01884,-13.1758,1.09,2456716,319.97977,-13.30493,1,2456716.5,319.96914,-13.42601,.92,2456717,319.98634,-13.53898,.85,2456717.5,320.03067,-13.64379,.78,2456718,320.10142,-13.74042,.72,2456718.5,320.19784,-13.82886,.66,2456719,320.31916,-13.90914,.61,2456719.5,320.46462,-13.98128,.56,2456720,320.63342,-14.04532,.51,2456720.5,320.82479,-14.10131,.47,2456721,321.03795,-14.14931,.44,2456721.5,321.27212,-14.18938,.4,2456722,321.52656,-14.22159,.37,2456722.5,321.80051,-14.24601,.34,2456723,322.09325,-14.26272,.32,2456723.5,322.40407,-14.2718,.29,2456724,322.73228,-14.27331,.27,2456724.5,323.07721,-14.26735,.25,2456725,323.43821,-14.25398,.23,2456725.5,323.81465,-14.2333,.22,2456726,324.20592,-14.20538,.2,2456726.5,324.61145,-14.17029,.19,2456727,325.03067,-14.12811,.17,2456727.5,325.46305,-14.07893,.16,2456728,325.90805,-14.02281,.15,2456728.5,326.36519,-13.95982,.14,2456729,326.834,-13.89005,.13,2456729.5,327.31401,-13.81355,.12,2456730,327.80478,-13.73041,.11,2456730.5,328.30592,-13.64068,.1,2456731,328.81701,-13.54443,.1,2456731.5,329.33767,-13.44173,.09,2456732,329.86755,-13.33264,.08,2456732.5,330.40631,-13.21722,.07,2456733,330.95361,-13.09553,.07,2456733.5,331.50914,-12.96762,.06,2456734,332.07262,-12.83357,.06,2456734.5,332.64375,-12.69341,.05,2456735,333.22227,-12.54721,.04,2456735.5,333.80793,-12.39502,.04,2456736,334.40049,-12.2369,.03,2456736.5,334.99972,-12.07289,.03,2456737,335.60542,-11.90304,.02,2456737.5,336.21737,-11.7274,.01,2456738,336.83539,-11.54603,.01,2456738.5,337.45929,-11.35897,.01,2456739,338.08892,-11.16626,-0.01,2456739.5,338.72411,-10.96795,-0.01,2456740,339.3647,-10.7641,-0.02,2456740.5,340.01057,-10.55473,-0.03,2456741,340.66158,-10.3399,-0.03,2456741.5,341.31762,-10.11965,-0.04,2456742,341.97856,-9.89402,-0.05,2456742.5,342.64431,-9.66305,-0.06,2456743,343.31477,-9.42679,-0.07,2456743.5,343.98986,-9.18527,-0.08,2456744,344.6695,-8.93854,-0.09,2456744.5,345.35362,-8.68663,-0.1,2456745,346.04216,-8.42959,-0.11,2456745.5,346.73505,-8.16745,-0.12,2456746,347.43227,-7.90025,-0.13,2456746.5,348.13375,-7.62804,-0.14,2456747,348.83949,-7.35084,-0.15,2456747.5,349.54944,-7.06869,-0.17,2456748,350.26359,-6.78165,-0.18,2456748.5,350.98192,-6.48973,-0.19,2456749,351.70444,-6.19298,-0.21,2456749.5,352.43114,-5.89145,-0.22,2456750,353.16202,-5.58516,-0.24,2456750.5,353.8971,-5.27415,-0.25,2456751,354.6364,-4.95847,-0.27,2456751.5,355.37995,-4.63816,-0.29,2456752,356.12776,-4.31325,-0.31,2456752.5,356.87988,-3.98379,-0.33,2456753,357.63635,-3.64982,-0.35,2456753.5,358.39722,-3.31139,-0.37,2456754,359.16253,-2.96853,-0.39,2456754.5,359.93234,-2.6213,-0.41,2456755,.70672,-2.26973,-0.43,2456755.5,1.48574,-1.91389,-0.46,2456756,2.26945,-1.55382,-0.48,2456756.5,3.05794,-1.18958,-0.51,2456757,3.8513,-0.82122,-0.54,2456757.5,4.64959,-0.44879,-0.56,2456758,5.45292,-0.07237,-0.59,2456758.5,6.26137,.30799,-0.62,2456759,7.07504,.69222,-0.65,2456759.5,7.89403,1.08024,-0.69,2456760,8.71844,1.47198,-0.72,2456760.5,9.54838,1.86737,-0.76,2456761,10.38394,2.26631,-0.79,2456761.5,11.22524,2.66871,-0.83,2456762,12.07238,3.07448,-0.87,2456762.5,12.92547,3.48352,-0.91,2456763,13.78462,3.89571,-0.95,2456763.5,14.64995,4.31094,-1,2456764,15.52154,4.72909,-1.04,2456764.5,16.39951,5.15003,-1.09,2456765,17.28395,5.5736,-1.14,2456765.5,18.17496,5.99966,-1.19,2456766,19.07262,6.42806,-1.25,2456766.5,19.97702,6.8586,-1.3,2456767,20.88823,7.29112,-1.36,2456767.5,21.80631,7.72542,-1.42,2456768,22.73131,8.16128,-1.49,2456768.5,23.66327,8.59849,-1.55,2456769,24.60222,9.03681,-1.62,2456769.5,25.54816,9.47599,-1.7,2456770,26.5011,9.91577,-1.77,2456770.5,27.461,10.35587,-1.85,2456771,28.42781,10.79599,-1.93,2456771.5,29.40146,11.23583,-2.02,2456772,30.38186,11.67505,-2.11,2456772.5,31.36889,12.11333,-2.2,2456773,32.36239,12.5503,-2.29,2456773.5,33.36221,12.98557,-2.29,2456774,34.36816,13.4189,-2.29,2456774.5,35.37988,13.84975,-2.32,2456775,36.39717,14.27774,-2.25,2456775.5,37.41974,14.70247,-2.18,2456776,38.44723,15.12352,-2.12,2456776.5,39.47926,15.54046,-2.05,2456777,40.51541,15.95287,-1.99,2456777.5,41.55526,16.36031,-1.92,2456778,42.5983,16.76234,-1.86,2456778.5,43.64405,17.15854,-1.8,2456779,44.69196,17.54847,-1.74,2456779.5,45.74146,17.93173,-1.69,2456780,46.79198,18.3079,-1.63,2456780.5,47.8429,18.6766,-1.58,2456781,48.89361,19.03745,-1.53,2456781.5,49.94345,19.39009,-1.48,2456782,50.99179,19.73418,-1.43,2456782.5,52.03796,20.06941,-1.38,2456783,53.0813,20.39548,-1.34,2456783.5,54.12115,20.71213,-1.29,2456784,55.15686,21.01911,-1.25,2456784.5,56.18777,21.31622,-1.2,2456785,57.21324,21.60328,-1.16,2456785.5,58.23263,21.88011,-1.12,2456786,59.24533,22.1466,-1.08,2456786.5,60.25074,22.40263,-1.04,2456787,61.24827,22.64814,-0.99,2456787.5,62.23735,22.88307,-0.95,2456788,63.21744,23.10739,-0.91,2456788.5,64.18802,23.3211,-0.87,2456789,65.14857,23.52423,-0.83,2456789.5,66.09861,23.7168,-0.79,2456790,67.03768,23.89889,-0.75,2456790.5,67.96533,24.07056,-0.71,2456791,68.88114,24.23191,-0.67,2456791.5,69.7847,24.38304,-0.63,2456792,70.67563,24.52409,-0.59,2456792.5,71.55356,24.65517,-0.55,2456793,72.41813,24.77644,-0.51,2456793.5,73.269,24.88805,-0.47,2456794,74.10585,24.99016,-0.43,2456794.5,74.92837,25.08294,-0.39,2456795,75.73626,25.16656,-0.34,2456795.5,76.52922,25.24121,-0.3,2456796,77.30699,25.30706,-0.26,2456796.5,78.06929,25.3643,-0.21,2456797,78.81587,25.41313,-0.17,2456797.5,79.54646,25.45374,-0.13,2456798,80.26083,25.48632,-0.08,2456798.5,80.95873,25.51106,-0.03,2456799,81.63992,25.52816,.01,2456799.5,82.30418,25.53782,.06,2456800,82.95128,25.54023,.11,2456800.5,83.58099,25.53558,.15,2456801,84.1931,25.52407,.2,2456801.5,84.78738,25.5059,.25,2456802,85.36362,25.48125,.3,2456802.5,85.92161,25.45032,.35,2456803,86.46113,25.41329,.41,2456803.5,86.98198,25.37035,.46,2456804,87.48395,25.32169,.51,2456804.5,87.96683,25.2675,.57,2456805,88.43042,25.20795,.63,2456805.5,88.87453,25.14322,.69,2456806,89.29895,25.0735,.75,2456806.5,89.70351,24.99896,.81,2456807,90.08802,24.91978,.87,2456807.5,90.45229,24.83612,.94,2456808,90.79617,24.74818,1,2456808.5,91.11949,24.6561,1.07,2456809,91.4221,24.56007,1.14,2456809.5,91.70386,24.46024,1.22,2456810,91.96465,24.3568,1.29,2456810.5,92.20436,24.2499,1.37,2456811,92.42288,24.13971,1.45,2456811.5,92.62015,24.02639,1.53,2456812,92.79611,23.91012,1.62,2456812.5,92.95073,23.79105,1.71,2456813,93.084,23.66936,1.8,2456813.5,93.19593,23.5452,1.9,2456814,93.28659,23.41875,2,2456814.5,93.35605,23.29018,2.1,2456815,93.40442,23.15966,2.2,2456815.5,93.43186,23.02735,2.31,2456816,93.43856,22.89344,2.43,2456816.5,93.42477,22.75811,2.55,2456817,93.39075,22.62154,2.67,2456817.5,93.33684,22.48391,2.8,2456818,93.26342,22.34542,2.93,2456818.5,93.17091,22.20626,3.07,2456819,93.05979,22.06663,3.21,2456819.5,92.93061,21.92674,3.35,2456820,92.78396,21.78679,3.5,2456820.5,92.62048,21.64701,3.66,2456821,92.44088,21.50762,3.82,2456821.5,92.24593,21.36885,3.98,2456822,92.03645,21.23092,4.15,2456822.5,91.81331,21.09408,4.33,2456823,91.57744,20.95858,4.5,2456823.5,91.32982,20.82466,4.68,2456824,91.07148,20.69258,4.86,2456824.5,90.80351,20.56259,5.04,2456825,90.527,20.43496,5.21,2456825.5,90.24313,20.30995,5.38,2456826,89.95307,20.18783,5.54,2456826.5,89.65805,20.06885,5.54,2456827,89.35929,19.95328,5.54,2456827.5,89.05805,19.84139,5.54,2456828,88.7556,19.73342,5.54,2456828.5,88.45321,19.62963,5.54,2456829,88.15213,19.53027,5.54,2456829.5,87.85363,19.43557,5.54,2456830,87.55895,19.34576,5.54,2456830.5,87.26932,19.26105,5.45,2456831,86.98594,19.18164,5.28,2456831.5,86.70999,19.10774,5.1,2456832,86.4426,19.0395,4.92,2456832.5,86.18487,18.97708,4.74,2456833,85.93786,18.92064,4.55,2456833.5,85.70259,18.87029,4.37,2456834,85.48002,18.82613,4.19,2456834.5,85.27107,18.78825,4.01,2456835,85.07661,18.75673,3.84,2456835.5,84.89745,18.73159,3.67,2456836,84.73436,18.71288,3.51,2456836.5,84.58804,18.70059,3.34,2456837,84.45916,18.69472,3.19,2456837.5,84.34832,18.69524,3.04,2456838,84.25607,18.70209,2.89,2456838.5,84.18293,18.71521,2.75,2456839,84.12936,18.73452,2.61,2456839.5,84.09577,18.75991,2.48]],["Venus","rgb(245,222,179)",[2456474.5,126.71878,20.82026,-3.85,2456475.5,127.97871,20.53742,-3.85,2456476.5,129.23341,20.24516,-3.85,2456477.5,130.48282,19.94367,-3.85,2456478.5,131.72688,19.63312,-3.85,2456479.5,132.96554,19.31371,-3.85,2456480.5,134.19874,18.98562,-3.85,2456481.5,135.42647,18.64905,-3.85,2456482.5,136.64869,18.30418,-3.85,2456483.5,137.86538,17.95121,-3.86,2456484.5,139.07654,17.59034,-3.86,2456485.5,140.28217,17.22176,-3.86,2456486.5,141.48229,16.84567,-3.86,2456487.5,142.67692,16.46228,-3.86,2456488.5,143.86608,16.07177,-3.86,2456489.5,145.04983,15.67436,-3.86,2456490.5,146.22821,15.27024,-3.87,2456491.5,147.40128,14.85962,-3.87,2456492.5,148.56911,14.44269,-3.87,2456493.5,149.73176,14.01966,-3.87,2456494.5,150.88932,13.59072,-3.87,2456495.5,152.04186,13.15609,-3.88,2456496.5,153.18948,12.71596,-3.88,2456497.5,154.33228,12.27052,-3.88,2456498.5,155.4704,11.81996,-3.88,2456499.5,156.60394,11.36448,-3.88,2456500.5,157.73305,10.90426,-3.89,2456501.5,158.85787,10.43951,-3.89,2456502.5,159.97852,9.97041,-3.89,2456503.5,161.09514,9.49716,-3.89,2456504.5,162.20788,9.01995,-3.9,2456505.5,163.31686,8.53898,-3.9,2456506.5,164.42222,8.05445,-3.9,2456507.5,165.52409,7.56655,-3.91,2456508.5,166.62262,7.07547,-3.91,2456509.5,167.71794,6.58142,-3.91,2456510.5,168.8102,6.08458,-3.91,2456511.5,169.89952,5.58515,-3.92,2456512.5,170.98606,5.08332,-3.92,2456513.5,172.06997,4.57929,-3.92,2456514.5,173.15138,4.07324,-3.93,2456515.5,174.23044,3.56537,-3.93,2456516.5,175.30731,3.05586,-3.94,2456517.5,176.38212,2.54491,-3.94,2456518.5,177.45503,2.0327,-3.94,2456519.5,178.52619,1.51943,-3.95,2456520.5,179.59574,1.00528,-3.95,2456521.5,180.66382,.49043,-3.95,2456522.5,181.73059,-0.02491,-3.96,2456523.5,182.79619,-0.54058,-3.96,2456524.5,183.86077,-1.05637,-3.97,2456525.5,184.92449,-1.57212,-3.97,2456526.5,185.98754,-2.08764,-3.98,2456527.5,187.05007,-2.60277,-3.98,2456528.5,188.11227,-3.11731,-3.99,2456529.5,189.17431,-3.6311,-3.99,2456530.5,190.23636,-4.14396,-4,2456531.5,191.29858,-4.6557,-4,2456532.5,192.36113,-5.16616,-4.01,2456533.5,193.42416,-5.67514,-4.01,2456534.5,194.48782,-6.18246,-4.02,2456535.5,195.55225,-6.68794,-4.02,2456536.5,196.61761,-7.19139,-4.03,2456537.5,197.68402,-7.69264,-4.03,2456538.5,198.75162,-8.19148,-4.04,2456539.5,199.82053,-8.68775,-4.04,2456540.5,200.8909,-9.18124,-4.05,2456541.5,201.96283,-9.67178,-4.05,2456542.5,203.03645,-10.15917,-4.06,2456543.5,204.11186,-10.64323,-4.07,2456544.5,205.18918,-11.12377,-4.07,2456545.5,206.2685,-11.60061,-4.08,2456546.5,207.34991,-12.07355,-4.08,2456547.5,208.43349,-12.54241,-4.09,2456548.5,209.51931,-13.007,-4.1,2456549.5,210.60745,-13.46712,-4.1,2456550.5,211.69796,-13.92259,-4.11,2456551.5,212.79092,-14.37322,-4.12,2456552.5,213.88637,-14.81882,-4.13,2456553.5,214.9844,-15.2592,-4.13,2456554.5,216.08507,-15.69418,-4.14,2456555.5,217.18844,-16.12359,-4.15,2456556.5,218.29458,-16.54723,-4.15,2456557.5,219.40354,-16.96494,-4.16,2456558.5,220.51536,-17.37654,-4.17,2456559.5,221.63008,-17.78185,-4.18,2456560.5,222.74772,-18.18069,-4.18,2456561.5,223.86829,-18.57288,-4.19,2456562.5,224.99178,-18.95825,-4.2,2456563.5,226.11818,-19.33662,-4.21,2456564.5,227.24748,-19.70781,-4.22,2456565.5,228.37963,-20.07166,-4.22,2456566.5,229.51459,-20.42799,-4.23,2456567.5,230.6523,-20.77664,-4.24,2456568.5,231.79269,-21.11743,-4.25,2456569.5,232.93566,-21.45021,-4.26,2456570.5,234.08114,-21.77481,-4.27,2456571.5,235.22898,-22.09107,-4.28,2456572.5,236.37907,-22.39886,-4.28,2456573.5,237.53124,-22.69802,-4.29,2456574.5,238.68532,-22.9884,-4.3,2456575.5,239.84111,-23.26986,-4.31,2456576.5,240.99841,-23.54227,-4.32,2456577.5,242.15698,-23.8055,-4.33,2456578.5,243.31659,-24.05941,-4.34,2456579.5,244.47699,-24.30389,-4.35,2456580.5,245.63795,-24.53882,-4.36,2456581.5,246.7992,-24.76409,-4.37,2456582.5,247.96048,-24.9796,-4.38,2456583.5,249.12153,-25.18525,-4.39,2456584.5,250.28207,-25.38097,-4.4,2456585.5,251.44182,-25.56668,-4.41,2456586.5,252.60046,-25.74231,-4.42,2456587.5,253.7577,-25.9078,-4.43,2456588.5,254.91319,-26.06309,-4.44,2456589.5,256.0666,-26.20814,-4.45,2456590.5,257.21757,-26.34291,-4.46,2456591.5,258.36573,-26.46737,-4.47,2456592.5,259.51071,-26.58151,-4.48,2456593.5,260.65212,-26.6853,-4.49,2456594.5,261.78954,-26.77876,-4.51,2456595.5,262.92257,-26.86188,-4.52,2456596.5,264.05078,-26.93468,-4.53,2456597.5,265.17373,-26.9972,-4.54,2456598.5,266.29097,-27.04947,-4.55,2456599.5,267.40203,-27.09154,-4.56,2456600.5,268.50642,-27.12347,-4.57,2456601.5,269.60363,-27.14535,-4.58,2456602.5,270.69311,-27.15726,-4.59,2456603.5,271.77432,-27.15928,-4.61,2456604.5,272.84669,-27.15153,-4.62,2456605.5,273.90963,-27.13411,-4.63,2456606.5,274.96256,-27.10715,-4.64,2456607.5,276.0049,-27.07078,-4.65,2456608.5,277.03604,-27.02513,-4.66,2456609.5,278.05541,-26.97035,-4.67,2456610.5,279.06242,-26.9066,-4.68,2456611.5,280.05646,-26.83404,-4.7,2456612.5,281.03695,-26.75286,-4.71,2456613.5,282.00326,-26.66324,-4.72,2456614.5,282.95479,-26.56538,-4.73,2456615.5,283.89092,-26.45947,-4.74,2456616.5,284.811,-26.34573,-4.75,2456617.5,285.7144,-26.22437,-4.76,2456618.5,286.60045,-26.09563,-4.77,2456619.5,287.46849,-25.95973,-4.78,2456620.5,288.31784,-25.81692,-4.79,2456621.5,289.14781,-25.66744,-4.8,2456622.5,289.95767,-25.51154,-4.81,2456623.5,290.7467,-25.34951,-4.82,2456624.5,291.51415,-25.18159,-4.83,2456625.5,292.25927,-25.00807,-4.84,2456626.5,292.98125,-24.82924,-4.84,2456627.5,293.67929,-24.64539,-4.85,2456628.5,294.35252,-24.45683,-4.86,2456629.5,295.00006,-24.26388,-4.86,2456630.5,295.62098,-24.06684,-4.87,2456631.5,296.21429,-23.86606,-4.87,2456632.5,296.77899,-23.66187,-4.88,2456633.5,297.31405,-23.45459,-4.88,2456634.5,297.81842,-23.24456,-4.89,2456635.5,298.29105,-23.03212,-4.89,2456636.5,298.73087,-22.8176,-4.89,2456637.5,299.13684,-22.60133,-4.89,2456638.5,299.5079,-22.38364,-4.89,2456639.5,299.84301,-22.16488,-4.88,2456640.5,300.14113,-21.94536,-4.88,2456641.5,300.40128,-21.72542,-4.87,2456642.5,300.62246,-21.50538,-4.87,2456643.5,300.80376,-21.28557,-4.86,2456644.5,300.9443,-21.06629,-4.85,2456645.5,301.04326,-20.84786,-4.83,2456646.5,301.09992,-20.63058,-4.82,2456647.5,301.11366,-20.41475,-4.8,2456648.5,301.08396,-20.20066,-4.78,2456649.5,301.01045,-19.9886,-4.76,2456650.5,300.89292,-19.77884,-4.73,2456651.5,300.73133,-19.57166,-4.71,2456652.5,300.52585,-19.36733,-4.68,2456653.5,300.27686,-19.1661,-4.64,2456654.5,299.98499,-18.96825,-4.6,2456655.5,299.65112,-18.77402,-4.56,2456656.5,299.2764,-18.58368,-4.52,2456657.5,298.86226,-18.3975,-4.47,2456658.5,298.41043,-18.21573,-4.42,2456659.5,297.92292,-18.03864,-4.37,2456660.5,297.40208,-17.86649,-4.31,2456661.5,296.85059,-17.69956,-4.26,2456662.5,296.27145,-17.53809,-4.25,2456663.5,295.668,-17.38234,-4.28,2456664.5,295.0439,-17.23258,-4.31,2456665.5,294.40305,-17.08905,-4.34,2456666.5,293.74962,-16.95201,-4.34,2456667.5,293.08793,-16.8217,-4.34,2456668.5,292.42243,-16.69835,-4.34,2456669.5,291.75763,-16.5822,-4.34,2456670.5,291.09805,-16.47344,-4.34,2456671.5,290.44814,-16.37227,-4.34,2456672.5,289.81221,-16.27885,-4.31,2456673.5,289.19442,-16.19332,-4.28,2456674.5,288.59869,-16.11576,-4.25,2456675.5,288.02867,-16.04625,-4.23,2456676.5,287.48769,-15.98479,-4.29,2456677.5,286.97879,-15.93137,-4.35,2456678.5,286.50462,-15.8859,-4.4,2456679.5,286.06748,-15.84828,-4.45,2456680.5,285.66933,-15.81835,-4.5,2456681.5,285.31176,-15.79588,-4.54,2456682.5,284.99602,-15.78065,-4.58,2456683.5,284.72302,-15.77237,-4.62,2456684.5,284.49337,-15.77071,-4.65,2456685.5,284.30739,-15.77533,-4.68,2456686.5,284.16514,-15.78584,-4.71,2456687.5,284.06646,-15.80185,-4.73,2456688.5,284.01097,-15.82291,-4.75,2456689.5,283.99819,-15.8486,-4.77,2456690.5,284.02746,-15.87843,-4.79,2456691.5,284.09808,-15.91194,-4.81,2456692.5,284.20922,-15.94865,-4.82,2456693.5,284.36004,-15.98807,-4.83,2456694.5,284.54959,-16.02971,-4.84,2456695.5,284.77691,-16.07308,-4.85,2456696.5,285.04098,-16.1177,-4.85,2456697.5,285.34078,-16.16309,-4.86,2456698.5,285.67523,-16.20877,-4.86,2456699.5,286.04327,-16.25428,-4.86,2456700.5,286.44381,-16.29916,-4.86,2456701.5,286.87579,-16.34297,-4.86,2456702.5,287.33813,-16.38528,-4.86,2456703.5,287.82977,-16.42566,-4.86,2456704.5,288.34966,-16.46373,-4.85,2456705.5,288.89676,-16.49907,-4.85,2456706.5,289.47005,-16.53133,-4.84,2456707.5,290.06853,-16.56015,-4.84,2456708.5,290.69121,-16.58517,-4.83,2456709.5,291.33713,-16.60609,-4.83,2456710.5,292.00533,-16.62258,-4.82,2456711.5,292.69487,-16.63437,-4.81,2456712.5,293.40483,-16.64118,-4.8,2456713.5,294.1343,-16.64275,-4.79,2456714.5,294.88241,-16.63884,-4.78,2456715.5,295.64827,-16.62923,-4.78,2456716.5,296.43105,-16.6137,-4.77,2456717.5,297.22995,-16.59204,-4.76,2456718.5,298.0442,-16.56408,-4.75,2456719.5,298.87307,-16.52962,-4.74,2456720.5,299.71587,-16.48851,-4.73,2456721.5,300.57193,-16.4406,-4.72,2456722.5,301.44063,-16.38574,-4.71,2456723.5,302.32134,-16.32379,-4.69,2456724.5,303.2135,-16.25465,-4.68,2456725.5,304.11653,-16.1782,-4.67,2456726.5,305.0299,-16.09434,-4.66,2456727.5,305.95307,-16.00298,-4.65,2456728.5,306.88555,-15.90405,-4.64,2456729.5,307.82685,-15.79748,-4.63,2456730.5,308.77651,-15.68321,-4.62,2456731.5,309.73406,-15.56119,-4.61,2456732.5,310.69909,-15.4314,-4.59,2456733.5,311.67118,-15.29379,-4.58,2456734.5,312.64992,-15.14836,-4.57,2456735.5,313.63493,-14.9951,-4.56,2456736.5,314.62583,-14.83401,-4.55,2456737.5,315.62226,-14.66511,-4.54,2456738.5,316.62386,-14.48843,-4.53,2456739.5,317.63027,-14.30399,-4.52,2456740.5,318.64116,-14.11186,-4.51,2456741.5,319.65619,-13.91208,-4.49,2456742.5,320.67503,-13.70472,-4.48,2456743.5,321.69737,-13.48985,-4.47,2456744.5,322.7229,-13.26754,-4.46,2456745.5,323.75136,-13.03788,-4.45,2456746.5,324.78247,-12.80094,-4.44,2456747.5,325.816,-12.55683,-4.43,2456748.5,326.85172,-12.30564,-4.42,2456749.5,327.88943,-12.04747,-4.41,2456750.5,328.92893,-11.78242,-4.4,2456751.5,329.97005,-11.51061,-4.39,2456752.5,331.01262,-11.23213,-4.38,2456753.5,332.0565,-10.94712,-4.37,2456754.5,333.10156,-10.65568,-4.36,2456755.5,334.14767,-10.35795,-4.35,2456756.5,335.19472,-10.05403,-4.34,2456757.5,336.24263,-9.74407,-4.33,2456758.5,337.2913,-9.42818,-4.32,2456759.5,338.34067,-9.10652,-4.31,2456760.5,339.39067,-8.7792,-4.3,2456761.5,340.44125,-8.44637,-4.29,2456762.5,341.49238,-8.10817,-4.28,2456763.5,342.54402,-7.76474,-4.27,2456764.5,343.59615,-7.41624,-4.26,2456765.5,344.64874,-7.06281,-4.25,2456766.5,345.70176,-6.70462,-4.25,2456767.5,346.75521,-6.34182,-4.24,2456768.5,347.80906,-5.97458,-4.23,2456769.5,348.8633,-5.60307,-4.22,2456770.5,349.91791,-5.22745,-4.21,2456771.5,350.97288,-4.84791,-4.2,2456772.5,352.02822,-4.4646,-4.19,2456773.5,353.08394,-4.07771,-4.19,2456774.5,354.14006,-3.68741,-4.18,2456775.5,355.19659,-3.29387,-4.17,2456776.5,356.25356,-2.89726,-4.16,2456777.5,357.31102,-2.49777,-4.15,2456778.5,358.36901,-2.09555,-4.15,2456779.5,359.42757,-1.6908,-4.14,2456780.5,.48677,-1.28368,-4.13,2456781.5,1.54665,-0.87436,-4.12,2456782.5,2.6073,-0.46303,-4.12,2456783.5,3.66879,-0.04986,-4.11,2456784.5,4.73121,.36498,-4.1,2456785.5,5.79463,.78131,-4.1,2456786.5,6.85916,1.19897,-4.09,2456787.5,7.9249,1.61777,-4.08,2456788.5,8.99194,2.03754,-4.08,2456789.5,10.0604,2.4581,-4.07,2456790.5,11.1304,2.8793,-4.06,2456791.5,12.20205,3.30094,-4.06,2456792.5,13.27546,3.72285,-4.05,2456793.5,14.35075,4.14485,-4.04,2456794.5,15.42804,4.56677,-4.04,2456795.5,16.50741,4.98842,-4.03,2456796.5,17.58899,5.40961,-4.03,2456797.5,18.67286,5.83015,-4.02,2456798.5,19.75913,6.24985,-4.01,2456799.5,20.84789,6.66853,-4.01,2456800.5,21.93926,7.086,-4,2456801.5,23.03332,7.50206,-4,2456802.5,24.13017,7.91652,-3.99,2456803.5,25.22992,8.3292,-3.99,2456804.5,26.33265,8.73991,-3.98,2456805.5,27.43846,9.14846,-3.98,2456806.5,28.54743,9.55465,-3.97,2456807.5,29.65966,9.95829,-3.97,2456808.5,30.77524,10.35919,-3.96,2456809.5,31.89425,10.75716,-3.96,2456810.5,33.01679,11.152,-3.95,2456811.5,34.14295,11.54353,-3.95,2456812.5,35.27282,11.93155,-3.94,2456813.5,36.4065,12.31588,-3.94,2456814.5,37.54407,12.69631,-3.94,2456815.5,38.68562,13.07267,-3.93,2456816.5,39.83126,13.44475,-3.93,2456817.5,40.98105,13.81238,-3.92,2456818.5,42.13509,14.17535,-3.92,2456819.5,43.29347,14.53349,-3.92,2456820.5,44.45625,14.8866,-3.91,2456821.5,45.62351,15.23449,-3.91,2456822.5,46.79531,15.57698,-3.91,2456823.5,47.9717,15.91387,-3.9,2456824.5,49.15272,16.24497,-3.9,2456825.5,50.33841,16.57008,-3.9,2456826.5,51.5288,16.889,-3.89,2456827.5,52.72391,17.20156,-3.89,2456828.5,53.92376,17.50755,-3.89,2456829.5,55.12835,17.8068,-3.89,2456830.5,56.33768,18.0991,-3.88,2456831.5,57.55174,18.38429,-3.88,2456832.5,58.77049,18.66217,-3.88,2456833.5,59.9939,18.93257,-3.87,2456834.5,61.22192,19.19531,-3.87,2456835.5,62.4545,19.4502,-3.87,2456836.5,63.69159,19.69708,-3.87,2456837.5,64.93311,19.93578,-3.87,2456838.5,66.17899,20.16611,-3.86,2456839.5,67.42916,20.38792,-3.86]],["Mars","rgb(255,50,50)",[2456474.5,80.64099,23.54688,1.53,2456475.5,81.38904,23.59991,1.53,2456476.5,82.13678,23.64934,1.53,2456477.5,82.88417,23.69519,1.54,2456478.5,83.63116,23.73746,1.54,2456479.5,84.37771,23.77615,1.54,2456480.5,85.12376,23.81128,1.55,2456481.5,85.86927,23.84284,1.55,2456482.5,86.61418,23.87085,1.55,2456483.5,87.35845,23.89531,1.56,2456484.5,88.10203,23.91623,1.56,2456485.5,88.84488,23.93362,1.56,2456486.5,89.58696,23.94749,1.57,2456487.5,90.32823,23.95785,1.57,2456488.5,91.06864,23.96471,1.57,2456489.5,91.80818,23.96807,1.57,2456490.5,92.5468,23.96797,1.58,2456491.5,93.28448,23.96441,1.58,2456492.5,94.02118,23.9574,1.58,2456493.5,94.75687,23.94698,1.59,2456494.5,95.49152,23.93314,1.59,2456495.5,96.2251,23.91592,1.59,2456496.5,96.95756,23.89532,1.59,2456497.5,97.68888,23.87136,1.6,2456498.5,98.41903,23.84405,1.6,2456499.5,99.14799,23.81341,1.6,2456500.5,99.87574,23.77946,1.6,2456501.5,100.60225,23.74222,1.61,2456502.5,101.3275,23.70172,1.61,2456503.5,102.05144,23.65797,1.61,2456504.5,102.77405,23.611,1.61,2456505.5,103.49529,23.56083,1.61,2456506.5,104.21513,23.5075,1.62,2456507.5,104.93351,23.45103,1.62,2456508.5,105.65041,23.39144,1.62,2456509.5,106.36579,23.32876,1.62,2456510.5,107.0796,23.26302,1.62,2456511.5,107.79182,23.19423,1.62,2456512.5,108.50241,23.12244,1.63,2456513.5,109.21134,23.04766,1.63,2456514.5,109.91858,22.96992,1.63,2456515.5,110.62411,22.88924,1.63,2456516.5,111.32791,22.80566,1.63,2456517.5,112.02995,22.71921,1.63,2456518.5,112.73022,22.6299,1.63,2456519.5,113.42871,22.53778,1.64,2456520.5,114.12539,22.44288,1.64,2456521.5,114.82025,22.34522,1.64,2456522.5,115.51327,22.24484,1.64,2456523.5,116.20444,22.14176,1.64,2456524.5,116.89374,22.03602,1.64,2456525.5,117.58115,21.92763,1.64,2456526.5,118.26669,21.81663,1.64,2456527.5,118.95035,21.70304,1.64,2456528.5,119.63212,21.5869,1.64,2456529.5,120.31201,21.46823,1.64,2456530.5,120.99,21.34708,1.64,2456531.5,121.66609,21.22346,1.64,2456532.5,122.34026,21.09743,1.65,2456533.5,123.0125,20.96901,1.65,2456534.5,123.68278,20.83825,1.65,2456535.5,124.35109,20.70517,1.65,2456536.5,125.01742,20.56981,1.65,2456537.5,125.68175,20.4322,1.65,2456538.5,126.34406,20.29239,1.65,2456539.5,127.00434,20.15041,1.65,2456540.5,127.66258,20.00628,1.65,2456541.5,128.31876,19.86005,1.64,2456542.5,128.97288,19.71175,1.64,2456543.5,129.62494,19.56141,1.64,2456544.5,130.27493,19.40907,1.64,2456545.5,130.92284,19.25476,1.64,2456546.5,131.5687,19.09852,1.64,2456547.5,132.21247,18.94038,1.64,2456548.5,132.85418,18.78037,1.64,2456549.5,133.49382,18.61854,1.64,2456550.5,134.13138,18.45492,1.64,2456551.5,134.76687,18.28953,1.64,2456552.5,135.4003,18.12241,1.64,2456553.5,136.03168,17.95359,1.63,2456554.5,136.66102,17.7831,1.63,2456555.5,137.28835,17.61097,1.63,2456556.5,137.91368,17.43723,1.63,2456557.5,138.53701,17.26191,1.63,2456558.5,139.15837,17.08505,1.63,2456559.5,139.77776,16.90668,1.62,2456560.5,140.39517,16.72685,1.62,2456561.5,141.01061,16.54559,1.62,2456562.5,141.62407,16.36293,1.62,2456563.5,142.23556,16.17892,1.62,2456564.5,142.84507,15.99359,1.61,2456565.5,143.45259,15.80697,1.61,2456566.5,144.05813,15.61911,1.61,2456567.5,144.66168,15.43003,1.61,2456568.5,145.26325,15.23978,1.6,2456569.5,145.86284,15.04839,1.6,2456570.5,146.46044,14.85589,1.6,2456571.5,147.05606,14.66231,1.59,2456572.5,147.64971,14.4677,1.59,2456573.5,148.2414,14.27208,1.59,2456574.5,148.83112,14.0755,1.58,2456575.5,149.41887,13.87798,1.58,2456576.5,150.00468,13.67957,1.58,2456577.5,150.58852,13.48029,1.57,2456578.5,151.17043,13.28018,1.57,2456579.5,151.7504,13.07926,1.57,2456580.5,152.32845,12.87757,1.56,2456581.5,152.9046,12.67513,1.56,2456582.5,153.47887,12.47198,1.55,2456583.5,154.05129,12.26813,1.55,2456584.5,154.62188,12.06362,1.55,2456585.5,155.19064,11.85849,1.54,2456586.5,155.75759,11.65276,1.54,2456587.5,156.32274,11.44647,1.53,2456588.5,156.88609,11.23965,1.53,2456589.5,157.44765,11.03234,1.52,2456590.5,158.0074,10.82457,1.52,2456591.5,158.56536,10.61638,1.51,2456592.5,159.12152,10.40781,1.51,2456593.5,159.67588,10.19888,1.5,2456594.5,160.22843,9.98964,1.5,2456595.5,160.77918,9.78012,1.49,2456596.5,161.32811,9.57035,1.48,2456597.5,161.87524,9.36037,1.48,2456598.5,162.42055,9.1502,1.47,2456599.5,162.96404,8.93989,1.47,2456600.5,163.50572,8.72946,1.46,2456601.5,164.04558,8.51895,1.45,2456602.5,164.58361,8.30839,1.45,2456603.5,165.1198,8.09783,1.44,2456604.5,165.65415,7.88729,1.43,2456605.5,166.18665,7.67679,1.43,2456606.5,166.71732,7.46639,1.42,2456607.5,167.24614,7.25609,1.41,2456608.5,167.77315,7.04592,1.41,2456609.5,168.29833,6.83592,1.4,2456610.5,168.82172,6.62611,1.39,2456611.5,169.34332,6.41651,1.38,2456612.5,169.86314,6.20716,1.37,2456613.5,170.38117,5.99807,1.37,2456614.5,170.89743,5.78929,1.36,2456615.5,171.4119,5.58084,1.35,2456616.5,171.92458,5.37276,1.34,2456617.5,172.43546,5.16509,1.33,2456618.5,172.94452,4.95785,1.32,2456619.5,173.45175,4.75107,1.32,2456620.5,173.95713,4.5448,1.31,2456621.5,174.46065,4.33907,1.3,2456622.5,174.96229,4.13391,1.29,2456623.5,175.46203,3.92935,1.28,2456624.5,175.95985,3.72543,1.27,2456625.5,176.45573,3.52218,1.26,2456626.5,176.94965,3.31963,1.25,2456627.5,177.44158,3.11782,1.24,2456628.5,177.9315,2.91679,1.23,2456629.5,178.41938,2.71655,1.22,2456630.5,178.90518,2.51716,1.21,2456631.5,179.38887,2.31864,1.2,2456632.5,179.87042,2.12102,1.19,2456633.5,180.3498,1.92435,1.18,2456634.5,180.827,1.72864,1.16,2456635.5,181.302,1.53393,1.15,2456636.5,181.77478,1.34023,1.14,2456637.5,182.24535,1.14757,1.13,2456638.5,182.71367,.95598,1.12,2456639.5,183.17974,.76549,1.11,2456640.5,183.64354,.57611,1.09,2456641.5,184.10504,.38789,1.08,2456642.5,184.5642,.20085,1.07,2456643.5,185.021,.01502,1.06,2456644.5,185.4754,-0.16957,1.04,2456645.5,185.92735,-0.35288,1.03,2456646.5,186.37681,-0.53487,1.02,2456647.5,186.82373,-0.71552,1,2456648.5,187.26806,-0.89479,.99,2456649.5,187.70975,-1.07264,.98,2456650.5,188.14875,-1.24905,.96,2456651.5,188.585,-1.42397,.95,2456652.5,189.01844,-1.59738,.93,2456653.5,189.44901,-1.76923,.92,2456654.5,189.87664,-1.9395,.9,2456655.5,190.30127,-2.10815,.89,2456656.5,190.72282,-2.27513,.87,2456657.5,191.14121,-2.44043,.86,2456658.5,191.55635,-2.604,.84,2456659.5,191.96817,-2.76579,.83,2456660.5,192.37658,-2.92579,.81,2456661.5,192.78151,-3.08395,.79,2456662.5,193.1829,-3.24024,.78,2456663.5,193.58068,-3.39464,.76,2456664.5,193.97479,-3.54713,.74,2456665.5,194.36518,-3.69767,.73,2456666.5,194.75177,-3.84624,.71,2456667.5,195.1345,-3.99281,.69,2456668.5,195.51329,-4.13736,.67,2456669.5,195.88806,-4.27984,.66,2456670.5,196.25872,-4.42024,.64,2456671.5,196.62518,-4.55851,.62,2456672.5,196.98733,-4.69461,.6,2456673.5,197.34509,-4.82853,.58,2456674.5,197.69833,-4.96021,.56,2456675.5,198.04695,-5.08961,.54,2456676.5,198.39083,-5.21672,.52,2456677.5,198.72986,-5.34147,.51,2456678.5,199.06392,-5.46384,.49,2456679.5,199.39286,-5.58379,.46,2456680.5,199.71657,-5.70128,.44,2456681.5,200.0349,-5.81626,.42,2456682.5,200.34772,-5.92871,.4,2456683.5,200.65486,-6.03857,.38,2456684.5,200.95618,-6.14581,.36,2456685.5,201.25151,-6.25038,.34,2456686.5,201.54068,-6.35224,.32,2456687.5,201.82354,-6.45135,.29,2456688.5,202.09991,-6.54766,.27,2456689.5,202.36965,-6.64114,.25,2456690.5,202.63261,-6.73175,.23,2456691.5,202.88865,-6.81946,.2,2456692.5,203.13764,-6.90424,.18,2456693.5,203.37944,-6.98606,.16,2456694.5,203.6139,-7.06488,.13,2456695.5,203.84087,-7.14067,.11,2456696.5,204.0602,-7.21341,.08,2456697.5,204.27172,-7.28304,.06,2456698.5,204.47527,-7.34953,.04,2456699.5,204.67067,-7.41284,.01,2456700.5,204.85775,-7.47293,-0.01,2456701.5,205.03632,-7.52976,-0.04,2456702.5,205.20621,-7.58328,-0.07,2456703.5,205.36722,-7.63346,-0.09,2456704.5,205.51917,-7.68024,-0.12,2456705.5,205.66187,-7.72359,-0.14,2456706.5,205.79512,-7.76346,-0.17,2456707.5,205.91872,-7.79981,-0.2,2456708.5,206.03246,-7.83259,-0.22,2456709.5,206.13616,-7.86176,-0.25,2456710.5,206.2296,-7.88728,-0.28,2456711.5,206.31258,-7.9091,-0.31,2456712.5,206.38489,-7.92718,-0.33,2456713.5,206.44633,-7.94148,-0.36,2456714.5,206.4967,-7.95196,-0.39,2456715.5,206.53581,-7.95858,-0.42,2456716.5,206.56349,-7.9613,-0.45,2456717.5,206.5796,-7.9601,-0.48,2456718.5,206.58401,-7.95496,-0.5,2456719.5,206.5766,-7.94586,-0.53,2456720.5,206.55728,-7.9328,-0.56,2456721.5,206.52597,-7.91576,-0.59,2456722.5,206.48259,-7.89473,-0.62,2456723.5,206.42707,-7.86973,-0.65,2456724.5,206.35935,-7.84074,-0.68,2456725.5,206.27938,-7.80777,-0.71,2456726.5,206.18713,-7.77081,-0.73,2456727.5,206.08257,-7.72989,-0.76,2456728.5,205.96569,-7.68501,-0.79,2456729.5,205.83651,-7.6362,-0.82,2456730.5,205.69505,-7.58347,-0.85,2456731.5,205.54135,-7.52685,-0.88,2456732.5,205.37548,-7.46639,-0.91,2456733.5,205.19752,-7.40212,-0.94,2456734.5,205.00758,-7.3341,-0.97,2456735.5,204.80578,-7.26238,-0.99,2456736.5,204.59228,-7.18704,-1.02,2456737.5,204.36725,-7.10815,-1.05,2456738.5,204.13089,-7.0258,-1.08,2456739.5,203.88343,-6.94008,-1.1,2456740.5,203.62513,-6.85109,-1.13,2456741.5,203.35629,-6.75897,-1.16,2456742.5,203.07723,-6.66382,-1.18,2456743.5,202.78835,-6.56581,-1.21,2456744.5,202.49005,-6.46509,-1.24,2456745.5,202.18281,-6.36183,-1.26,2456746.5,201.86714,-6.25622,-1.29,2456747.5,201.54359,-6.14848,-1.31,2456748.5,201.21273,-6.0388,-1.33,2456749.5,200.87516,-5.92742,-1.36,2456750.5,200.53151,-5.81456,-1.38,2456751.5,200.18242,-5.70045,-1.4,2456752.5,199.82854,-5.58535,-1.42,2456753.5,199.47053,-5.46948,-1.44,2456754.5,199.10907,-5.35311,-1.46,2456755.5,198.74484,-5.23646,-1.47,2456756.5,198.37853,-5.11982,-1.48,2456757.5,198.01083,-5.00341,-1.48,2456758.5,197.64243,-4.88751,-1.48,2456759.5,197.27404,-4.77236,-1.47,2456760.5,196.90633,-4.65822,-1.46,2456761.5,196.54,-4.54534,-1.45,2456762.5,196.1757,-4.43396,-1.44,2456763.5,195.8141,-4.32433,-1.43,2456764.5,195.45585,-4.2167,-1.41,2456765.5,195.10158,-4.11128,-1.4,2456766.5,194.7519,-4.0083,-1.38,2456767.5,194.40742,-3.90799,-1.37,2456768.5,194.06872,-3.81056,-1.35,2456769.5,193.73639,-3.71621,-1.34,2456770.5,193.41097,-3.62515,-1.32,2456771.5,193.09304,-3.53756,-1.3,2456772.5,192.78312,-3.45364,-1.29,2456773.5,192.48174,-3.37356,-1.27,2456774.5,192.1894,-3.2975,-1.25,2456775.5,191.90655,-3.22561,-1.23,2456776.5,191.63365,-3.15804,-1.21,2456777.5,191.37109,-3.09491,-1.19,2456778.5,191.11924,-3.03634,-1.17,2456779.5,190.87841,-2.98243,-1.15,2456780.5,190.64888,-2.93327,-1.13,2456781.5,190.43092,-2.88892,-1.11,2456782.5,190.22473,-2.84944,-1.09,2456783.5,190.03048,-2.81488,-1.06,2456784.5,189.84834,-2.78528,-1.04,2456785.5,189.67842,-2.76065,-1.02,2456786.5,189.52082,-2.74101,-1,2456787.5,189.37559,-2.72636,-0.98,2456788.5,189.24278,-2.71671,-0.96,2456789.5,189.12242,-2.71204,-0.93,2456790.5,189.01449,-2.71232,-0.91,2456791.5,188.91897,-2.71754,-0.89,2456792.5,188.83582,-2.72766,-0.87,2456793.5,188.76497,-2.74265,-0.84,2456794.5,188.70637,-2.76245,-0.82,2456795.5,188.65992,-2.78703,-0.8,2456796.5,188.62554,-2.81633,-0.78,2456797.5,188.60315,-2.85032,-0.76,2456798.5,188.59266,-2.88893,-0.73,2456799.5,188.59398,-2.93212,-0.71,2456800.5,188.60704,-2.97984,-0.69,2456801.5,188.63173,-3.03204,-0.67,2456802.5,188.66797,-3.08867,-0.65,2456803.5,188.71565,-3.14968,-0.62,2456804.5,188.77465,-3.21499,-0.6,2456805.5,188.84484,-3.28455,-0.58,2456806.5,188.92608,-3.35829,-0.56,2456807.5,189.01823,-3.43614,-0.54,2456808.5,189.12114,-3.51803,-0.52,2456809.5,189.23463,-3.60388,-0.5,2456810.5,189.35853,-3.6936,-0.48,2456811.5,189.49269,-3.78713,-0.46,2456812.5,189.63692,-3.88439,-0.44,2456813.5,189.79105,-3.98528,-0.42,2456814.5,189.9549,-4.08974,-0.4,2456815.5,190.12829,-4.19769,-0.38,2456816.5,190.31106,-4.30905,-0.36,2456817.5,190.50301,-4.42373,-0.34,2456818.5,190.70398,-4.54166,-0.32,2456819.5,190.9138,-4.66276,-0.3,2456820.5,191.13228,-4.78696,-0.28,2456821.5,191.35925,-4.91417,-0.27,2456822.5,191.59454,-5.04431,-0.25,2456823.5,191.838,-5.17733,-0.23,2456824.5,192.08947,-5.31313,-0.21,2456825.5,192.34882,-5.45165,-0.19,2456826.5,192.61592,-5.59283,-0.18,2456827.5,192.89067,-5.73661,-0.16,2456828.5,193.17295,-5.88293,-0.14,2456829.5,193.46266,-6.03174,-0.13,2456830.5,193.75972,-6.18296,-0.11,2456831.5,194.06401,-6.33656,-0.09,2456832.5,194.37543,-6.49246,-0.08,2456833.5,194.69389,-6.65061,-0.06,2456834.5,195.01926,-6.81094,-0.04,2456835.5,195.35145,-6.97339,-0.03,2456836.5,195.69035,-7.13791,-0.01,2456837.5,196.03584,-7.30441,-0.01,2456838.5,196.38783,-7.47285,.02,2456839.5,196.7462,-7.64316,.03]],["Jupiter","rgb(255,150,150)",[2456474.5,91.2258,23.22051,-1.91,2456484.5,93.69042,23.19678,-1.91,2456494.5,96.10542,23.13593,-1.92,2456504.5,98.44898,23.04153,-1.93,2456514.5,100.69851,22.91853,-1.96,2456524.5,102.82743,22.77329,-1.99,2456534.5,104.8111,22.61314,-2.02,2456544.5,106.62191,22.44687,-2.07,2456554.5,108.22942,22.28406,-2.12,2456564.5,109.605,22.13459,-2.17,2456574.5,110.7164,22.00919,-2.23,2456584.5,111.53287,21.91768,-2.3,2456594.5,112.02888,21.8683,-2.37,2456604.5,112.18092,21.86758,-2.43,2456614.5,111.97878,21.91776,-2.5,2456624.5,111.42877,22.01666,-2.56,2456634.5,110.55452,22.15723,-2.62,2456644.5,109.40875,22.32703,-2.66,2456654.5,108.06771,22.51118,-2.69,2456664.5,106.62721,22.69384,-2.7,2456674.5,105.19885,22.86087,-2.67,2456684.5,103.88882,23.00306,-2.64,2456694.5,102.79196,23.11523,-2.58,2456704.5,101.98294,23.19611,-2.52,2456714.5,101.50553,23.24708,-2.45,2456724.5,101.38248,23.26957,-2.38,2456734.5,101.61476,23.26483,-2.31,2456744.5,102.18511,23.23278,-2.23,2456754.5,103.07011,23.1719,-2.16,2456764.5,104.2376,23.08036,-2.1,2456774.5,105.65303,22.95539,-2.04,2456784.5,107.28421,22.79405,-1.99,2456794.5,109.09615,22.59428,-1.94,2456804.5,111.05785,22.35409,-1.9,2456814.5,113.14144,22.0723,-1.86,2456824.5,115.31775,21.74897,-1.84,2456834.5,117.5626,21.3847,-1.82]],["Saturne","rgb(200,150,150)",[2456474.5,213.43924,-10.77595,1.18,2456484.5,213.38929,-10.8057,1.23,2456494.5,213.49677,-10.89043,1.27,2456504.5,213.75872,-11.02768,1.31,2456514.5,214.17001,-11.21397,1.34,2456524.5,214.72219,-11.44448,1.36,2456534.5,215.40312,-11.71336,1.38,2456544.5,216.20117,-12.01481,1.39,2456554.5,217.10234,-12.34229,1.38,2456564.5,218.09096,-12.689,1.37,2456574.5,219.1523,-13.0486,1.36,2456584.5,220.26942,-13.41441,1.33,2456594.5,221.42526,-13.78004,1.3,2456604.5,222.60273,-14.13941,1.28,2456614.5,223.78251,-14.48665,1.31,2456624.5,224.94632,-14.81634,1.34,2456634.5,226.07506,-15.12344,1.37,2456644.5,227.14762,-15.40312,1.38,2456654.5,228.14501,-15.65157,1.39,2456664.5,229.04744,-15.86518,1.39,2456674.5,229.83488,-16.04081,1.38,2456684.5,230.49048,-16.17633,1.36,2456694.5,230.99789,-16.27,1.33,2456704.5,231.34423,-16.32088,1.3,2456714.5,231.52159,-16.32898,1.25,2456724.5,231.52511,-16.29505,1.21,2456734.5,231.3581,-16.22129,1.15,2456744.5,231.03051,-16.11104,1.09,2456754.5,230.55788,-15.96885,1.03,2456764.5,229.96565,-15.80136,.97,2456774.5,229.28418,-15.61629,.92,2456784.5,228.54825,-15.42258,.87,2456794.5,227.79726,-15.23036,.88,2456804.5,227.06876,-15.04966,.93,2456814.5,226.39954,-14.89033,.99,2456824.5,225.82256,-14.76116,1.05,2456834.5,225.36295,-14.66905,1.11]],["Uranus","rgb(130,150,255)",[2456474.5,11.68524,4.26131,5.84,2456494.5,11.78993,4.29416,5.8,2456514.5,11.6,4.20364,5.77,2456534.5,11.14671,4.00416,5.74,2456554.5,10.49986,3.72606,5.72,2456574.5,9.76319,3.41372,5.72,2456594.5,9.05949,3.11949,5.73,2456614.5,8.50801,2.89391,5.76,2456634.5,8.20411,2.77688,5.79,2456654.5,8.20303,2.7907,5.83,2456674.5,8.51624,2.93862,5.87,2456694.5,9.11473,3.20643,5.9,2456714.5,9.9414,3.56795,5.92,2456734.5,10.9207,3.98954,5.93,2456754.5,11.96871,4.43457,5.93,2456774.5,12.99963,4.86656,5.93,2456794.5,13.93188,5.25163,5.91,2456814.5,14.69128,5.56008,5.89,2456834.5,15.2153,5.76768,5.85]],["Neptune","rgb(100,100,255)",[2456474.5,337.29849,-10.21336,7.86,2456494.5,336.98802,-10.34344,7.84,2456514.5,336.54551,-10.52194,7.83,2456534.5,336.03597,-10.72256,7.82,2456554.5,335.53577,-10.91563,7.83,2456574.5,335.12211,-11.07201,7.84,2456594.5,334.86154,-11.16764,7.86,2456614.5,334.79872,-11.18692,7.89,2456634.5,334.95207,-11.12412,7.91,2456654.5,335.31179,-10.98356,7.94,2456674.5,335.84461,-10.77793,7.95,2456694.5,336.49809,-10.52693,7.97,2456714.5,337.21013,-10.25415,7.97,2456734.5,337.91508,-9.98489,7.96,2456754.5,338.55008,-9.74378,7.95,2456774.5,339.05963,-9.55294,7.93,2456794.5,339.40083,-9.42944,7.91,2456814.5,339.54669,-9.38388,7.89,2456834.5,339.48931,-9.41868,7.86]]]},o=function(e,t){var n=e,r=0;for(var i=0;i<t.length;i+=4){var s=e-t[i];Math.abs(s)<Math.abs(n)&&(n=s,r=i)}var o,u,a,f,l,c;return n>=0?(f=r+1+4,l=r+1,c=n/Math.abs(t[f-1]-t[l-1])):(f=r+1,l=r+1-4,c=1+n/Math.abs(t[f-1]-t[l-1])),f>t.length||l<0?(o=t[r+1],u=t[r+2],a=t[r+3]):(o=Math.abs(t[f]-t[l])>180?(t[l]+(t[f]+360-t[l])*c)%360:(t[l]+(t[f]-t[l])*c)%360,u=t[l+1]+(t[f+1]-t[l+1])*c,a=t[l+2]+(t[f+2]-t[l+2])*c),{ra:o,dec:u,mag:a}},u=function(e){var n=i(),u,a,f,l,c=[];for(p=0;p<s.planets.length;p++){f=s.planets[p][0],l=s.planets[p][1];if(s.planets[p].length==3){if(s.planets[p][2].length%4==0){if(!(n>s.planets[p][2][0]&&n<s.planets[p][2][s.planets[p][2].length-4]))continue;var h=o(n,s.planets[p][2]);u=h.ra,a=h.dec,mag=h.mag}}else u=s.planets[p][2],a=s.planets[p][3];var d={geometry:{type:"Point",gid:"planetLabel_"+f,coordinates:[u,a]},properties:{name:f,style:new t({label:f,strokeColor:t.fromStringToColor(l),fillColor:t.fromStringToColor(l)})}};c.push(d),d={geometry:{type:"Point",gid:"planetPoint_"+f,coordinates:[u,a]},properties:{name:f,style:new t({iconUrl:"css/images/star.png",strokeColor:t.fromStringToColor(l),fillColor:t.fromStringToColor(l)})}},c.push(d)}r={type:"FeatureCollection",features:c},e.addFeatureCollection(r)};n.registerDataProvider("planets",function(e,t){var n=t.interval?t.interval:6e4;u(e),setInterval(function(){e.removeFeatureCollection(r),u(e)},n)})}),define("gw/VectorRenderer",["./RendererTileData","./Tile"],function(e,t){var n=function(e){this.tileManager=e.tileManager,this.globe=e,this.buckets=[],this.maxTilePerGeometry=100,this.levelZeroTiledGeometries=[]};return n.prototype.findBucket=function(e,t){for(var n=0;n<this.buckets.length;n++){var r=this.buckets[n];if(r.layer==e&&r.isCompatible(t))return r}return null},n.prototype.generateLevelZero=function(e){for(var t=0;t<this.levelZeroTiledGeometries.length;t++){var n=this.levelZeroTiledGeometries[t],r=!1;for(var i=0;i<n._tileIndices.length&&!r;i++){var s=this.tileManager.level0Tiles[n._tileIndices[i]];r=s==e}r&&this._addGeometryToTile(n._bucket,n,e)}},n.prototype._recursiveAddGeometryToTile=function(e,n,r){var i=this._addGeometryToTile(e,n,r);if(i&&i.generateChild&&r.children)for(var s=0;s<4;s++)r.children[s].state==t.State.LOADED&&(i.hasChildren=!0,this._recursiveAddGeometryToTile(e,n,r.children[s]))},n.prototype.addGeometry=function(e,n,r){var i=this.getOrCreateBucket(e,n,r);n._bucket=i;var s=this.maxTilePerGeometry>0?this.tileManager.getOverlappedLevelZeroTiles(n):null;if(s&&s.length<this.maxTilePerGeometry){for(var o=0;o<s.length;o++){var u=this.tileManager.level0Tiles[s[o]];u.state==t.State.LOADED&&this._recursiveAddGeometryToTile(i,n,u)}n._tileIndices=s,this.levelZeroTiledGeometries.push(n)}else i.mainRenderable||(i.mainRenderable=i.createRenderable()),i.mainRenderable.add(n)},n.prototype.removeGeometry=function(e){var t=e._tileIndices;if(t){for(var n=0;n<t.length;n++){var r=this.tileManager.level0Tiles[t[n]];this.removeGeometryFromTile(e,r)}this.levelZeroTiledGeometries.splice(this.levelZeroTiledGeometries.indexOf(e),1),e._tileIndices=null}else{var i=e._bucket;if(i.mainRenderable){var s=i.mainRenderable.remove(e);s==0&&(i.mainRenderable.dispose(this.renderContext),i.mainRenderable=null)}}},n.prototype.getOrCreateBucket=function(e,t,n){var r=this.findBucket(e,n);return r||(r=this.createBucket(e,n),r.renderer=this,r.id=this.globe.vectorRendererManager.bucketId++,this.buckets.push(r)),r},n.prototype.addGeometryToTile=function(e,t,n,r){var i=this.getOrCreateBucket(e,t,n);return t._bucket=i,this._addGeometryToTile(i,t,r)},n.prototype._addGeometryToTile=function(t,n,r){var i=r.extension.renderer;i||(i=r.extension.renderer=new e(this.globe.vectorRendererManager));var s=i.getRenderable(t),o=!1;return s||(s=t.createRenderable(),o=!0),s.add(n,r)?(o&&i.renderables.push(s),s):null},n.prototype.removeGeometryFromTile=function(e,n){var r=n.extension.renderer;if(r){var i=0;while(i<r.renderables.length){var s=r.renderables[i],o=s.bucket.renderer;if(o==this){var u=s.remove(e);u==0?r.renderables.splice(i,1):i++;if(s.hasChildren&&n.children)for(var a=0;a<4;a++)n.children[a].state==t.State.LOADED&&this.removeGeometryFromTile(e,n.children[a])}else i++}}},n}),define("gw/Triangulator",[],function(){var e=1e-10,t=function(e){var t=e.length,n=0;for(var r=t-1,i=0;i<t;r=i++)n+=e[r][0]*e[i][1]-e[i][0]*e[r][1];return n*.5},n=function(e,t,n,r,i,s,o,u){var a,f,l,c,h,p,d,v,m,g,y,b,w,E,S;return a=i-n,f=s-r,l=e-i,c=t-s,h=n-e,p=r-t,d=o-e,v=u-t,m=o-n,g=u-r,y=o-i,b=u-s,S=a*g-f*m,w=h*v-p*d,E=l*b-c*y,S>=0&&E>=0&&w>=0},r=function(t,r,i,s,o,u){var a,f,l,c,h,p,d,v,m;f=t[u[r]][0],l=t[u[r]][1],c=t[u[i]][0],h=t[u[i]][1],p=t[u[s]][0],d=t[u[s]][1];if(e>(c-f)*(d-l)-(h-l)*(p-f))return!1;for(a=0;a<o;a++){if(a==r||a==i||a==s)continue;v=t[u[a]][0],m=t[u[a]][1];if(n(f,l,c,h,p,d,v,m))return!1}return!0},i=function(e){var n=e.length;e[0][0]==e[n-1][0]&&e[0][1]==e[n-1][1]&&n--;if(n<3)return null;var i=new Array(n);if(0<t(e))for(var s=0;s<n;s++)i[s]=s;else for(var s=0;s<n;s++)i[s]=n-1-s;var o=n,u=[],a=2*o;for(var f=0,s=o-1;o>2;){if(0>=a--)return null;var l=s;o<=l&&(l=0),s=l+1,o<=s&&(s=0);var c=s+1;o<=c&&(c=0);if(r(e,l,s,c,o,i)){var h,p,d,v,m;h=i[l],p=i[s],d=i[c],u.push(h),u.push(p),u.push(d),f++;for(v=s,m=s+1;m<o;v++,m++)i[v]=i[m];o--,a=2*o}}return u},s={process:i};return s}),define("gw/ConvexPolygonRenderer",["./Utils","./VectorRenderer","./Program","./CoordinateSystem","./FeatureStyle","./VectorRendererManager","./Triangulator","./glMatrix"],function(e,t,n,r,i,s,o){var u=function(e){t.prototype.constructor.call(this,e),this.maxTilePerGeometry=2,this.renderContext=e.tileManager.renderContext,this.tileConfig=e.tileManager.tileConfig,this.programs=[],this.basicVertexShader="	attribute vec3 vertex;\n	uniform mat4 viewProjectionMatrix;\n	\n	void main(void)\n	{\n		gl_Position = viewProjectionMatrix * vec4(vertex, 1.0);\n	}\n	",this.basicFragmentShader="	precision lowp float; \n	uniform vec4 color; \n	\n	void main(void) \n	{ \n		gl_FragColor = color; \n	} \n	",this.texVertexShader="	attribute vec3 vertex;\n	attribute vec2 tcoord;\n	uniform mat4 viewProjectionMatrix;\n	\n	varying vec2 vTextureCoord;\n	\n	void main(void) \n	{\n		vTextureCoord = tcoord;\n		vTextureCoord.y = 1.0 - vTextureCoord.y; \n		gl_Position = viewProjectionMatrix * vec4(vertex, 1.0);\n	}\n	",this.texFragmentShader="		precision lowp float; \n		uniform vec4 color;\n		varying vec2 vTextureCoord;\n		uniform sampler2D texture; \n		void main(void)\n		{\n			gl_FragColor = texture2D(texture, vTextureCoord) * color;\n		}\n		",this.basicFillShader={vertexCode:this.basicVertexShader,fragmentCode:this.basicFragmentShader,updateUniforms:null},this.texFillShader={vertexCode:this.texVertexShader,fragmentCode:this.texFragmentShader,updateUniforms:null},this.basicProgram=this.createProgram(this.basicFillShader),this.texProgram=this.createProgram(this.texFillShader);var n=this.renderContext.gl;this.whiteTexture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this.whiteTexture);var r=new Uint8Array([255,255,255,255]);n.texImage2D(n.TEXTURE_2D,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,r),this.tcoordBuffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.tcoordBuffer);var i=[0,0,1,0,1,1,0,1,0,0];n.bufferData(n.ARRAY_BUFFER,new Float32Array(i),n.STATIC_DRAW),this.tcoordBuffer.itemSize=2,this.tcoordBuffer.numItems=5};e.inherits(t,u);var a=function(e){this.bucket=e,this.geometry2vb={},this.vertices=[],this.lineIndices=[],this.triangleIndices=[],this.vertexBuffer=null,this.lineIndexBuffer=null,this.triangleIndexBuffer=null,this.bufferDirty=!1,this.triBufferDirty=!1,this.tcoords=[]};a.prototype.add=function(e){var t=[];if(e["type"]=="MultiPolygon")for(var n=0;n<e.coordinates.length;n++)t.push(e.coordinates[n][0]);else t.push(e.coordinates[0]);for(var i=0;i<t.length;i++){var s=t[i],u=s.length-1,a={vertexStart:this.vertices.length,vertexCount:3*u,lineIndexStart:this.lineIndices.length,lineIndexCount:2*u,triIndexStart:0,triIndexCount:0};if(e._imageCoordinates){a.tcoordsStart=this.tcoords.length,a.tcoordsCount=2*u;var f=r.fromGeoTo3D(e._imageCoordinates[0][0]),l=r.fromGeoTo3D(e._imageCoordinates[0][1]),c=r.fromGeoTo3D(e._imageCoordinates[0][3]),h=[];vec3.subtract(l,f,h);var p=[];vec3.subtract(c,f,p);var d=vec3.length(h)*vec3.length(h),v=vec3.length(p)*vec3.length(p);for(var n=0;n<u;n++){var m=r.fromGeoTo3D(s[n]),g=[];vec3.subtract(m,f,g);var y=vec3.dot(g,h),b=vec3.dot(g,p),w=y/d,E=b/v;this.tcoords.push(w),this.tcoords.push(E)}}var S=this.vertices.length/3;for(var n=0;n<u;n++){var m=r.fromGeoTo3D(s[n]);this.vertices.push(m[0],m[1],m[2]),this.lineIndices.push(S+n,S+(n+1)%u)}if(this.bucket.style.fill){a.triIndexStart=this.triangleIndices.length,a.triIndexCount=3*(u-2);var x=o.process(s);if(x!=null)this.triangleIndices=x;else for(var n=0;n<u-2;n++)this.triangleIndices.push(S,S+n+1,S+n+2)}this.geometry2vb[e.gid]?(this.geometry2vb[e.gid].vertexCount+=a.vertexCount,this.geometry2vb[e.gid].lineIndexCount+=a.lineIndexCount,this.geometry2vb[e.gid].triIndexCount+=a.triIndexCount):this.geometry2vb[e.gid]=a,this.bufferDirty=!0,this.triBufferDirty=!0}return!0},a.prototype.remove=function(e){if(this.geometry2vb.hasOwnProperty(e.gid)){var t=this.geometry2vb[e.gid];delete this.geometry2vb[e.gid],this.vertices.splice(t.vertexStart,t.vertexCount);for(var n=t.lineIndexStart+t.lineIndexCount;n<this.lineIndices.length;n++)this.lineIndices[n]-=t.vertexCount/3;for(var n=t.triIndexStart+t.triIndexCount;n<this.triangleIndices.length;n++)this.triangleIndices[n]-=t.vertexCount/3;this.lineIndices.splice(t.lineIndexStart,t.lineIndexCount),this.triangleIndices.splice(t.triIndexStart,t.triIndexCount),t.tcoordsStart>=0&&this.tcoords.splice(t.tcoordsStart,t.tcoordsCount);for(var r in this.geometry2vb)if(r){var i=this.geometry2vb[r];i.vertexStart>t.vertexStart&&(i.vertexStart-=t.vertexCount,i.lineIndexStart-=t.lineIndexCount,i.triIndexStart-=t.triIndexCount,i.tcoordsStart>=0&&(i.tcoordsStart-=t.tcoordsCount))}this.bufferDirty=!0,this.triBufferDirty=!0}return this.vertices.length},a.prototype.dispose=function(e){this.vertexBuffer&&e.gl.deleteBuffer(this.vertexBuffer),this.lineIndexBuffer&&e.gl.deleteBuffer(this.lineIndexBuffer),this.triangleIndexBuffer&&e.gl.deleteBuffer(this.triangleIndexBuffer),this.tcoordBuffer&&e.gl.deleteBuffer(this.tcoordBuffer)},u.prototype.canApply=function(e,t){return e=="Polygon"||e=="MultiPolygon"||e=="LineString"||e=="MultiLineString"},u.prototype.createProgram=function(e){var t=new n(this.renderContext);return t.createFromSource(e.vertexCode,e.fragmentCode),t.id=this.programs.length,this.programs.push({fillShader:e,program:t}),t},u.prototype.getProgram=function(e){var t;for(var n=0;n<this.programs.length;n++)this.programs[n].fillShader==e&&(t=this.programs[n].program);return t||(t=this.createProgram(e)),t};var f=function(e,t){this.layer=e,this.style=new i(t),this.texture=null,this.polygonProgram=null,this.renderer=null,this.mainRenderable=null};return f.prototype.createRenderable=function(){return new a(this)},f.prototype.isCompatible=function(e){return this.style.strokeColor[0]==e.strokeColor[0]&&this.style.strokeColor[1]==e.strokeColor[1]&&this.style.strokeColor[2]==e.strokeColor[2]&&this.style.fill==e.fill&&this.style.fillTexture==e.fillTexture&&this.style.fillTextureUrl==e.fillTextureUrl&&this.style.fillShader==e.fillShader?!0:!1},u.prototype.createBucket=function(e,t){var n=this.renderContext.gl,r=n.createBuffer(),i=new f(e,t),s=this;if(t.fill){var o=!1;if(t.fillTextureUrl){var u=new Image;u.crossOrigin="",u.onload=function(){i.texture=s.renderContext.createNonPowerOfTwoTextureFromImage(u,e.invertY)},u.onerror=function(e){console.log("Cannot load "+u.src)},u.src=t.fillTextureUrl,o=!0}else t.fillTexture&&(i.texture=t.fillTexture,o=!0);t.fillShader&&t.fillShader.fragmentCode?(t.fillShader.vertexCode||(t.fillShader.vertexCode=this.texVertexShader),t.fillShader.vertexCode||(t.fillShader.fragmentCode=this.texFragmentShader),i.polygonProgram=this.getProgram(t.fillShader)):i.polygonProgram=o?this.texProgram:this.basicProgram}return i},u.prototype.render=function(e,t,n){var r=this.renderContext,i=this.renderContext.gl;i.disable(i.DEPTH_TEST),i.depthMask(!1),i.enable(i.BLEND),i.blendEquation(i.FUNC_ADD),i.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA),this.basicProgram.apply(),mat4.multiply(r.projectionMatrix,r.viewMatrix,r.modelViewMatrix),i.uniformMatrix4fv(this.basicProgram.uniforms.viewProjectionMatrix,!1,r.modelViewMatrix);var s=null;for(var o=t;o<n;o++){var u=e[o],a=u.bucket,f=a.style.strokeColor;i.uniform4f(this.basicProgram.uniforms.color,f[0],f[1],f[2],f[3]*a.layer.opacity()),u.vertexBuffer||(u.vertexBuffer=i.createBuffer(),u.lineIndexBuffer=i.createBuffer()),i.bindBuffer(i.ARRAY_BUFFER,u.vertexBuffer),i.vertexAttribPointer(this.basicProgram.attributes.vertex,3,i.FLOAT,!1,0,0),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,u.lineIndexBuffer),u.bufferDirty&&(i.bufferData(i.ARRAY_BUFFER,new Float32Array(u.vertices),i.STATIC_DRAW),i.bufferData(i.ELEMENT_ARRAY_BUFFER,new Uint16Array(u.lineIndices),i.STATIC_DRAW),u.bufferDirty=!1),i.drawElements(i.LINES,u.lineIndices.length,i.UNSIGNED_SHORT,0);if(a.polygonProgram){var l=a.polygonProgram;l.apply(),i.uniformMatrix4fv(l.uniforms.viewProjectionMatrix,!1,r.modelViewMatrix),i.uniform1i(l.uniforms.texture,0),u.tcoords.length>0?(u.tcoordBuffer||(u.tcoordBuffer=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,u.tcoordBuffer),i.bufferData(i.ARRAY_BUFFER,new Float32Array(u.tcoords),i.STATIC_DRAW),u.tcoordBuffer.itemSize=2,u.tcoordBuffer.numItems=u.tcoords.length/2),i.bindBuffer(i.ARRAY_BUFFER,u.tcoordBuffer)):i.bindBuffer(i.ARRAY_BUFFER,this.tcoordBuffer),i.vertexAttribPointer(l.attributes.tcoord,2,i.FLOAT,!1,0,0),i.bindBuffer(i.ARRAY_BUFFER,u.vertexBuffer),i.vertexAttribPointer(l.attributes.vertex,3,i.FLOAT,!1,0,0),a.style.fillShader&&a.style.fillShader.updateUniforms&&a.style.fillShader.updateUniforms(i,u.bucket,l),u.triangleIndexBuffer||(u.triangleIndexBuffer=i.createBuffer()),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,u.triangleIndexBuffer),u.triBufferDirty&&(i.bufferData(i.ELEMENT_ARRAY_BUFFER,new Uint16Array(u.triangleIndices),i.STATIC_DRAW),u.triBufferDirty=!1),i.activeTexture(i.TEXTURE0),u.bucket.texture?(i.bindTexture(i.TEXTURE_2D,u.bucket.texture),i.uniform4f(l.uniforms.color,1,1,1,f[3]*a.layer.opacity())):(i.bindTexture(i.TEXTURE_2D,this.whiteTexture),f=u.bucket.style.fillColor,i.uniform4f(l.uniforms.color,f[0],f[1],f[2],f[3]*a.layer.opacity())),i.drawElements(i.TRIANGLES,u.triangleIndices.length,i.UNSIGNED_SHORT,0),this.basicProgram.apply()}}i.enable(i.DEPTH_TEST),i.depthMask(!0),i.disable(i.BLEND)},s.factory.push(function(e){return new u(e)}),u}),define("gw/PointSpriteRenderer",["./Utils","./VectorRenderer","./Program","./CoordinateSystem","./FeatureStyle","./VectorRendererManager"],function(e,t,n,r,i,s){var o=function(e){t.prototype.constructor.call(this,e),this.numberOfRenderPoints=0;var r="	attribute vec3 vertex; \n	uniform mat4 viewProjectionMatrix; \n	uniform float pointSize; \n	void main(void)  \n	{ \n		gl_Position = viewProjectionMatrix * vec4(vertex,1.0); \n		gl_PointSize = pointSize; \n	} \n	",i="	precision lowp float; \n	uniform sampler2D texture; \n	uniform float alpha; \n	uniform vec3 color; \n	\n	void main(void) \n	{ \n		vec4 textureColor = texture2D(texture, gl_PointCoord); \n		gl_FragColor = vec4(textureColor.rgb * color, textureColor.a * alpha); \n		if (gl_FragColor.a <= 0.0) discard; \n		//gl_FragColor = vec4(1.0); \n	} \n	";this.program=new n(e.renderContext),this.program.createFromSource(r,i),this.defaultTexture=null};e.inherits(t,o);var u=function(e){this.bucket=e,this.geometry2vb={},this.vertices=[],this.vertexBuffer=null,this.vertexBufferDirty=!1};u.prototype.add=function(e){this.geometry2vb[e.gid]=this.vertices.length;var t=r.fromGeoTo3D(e.coordinates);return this.vertices.push(.99*t[0],.99*t[1],.99*t[2]),this.vertexBufferDirty=!0,!0},u.prototype.remove=function(e){if(this.geometry2vb.hasOwnProperty(e.gid)){var t=this.geometry2vb[e.gid];delete this.geometry2vb[e.gid],this.vertices.splice(t,3),this.vertexBufferDirty=!0;for(var n in this.geometry2vb)n&&this.geometry2vb[n]>t&&(this.geometry2vb[n]-=3)}return this.vertices.length},u.prototype.dispose=function(e){this.vertexBuffer&&e.gl.deleteBuffer(this.vertexBuffer)},o.prototype._buildDefaultTexture=function(e){if(!this.defaultTexture){var t=this.globe.renderContext.gl;this.defaultTexture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.defaultTexture);var n=new Uint8Array([255,255,255,255]);t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,n)}e.texture=this.defaultTexture,e.textureWidth=10,e.textureHeight=10},o.prototype._buildTextureFromImage=function(e,t){e.texture=this.globe.renderContext.createNonPowerOfTwoTextureFromImage(t),e.textureWidth=t.width,e.textureHeight=t.height},o.prototype.canApply=function(e,t){return e=="Point"&&!t.label};var a=function(e,t){this.layer=e,this.style=new i(t),this.texture=null,this.renderer=null};return a.prototype.createRenderable=function(){return new u(this)},a.prototype.isCompatible=function(e){return this.style.iconUrl==e.iconUrl&&this.style.icon==e.icon&&this.style.fillColor[0]==e.fillColor[0]&&this.style.fillColor[1]==e.fillColor[1]&&this.style.fillColor[2]==e.fillColor[2]?!0:!1},o.prototype.createBucket=function(e,t){var n=this.globe.renderContext.gl,r=n.createBuffer(),i=new a(e,t);i.renderer=this;if(t.iconUrl){var s=new Image;s.crossOrigin="";var o=this;s.onload=function(){o._buildTextureFromImage(i,s),o.globe.renderContext.requestFrame()},s.onerror=function(){o._buildDefaultTexture(i)},s.src=t.iconUrl}else t.icon?this._buildTextureFromImage(i,t.icon):this._buildDefaultTexture(i);return i},o.prototype.render=function(e,t,n){var r=this.globe.renderContext,i=r.gl;i.disable(i.DEPTH_TEST),i.enable(i.BLEND),i.blendEquation(i.FUNC_ADD),i.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA),this.program.apply(),mat4.multiply(r.projectionMatrix,r.viewMatrix,r.modelViewMatrix),i.uniformMatrix4fv(this.program.uniforms.viewProjectionMatrix,!1,r.modelViewMatrix),i.uniform1i(this.program.uniforms.texture,0);var s=null;for(var o=t;o<n;o++){var u=e[o],a=u.bucket;if(s!=a){i.uniform1f(this.program.uniforms.alpha,a.layer._opacity);var f=a.style.fillColor;i.uniform3f(this.program.uniforms.color,f[0],f[1],f[2]),i.uniform1f(this.program.uniforms.pointSize,a.textureWidth),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,a.texture),s=a}u.vertexBuffer||(u.vertexBuffer=i.createBuffer()),i.bindBuffer(i.ARRAY_BUFFER,u.vertexBuffer),i.vertexAttribPointer(this.program.attributes.vertex,3,i.FLOAT,!1,0,0),u.vertexBufferDirty&&(i.bufferData(i.ARRAY_BUFFER,new Float32Array(u.vertices),i.STATIC_DRAW),u.vertexBufferDirty=!1),i.drawArrays(i.POINTS,0,u.vertices.length/3)}i.enable(i.DEPTH_TEST),i.disable(i.BLEND)},s.factory.push(function(e){return new o(e)}),o}),define("gw/PointRenderer",["./Utils","./VectorRenderer","./CoordinateSystem","./VectorRendererManager","./FeatureStyle","./Program"],function(e,t,n,r,i,s){var o=function(){var e=18,t=1,n=null,r=function(){n=document.createElement("canvas"),n.width=512,n.height=e+2*t},s=function(s,o){n||r();var u=o;u?u instanceof Array&&(u=i.fromColorToString(o)):u="#fff";var a=n.getContext("2d");a.clearRect(0,0,n.width,n.height),a.fillStyle=u,a.font=e+"px sans-serif",a.textBaseline="top",a.shadowColor="#000",a.shadowOffsetX=1,a.shadowOffsetY=1,a.shadowBlur=2,a.fillText(s,t,t);var f=a.measureText(s);return a.getImageData(0,0,Math.floor(f.width)+2*t,n.height)};return{generateImageData:s}}(),u=function(e){t.prototype.constructor.call(this,e),this.renderContext=e.tileManager.renderContext,this.tileConfig=e.tileManager.tileConfig,this.numberOfRenderPoints=0;var n="	attribute vec3 vertex; // vertex have z = 0, spans in x,y from -0.5 to 0.5 \n	uniform mat4 viewProjectionMatrix; \n	uniform vec3 poiPosition; // world position \n	uniform vec2 poiScale; // x,y scale \n	uniform vec2 tst; \n	\n	varying vec2 texCoord; \n	\n	void main(void)  \n	{ \n		// Generate texture coordinates, input vertex goes from -0.5 to 0.5 (on x,y) \n		texCoord = vertex.xy + vec2(0.5) + tst; \n		// Invert y \n		texCoord.y = 1.0 - texCoord.y; \n		\n		// Compute poi position in clip coordinate \n		gl_Position = viewProjectionMatrix * vec4(poiPosition, 1.0); \n		gl_Position.xy += vertex.xy * gl_Position.w * poiScale; \n	} \n	",r="	precision lowp float; \n	varying vec2 texCoord; \n	uniform sampler2D texture; \n	uniform float alpha; \n	uniform vec3 color; \n	\n	void main(void) \n	{ \n		vec4 textureColor = texture2D(texture, texCoord); \n		gl_FragColor = vec4(textureColor.rgb * color, textureColor.a * alpha); \n		if (gl_FragColor.a <= 0.0) discard; \n	} \n	";this.program=new s(this.renderContext),this.program.createFromSource(n,r);var i=new Float32Array([-0.5,-0.5,0,.5,-0.5,0,.5,.5,0,-0.5,.5,0]),o=this.renderContext.gl;this.vertexBuffer=o.createBuffer(),o.bindBuffer(o.ARRAY_BUFFER,this.vertexBuffer),o.bufferData(o.ARRAY_BUFFER,i,o.STATIC_DRAW),this.defaultTexture=null};e.inherits(t,u),u.prototype._buildDefaultTexture=function(e){if(!this.defaultTexture){var t=this.renderContext.gl;this.defaultTexture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.defaultTexture);var n=new Uint8Array([255,255,255,255]);t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,n)}e.texture=this.defaultTexture,e.textureWidth=10,e.textureHeight=10},u.prototype._buildTextureFromImage=function(e,t){e.texture=this.renderContext.createNonPowerOfTwoTextureFromImage(t),e.textureWidth=t.width,e.textureHeight=t.height};var a=function(e){this.bucket=e,this.points=[]};a.prototype.add=function(e){var t=e.coordinates,r=n.fromGeoTo3D(t),i=vec3.create();return vec3.normalize(r,i),this.points.push({pos3d:r,vertical:i,geometry:e}),!0},a.prototype.remove=function(e){for(var t=0;t<this.points.length;t++)if(this.points[t].geometry==e)return this.points.splice(t,1),this.points.length;return this.points.length},a.prototype.dispose=function(e){};var f=function(e,t){this.layer=e,this.style=new i(t),this.renderer=null,this.texture=null};return f.prototype.createRenderable=function(){return new a(this)},f.prototype.isCompatible=function(e){return this.style.iconUrl==e.iconUrl&&this.style.icon==e.icon&&this.style.label==e.label},u.prototype.createBucket=function(e,t){var n=new f(e,t);if(t.label){var r=o.generateImageData(t.label,t.textColor);this._buildTextureFromImage(n,r)}else if(t.iconUrl){var i=new Image;i.crossOrigin="";var s=this;i.onload=function(){s._buildTextureFromImage(n,i),s.renderContext.requestFrame()},i.onerror=function(){s._buildDefaultTexture(n)},i.src=t.iconUrl}else t.icon?this._buildTextureFromImage(n,t.icon):this._buildDefaultTexture(n);return n},u.prototype.render=function(e,t,r){this.numberOfRenderPoints=0;var i=this.renderContext,s=this.renderContext.gl;s.enable(s.BLEND),s.blendEquation(s.FUNC_ADD),s.blendFunc(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA),this.program.apply(),mat4.multiply(i.projectionMatrix,i.viewMatrix,i.modelViewMatrix),s.uniformMatrix4fv(this.program.uniforms.viewProjectionMatrix,!1,i.modelViewMatrix),s.uniform1i(this.program.uniforms.texture,0),mat4.inverse(i.viewMatrix,i.modelViewMatrix);var o=[i.modelViewMatrix[8],i.modelViewMatrix[9],i.modelViewMatrix[10]];vec3.normalize(o),vec3.scale(o,this.tileConfig.cullSign,o);var u=i.computePixelSizeVector();s.bindBuffer(s.ARRAY_BUFFER,this.vertexBuffer),s.vertexAttribPointer(this.program.attributes.vertex,3,s.FLOAT,!1,0,0);var a=null;for(var f=t;f<r;f++){var l=e[f],c=l.bucket;if(l.points.length==0)continue;if(c!=a){s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,c.texture);var h=[2*c.textureWidth/i.canvas.width,2*c.textureHeight/i.canvas.height];s.uniform2fv(this.program.uniforms.poiScale,h),s.uniform2fv(this.program.uniforms.tst,[.5/c.textureWidth,.5/c.textureHeight])}for(var p=0;p<l.points.length;p++){var d=l.points[p].pos3d,v=l.points[p].vertical,h=c.textureHeight*(u[0]*d[0]+u[1]*d[1]+u[2]*d[2]+u[3]);h*=this.tileConfig.cullSign;var m=h/n.heightScale*.001;if(m>c.style.pointMaxSize)continue;if(vec3.dot(v,o)>0&&i.worldFrustum.containsSphere(d,h)>=0){var g=v[0]*h+d[0],y=v[1]*h+d[1],b=v[2]*h+d[2];s.uniform3f(this.program.uniforms.poiPosition,g,y,b),s.uniform1f(this.program.uniforms.alpha,c.layer._opacity);var w=c.style.fillColor;s.uniform3f(this.program.uniforms.color,w[0],w[1],w[2]),s.drawArrays(s.TRIANGLE_FAN,0,4),this.numberOfRenderPoints++}}}s.disable(s.BLEND)},u.prototype.canApply=function(e,t){return e=="Point"},r.factory.push(function(e){return new u(e)}),u}),define("MizarWidget",["jquery","underscore-min","gw/EquatorialCoordinateSystem","gw/Sky","gw/Stats","gw/AstroNavigation","gw/AttributionHandler","gw/VectorLayer","gw/TouchNavigationHandler","gw/MouseNavigationHandler","gw/KeyboardNavigationHandler","gw/Event","text!../templates/mizarCore.html","text!../data/backgroundSurveys.json","./LayerManager","./LayerManagerView","./BackgroundLayersView","./NameResolver","./NameResolverView","./ReverseNameResolver","./Utils","./PickingManager","./FeaturePopup","./IFrame","./Compass","./MollweideViewer","./ErrorDialog","./AboutDialog","./Share","./Samp","./AdditionalLayersView","./ImageManager","./ImageViewer","./UWSManager","./PositionTracker","./MeasureTool","./StarProvider","./ConstellationProvider","./JsonProvider","./OpenSearchProvider","./PlanetProvider","gw/ConvexPolygonRenderer","gw/PointSpriteRenderer","gw/PointRenderer","jquery.ui"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H){var B=!1,j,F,I=function(t){var n=window.document.documentURI,r=n.indexOf("sharedParameters=");if(r!=-1){var i=r+"sharedParameters=".length,s=n.substr(i);if(t.shortener)e.ajax({type:"GET",url:t.shortener.baseUrl+"/"+s,async:!1,success:function(e){z(t,e)},error:function(e){console.error(e)}});else{console.log("Shortener plugin isn't defined, try to extract as a string");var o=JSON.parse(unescape(s));z(t,o)}}},q=function(){var e="js/conf.json",t=window.document.documentURI,n=t.indexOf("?conf=");if(n!=-1){var r=t.search(/[&|?]sharedParameters=/);if(r!=-1)var i=r-n-"?conf=".length;var s=t.substr(n+"?conf=".length,i);s!="undefined"&&s!=""&&(e=s)}return e},R=function(){localStorage.showAbout==undefined&&!B&&(k.show(),B=!0),e(j).find("#loading").hide(300)},U=function(e){var t=new RegExp("/\\*(.|[\r\n])*?\\*/","g"),n=new RegExp("[^:]//.*[\r\n]","g");return e=e.replace(n,""),e=e.replace(t,""),e},z=function(e,t){e.navigation.initTarget=t.initTarget,e.navigation.initFov=t.fov,e.navigation.up=t.up;if(e.layers)for(var n in t.visibility){var r=n;for(var i=0;i<e.layers.length;i++){var s=e.layers[i];if(r==s.name){s.visible=t.visibility[r];continue}}}},W=document.getElementsByTagName("script"),X=t.find(W,function(e){return e.src.indexOf("MizarWidget.min")!=-1}),V;X?V=X.src.split("/").slice(0,-1).join("/")+"/":V="./";var $=function(u,v){c.prototype.constructor.call(this),j=u;var m=v.sitoolsBaseUrl?v.sitoolsBaseUrl:"http://demonstrator.telespazio.com/sitools";this.isMobile="ontouchstart"in window&&window.ontouchstart!=null||window.DocumentTouch&&document instanceof DocumentTouch,F={sitoolsBaseUrl:m,mizarBaseUrl:V,continuousRendering:v.hasOwnProperty("continuousRendering")?v.continuousRendering:!0,coordSystem:v.hasOwnProperty("coordSystem")?v.coordSystem:"EQ",debug:v.hasOwnProperty("debug")?v.debug:!1,nameResolver:{baseUrl:m+"/project/mizar/plugin/nameResolver",zoomFov:15},reverseNameResolver:{baseUrl:m+"/project/mizar/plugin/reverseNameResolver"},coverageService:{baseUrl:m+"/project/mizar/plugin/coverage?moc="},solarObjects:{baseUrl:m+"/project/mizar/plugin/solarObjects/"},votable2geojson:{baseUrl:m+"/project/mizar/plugin/votable2geojson"},cutOut:{baseUrl:m+"/cutout"},zScale:{baseUrl:m+"/zscale"},healpixcut:{baseUrl:m+"/healpixcut"},shortener:{baseUrl:m+"/shortener"},navigation:{initTarget:[85.25,-2.4608],initFov:20,inertia:!0,minFov:.001,zoomFactor:0,handlers:[new f({zoomOnDblClick:!0}),new l]},stats:{verbose:!1,visible:!1},isMobile:this.isMobile};var y=["navigation","nameResolver","stats"];for(var b=0;b<y.length;b++){var T=y[b];e.extend(F[T],v[T])}var N=t.template(h,{});e(N).appendTo(u),this.sky=null,this.navigation=null;var k=q(),O=e(u).find("#GlobWebCanvas")[0],_=e(u).attr("width");_||(_=window.innerWidth);var H=e(u).attr("height");H||(H=window.innerHeight),O.width=_,O.height=H,e(j).css({position:"relative",width:O.width,height:O.height,overflow:"hidden"}),e(window).resize(function(){O.width!=window.innerWidth&&(O.width=window.innerWidth),O.height!=window.innerHeight&&(O.height=window.innerHeight)});try{this.sky=new r({canvas:O,tileErrorTreshold:1.5,continuousRendering:this.isMobile?!1:F.continuousRendering})}catch(B){document.getElementById("GlobWebCanvas").style.display="none",document.getElementById("loading").style.display="none",document.getElementById("webGLNotAvailable").style.display="block"}this.sky.subscribe("baseLayersReady",R),this.sky.subscribe("baseLayersError",function(t){e(j).find("#loading").hide();var n=t.id==0?" background layer ":" additional layer ";C.open("<p>The"+n+"<span style='color: orange'>"+t.name+"</span> can not be displayed.</p>			 <p>First check if data source related to this layer is still accessible. Otherwise, check your Sitools2 configuration.</p>")}),O.addEventListener("webglcontextlost",function(e){e.preventDefault(),document.getElementById("loading").style.display="none",document.getElementById("webGLContextLost").style.display="block"},!1),I(F);var z=this;F.stats.visible&&(new i(z.sky.renderContext,{element:"fps",verbose:F.stats.verbose}),e("#fps").show()),n.type=F.coordSystem,this.isMobile&&(F.navigation.handlers=[new a({inversed:!0,zoomOnDblClick:!0})],window.addEventListener("orientationchange",function(){z.sky.renderContext.requestFrame()},!1)),this.navigation=new s(this.sky,F.navigation),new o(this.sky,{element:"attributions"}),g.init(this,F),d.init(this,F),E.init(this,F),L.init({navigation:this.navigation,configuration:F}),A.init(this,d,M,F),P.init({element:"posTracker",globe:this.sky,navigation:this.navigation,isMobile:this.isMobile}),D.init(F),w.init(this.sky),p=U(p);try{var W=e.parseJSON(p)}catch(X){return C.open("Background surveys parsing error<br/> For more details see http://jsonlint.com/."),console.error(X.message),!1}for(var b=0;b<W.length;b++)z.addLayer(W[b]);document.addEventListener("keydown",function(t){t.ctrlKey==1&&t.keyCode==32&&e(".canvas > canvas").siblings().each(function(){e(this).fadeToggle()})}),e("body").on("mouseenter","span.defaultImg",function(){e(this).stop().animate({opacity:"0"},100),e(this).siblings(".hoverImg").stop().animate({opacity:"1"},100)}),e("body").on("mouseleave","span.defaultImg",function(){e(this).stop().animate({opacity:"1"},100),e(this).siblings(".hoverImg").stop().animate({opacity:"0"},100)}),e("body").on("click",".closeBtn",function(t){switch(e(this).parent().attr("id")){case"externalIFrame":x.hide();break;case"selectedFeatureDiv":S.hide();break;default:e(this).parent().fadeOut(300)}})};return w.inherits(c,$),$.prototype.setBackgroundSurvey=function(e){d.setBackgroundSurvey(e)},$.prototype.setCustomBackgroundSurvey=function(e){e.background=!0;var t=d.addLayer(e);return d.setBackgroundSurvey(e.name),t},$.prototype.addLayer=function(t){return t.fitsSupported&&(t.onready=function(t){if(t.dataType=="fits"&&t.levelZeroImage)if(t.div){var n=w.formatId(t.name);e("#addFitsView_"+n).button("enable"),t.div.setImage(t.levelZeroImage)}else{e("#fitsView").button("enable");var r=m.getDiv();r.setImage(t.levelZeroImage)}}),d.addLayer(t)},$.prototype.removeLayer=function(e){d.removeLayer(e)},$.prototype.goTo=function(e){g.goTo(e)},$.prototype.getCurrentFov=function(){return this.navigation.getFov()},$.prototype.setZoom=function(e){var t=n.from3DToGeo(this.navigation.center3d);this.navigation.zoomTo(t,e,1e3)},$.prototype.setCompassGui=function(e){e?this.compass=new T({element:"compassDiv",globe:this.sky,navigation:this.navigation,coordSystem:n.type,isMobile:this.isMobile,mizarBaseUrl:V}):this.compass.remove()},$.prototype.setAngleDistanceGui=function(t){t?(this.measureTool||(this.measureTool=new H({globe:this.sky,navigation:this.navigation,isMobile:this.isMobile})),e(j).find("#measureContainer").show()):e(j).find("#measureContainer").hide()},$.prototype.setSampGui=function(t){t?e(j).find("#sampContainer").show():e(j).find("#sampContainer").hide()},$.prototype.setShortenerUrlGui=function(t){t?e(j).find("#shareContainer").show():e(j).find("#shareContainer").hide()},$.prototype.set2dMapGui=function(t){t?(this.mollweideViewer||(this.mollweideViewer=new N({globe:this.sky,navigation:this.navigation,mizarBaseUrl:V})),e(j).find("#2dMapContainer").show()):e(j).find("#2dMapContainer").hide()},$.prototype.setReverseNameResolverGui=function(e){e?b.init(this,F):b.remove()},$.prototype.setNameResolverGui=function(e){e?y.init():y.remove()},$.prototype.setCategoryGui=function(t){t?v.init(this,e.extend({element:e(j).find(".sidebar")},F)):v.remove()},$.prototype.setImageViewerGui=function(e){e?_.init(this):_.remove()},$.prototype.setCoordinateSystem=function(e){n.type=e,this.mollweideViewer&&this.mollweideViewer.setCoordSystem(e),this.navigation.publish("modified")},$.prototype.getLayers=function(e){return d.getLayers()},$.prototype.getLayer=function(e){var n=this.getLayers();return t.findWhere(n,{name:e})},$}),require("MizarWidget")});